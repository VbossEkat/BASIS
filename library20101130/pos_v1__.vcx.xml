<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S00L5IAF</uniqueid>
		<timestamp>881610468</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblgrd</objname>
		<parent/>
		<properties>WordWrap = .T.
value = 
Name = "lblgrd"
</properties>
		<protected/>
		<methods>PROCEDURE value_assign
LPARAMETERS luNewVal

This.Value   = luNewVal
This.Caption = luNewVal
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>value
*value_assign 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>lblgrd</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>881746130</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselprctype</objname>
		<parent/>
		<properties>Height = 60
Width = 330
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = "Ïðàéñ-ëèñò"
ZoomBox = .F.
Name = "frmselprctype"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Top = 0
CSTRESIZABLE.Left = 24
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Top = 0
CSTDATAWORK.Left = 48
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmPriceEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*------------------------------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*09.08.2005 17:26 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]
	.uRetVal = .cntIdCtlTreePrcType.Value
ELSE
	.uRetVal = 0
ENDIF
*------------------------------------------------------------------------------

*09.08.2005 17:28 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmSelPrcType.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS	tnPrcTypeID

*14.04.2006 09:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*14.04.2006 09:17 -&gt;Óñòàíîâèì ïðàéñ-ëèñò ïî óìîë÷àíèþ
This.cntIdCtlTreePrcType.Value = tnPrcTypeID
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl

*13.04.2006 18:59 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnKeyCode, tnShiftAltCtrl)
*------------------------------------------------------------------------------

*13.04.2006 19:07 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE
	CASE tnKeyCode = 88 &amp;&amp; Sfift-F5(Âûáîð)
		*13.04.2006 19:01 -&gt;Àêòèâèðóåì ñïèñîê âûáîðà
		NODEFAULT
		This.cntIdCtlTreePrcType.ShowSelectObject()
	CASE tnKeyCode = 13 &amp;&amp; Enter(Âûõîä)
		NODEFAULT
		This._HandleCntCancelSaveEvent([OK])
	CASE tnKeyCode = 133 &amp;&amp; F11(Âûõîä)
		NODEFAULT
		This._HandleCntCancelSaveEvent([CANCEL])
ENDCASE
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmPriceEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*------------------------------------------------------------------------------

*09.08.2005 17:00 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*09.08.2005 17:01 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*09.08.2005 17:09 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvPrcTypeList IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18L1B4NYC</uniqueid>
		<timestamp>881746130</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlTreePrcType</objname>
		<parent>frmselprctype</parent>
		<properties>Top = 5
Left = 77
TabIndex = 4
_rsaliasname = lvPrcTypeList
_rsfieldnameid = PrcTypeID
_rsfieldnametext = PrcTypeNM
_selectobject = frmidctlgridintop;pos_v1.vcx
Name = "cntIdCtlTreePrcType"
txtText._highlightobject = .Parent.Parent.lblPrcType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18L1BE4FO</uniqueid>
		<timestamp>881746130</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblPrcType</objname>
		<parent>frmselprctype</parent>
		<properties>FontBold = .T.
Caption = "Ïðàéñ-ëèñò:"
Left = 5
Top = 8
TabIndex = 3
ZOrderSet = 7
Name = "lblPrcType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>881746130</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmselprctype</parent>
		<properties>Top = 32
Left = 122
TabIndex = 2
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselprctype</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SD0LF3I2</uniqueid>
		<timestamp>882463921</timestamp>
		<class>olecomm</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>olecommprox</objname>
		<parent/>
		<properties>Height = 41
Width = 42
clinkobjname = 
Name = "olecommprox"
</properties>
		<protected/>
		<methods>PROCEDURE _read
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: pos_v1.vcx
* Class.Module....: OleCommProx._Read
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ôîðìèðîâàíèå ïðèíèìàåìîãî ñîîáùåíèÿ
*------------------------------------------------------------------------------

*25.04.2006 10:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnLen, ;
		lcMsg, ;
		lcBuffer
***
lnLen = 1
lcMsg = []
*------------------------------------------------------------------------------

WITH This

*25.04.2006 09:59 -&gt;
.InputLen = 1

DO WHILE lnLen &lt; 1000
	***
	lcBuffer = .Input
	IF !EMPTY(ALLTRIM(lcBuffer)) OR ALLTRIM(lcBuffer)&lt;&gt;CHR(13)
		lcMsg=lcMsg+lcBuffer
		lnLen=1
	ELSE
		IF ALLTRIM(lcBuffer)=CHR(13)
	.Input
RETURN lcMsg
		ENDIF
	ENDIF
	lnLen=lnLen+1
	***
ENDDO

MESSAGEBOX ("Timeout!",0,"Error")
RETURN []

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
This._Close()

*25.04.2006 10:37 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
*25.04.2006 10:37 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

This._Open()
ENDPROC
PROCEDURE OnComm
*** ActiveX Control Event ***
*25.04.2006 10:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcCode, ;
		lcObjName
***
lcCode = []
lcObjName = This.cLinkObjName
*------------------------------------------------------------------------------

*25.04.2006 10:34 -&gt;Ïîêàçûâàåì ïîëó÷åííûé êîä
&amp;lcObjName..Value    = []
&amp;lcObjName..Refresh()
lcCode = This._Read()

&amp;lcObjName..Value    = lcCode
&amp;lcObjName..Refresh()
&amp;lcObjName..SetFocus()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDjrPchaMYBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAHcAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAoAAABSVFNFbmFibGUABQAAAEwAAAAACQAAAFNldHRpAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG5ncwATAAAASAAAAAAKAAAAOTYwMCxuLDgsMQsAAABTVGhyZXNob2xkAAkAAABJCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\System32\mscomm32.ocx
</ole2>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>clinkobjname èìÿ îáúåêòà,  â êîòîðûé áóäåò îñóùåñòâëÿòüñÿ ââîä
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>olecommprox</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0MAY5G</uniqueid>
		<timestamp>895705977</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntclock</objname>
		<parent/>
		<properties>Width = 189
Height = 30
BorderWidth = 0
cclock = 
Name = "cntclock"
</properties>
		<protected/>
		<methods>PROCEDURE clockrefresh
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: CNTCLOCK.CLOCKREFRESH
* Called by.......: &lt;This.TmrClock.Timer()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå òåêóùåãî âðåìåíè
*------------------------------------------------------------------------------

*11.04.2006 10:38 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcClock
***
lcClock = LEFT(TTOC(DATETIME()),LEN(TTOC(DATETIME()))-3)
*------------------------------------------------------------------------------

*11.04.2006 10:39 -&gt;Ìåíÿåì âðåìÿ
IF This.cClock # lcClock
	This.cClock = lcClock
	This.lblClock.Caption = lcClock
	This.lblClock.Refresh()
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*11.04.2006 10:35 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*11.04.2006 10:35 -&gt;Ïîëó÷èì òåêóùåå âðåìÿ
This.cClock = LEFT(TTOC(DATETIME()),LEN(TTOC(DATETIME()))-3)
*------------------------------------------------------------------------------

*11.04.2006 10:43 -&gt;Îòîáðàçèì òåêóùåå âðåìÿ
*This.lblClock.Caption = This.cClock
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>cclock îòîáðàæàåìîå âðåìÿ
*clockrefresh îáíîâëåíèå òåêóùåãî âðåìåíè
*tick âûçûâàåòñÿ ïðè ñðàáîòêå òàéìåðà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0MK5GI</uniqueid>
		<timestamp>881547485</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblClock</objname>
		<parent>cntclock</parent>
		<properties>FontSize = 18
Caption = ( LEFT(TTOC(DATETIME()),LEN(TTOC(DATETIME()))-3))
ZOrderSet = 0
Name = "lblClock"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0MK5GK</uniqueid>
		<timestamp>895705977</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>tmrClock</objname>
		<parent>cntclock</parent>
		<properties>Top = 4
Left = 166
Height = 23
Width = 23
Interval = 5000
Name = "tmrClock"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
This.Parent.ClockRefresh()
This.Parent.Tick()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntclock</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>910781236</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdiscount</objname>
		<parent/>
		<properties>Height = 108
Width = 585
ShowWindow = 1
DoCreate = .T.
BorderStyle = 0
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
cclu = 
Name = "frmdiscount"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE cstresizable.doresize
NODEFAULT
ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: Pos.pjx
* Library.........: .vcx
* Class.Module....: frmDiscount.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tcCLU&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î äèñêîíòíîé êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tcCLU

*12.05.2006 11:38 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tcCLU
*------------------------------------------------------------------------------

WITH This

*12.05.2006 11:37 -&gt;Ïîëó÷èì äàííûå î êàðòå
USE IN SELECT([lvDiscCardViewByCLU])
***

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS SHARED
ENDIF
***
SET DATABASE TO BASIS

USE lvDiscCardViewByCLU IN 0
*------------------------------------------------------------------------------

*12.05.2006 11:40 -&gt;Ïîêàæåì äàííûå ïî êàðòå
.txtClientNM.Value = lvDiscCardViewByCLU.CltNM
.txtDiscNM.Value   = lvDiscCardViewByCLU.DiscNM
*------------------------------------------------------------------------------

*12.05.2006 11:41 -&gt;Ñîõðàíèì ID êàðòû
.uRetVal = lvDiscCardViewByCLU.DiscCardID
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
LPARAMETERS tnTop,tnWidth

WITH This

*11.05.2006 15:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.09.2006 11:12 -&gt;Ïîçèöèîíèðóåì îêíî
.Left	 = 5
.Top  	 = tnTop
.Width	 = tnWidth
.uRetVal = 0
*------------------------------------------------------------------------------

*24.01.2007 11:04 -&gt;Çàäàåì ðàçìåðû ýëåìåíòîâ
.lblHeader.Width	= tnWidth
.txtClientNM.Width	= tnWidth
.txtDiscNM.Width	= tnWidth
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl

WITH This

DO CASE

	CASE tnKeyCode = 13 AND .uRetVal # 0
		NODEFAULT
		.Hide()
	CASE tnKeyCode = 27 &amp;&amp;OR tnKeyCode = 133
		NODEFAULT
		.uRetVal = 0
		.Hide()
	CASE tnKeyCode &gt; 0 AND ISDIGIT(CHR(tnKeyCode)) OR CHR(tnKeyCode)=[=]
		NODEFAULT
		.cCLU = .cCLU + CHR(tnKeyCode)
	CASE tnKeyCode = 13 AND NOT EMPTY(.cCLU)
		NODEFAULT
		.GetCardInfo(.cCLU)
		.cCLU = []
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE

ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>cclu
*getcardinfo ïîëó÷åíèå èíôîðìàöèè î äèñêîíòíîé êàðòå
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>çîíà ïîêàçà äèñêîíòà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ129366</uniqueid>
		<timestamp>909662502</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtClientNM</objname>
		<parent>frmdiscount</parent>
		<properties>FontSize = 18
Enabled = .F.
Height = 32
Top = 37
Width = 585
DisabledForeColor = 0,0,0
ZOrderSet = 3
Name = "txtClientNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0MRKV7</uniqueid>
		<timestamp>909662502</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtDiscNM</objname>
		<parent>frmdiscount</parent>
		<properties>FontSize = 18
Alignment = 3
Value = 
Enabled = .F.
Height = 32
Top = 74
Width = 585
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtDiscNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0PEQS4</uniqueid>
		<timestamp>910781236</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblHeader</objname>
		<parent>frmdiscount</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
Caption = "Äèñêîíòíàÿ êàðòà"
Height = 26
Top = 5
Width = 585
ZOrderSet = 5
Name = "lblHeader"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80NOU12</uniqueid>
		<timestamp>910781236</timestamp>
		<class>msrreader</class>
		<classloc>opos_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Msrreader1</objname>
		<parent>frmdiscount</parent>
		<properties>Top = 2
Left = 514
Height = 33
Width = 32
ZOrderSet = 6
Name = "Msrreader1"
</properties>
		<protected/>
		<methods>PROCEDURE DataEvent
*** ActiveX Control Event ***
LPARAMETERS status

WITH This

*17.10.2006 11:05 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòå
.Parent.GetCardInfo(.Track2Data)
*------------------------------------------------------------------------------

*17.10.2006 11:05 -&gt;Çàïóñêàåì óñòðîéñòâî ñíîâà
.DeviceEnabled = .T.
.DataEventEnabled = .T.
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************


ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBlwOAjTMcBAwAAAMAAAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAA/v////7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iAbnMHrjSEat0AEAFTDcZAAMAAE8DAABpAwAAXABBAFUARABJAE8AQwB+ADEALgBPAEMAWAAAAEEAeABCAHIAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBAC0AMQAxAAEAAIAtADgARAA3ADAALQAwADAAQQAwAEMAOQA4AEIAMgA4AEUAMgB9ACAARAA6AFwAQgBpAG4AXABNAGkAYwByAG8AcwBvAGYAdAAgAFYAaQBzAHUAYQBsACAAUwB0AHUAZABpAG8AXABDAG8AbQBtAG8AbgBcAFQAbwBvAGwAcwBcAFYAQwBNAFwAVgBDAE0AQQBYAEIALgBPAEMAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = c:\develop\ncr\opos\oposmsr.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0MRKV8</uniqueid>
		<timestamp>910781236</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleCommProx</objname>
		<parent>frmdiscount</parent>
		<properties>Top = 0
Left = 546
Height = 48
Width = 58
ZOrderSet = 7
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "OleCommProx"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

*12.05.2006 11:08 -&gt;×èòàåì êîä
lcMsg = ._Read()
*------------------------------------------------------------------------------

*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
This.Parent.GetCardInfo(lcMsg)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDWwuAjTMcBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdiscount</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_20H0R2Z95</uniqueid>
		<timestamp>910781315</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmposedit</objname>
		<parent/>
		<properties>DoCreate = .T.
nkeyboard = 
Name = "frmposedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*09.02.2007 13:15 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

This.nKeyBoard = VAL(oRes.GetParam([SET],[KEYBOARD]))
*------------------------------------------------------------------------------

*19.10.2006 18:20 -&gt;Çàãðóçèì ðàñêëàäêó êëàâèàòóðû
LOCAL _PARAM
***
_PARAM = This.nKeyBoard
REQUERY([lvPOSKeyMap])
*------------------------------------------------------------------------------



ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl

*20.10.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcPOSFuncMsg
*------------------------------------------------------------------------------

WITH This

*09.02.2007 13:19 -&gt;Èùåì êîä íàæàòîé êëàâèøè è ïûòàåìñÿ îáðàáîòàòü
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
*------------------------------------------------------------------------------

IF lcPOSFuncMsg == [ESC]
		NODEFAULT
		.uRetVal = 0
		.Hide()
ELSE

	*09.02.2007 13:26 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	*------------------------------------------------------------------------------

ENDIF


ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*09.02.2007 13:14 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*09.02.2007 13:28 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS SHARED
ENDIF
***
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*19.10.2006 18:19 -&gt;Çàãðóçèì ðàñêëàäêó êëàâèàòóðû
USE lvPOSKeyMap IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nkeyboard ðàñêëàäêà êëàâèàòóðû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmposedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>910781410</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcard</objname>
		<parent/>
		<properties>Height = 77
Width = 585
ShowWindow = 1
DoCreate = .T.
BorderStyle = 0
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
ncheckid = 0
npaymenttypeid = 0
Name = "frmcard"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
WITH This

*31.05.2006 12:28 -&gt;Îòêðîåì ÁÄ
IF !USED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*31.05.2006 12:28 -&gt;Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òèïà îïëàòû
USE IN SELECT([lvCheckPaymentEdit])
USE lvCheckPaymentEdit IN 0
CURSORSETPROP([BUFFERING],3,[lvCheckPaymentEdit])
*------------------------------------------------------------------------------

*31.05.2006 12:28 -&gt;Äîáàâëÿåì òðàíçàêöèþ
APPEND BLANK IN lvCheckPaymentEdit
REPLACE ;
	lvCheckPaymentEdit.CheckPaymentTypeID WITH .nPaymentTypeID, ;
	lvCheckPaymentEdit.CheckID 			  WITH .nCheckID, ;
	lvCheckPaymentEdit.CheckPaymentPANNo  WITH [], ;
	lvCheckPaymentEdit.CheckPaymentQnt    WITH 1, ;
	lvCheckPaymentEdit.CheckPaymentPrcSum WITH .txtPaySum.Value ;
IN lvCheckPaymentEdit
*------------------------------------------------------------------------------

*31.05.2006 12:28 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåííîé çàïèñè
IF TABLEUPDATE(0,.T.,[lvCheckPaymentEdit])
	RETURN spGetLastIncrementedID([lvCheckPaymentEdit])
ELSE
	RETURN 0
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Pos_v1.pjx
* Library.........: Pos_v1.vcx
* Class.Module....: frmCard.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnCheckID, tnPaymentTypeID, tnPayNM, tnPaySum, tnTop&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tnCheckID, tnPaymentTypeID, tnPayNM, tnPaySum, tnTop

WITH This

*31.05.2006 12:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*31.05.2006 12:24 -&gt;Ïîìåùàåì ôîðìó íà ìåñòî
.Left = 5
.Top  = tnTop
*------------------------------------------------------------------------------

*31.05.2006 12:24 -&gt;Ñîõðàíÿåì ïàðàìåòðû
.nCheckID		 = tnCheckID
.nPaymentTypeID	 = tnPaymentTypeID
.txtPayNM.Value	 = tnPayNM
.txtPaySum.Value = tnPaySum
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
*------------------------------------------------------------------------------
* Project.........: Pos_v1.pjx
* Library.........: Pos_v1.vcx
* Class.Module....: frmCard.KeyPress
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnKeyCode, tnShiftAltCtrl&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáðàáîòêà äåéñòâèé ïîëüçîâàòåëÿ
*------------------------------------------------------------------------------
LPARAMETERS tnKeyCode, tnShiftAltCtrl

WITH This

*31.05.2006 12:26 -&gt;Îáðàáàòûâàåì íàæàòèÿ êëàâèø
DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		.uRetVal = ._HandleCntCancelSaveEvent()
		.Hide()
	CASE tnKeyCode = 27
		NODEFAULT
		.uRetVal = 0
		.Hide()
	OTHERWISE
	
		*31.05.2006 12:26 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>ncheckid èäåíòèôèêàòîð ÷åêà
npaymenttypeid òèï îïëàòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ129366</uniqueid>
		<timestamp>884958215</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPayNM</objname>
		<parent>frmcard</parent>
		<properties>FontSize = 18
Enabled = .F.
Height = 32
Left = 0
Width = 585
DisabledForeColor = 0,0,0
Name = "txtPayNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ12936E</uniqueid>
		<timestamp>884958497</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPaySum</objname>
		<parent>frmcard</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 0.00
Enabled = .F.
Height = 32
Left = 390
Top = 37
Width = 200
DisabledForeColor = 0,0,0
Name = "txtPaySum"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	*27.04.2006 10:15 -&gt;Îáðàáîòàåì íàæàòèå êíîïêè âûáîð
	CASE tnKeyCode = 88	&amp;&amp;Shift-F5 - âûáîð
		KEYBOARD [{TAB}]
	*------------------------------------------------------------------------------
	
	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
		This.Value= NTOM(0)		
	*------------------------------------------------------------------------------
	
OTHERWISE
	
	*16.04.2006 11:55 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	*------------------------------------------------------------------------------

ENDCASE
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ12936H</uniqueid>
		<timestamp>910781410</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblSumm</objname>
		<parent>frmcard</parent>
		<properties>FontSize = 18
Caption = "Ñóììà îïëàòû"
Left = 220
Top = 38
Name = "lblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcard</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>910781415</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcashinout</objname>
		<parent/>
		<properties>Height = 108
Width = 585
ShowWindow = 1
DoCreate = .T.
BorderStyle = 0
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
Name = "frmcashinout"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE cstresizable.doresize
NODEFAULT
ENDPROC
PROCEDURE Init
LPARAMETERS tnMode, ;
			tnTop, ;
			tnWidth
*------------------------------------------------------------------------------			

WITH This

*18.10.2006 12:19 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.09.2006 11:12 -&gt;Ïîçèöèîíèðóåì îêíî
.Left	 = 5
.Top  	 = tnTop
.Width	 = tnWidth
*------------------------------------------------------------------------------

*18.10.2006 12:19 -&gt;Âûñòàâëÿåì ïàðàìåòðû
.uRetVal = 0.00
.lblMode.Caption = ICASE(tnMode = 1,[Âíåñåíèå äåíåã â êàññó],tnMode = 2,[Âûïëàòà äåíåã èç êàññû],[])
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl

WITH This

DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		.uRetVal = .txtSumm.Value
		IF .uRetVal # 0
			.Hide()
		ENDIF
	CASE tnKeyCode = 27
		NODEFAULT
		.uRetVal = 0
		.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE

ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0MRKV7</uniqueid>
		<timestamp>909724444</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtSumm</objname>
		<parent>frmcashinout</parent>
		<properties>FontSize = 18
Anchor = 8
Alignment = 1
Value = 0.00
Height = 32
Left = 200
Top = 74
Width = 385
DisabledForeColor = 0,0,0
Name = "txtSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S00L5IAF</uniqueid>
		<timestamp>910781415</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblMode</objname>
		<parent>frmcashinout</parent>
		<properties>FontSize = 18
Anchor = 32
Alignment = 2
Caption = "êàññà"
Left = 261
Top = 39
Name = "lblMode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X90QCZT2</uniqueid>
		<timestamp>910781415</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblSumm</objname>
		<parent>frmcashinout</parent>
		<properties>FontSize = 18
Anchor = 128
Caption = "Ñóììà"
Left = 119
Top = 75
Name = "lblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcashinout</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>910781421</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcoupon</objname>
		<parent/>
		<properties>Height = 77
Width = 585
ShowWindow = 1
DoCreate = .T.
BorderStyle = 0
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
ncheckid = 0
npaymenttypeid = 0
Name = "frmcoupon"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
WITH This

*16.05.2006 10:49 -&gt;Îòêðîåì ÁÄ
IF !USED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*11.05.2006 12:06 -&gt;Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òèïà îïëàòû
USE IN SELECT([lvCheckPaymentEdit])
USE lvCheckPaymentEdit IN 0
CURSORSETPROP([BUFFERING],3,[lvCheckPaymentEdit])
*------------------------------------------------------------------------------

*11.05.2006 12:06 -&gt;Äîáàâëÿåì òðàíçàêöèþ
APPEND BLANK IN lvCheckPaymentEdit
REPLACE ;
	lvCheckPaymentEdit.CheckPaymentTypeID WITH .nPaymentTypeID, ;
	lvCheckPaymentEdit.CheckID 			  WITH .nCheckID, ;
	lvCheckPaymentEdit.CheckPaymentPANNo  WITH [], ;
	lvCheckPaymentEdit.CheckPaymentQnt    WITH .txtCouponQnt.Value, ;
	lvCheckPaymentEdit.CheckPaymentPrcSum WITH ROUND(.txtCouponQnt.Value*.txtCouponRate.Value,2) ;
IN lvCheckPaymentEdit
*------------------------------------------------------------------------------

*16.05.2006 09:20 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåííîé çàïèñè
IF TABLEUPDATE(0,.T.,[lvCheckPaymentEdit])
	RETURN spGetLastIncrementedID([lvCheckPaymentEdit])
ELSE
	RETURN 0
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Pos_v1.pjx
* Library.........: pos_v1.vcx
* Class.Module....: FRMCOUPON.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnCheckID, tnPaymentTypeID, tnCouponNM, tnCouponRate, tnTop&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tnCheckID, tnPaymentTypeID, tnCouponNM, tnCouponRate, tnTop

WITH This

*11.05.2006 15:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.05.2006 09:12 -&gt;Ïîìåùàåì ôîðìó íà ìåñòî
.Left = 5
.Top  = tnTop
*------------------------------------------------------------------------------

*16.05.2006 09:12 -&gt;Ñîõðàíÿåì ïàðàìåòðû
.nCheckID			 = tnCheckID
.nPaymentTypeID		 = tnPaymentTypeID
.txtCouponNM.Value   = tnCouponNM
.txtCouponRate.Value = tnCouponRate
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
*------------------------------------------------------------------------------
* Project.........: Pos_v1.pjx
* Library.........: pos_v1.vcx
* Class.Module....: FRMCOUPON.KEYPRESS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnKeyCode, tnShiftAltCtrl&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáðàáîòêà äåéñòâèé ïîëüçîâàòåëÿ
*------------------------------------------------------------------------------
LPARAMETERS tnKeyCode, tnShiftAltCtrl

WITH This

*16.05.2006 09:15 -&gt;Îáðàáàòûâàåì íàæàòèÿ êëàâèø
DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		.uRetVal = ._HandleCntCancelSaveEvent()
		.Hide()
	CASE tnKeyCode = 27
		NODEFAULT
		.uRetVal = 0
		.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>ncheckid èäåíòèôèêàòîð ÷åêà
npaymenttypeid òèï îïëàòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ129366</uniqueid>
		<timestamp>883651101</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCouponNM</objname>
		<parent>frmcoupon</parent>
		<properties>FontSize = 18
Enabled = .F.
Height = 32
Left = 0
Width = 585
DisabledForeColor = 0,0,0
Name = "txtCouponNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ129368</uniqueid>
		<timestamp>883972422</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCouponQnt</objname>
		<parent>frmcoupon</parent>
		<properties>FontSize = 18
Alignment = 3
Value = 1.000
Height = 32
Left = 79
Top = 37
Width = 165
DisabledForeColor = 0,0,0
Name = "txtCouponQnt"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	*27.04.2006 10:15 -&gt;Îáðàáîòàåì íàæàòèå êíîïêè âûáîð
	CASE tnKeyCode = 88	&amp;&amp;Shift-F5 - âûáîð
		KEYBOARD [{TAB}]
	*------------------------------------------------------------------------------
	
	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
		This.Value= 1.000		
	*------------------------------------------------------------------------------
	
OTHERWISE
	
	*16.04.2006 11:55 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	*------------------------------------------------------------------------------

ENDCASE
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ12936E</uniqueid>
		<timestamp>884955850</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCouponRate</objname>
		<parent>frmcoupon</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 0.00
Enabled = .F.
Height = 32
Left = 385
Top = 37
Width = 200
DisabledForeColor = 0,0,0
Name = "txtCouponRate"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	*27.04.2006 10:15 -&gt;Îáðàáîòàåì íàæàòèå êíîïêè âûáîð
	CASE tnKeyCode = 88	&amp;&amp;Shift-F5 - âûáîð
		KEYBOARD [{TAB}]
	*------------------------------------------------------------------------------
	
	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
		This.Value= NTOM(0)		
	*------------------------------------------------------------------------------
	
OTHERWISE
	
	*16.04.2006 11:55 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	*------------------------------------------------------------------------------

ENDCASE
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ12936H</uniqueid>
		<timestamp>910781421</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmcoupon</parent>
		<properties>FontSize = 18
Caption = "Ñòîèìîñòü"
Left = 260
Top = 38
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ12936J</uniqueid>
		<timestamp>910781421</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>frmcoupon</parent>
		<properties>FontSize = 18
Caption = "Êîë-âî"
Top = 38
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcoupon</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>910781462</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselectitemdisc</objname>
		<parent/>
		<properties>Height = 350
Width = 355
ShowWindow = 1
DoCreate = .T.
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
WindowType = 0
ntvrsetid = 0
Name = "frmselectitemdisc"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnTvrSetID,tcTvrSetNM&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------

*04.08.2005 11:46 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*10.04.2006 09:44 -&gt;Ïîêàæåì â çàãîëîâêå ôîðìû íàçâàíèÿ íàáîðà òîâàðîâ
This.lblCaption.Caption = [Ñêèäêè]
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl


DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		ThisForm.uRetVal = lvDiscCardView.DiscCardID
		ThisForm.Hide()
	CASE tnKeyCode = 27
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*04.08.2005 10:45 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*04.08.2005 10:45 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*04.08.2005 10:50 -&gt; Îòêðûâàåì Local View ñ êàðòèíêàìè
USE lvDiscCardView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00VGWHD</uniqueid>
		<timestamp>882269508</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdDiscCardSet</objname>
		<parent>frmselectitemdisc</parent>
		<properties>ColumnCount = 1
FontSize = 12
HeaderHeight = 0
Height = 325
RecordSource = "lvDiscCardView"
RowHeight = 22
ScrollBars = 2
Top = 25
Width = 355
HighlightStyle = 2
Name = "grdDiscCardSet"
Column1.FontSize = 12
Column1.ControlSource = "lvDiscCardView.DiscCardNM"
Column1.Width = 324
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F42</uniqueid>
		<timestamp>882214781</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmselectitemdisc.grdDiscCardSet.Column1</parent>
		<properties>FontSize = 12
Alignment = 2
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F44</uniqueid>
		<timestamp>883647099</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmselectitemdisc.grdDiscCardSet.Column1</parent>
		<properties>FontSize = 12
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
ThisForm.uRetVal = lvTvrInSetView.TvrID
ThisForm.Hide()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z9BHL</uniqueid>
		<timestamp>910781462</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmselectitemdisc</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Width = 355
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CL6G</uniqueid>
		<timestamp>910781462</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmselectitemdisc</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselectitemdisc</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>910781474</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselectitempayment</objname>
		<parent/>
		<properties>Height = 350
Width = 355
ShowWindow = 1
DoCreate = .T.
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
WindowType = 0
ntvrsetid = 0
Name = "frmselectitempayment"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmSelectItemPayment.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------

*11.05.2006 12:20 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*11.05.2006 12:21 -&gt;Ïîêàæåì â çàãîëîâêå ôîðìû íàçâàíèÿ íàáîðà òîâàðîâ
This.lblCaption.Caption = [Òèïû îïëàò]
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl


DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		ThisForm.uRetVal = lvPaymentTypeView.ID
		ThisForm.Hide()
	CASE tnKeyCode = 27
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmSelectItemPayment.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*11.05.2006 12:15 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*11.05.2006 12:15 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*11.05.2006 12:15 -&gt;Îòêðûâàåì Local View ñ êàðòèíêàìè
USE lvPaymentTypeView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00VGWHD</uniqueid>
		<timestamp>883647069</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdPaymentTypeSet</objname>
		<parent>frmselectitempayment</parent>
		<properties>ColumnCount = 1
FontSize = 12
HeaderHeight = 0
Height = 325
RecordSource = "lvPaymentTypeView"
RowHeight = 22
ScrollBars = 2
Top = 25
Width = 355
HighlightStyle = 2
Name = "grdPaymentTypeSet"
Column1.FontSize = 12
Column1.ControlSource = "lvPaymentTypeView.NM"
Column1.Width = 324
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F42</uniqueid>
		<timestamp>882214781</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmselectitempayment.grdPaymentTypeSet.Column1</parent>
		<properties>FontSize = 12
Alignment = 2
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F44</uniqueid>
		<timestamp>883647739</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmselectitempayment.grdPaymentTypeSet.Column1</parent>
		<properties>FontSize = 12
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
ThisForm.uRetVal = lvTvrInSetView.TvrID
ThisForm.Hide()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z9BHL</uniqueid>
		<timestamp>910781474</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmselectitempayment</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Width = 355
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CL6G</uniqueid>
		<timestamp>910781474</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmselectitempayment</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselectitempayment</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>910781485</timestamp>
		<class>frmposview</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselectitemtree</objname>
		<parent/>
		<properties>Height = 350
Width = 355
ShowWindow = 1
DoCreate = .T.
AutoCenter = .T.
BorderStyle = 2
Caption = ""
ControlBox = .F.
Closable = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
ClipControls = .F.
WindowType = 0
WindowState = 0
ltvrsetbindtlu = .F.
ntvrsetid = 0
uretval = .F.
Name = "frmselectitemtree"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnTvrSetID,tcTvrSetNM&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS tnTvrSetID, tcTvrSetNM

*19.04.2006 11:55 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM
*------------------------------------------------------------------------------

*19.04.2006 12:51 -&gt;Ïîêàæåì íàèìåíîâàíèå íàáîðà â çàãîëîâêå
This.lblCaption.Caption = tcTvrSetNM
*------------------------------------------------------------------------------

*04.08.2005 11:46 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*08.08.2005 18:07 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*26.07.2005 16:10 -&gt; Âûáèðàåì íàáîð äëÿ ðåäàêòèðîâàíèÿ ñîñòàâà íàáîðà
This.nTvrSetID = tnTvrSetID &amp;&amp; oApp.DoModalFormRetValObj([frmtvrsetselect;tovar_v1.vcx;tovar.app])
***
IF TYPE([This.nTvrSetID])#[N]
	NODEFAULT
ENDIF
*------------------------------------------------------------------------------

*04.08.2005 11:46 -&gt; Âûïîëíèì õðàíèìóþ ïðîöåäóðó
lcUniqueFileNM = spTvrSetTree(This.nTvrSetID)
*------------------------------------------------------------------------------

*04.08.2005 11:46 -&gt; Îòêðîåì ïîäãîòîâëåííûé íàáîð
USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS TvrInSetView
*------------------------------------------------------------------------------

*04.08.2005 12:09 -&gt;Çàãðóçèì äàííûå â äåðåâî
ThisForm.OleSelTreeView.Init(.T.)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl

DO CASE

	CASE tnKeyCode = 27
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*04.08.2005 10:45 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*04.08.2005 10:45 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*04.08.2005 10:50 -&gt; Îòêðûâàåì Local View ñ êàðòèíêàìè
USE lvTvrSetBmps IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>ltvrsetbindtlu Ëîãè÷åñêè ïðèçíàê òîãî, ÷òî ýëåìåíòîì íàáîðà ÿâëÿåòñÿ ñâÿçêà Òîâàð + Èäåíòèôèêàòîð
ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
uretval
*_handlecntcancelsaveevent 
*showtvrinfo 
*showtluinfo 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KZ0NH5QD</uniqueid>
		<timestamp>910781485</timestamp>
		<class>oleimagelist</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleImageList</objname>
		<parent>frmselectitemtree</parent>
		<properties>Top = 65
Left = 132
Height = 100
Width = 100
ZOrderSet = 3
Name = "OleImageList"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDNGPckTMcBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PjdpYap0bEK/AQhAQKo2nIUM0EggAAADtAwAA7QMAAIB+4eYCAAUAIAAAAAAAAADAwMAA//8AAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIADmjgAAAAAAAGyOAAAAAAAA6I8AAAAAAABojwAAAAAAAOqQAAAAAAAAcJAAAAAAAAABAACAAAAAAHqSAAAAAAAADJQAAAAAAACElAAAAAAAAAKVAAAAAAAAjJUAAAAAAAAElwAAAAAAAASWAAAAAAAAGKwaAAYAAAD/////BQAAgBisGgAAAAAAAAAAAAAAAAAImgAAAAAAAIiZAAAAAAAAjJoAAAAAAACyNQAAAAAAAJacAAAAAAAATIMAAAAAAAAEmwAAAAAAABCdAAAAAAAAkFgAAAAAAACYPQAAAAAAAI6dAAAAAAAAGp4AAAAAAABYiwAAAAAAAPCLAAAAAAAAHDcAAAAAAACkNgAAAAAAAOYdAAAAAAAA3jgAAAAAAABqOQAAAAAAAAo6AAAAAAAAtjoAAAAAAACAjQAAAAAAAF47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z23TN</uniqueid>
		<timestamp>910781485</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmselectitemtree</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Width = 355
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KX0XW9DF</uniqueid>
		<timestamp>910781485</timestamp>
		<class>oleseltreeview</class>
		<classloc>comselctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleSelTreeView</objname>
		<parent>frmselectitemtree</parent>
		<properties>Top = 25
Height = 325
Width = 355
ZOrderSet = 4
_imgalias = lvTvrSetBmps
_imgfieldnamefilename = BmpFileNM
_imgfieldnameindex = BmpID
_rsaliasname = TvrInSetView
_rsfieldnameid = Key
_rsfieldnameimageindex = BmpID
_rsfieldnameimageselectedindex = SBmpID
_rsfieldnamemark = Mark
_rsfieldnamemarkimageindex = BmpMID
_rsfieldnamemarkimageselectedindex = SBmpMID
_rsfieldnameparentflag = TvrIsCnt
_rsfieldnameparentid = TvrParID
_rsfieldnamepartmarkimageindex = BmpPMID
_rsfieldnamepartmarkimageselectedindex = SBmpPMID
_rsfieldnametext = TvrNM
_imagelistobject = .parent.Oleimagelist.object
_parentonly = .F.
Name = "OleSelTreeView"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: OLESELTREEVIEW.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tlInitAllowed&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äåðåâà ïî ñîáûòèþ
*------------------------------------------------------------------------------
LPARAMETERS	tlInitAllowed

*04.08.2005 12:08 -&gt;Çàãðóæàåì äåðåâî ïî ñîáûòèþ
IF tlInitAllowed
	DODEFAULT()
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
*** ActiveX Control Event ***
LPARAMETERS keyascii

LOCAL lnTvrID

*19.04.2006 14:50 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
*DODEFAULT(keyascii)
*------------------------------------------------------------------------------

DO CASE
	CASE keyascii = 32 OR keyascii = 13
		lnTvrID = This.ConvertID(cnDIR_TREE2ID,This.SelectedItem.Key)
		
		*21.04.2006 13:58 -&gt;Îïðåäåëèì òèï âûáðàííîãî òîâàðà
		IF	lnTvrID#0 AND !spTvrIsCnt(lnTvrID)
			NODEFAULT
			ThisForm.uRetVal = lnTvrID
			ThisForm.Hide()
		ENDIF
		
	CASE keyascii = 27 OR keyascii = 133
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()

ENDCASE
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAXG/ckTMcBAwAAAMACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAEIBAAAAAAAABAAAAAIAAAD+////BQAAAAkAAAAGAAAABwAAAAgAAAAKAAAA/v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+i6BMHCoUbEK/AQhAQKo2nIUM0EggAAACxJAAAlyEAAI5+4eYCAAUAIgAAAH0gaWaNAQAAAQAAAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAAAAMAAAAAAAAABQAAgGziEgABAAAAXAAf3uy9AQAFAAEAAAADUuMLkY/OEZ3jAKoAS7hRAcwAAJABpCwCAAAALkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAHAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAsAAABBcHBlYXJhbmNlAAkAAABJCgAAAAAAAAAMAAAAQm9yZGVyU3R5bGUACQAAAEkKAAAAAQAJQXJpYWwgQ1lSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>910781485</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmselectitemtree</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Top = 0
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselectitemtree</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0OQASU</uniqueid>
		<timestamp>910784874</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdchecktransview</objname>
		<parent/>
		<properties>ColumnCount = 5
FontSize = 12
GridLines = 2
Height = 215
Panel = 1
RecordSource = "lvCheckTransView"
RowHeight = 22
ScrollBars = 2
Width = 365
GridLineColor = 128,128,128
ncheckid = 0
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
Name = "grdchecktransview"
Column1.FontSize = 12
Column1.ControlSource = "lvCheckTransView.CheckTransType"
Column1.Width = 60
Column1.BackColor = 255,255,255
Column1.Name = "Column1"
Column2.FontSize = 12
Column2.ControlSource = "lvCheckTransView.TvrNM"
Column2.BackColor = 255,255,255
Column2.Name = "Column2"
Column3.FontSize = 12
Column3.ControlSource = "lvCheckTransView.CheckTransQnt"
Column3.Width = 60
Column3.BackColor = 255,255,255
Column3.Name = "Column3"
Column4.FontSize = 12
Column4.ControlSource = "ROUND(MTON(lvCheckTransView.CheckTransPrc),2)"
Column4.Width = 60
Column4.BackColor = 255,255,255
Column4.Name = "Column4"
Column5.FontSize = 12
Column5.ControlSource = "ROUND(MTON(lvCheckTransView.CheckTransPrc)*lvCheckTransView.CheckTransQnt,2)"
Column5.Name = "Column5"
</properties>
		<protected>ncheckid
</protected>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Cash_v1.vcx
* Class.Module....: grdCheckTransView._Add
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå òðàíçàêöèè ÷åêà
*------------------------------------------------------------------------------

*28.02.2006 16:04 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*28.02.2006 16:05 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ òðàíçàêöèè ÷åêà
lnResAdding = oMgrCash.Do([CHECKTRANS],[ADD],This.nCheckID,This.nStorageID)
*------------------------------------------------------------------------------

*28.02.2006 16:05 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*28.02.2006 16:05 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*17.01.2005 15:31 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîì êëèåíòå
	IF USED([lvCheckTransViewRepl])
		USE IN lvCheckTransViewRepl
	ENDIF
	_PARAM = lnId
	USE lvCheckTransViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*28.02.2006 16:06 -&gt;Îáíîâèì äàííûå â lvCheckTransView
	SELECT lvCheckTransViewRepl
	SCATTER TO laReplaceArray
	SELECT lvCheckTransView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*28.02.2006 16:07 -&gt;Çàêðîåì Alis
	USE IN lvCheckTransViewRepl
	*------------------------------------------------------------------------------
		
	*28.02.2006 16:07 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCheckTransView
	LOCATE FOR lvCheckTransView.CheckTransUID = lnID
	*------------------------------------------------------------------------------

	*17.01.2005 15:32 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*17.01.2005 15:32 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*28.02.2006 16:07 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequery
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_v1.vcx
* Class.Module....: GRDCHECKTRANSVIEW._RSREQUERY
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnCheckID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â Grid-å
*------------------------------------------------------------------------------
LPARAMETERS tnCheckID

*27.02.2006 12:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

WITH This

*28.02.2006 16:02 -&gt;Ñîõðàíèì ID ÷åêà
.nCheckID = tnCheckID
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*27.02.2006 11:11 -&gt;Îáíîâèì RS
_PARAM = tnCheckID
REQUERY([lvCheckTransView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE handlekey
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*09.02.2007 15:11 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcPOSFuncMsg
*------------------------------------------------------------------------------

*09.02.2007 13:19 -&gt;Èùåì êîä íàæàòîé êëàâèøè è ïûòàåìñÿ îáðàáîòàòü
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
*------------------------------------------------------------------------------

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	CASE tnKeyCode = 13
		
		*11.04.2006 16:53 -&gt;Âûïðîëíèì ñòîðíèðîâàíèå òðàíçàêöèè ÷åêà
		This.Parent.StornoTvr()
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		
	CASE tnKeyCode = 27 OR lcPOSFuncMsg == [ESC]
		
		NODEFAULT
		*12.04.2006 12:30 -&gt;Âûéäåì èç ðåæèìà ñòîðíèðîâàíèÿ
		This.Parent.StornoBreak()
		*------------------------------------------------------------------------------

	CASE tnKeyCode = 28
	
		NODEFAULT
		This._Prev()

	CASE tnKeyCode = -2
	
		NODEFAULT
		This._Next()

OTHERWISE
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	
ENDCASE
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*11.04.2006 10:04 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*11.04.2006 10:06 -&gt;Óñòàíîâèì äîáîëíèòåëüíûå ñâîéñòâà Grid-à
This.SetAll([DynamicBackColor], [IIF(RECNO()%2 # 0,RGB(192,192,192), RGB(255,255,255))], [Column])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3>ncheckid
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PVBP4</uniqueid>
		<timestamp>881755799</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdchecktransview.Column1</parent>
		<properties>FontSize = 12
Caption = "Ïîç."
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PZK9T</uniqueid>
		<timestamp>881614124</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdchecktransview.Column1</parent>
		<properties>FontSize = 12
Left = 37
Top = 35
BackColor = 255,255,255
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PVBP8</uniqueid>
		<timestamp>881545828</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdchecktransview.Column2</parent>
		<properties>FontSize = 12
Caption = "Òîâàð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PZK9W</uniqueid>
		<timestamp>881545828</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdchecktransview.Column2</parent>
		<properties>FontSize = 12
Left = 9
Top = 35
BackColor = 255,255,255
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PVBPA</uniqueid>
		<timestamp>881545828</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdchecktransview.Column3</parent>
		<properties>FontSize = 12
Caption = "Êîë-âî"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PZK9X</uniqueid>
		<timestamp>881545828</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdchecktransview.Column3</parent>
		<properties>FontSize = 12
Left = 17
Top = 35
BackColor = 255,255,255
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PVBPC</uniqueid>
		<timestamp>881545828</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdchecktransview.Column4</parent>
		<properties>FontSize = 12
Caption = "Öåíà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1QT0PZK9Z</uniqueid>
		<timestamp>881545828</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdchecktransview.Column4</parent>
		<properties>FontSize = 12
Left = 16
Top = 35
BackColor = 255,255,255
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XI11KTCP</uniqueid>
		<timestamp>895192088</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdchecktransview.Column5</parent>
		<properties>FontSize = 12
Caption = "Ñóììà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XI11SJHG</uniqueid>
		<timestamp>895192277</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdchecktransview.Column5</parent>
		<properties>Left = 6
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdchecktransview</objname>
		<parent/>
		<properties>Arial, 0, 12, 7, 19, 15, 43, 3, 1
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2010LVCWN</uniqueid>
		<timestamp>910972112</timestamp>
		<class>frmpos</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmpos640</objname>
		<parent/>
		<properties>DefHeight = 
Height = (480-SYSMETRIC(9))
Width = 640
DoCreate = .T.
Name = "frmpos640"
cntsummary.txtReceived.Left = 343
cntsummary.txtReceived.Top = 37
cntsummary.txtReceived.Name = "txtReceived"
cntsummary.txtDelivery.Left = 343
cntsummary.txtDelivery.Top = 74
cntsummary.txtDelivery.Name = "txtDelivery"
cntsummary.lblTvrPrice.Left = 269
cntsummary.lblTvrPrice.Top = 75
cntsummary.lblTvrPrice.Name = "lblTvrPrice"
cntsummary.Lbl1.Left = 231
cntsummary.Lbl1.Top = 38
cntsummary.Lbl1.Name = "Lbl1"
cntsummary.Top = 347
cntsummary.Left = 5
cntsummary.Width = 630
cntsummary.Name = "cntsummary"
cntsale.txtTvrNM.Left = 0
cntsale.txtTvrNM.Width = 630
cntsale.txtTvrNM.Name = "txtTvrNM"
cntsale.txtTvrQnt.Height = 32
cntsale.txtTvrQnt.Left = 79
cntsale.txtTvrQnt.Top = 74
cntsale.txtTvrQnt.Width = 185
cntsale.txtTvrQnt.Name = "txtTvrQnt"
cntsale.txtTvrPrice.Left = 342
cntsale.txtTvrPrice.Top = 74
cntsale.txtTvrPrice.Name = "txtTvrPrice"
cntsale.Lbl1.Left = 283
cntsale.Lbl1.Top = 75
cntsale.Lbl1.Name = "Lbl1"
cntsale.Lbl2.Left = 0
cntsale.Lbl2.Top = 75
cntsale.Lbl2.Name = "Lbl2"
cntsale.txtPLU.Width = 630
cntsale.txtPLU.Name = "txtPLU"
cntsale.Top = 347
cntsale.Left = 5
cntsale.Width = 630
cntsale.Name = "cntsale"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
shtrih.Name = "shtrih"
grdchecktransview.Column1.Header1.Name = "Header1"
grdchecktransview.Column1.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column1.Name = "Column1"
grdchecktransview.Column2.Header1.Name = "Header1"
grdchecktransview.Column2.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column2.Name = "Column2"
grdchecktransview.Column3.Header1.Name = "Header1"
grdchecktransview.Column3.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column3.Name = "Column3"
grdchecktransview.Column4.Header1.Name = "Header1"
grdchecktransview.Column4.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column4.Name = "Column4"
grdchecktransview.COLUMN5.Header1.Name = "Header1"
grdchecktransview.COLUMN5.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.COLUMN5.Name = "COLUMN5"
grdchecktransview.DefHeight = 
grdchecktransview.Height = (293-SYSMETRIC(9))
grdchecktransview.Left = 5
grdchecktransview.Top = 31
grdchecktransview.Width = 630
grdchecktransview.Name = "grdchecktransview"
cntclock.lblClock.Name = "lblClock"
cntclock.tmrClock.Name = "tmrClock"
cntclock.Top = 0
cntclock.Left = 446
cntclock.Name = "cntclock"
lblCheckStatus.Height = 30
lblCheckStatus.Left = 245
lblCheckStatus.Top = 0
lblCheckStatus.Width = 195
lblCheckStatus.Name = "lblCheckStatus"
lblUserNM.Height = 30
lblUserNM.Left = 5
lblUserNM.Top = 0
lblUserNM.Width = 242
lblUserNM.Name = "lblUserNM"
txtPosMode.Left = 5
txtPosMode.Top = 308
txtPosMode.Name = "txtPosMode"
txtCheckSum.Left = 349
txtCheckSum.Top = 308
txtCheckSum.Name = "txtCheckSum"
lblCheckNo.Left = 67
lblCheckNo.Top = 319
lblCheckNo.Name = "lblCheckNo"
lblCheckSum.Left = 271
lblCheckSum.Top = 309
lblCheckSum.Name = "lblCheckSum"
olecommscanner.Top = 347
olecommscanner.Left = 598
olecommscanner.Height = 48
olecommscanner.Width = 58
olecommscanner.Name = "olecommscanner"
linedisplay.Top = 0
linedisplay.Left = 214
linedisplay.Height = 33
linedisplay.Width = 33
linedisplay.Name = "linedisplay"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>äëÿ ðàçðåøåíèÿ 640</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmpos640</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15B0OJTIT</uniqueid>
		<timestamp>921129769</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmidctlgridintop</objname>
		<parent/>
		<properties>Height = 110
Width = 250
ShowWindow = 1
DoCreate = .T.
BorderStyle = 0
Caption = ""
ControlBox = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
ClipControls = .F.
rsfieldnameid = 
timer = 0
_grdaddparams = 
_grdinfoparams = 
Name = "frmidctlgridintop"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: COMIDCTL_V1.VCX
* Class.Module....: FRMIDCTLGRID.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;toParentObject,toParentForm&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;sysevent&gt; Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS	toParentObject, ;
			toParentForm
			
*29.04.2004 17:29 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnHeight, ;
		lnTop, ;
		lnLeft, ;
		lnWidth
*------------------------------------------------------------------------------	

*29.04.2004 17:32 -&gt;Âûïîëíèì ìåòîä áàçîâîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*01.04.2004 11:27 -&gt;Óñòàíîâèì ñåññèþ äàííûõ
IF TYPE([toParentForm.DataSessionId])==[N]
	SET DATASESSION TO toParentForm.DataSessionId
ENDIF	
*------------------------------------------------------------------------------

*29.04.2004 17:36 -&gt;Ñ÷èòàåì êîîðäèíàòû ðàçìåùåíèÿ îáúåêòà
lnHeight = .Height

lnTop =   toParentForm.Top + ;								&amp;&amp; ïîëîæåíèå ðîäèòåëüêîãî îíêà
		  IIF(toParentForm.BorderStyle&gt;1,SYSMETRIC(4),0) + ;&amp;&amp; ðàìêà ðîäèòåëüñêîãî îêíà
		  SYSMETRIC(9) + ;									&amp;&amp; âûñîòà çàãîëîâêà ðîäèòåëüñêîãî îêíà
		  OBJTOCLIENT(toParentObject.TxtText,1) + ;			&amp;&amp; ïîëîæåíèå TextBox-à îòíîñèòåëüíî ðîäèòåëüñêîé ôîðìû
		  toParentObject.TxtText.Height						&amp;&amp; âûñîòà TextBox-à
***
IF lnTop + This.Height &gt; _Screen.Height
	
	*29.04.2004 17:50 -&gt;Âûâîäèì îêíî íàä
	lnTop =   toParentForm.Top + ;								&amp;&amp; ïîëîæåíèå ðîäèòåëüêîãî îíêà
			  IIF(toParentForm.BorderStyle&gt;1,SYSMETRIC(4),0) + ;&amp;&amp; ðàìêà ðîäèòåëüñêîãî îêíà
			  SYSMETRIC(9) + ;									&amp;&amp; âûñîòà çàãîëîâêà ðîäèòåëüñêîãî îêíà
			  OBJTOCLIENT(toParentObject.TxtText,1) - ;			&amp;&amp; ïîëîæåíèå TextBox-à îòíîñèòåëüíî ðîäèòåëüñêîé ôîðìû
			  This.Height										&amp;&amp; âûñîòà ôîðìû äëÿ âûáîðà
	*------------------------------------------------------------------------------
	
ENDIF
***
lnLeft =  toParentForm.Left + ;								&amp;&amp; ïîëîæåíèå ðîäèòåëüêîãî îíêà
		  IIF(toParentForm.BorderStyle&gt;1,SYSMETRIC(3),0) + ;&amp;&amp; ðàìêà ðîäèòåëüñêîãî îêíà
		  OBJTOCLIENT(toParentObject.TxtText,2)				&amp;&amp; ïîëîæåíèå TextBox-à îòíîñèòåëüíî ðîäèòåëüñêîé ôîðìû	
***
lnWidth = INT(toParentObject.TxtText.Width*1.5)
*------------------------------------------------------------------------------

WITH THIS

*29.04.2004 17:55 -&gt;Çàïîëíÿåì ñâîéñòâî Grid-à
.Grd.RecordSource = ALLTRIM(toParentObject._RSAliasName)
.Grd.Column1.ControlSource = .Grd.RecordSource + [.] + ALLTRIM(toParentObject._RSFieldNameText)
*-------------------------------------------------------------------------------------------------

*29.04.2004 17:54 -&gt; Çàïîëíÿåì ñâîéñòâî ôîðìû äëÿ âûáîðà
.Top   = lnTop
.Left  = lnLeft
.MinWidth = lnWidth
.Width = lnWidth
.Height = lnHeight
***
.RSFieldNameID  = toParentObject._RSFieldNameID
._GrdAddParams  = toParentObject._GrdAddParams
._GrdInfoParams = toParentObject._GrdInfoParams
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE mouse
*-------------------------------------------------------
* Project.........: GLOBAL.PJX
* Library.........: BASELIST_V1.VCX
* Class.Module....: FRMLISTGRID.MOUSE
* Called by.......: System event
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LOCAL loWhatClick, lcNameParent

WITH THIS

*19.01.2004 12:24 -&gt;Ïðîâåðÿåì íàæàòà ëè êíîïêà âíå îáüåêòà
IF MCOL() = -1 OR MROW() = -1

	*20.01.2004 15:54 -&gt;Ñìîòðèì êóäà êëèêíóëè
	loWhatClick = SYS(1270)
	***
	IF TYPE([loWhatClick])==[O]
		
		*21.01.2004 10:32 -&gt;Îïðåäåëÿåì ðîäèòåëÿ
		lcNameParent = SYS(1272,loWhatClick)
		IF [.] $ lcNameParent
			lcNameParent = LEFT(lcNameParent,AT([.],lcNameParent)-1)
		ENDIF
		lcNameParent = [;] + lcNameParent + [;]
		*------------------------------------------------------------------------------

		*20.01.2004 16:03 -&gt;Ïðîâåðÿì íàø ëè ýòî ToolBar, åñëè äà òî âûõîäèì
		IF lcNameParent $ ([;] + ._StandartToolbar + [;] + ._CustomToolbar + [;])
			RETURN
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*04.05.2004 16:49 -&gt;Ñêðûâàåì îêíî
	.Hide()
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>rsfieldnameid &lt;public/runtime&gt; Èìÿ ïîëÿ, ñîäåðæàùåãî èäåíòèôèêàòîð çàïèñè.
timer &lt;public/runtime&gt; Âðåìÿ ïîñëåäíåãî ñîáûòèÿ Click().
_grdaddparams Ïàðàìåòðû Grid'à ïðè äîáàâëåíèè çàïèñè (ìåíåäæåð; îáúåêò; îïåðàöèÿ; LV äëÿ îáíîâëåíèÿ çàïèñè)
_grdinfoparams Ïàðàìåòðû Grid'à ïðè ïðîñìîòðå çàïèñè (ìåíåäæåð; îáúåêò; îïåðàöèÿ)
*mouse &lt;public&gt; Ìåòîä ñðàáàòûâàþùèé ïðè íàæàòèè ìûøè.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N0ZT8IA</uniqueid>
		<timestamp>865437174</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>Grd</objname>
		<parent>frmidctlgridintop</parent>
		<properties>ColumnCount = 1
FontSize = 9
DeleteMark = .F.
GridLines = 1
HeaderHeight = 0
Height = 110
RecordMark = .F.
RowHeight = 18
ScrollBars = 2
Width = 250
ZOrderSet = 0
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;ADD;INFO
_allowsaveandrestorelayout = .F.
_handledstandartmsgpromptlist = ;;;;Äîáàâèòü;Ïðîñìîòð
Name = "Grd"
Column1.FontSize = 9
Column1.Width = 250
Column1.Movable = .F.
Column1.Resizable = .F.
Column1.ReadOnly = .T.
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: ComIDCtl_v1.vcx
* Class.Module....: grd._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå çàïèñè
*------------------------------------------------------------------------------

*19.12.2005 12:48 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcMgrName, ;
		lcEntityName, ;
		lcRequestedOperation, ;
		lcAdditionalParameters, ;
		lcLVForUpdateName, ;
		lcExecScript, ;
		luResAdding, ;
		lcRSFieldNameID
***
lcRSFieldNameID = ThisForm.RSFieldNameID
*------------------------------------------------------------------------------

*19.12.2005 12:48 -&gt; Ïðîâåðÿåì íàëè÷èå ïàðàìåòðîâ Grid'à äëÿ ìåòîäà _add
IF TYPE([ThisForm._GrdAddParams]) == [C] AND OCCURS([;],ThisForm._GrdAddParams) = 4

	*16.12.2005 18:05 -&gt; Ðàçáèðàåì ïàðàìåòðû
	lcMgrName = ALLTRIM(SUBSTR(ThisForm._GrdAddParams,1,AT([;],ThisForm._GrdAddParams,1)-1))
	lcEntityName = ALLTRIM(SUBSTR(ThisForm._GrdAddParams,AT([;],ThisForm._GrdAddParams,1)+1,AT([;],ThisForm._GrdAddParams,2)-AT([;],ThisForm._GrdAddParams,1)-1))
	lcRequestedOperation = ALLTRIM(SUBSTR(ThisForm._GrdAddParams,AT([;],ThisForm._GrdAddParams,2)+1,AT([;],ThisForm._GrdAddParams,3)-AT([;],ThisForm._GrdAddParams,2)-1))
	lcAdditionalParameters = ALLTRIM(SUBSTR(ThisForm._GrdAddParams,AT([;],ThisForm._GrdAddParams,3)+1,AT([;],ThisForm._GrdAddParams,4)-AT([;],ThisForm._GrdAddParams,3)-1))
	lcLVForUpdateName = ALLTRIM(SUBSTR(ThisForm._GrdAddParams,AT([;],ThisForm._GrdAddParams,4)+1,LEN(ThisForm._GrdAddParams)-AT([;],ThisForm._GrdAddParams,4)))
	*------------------------------------------------------------------------------

ELSE

	*16.12.2005 17:32 -&gt; Âîçâðàùàåì False
	RETURN .F.
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*19.12.2005 12:49 -&gt; Ôîðìèðóåì ñêðèïò
lcExecScript = lcMgrName + [.Do("] + lcEntityName + [","] + lcRequestedOperation + [",] + lcAdditionalParameters +[)]
*------------------------------------------------------------------------------

*19.12.2005 12:49 -&gt; Âûïîëíÿåì ñêðèïò
luResAdding = &amp;lcExecScript
*------------------------------------------------------------------------------

*19.12.2005 12:50 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([luResAdding])==[N] &amp;&amp; çàïèñü äîáàâëåíà

	*19.12.2005 12:54 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnID
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnID = luResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------

	*19.12.2005 12:54 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîé çàïèñå
	IF USED(lcLVForUpdateName)
		USE IN (lcLVForUpdateName)
	ENDIF
	_PARAM = lnID
	USE (lcLVForUpdateName) IN 0
	*------------------------------------------------------------------------------

	*19.12.2005 12:55 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This._RefreshRelatedObjectsOnRSRecNoChange = .F.
	*------------------------------------------------------------------------------

	*05.04.2004 17:52 -&gt; Îáíîâèì äàííûå
	SELECT (lcLVForUpdateName)
	SCATTER TO laReplaceArray
	SELECT (This.RecordSource)
	APPEND FROM ARRAY laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*19.12.2005 12:56 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	LOCATE FOR &amp;lcRSFieldNameID = lnID
	*------------------------------------------------------------------------------

	*19.12.2005 12:58 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå
	This._RefreshRelatedObjectsOnRSRecNoChange = .T.
	*------------------------------------------------------------------------------

	*19.12.2005 12:58 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*19.12.2005 12:58 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*19.12.2005 12:58 -&gt; Çàêðîåì íåíóæíûé íàì Alias
	USE IN SELECT(lcLVForUpdateName)
	*------------------------------------------------------------------------------

	*19.12.2005 12:58 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _gethandledstandartmsglist
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: ComIDCtl_v1.vcx
* Class.Module....: grd._GetHandledStandartMsgList
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;lcResult&gt;
* Notes...........: &lt;~&gt;
*------------------------------------------------------------------------------
WITH This

*21.12.2005 16:39 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcResult
*------------------------------------------------------------------------------

*21.12.2005 16:35 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
lcResult = [;] + DODEFAULT() + [;]
*------------------------------------------------------------------------------

*21.12.2005 16:36 -&gt; Ïðîâåðÿåì  íàëè÷èå îáðàáîòêè ìåòîäà Add
IF TYPE([ThisForm._grdAddParams]) # [C] OR EMPTY(ThisForm._grdAddParams) OR OCCURS([;],ThisForm._grdAddParams) # 4
	lcResult = STRTRAN(lcResult,[;ADD;],[;])
ENDIF
*------------------------------------------------------------------------------

*21.12.2005 16:36 -&gt; Ïðîâåðÿåì  íàëè÷èå îáðàáîòêè ìåòîäà Info
IF TYPE([ThisForm._grdInfoParams]) # [C] OR EMPTY(ThisForm._grdInfoParams) OR OCCURS([;],ThisForm._grdInfoParams) # 2
	lcResult = STRTRAN(lcResult,[;INFO;],[;])
ENDIF
*------------------------------------------------------------------------------

*21.12.2005 16:39 -&gt; Óäàëÿåì ñëåâà è ñïðàâà ; äîáàâëåííûå ðàíåå
IF !(lcResult == [;])
	lcResult = SUBSTR(lcResult,2,LEN(lcResult)-2)
ELSE
	lcResult = []
ENDIF	
*------------------------------------------------------------------------------

*21.12.2005 16:39 -&gt; Âîçâðàùàåì ðåçóëüòàò
RETURN lcResult
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: ComIDCtl_v1.vcx
* Class.Module....: grd._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Info()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð çàïèñè Grid'à
*------------------------------------------------------------------------------

*16.12.2005 17:33 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcMgrName, ;
		lcEntityName, ;
		lcRequestedOperation, ;
		lcExecScript
*------------------------------------------------------------------------------

*16.12.2005 17:32 -&gt; Ïðîâåðÿåì íàëè÷èå ïàðàìåòðîâ Grid'à äëÿ ìåòîäà _info
IF TYPE([ThisForm._GrdInfoParams]) == [C] AND OCCURS([;],ThisForm._GrdInfoParams) = 2

	*16.12.2005 18:05 -&gt; Ðàçáèðàåì ïàðàìåòðû
	lcMgrName = ALLTRIM(SUBSTR(ThisForm._GrdInfoParams,1,AT([;],ThisForm._GrdInfoParams,1)-1))
	lcEntityName = ALLTRIM(SUBSTR(ThisForm._GrdInfoParams,AT([;],ThisForm._GrdInfoParams,1)+1,AT([;],ThisForm._GrdInfoParams,2)-AT([;],ThisForm._GrdInfoParams,1)-1))
	lcRequestedOperation = ALLTRIM(SUBSTR(ThisForm._GrdInfoParams,AT([;],ThisForm._GrdInfoParams,2)+1,LEN(ThisForm._GrdInfoParams)-AT([;],ThisForm._GrdInfoParams,2)))
	*------------------------------------------------------------------------------

ELSE

	*16.12.2005 17:32 -&gt; Âîçâðàùàåì False
	RETURN .F.
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*16.12.2005 18:09 -&gt; Ôîðìèðóåì ñêðèïò
lcExecScript = lcMgrName + [.Do("] + lcEntityName + [","] + lcRequestedOperation + [",EVAL(ThisForm.RSFieldNameID))]
*------------------------------------------------------------------------------

*16.12.2005 18:11 -&gt; Âûïîëíÿåì ñêðèïò
&amp;lcExecScript
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE handlekey
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: COMIDCTL_V1.VCX
* Class.Module....: GRD.HANDLEKEY
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnKeyCode, tnShiftAltCtrl&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîïîëíèòåëüíàÿ îáðàáîòêà íàæàòèÿ êëàâèø Alt+UpArrow, Enter, Escape
*-------------------------------------------------------
LPARAMETERS tnKeyCode, tnShiftAltCtrl

*04.05.2004 16:57 -&gt;Åñëè ïîëüçîâàòåëü íàæàë Enter èëè Aly+UpArrow -&gt; ñîõðàíèì âûáîð, Esc -&gt; îòìåíèì âûáîð
DO CASE
	
	CASE (tnKeyCode = 152 AND tnShiftAltCtrl = 4) OR ;	&amp;&amp; Alt + UpArrow
		 (tnKeyCode = 13 AND tnShiftAltCtrl = 0)		&amp;&amp; Enter
		
		
		*19.01.2004 17:07 -&gt;Ñîõðàíèì âûáîð è ñêðîåì ôîðìó
		ThisForm.uRetVal = EVAL(ThisForm.RSFieldNameID)
		ThisForm.Hide()
		*-------------------------------------------------------------------------------------------------
		
	CASE tnKeyCode = 27 &amp;&amp; Escape
		
		*29.04.2004 18:20 -&gt;Ñêðîåì ôîðìó áåç ñîõðàíåíèÿ âûáîðà
		ThisForm.uRetVal = .F.
		ThisForm.Hide()
		*-------------------------------------------------------------------------------------------------
	
	OTHERWISE
		
		*04.05.2004 17:00 -&gt;Âûïîëíèì ìåòîä áàçîâîãî êëàññà äëÿ âñåõ äóãèõ ñî÷åòàíèé êëàâèø	
		DODEFAULT(tnKeyCode,tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		
ENDCASE
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE refreshhandledhotkey
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: COMIDCTL_V1.VCX
* Class.Module....: GRD.REFRESHHANDLEDHOTKEY
* Called by.......: &lt;.When();.Valid();.Destroy()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Îáíîâëåíèå ñïèñêà íàçíà÷åíèé ãîðÿ÷èõ êëàâèø.
*-------------------------------------------------------
WITH This

*29.04.2004 18:34 -&gt;Âûïîëíèì ìåòîä áàçîâîãî êëàññà
DODEFAULT ()
*------------------------------------------------------------------------------

*23.04.2004 13:32 -&gt;Åñëè Grid àêòèâåí - âûñòàâëÿåì ãîðÿ÷èå êëàâèøè, èíà÷å îòìåíÿåì
IF .lGridActive
	IF .lHotKeySet

		*16.04.2004 10:29 -&gt;Åñëè Grid àêòèâåí, äîáàâèì ñâîé îáðàáîò÷èê íàæàòèÿ ëåâîé êëàâèøè ìûøè	
		ON KEY LABEL LEFTMOUSE _screen.ActiveForm.Mouse()
		*------------------------------------------------------------------------------
		
	ENDIF	
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0OPN39</uniqueid>
		<timestamp>816086412</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmidctlgridintop.Grd.Column1</parent>
		<properties>FontSize = 9
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1570UBSIO</uniqueid>
		<timestamp>865299489</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmidctlgridintop.Grd.Column1</parent>
		<properties>FontSize = 9
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: COMIDCTL_V1.VCX
* Class.Module....: TEXT1.CLICK
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;sysevent&gt; Ïðîâåðêà äâîéíîãî íàæàòèÿ.
*-------------------------------------------------------

*22.01.2004 10:51 -&gt;Ïðîâåðÿåì íà äâîéíîå íàæàòèå ìûøè
IF SECONDS() - ThisForm.TIMER &gt; _DBLCLICK
	ThisForm.TIMER = SECONDS()
ELSE
	This.Parent.Parent.HandleKey(13,0) &amp;&amp; Íàæàòèå Enter
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmidctlgridintop</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_20H0R2Z95</uniqueid>
		<timestamp>925594604</timestamp>
		<class>frmview</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmposview</objname>
		<parent/>
		<properties>DoCreate = .T.
nkeyboard = 
Name = "frmposview"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*09.02.2007 13:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

This.nKeyBoard = VAL(oRes.GetParam([SET],[KEYBOARD]))
*------------------------------------------------------------------------------
*19.10.2006 18:20 -&gt;Çàãðóçèì ðàñêëàäêó êëàâèàòóðû
LOCAL _PARAM
***
_PARAM = This.nKeyBoard
REQUERY([lvPOSKeyMap])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*09.02.2007 13:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*09.02.2007 13:27 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS SHARED
ENDIF
***
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*19.10.2006 18:19 -&gt;Çàãðóçèì ðàñêëàäêó êëàâèàòóðû
USE lvPOSKeyMap IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nkeyboard ðàñêëàäêà êëàâèàòóðû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmposview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>927373021</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntsale</objname>
		<parent/>
		<properties>Width = 790
Height = 106
BorderWidth = 0
cbarcode = 
lkeylockswith = .F.
Name = "cntsale"
</properties>
		<protected/>
		<methods>PROCEDURE cbarcode_assign
LPARAMETERS tcBardCode

WITH This

.txtPLU.Value = tcBardCode
.cBarCode = tcBardCode
.FindTovar(tcBardCode)
.txtPLU.Value = []

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE findtovar
LPARAMETERS tcPLU

WITH This

*22.09.2006 17:42 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcPLU, ;
		_PARAM1, ;
		_PARAM2
***
lcPLU = ALLTRIM(tcPLU)
*------------------------------------------------------------------------------

*26.09.2006 10:03 -&gt;Ñáðîñèì àòðèáóòû ïîñëåäíåé ïîçèöèè ÷åêà
*.Parent.ClearPos()
*------------------------------------------------------------------------------

*25.09.2006 13:24 -&gt;Åñëè ØÊ âåñîâîé - ïîëó÷èì êîëè÷åñòâî òîâàðà è ñêîððåêòèðóåì ØÊ
IF LEN(lcPLU) = 13 AND LEFT(lcPLU ,2) = [21]
	.Parent.nTvrQnt = VAL(SUBSTR(lcPLU,8,5))/1000
	This.txtTvrQnt.Value = VAL(SUBSTR(lcPLU,8,5))/1000
	lcPLU = LEFT(lcPLU,7)+[00000]
	lcPLU = lcPLU + oTLU.CheckSum(lcPLU)
ENDIF
*------------------------------------------------------------------------------

*22.09.2006 17:43 -&gt;Çàêðîåì êóðñîð
USE IN SELECT([lvTovarInfoByTLU])
*------------------------------------------------------------------------------

*22.09.2006 17:44 -&gt;Ïîëó÷èì äàííûå ïî òîâàðó
_PARAM1 = lcPLU
_PARAM2 = 1
***
USE lvTovarInfoByTLU IN 0
*------------------------------------------------------------------------------

*22.09.2006 17:45 -&gt;Ïîêàæåì äàííûå ïî òîâàðó
.txtTvrNM.Value    = IIF(EMPTY(lvTovarInfoByTLU.TvrNM),[Òîâàð íå íàéäåí],lvTovarInfoByTLU.TvrNM)
.txtTvrPrice.Value = IIF(EMPTY(lvTovarInfoByTLU.Price),0.00,lvTovarInfoByTLU.Price)
*------------------------------------------------------------------------------

*22.09.2006 18:11 -&gt;Äîáàâèì òîâàð
IF lvTovarInfoByTLU.TvrID # 0
	.Parent.nTvrID = lvTovarInfoByTLU.TvrID
	.Parent.AddTvr()
ENDIF
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE updatestatusevent
LPARAMETERS lcMode

*23.01.2007 10:01 -&gt;Ïîêàæåì èçìåíåíèå ðåæèìà
DO CASE
	CASE lcMode = [S]
		This.Parent.SetPosMode(3)
	CASE lcMode = [R]
		This.Parent.SetPosMode(2)
	CASE lcMode = [L]
		This.Parent.SetPosMode(1)
	CASE lcMode = [X]
		This.Parent.SetPosMode(4)
ENDCASE
*------------------------------------------------------------------------------
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>cbarcode ïîñëåäíèé, ñ÷èòàííûé ñêàíåðîì ØÊ
lkeylockswith
*findtovar ïîèñê òîâàðîâ ïî PLU
*cbarcode_assign 
*updatestatusevent 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>892764387</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtTvrNM</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Enabled = .F.
Height = 32
Left = 0
Top = 37
Width = 790
DisabledForeColor = 0,0,0
Name = "txtTvrNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C17ZLMD</uniqueid>
		<timestamp>927373021</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtTvrQnt</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 1.000
Enabled = .T.
Height = 32
Left = 228
Top = 74
Width = 200
DisabledForeColor = 0,0,0
Name = "txtTvrQnt"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	*23.01.2007 09:48 -&gt;Ëîâèì ïåðåêëþ÷åíèå êëþ÷à êëàâèàòóðû
	CASE tnKeyCode = 96	&amp;&amp; ` - ïðèçíàê ïîâîðîòà
		This.Parent.lKeyLockSwith = .T.
		NODEFAULT

	CASE tnKeyCode &gt; 0 AND INLIST(UPPER(CHR(tnKeyCode)),;
	                        [S],[R],[L],[X]) AND This.Parent.lKeyLockSwith
		This.Parent.UpdateStatusEvent(UPPER(CHR(tnKeyCode)))
		NODEFAULT
		

	*23.01.2007 09:51 -&gt;Îêîí÷àíèå ïåðåêëþ÷åíèÿ êëþ÷à êëàâèàòóðû
	CASE tnKeyCode = 13 AND This.Parent.lKeyLockSwith
		This.Parent.lKeyLockSwith = .F.
		NODEFAULT


	*27.04.2006 10:15 -&gt;Îáðàáîòàåì íàæàòèå íà Enter
	CASE tnKeyCode = 13
		NODEFAULT
		
		This.Parent.Parent.nTvrQnt = This.Value
		This.Enabled = .F.
	*------------------------------------------------------------------------------
	
	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
		This.Value = 1.000		
		This.Parent.Parent.nTvrQnt = 1.000
	*------------------------------------------------------------------------------
	
OTHERWISE

	IF !INLIST(tnKeyCode,28)

		*25.09.2006 17:34 -&gt;Âûçîâåì îáðàáîò÷èê ñîáûòèé
		IF This.Parent.Parent.KeyEventHandler(tnKeyCode)
			NODEFAULT
		ENDIF
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*12.02.2007 10:45 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	*DODEFAULT(tnKeyCode, tnShiftAltCtrl)
	*------------------------------------------------------------------------------

ENDCASE
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************


ENDPROC
PROCEDURE LostFocus
**This.Enabled = .F.

ENDPROC
PROCEDURE Valid
**This.Enabled = .F.

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1GN0RC7IZ</uniqueid>
		<timestamp>892764387</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtTvrPrice</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 0.00
Enabled = .F.
Height = 32
Left = 502
Top = 74
Width = 288
DisabledForeColor = 0,0,0
Name = "txtTvrPrice"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB0UFKZR</uniqueid>
		<timestamp>892764387</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Caption = "Öåíà"
Left = 439
Top = 75
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1GN0RC7J0</uniqueid>
		<timestamp>892766039</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Caption = "Êîë-âî"
Left = 149
Top = 75
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WJ0Y2JXT</uniqueid>
		<timestamp>910656058</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPLU</objname>
		<parent>cntsale</parent>
		<properties>FontSize = 18
Alignment = 3
Height = 32
InputMask = "9999999999999"
Width = 790
DisabledForeColor = 0,0,0
Name = "txtPLU"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

*22.09.2006 17:49 -&gt;Èùåì òîâàð
DO CASE

	*23.01.2007 09:48 -&gt;Ëîâèì ïåðåêëþ÷åíèå êëþ÷à êëàâèàòóðû
	CASE tnKeyCode = 96	&amp;&amp; ` - ïðèçíàê ïîâîðîòà
		This.Parent.lKeyLockSwith = .T.
		NODEFAULT

	CASE tnKeyCode &gt; 0 AND INLIST(UPPER(CHR(tnKeyCode)),[S],[R],[L],[X]) AND This.Parent.lKeyLockSwith
		This.Parent.UpdateStatusEvent(UPPER(CHR(tnKeyCode)))
		NODEFAULT
		
	*23.01.2007 09:51 -&gt;Îêîí÷àíèå ïåðåêëþ÷åíèÿ êëþ÷à êëàâèàòóðû
	CASE tnKeyCode = 13 AND This.Parent.lKeyLockSwith
		This.Parent.lKeyLockSwith = .F.
		NODEFAULT

	CASE tnKeyCode = 13 AND !EMPTY(This.Value)

		This.Parent.FindTovar(This.Value)
		This.Value = []
		NODEFAULT
	
	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
*	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
*		This.Value = []

OTHERWISE

	IF !INLIST(tnKeyCode,28)

		*25.09.2006 17:34 -&gt;Âûçîâåì îáðàáîò÷èê ñîáûòèé
		IF This.Parent.Parent.KeyEventHandler(tnKeyCode)
			NODEFAULT
		ENDIF
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------


ENDCASE
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntsale</objname>
		<parent/>
		<properties>Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11NNYJ</uniqueid>
		<timestamp>927824624</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntsummary</objname>
		<parent/>
		<properties>Width = 790
Height = 106
BorderWidth = 0
Enabled = .F.
Visible = .F.
Name = "cntsummary"
</properties>
		<protected/>
		<methods>PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.Parent.nCltId = lvCardViewByCardCode.CltID
	ENDIF
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>*getcardinfo Ïîëó÷àåì èíôîðìàöèþ ïî ñ÷èòàíîé êàðòå
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11XMSL</uniqueid>
		<timestamp>927824624</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtReceived</objname>
		<parent>cntsummary</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 0.00
Height = 32
InputMask = "99999999.99"
Left = 502
Top = 37
Width = 288
DisabledForeColor = 0,0,0
Name = "txtReceived"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl


*09.02.2007 14:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcPOSFuncMsg
*------------------------------------------------------------------------------

WITH This.Parent.Parent

*09.02.2007 13:19 -&gt;Èùåì êîä íàæàòîé êëàâèøè è ïûòàåìñÿ îáðàáîòàòü
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
*------------------------------------------------------------------------------

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	CASE lcPOSFuncMsg == [ESC]
		.CheckSummaryReset()

	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 27	&amp;&amp;Shift-F7- î÷èñòèòü
		.CheckSummaryReset()
	*------------------------------------------------------------------------------


	*27.04.2006 10:16 -&gt;Ñáðîñèì êîëè÷åñòâî
	CASE tnKeyCode = 90	&amp;&amp;Shift-F7- î÷èñòèòü
		This.Value= 0.00		
	*------------------------------------------------------------------------------

	OTHERWISE
	
		*21.04.2006 10:57 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		RETURN
		*------------------------------------------------------------------------------
	
ENDCASE

NODEFAULT

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11XMSO</uniqueid>
		<timestamp>892961639</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtDelivery</objname>
		<parent>cntsummary</parent>
		<properties>FontSize = 18
Alignment = 1
Value = 0.00
Enabled = .F.
Height = 32
Left = 502
Top = 74
Width = 288
DisabledForeColor = 0,0,0
Name = "txtDelivery"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>892961677</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblTvrPrice</objname>
		<parent>cntsummary</parent>
		<properties>FontSize = 18
Caption = "Ñäà÷à"
Height = 30
Left = 428
Top = 75
Width = 72
Name = "lblTvrPrice"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ11XMSS</uniqueid>
		<timestamp>892961677</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>cntsummary</parent>
		<properties>FontSize = 18
Caption = "Ïîëó÷åíî"
Height = 30
Left = 390
Top = 38
Width = 110
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntsummary</objname>
		<parent/>
		<properties>Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RS1FFOW8</uniqueid>
		<timestamp>927825940</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdmenuview</objname>
		<parent/>
		<properties>ColumnCount = 1
DefHeight = 
HeaderHeight = 0
Height = (600-SYSMETRIC(9)-1)
HighlightRow = .F.
RecordMark = .F.
RecordSource = "lvPOSFuncInSetView"
RowHeight = (ROUND((600-SYSMETRIC(9)-1)/8,0))
ScrollBars = 0
Width = 200
nfuncsetid = 0
Name = "grdmenuview"
Column1.ControlSource = "lvPOSFuncInSetView.NM"
Column1.Width = 198
Column1.Sparse = .F.
Column1.SelectOnEntry = .F.
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_v1.vcx
* Class.Module....: GRDMENUVIEW._ADD
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcAddItemType&gt;
* Returns.........: &lt;lnTvrID&gt;
* Notes...........: Ïîëó÷åíèå èäåíòèôèêàòîðà òîâàðà
*------------------------------------------------------------------------------
LPARAMETERS tcAddItemType
*10.04.2006 09:10 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnTvrID, ;
		_PARAM ,;
		_PARAM_PRCTYPE

*------------------------------------------------------------------------------

*11.04.2006 09:44 -&gt;Ïîëó÷èì èäåíòèôèêàòîð òîâàðà
DO CASE
	CASE tcAddItemType == [DISHES]
	
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð íàáîðà áëþä
		USE IN SELECT([lvTvrSetInfo])
		_PARAM = lvPOSFuncInSetView.ID
		USE lvTvrSetInfo IN 0
		ThisForm.nPrcTypeID = lvTvrSetInfo.PrcTypeID
		*------------------------------------------------------------------------------
		
		*27.04.2006 09:56 -&gt;Ñîõðàíèì ID òîâàðà
		lnTvrID = oMgrPOS.Do([POS],[ADD],lvPOSFuncInSetView.ID,ALLTRIM(lvPOSFuncInSetView.NM),lvTvrSetInfo.TvrSetTypeID)
		*------------------------------------------------------------------------------
		
	CASE tcAddItemType == [MATRIX]
	
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð íàáîðà áëþä
		*------------------------------------------------------------------------------
		
		*27.04.2006 09:56 -&gt;Ñîõðàíèì ID òîâàðà
		lnTvrID = oMgrPOS.Do([POS],[ADD],lvPOSFuncInSetView.ID,ALLTRIM(lvPOSFuncInSetView.NM),3)
		
		*------------------------------------------------------------------------------

	CASE tcAddItemType == [DISH]
	
		*27.04.2006 09:57 -&gt;Ïîëó÷èì èäåíòèôèêàòîð áëþäà
		USE IN SELECT([lvTovarInfo])
		_PARAM = lvPOSFuncInSetView.ID
		_PARAM_PRCTYPE = 1
		USE lvTovarInfo IN 0
		ThisForm.nPrcTypeID = lvTovarInfo.PrcTypeID
		*------------------------------------------------------------------------------
		
		*27.04.2006 09:57 -&gt;Ñîõðàíèì ID òîâàðà
		lnTvrID = lvPOSFuncInSetView.ID
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------
*11.04.2006 09:44 -&gt;Âåðíåì ID òîâàðà
RETURN lnTvrID
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _handlecustommsg
LPARAMETERS	tcMessage

*10.04.2006 10:11 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnOffset, ;
		lnRecNo, ;
		lnSelItem, ;
		lcFuncMsg
*------------------------------------------------------------------------------
*10.04.2006 09:59 -&gt;Ïðîâåðèì, íåîáõîäèìî ëè ðàáîòàòü ñ ìåíþ-Grid-om
IF [CELL]$tcMessage
	
	*10.04.2006 10:02 -&gt;Ñîõðàíèðì ïîçèöèþ â RS
	lnRecNo	 = RECNO(This.RecordSource)
	*------------------------------------------------------------------------------
	
	*10.04.2006 10:02 -&gt;Îïðåäåëèì íîìåð çàïèñè, ïî êîòîðîé áóäåò îñóùåñòâëÿòüñÿ âûçîâ
	lnOffset  = VAL(STRTRAN(tcMessage,[CELL],[]))
	lnSelItem = This.ActiveRow-This.RelativeRow+lnOffset
	*------------------------------------------------------------------------------

	*10.04.2006 10:03 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
	SELECT(This.RecordSource)
	
	IF lnSelItem &lt;= RECCOUNT() AND lnSelItem &gt; 0
	
		*13.04.2006 15:05 -&gt;Ïåðåõîäì íà âûáðàííóþ çàïèñü
		GOTO lnSelItem
		*------------------------------------------------------------------------------
		
		*13.04.2006 15:54 -&gt;Ñîõðàíÿåì êîìàíäó
		lcFuncMsg = UPPER(ALLTRIM(POSFuncMsg))
		*------------------------------------------------------------------------------

		*13.04.2006 15:04 -&gt;Àíàëèçèðóåì êîìàíäó ìåíþ
		DO CASE
			CASE lcFuncMsg == [DISHES]
				This._Add([DISHES])
			CASE lcFuncMsg == [DISH]
				This._Add([DISH])
			CASE lcFuncMsg == [EXIT]
				This.Parent.Shutdown()
			CASE lcFuncMsg == [XREP]
				This.Parent.ReportX()
			CASE lcFuncMsg == [ZREP]
				This.Parent.CloseDay()
			CASE lcFuncMsg == [CHKRET]
				This.Parent.CheckReturnMode()
			CASE lcFuncMsg == [CHKSLS]
				This.Parent.CheckSaleMode()
			CASE lcFuncMsg == [TPRC]
				This.Parent.SelectPrice()
			CASE lcFuncMsg == [BLOCK]
				This.Parent.ChangeUser()
			CASE lcFuncMsg == [DRAWER]
				This.Parent.OpenDrawer()
			CASE lcFuncMsg == [PAY]
				This.Parent.PaymentSelect(ID)
			CASE lcFuncMsg == [CASHIN]
				This.Parent.CashIncome()
			CASE lcFuncMsg == [CASHOUT]
				This.Parent.CashOutcome()
			CASE lcFuncMsg == [MATRIX]
				This._Add([MATRIX])
		ENDCASE
		*------------------------------------------------------------------------------
		
		*13.04.2006 15:05 -&gt;Âîçâðàùàåìñÿ íà èñõîäíóþ çàïèñü
		SELECT(This.RecordSource)
		GOTO lnRecNo
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************




ENDPROC
PROCEDURE _rsrequery
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_v1.vcx
* Class.Module....: grdMenuView._rsRequery
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnFuncSetID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â Grid-å
*------------------------------------------------------------------------------
LPARAMETERS tnFuncSetID

*27.02.2006 12:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

WITH This

*28.02.2006 16:02 -&gt;Ñîõðàíèì ID ÷åêà
.nFuncSetID = tnFuncSetID
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*27.02.2006 11:11 -&gt;Îáíîâèì RS
_PARAM = tnFuncSetID
REQUERY([lvPOSFuncInSetView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>nfuncsetid Íàáîð ôóíêöèé îòîáðàæàåìûé â ìåíþ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RT006XM9</uniqueid>
		<timestamp>881131762</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmenuview.Column1</parent>
		<properties>Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S00M2J29</uniqueid>
		<timestamp>882593947</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edt1</objname>
		<parent>grdmenuview.Column1</parent>
		<properties>FontBold = .T.
FontSize = 11
BorderStyle = 0
Left = 23
ScrollBars = 0
Top = 11
DisabledForeColor = 0,0,0
Name = "Edt1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.Parent._Add()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdmenuview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 11, 7, 18, 14, 39, 4, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_0VL0XXSOC</uniqueid>
		<timestamp>927830739</timestamp>
		<class>custom</class>
		<classloc/>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE do
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_v1.vcx
* Class.Module....: Interface.Do
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé èíòåðôåéñ áèáëèîòåêè.
*-------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequstedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10
*19.05.2004 19:23 -&gt; Ïðîâåðÿåì ïåðâûé îáÿçàòåëüíûé ïàðàìåòð
IF TYPE([tcRequstedOperation])#[C] OR EMPTY(tcRequstedOperation)
	*{
	ASSERT .F. MESSAGE [Îøèáêà âûçîâà ìåíåäæåðà îðãàíèçàöèîííûõ åäèíèö: íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	*}
ENDIF	
*------------------------------------------------------------------------------

*19.05.2004 19:24 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequstedOperation, ;
		llOperateResult
***
lcEntityName		= UPPER(ALLTRIM(tcEntityName))
lcRequstedOperation = UPPER(ALLTRIM(tcRequstedOperation))
*------------------------------------------------------------------------------

*12.01.2005 16:41 -&gt; Âûïîëíÿåì îïåðàöèþ
DO CASE

	*************************************************************************************************************
	*[POSFUNC] &amp; [VIEW]) - ðàáîòà ñ ôóíêöèÿìè POS																*
	*************************************************************************************************************
	CASE lcEntityName == [POSFUNC] AND lcRequstedOperation == [VIEW]

	*12.01.2005 16:46 -&gt; Âûïîëíèì îïåðàöèþ
	oApp.ExecuteScrFormByObjDesc([frmposfunc;pos_v1.vcx;pos.app])

	*************************************************************************************************************
	*[POSFUNC] &amp; ([ADD] || [EDIT] || [INFO] || [DELE]) - äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ôóíêöèè POS*
	*************************************************************************************************************
	CASE lcEntityName == [POSFUNC] AND ;
		 (lcRequstedOperation == [ADD]  OR ;
		  lcRequstedOperation == [EDIT] OR ;
		  lcRequstedOperation == [INFO] OR ;
		  lcRequstedOperation == [DELE] )

		*12.01.2005 16:46 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð ôóíêöèè POS äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*12.01.2005 16:46 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmposfuncedit;pos_v1.vcx;pos.app],lcRequstedOperation,tuParam1)
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POSFUNCSET] &amp; ([ADD] || [EDIT] || [INFO] || [DELE]) - äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ôóíêöèè POS*
	*************************************************************************************************************
	CASE lcEntityName == [POSFUNCSET] AND ;
		 (lcRequstedOperation == [ADD]  OR ;
		  lcRequstedOperation == [EDIT] OR ;
		  lcRequstedOperation == [INFO] OR ;
		  lcRequstedOperation == [DELE] )

		*12.01.2005 16:46 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð ôóíêöèè POS äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*12.01.2005 16:46 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmposfuncsetedit;pos_v1.vcx;pos.app],lcRequstedOperation,tuParam1)
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------
	
	*************************************************************************************************************
	*[POSFUNCSET] &amp; [SET] - ðåäàêòèðîâàíèå íàáîðà ôóíêöèé POS													*
	*************************************************************************************************************
	CASE lcEntityName == [POSFUNCSET] AND lcRequstedOperation == [SET]
		
		*07.04.2006 18:14 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmposfuncsetcont;pos_v1.vcx;pos.app],tuParam1)
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[FUNCLINK] &amp; [EDIT] - ïðèâÿçêà ôóíêöèè íàáîðà POS															*
	*************************************************************************************************************
	CASE lcEntityName == [FUNCLINK] AND lcRequstedOperation == [EDIT]
		
		*07.04.2006 18:14 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmposfunclink;pos_v1.vcx;pos.app],tuParam1)
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POS] &amp; [ADD] - âûáîð òîâàðà(áëþäà)																		*
	*************************************************************************************************************
	CASE lcEntityName == [POS] AND lcRequstedOperation == [ADD]
		
		*07.04.2006 18:14 -&gt;Âûïîëíèì îïåðàöèþ
		DO CASE
			CASE tuParam3 = 1
				llOperateResult = oApp.DoModalFormRetValObj([frmselectitemtree;pos_v1.vcx],tuParam1,tuParam2)
			CASE tuParam3 = 2
				llOperateResult = oApp.DoModalFormRetValObj([frmselectitem;pos_v1.vcx],tuParam1,tuParam2)
			CASE tuParam3 = 3
				llOperateResult = oApp.DoModalFormRetValObj([frmselectitmatr;pos_v1.vcx],tuParam1,tuParam2)
		ENDCASE
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POS] &amp; [DISC] - âûáîð ñêèäêè																				*
	*************************************************************************************************************
	CASE lcEntityName == [POS] AND lcRequstedOperation == [DISC]
		
		*07.04.2006 18:14 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdiscount;pos_v1.vcx],tuParam1,tuParam2)
*		llOperateResult = oApp.DoModalFormRetValObj([frmselectitemdisc;pos_v1.vcx])
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POS] &amp; [PAYMENT] - âûáîð òèïà îïëàòû																				*
	*************************************************************************************************************
	CASE lcEntityName == [POS] AND lcRequstedOperation == [PAYMENT]
		
		*11.05.2006 12:13 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmselectitempayment;pos_v1.vcx])
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POS] &amp; [PAYMENTSUM] - ñóììà ïî òèïy îïëàòû																				*
	*************************************************************************************************************
	CASE lcEntityName == [POS] AND lcRequstedOperation == [PAYMENTSUM]
		
		*11.05.2006 12:13 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj(tuParam1+[;pos_v1.vcx],tuParam2,tuParam3,tuParam4,tuParam5,tuParam6)

		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[POS] &amp; [CASHSUM] - âíåñåíèå/âûïëàòà â êàññó																				*
	*************************************************************************************************************
	CASE lcEntityName == [POS] AND lcRequstedOperation == [CASHSUM]
		
		*18.10.2006 12:37 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmcashinout;pos_v1.vcx],tuParam1,tuParam2,tuParam3)
		***
		RETURN llOperateResult
		*------------------------------------------------------------------------------
		
	OTHERWISE
	
		*19.05.2004 21:59 -&gt;Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Ê ñîæàëåíèþ çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*do Îñíîâíîé èíòåðôåéñ áèáëèîòåêè.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ìåíåäæåð áèáëèîòåêè QueryParam_v1</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>928467988</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselectitem</objname>
		<parent/>
		<properties>Height = 450
Width = 355
ShowWindow = 1
DoCreate = .T.
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
ntvrsetid = 0
Name = "frmselectitem"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnScrFrmID,tcTvrSetNM&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS tnTvrSetID,tcTvrSetNM

*04.08.2005 11:46 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*10.04.2006 09:44 -&gt;Ïîêàæåì â çàãîëîâêå ôîðìû íàçâàíèÿ íàþîðà òîâàðîâ
IF TYPE([tcTvrSetNM])==[C] AND !EMPTY(tcTvrSetNM)
	This.lblCaption.Caption = tcTvrSetNM
ENDIF
*------------------------------------------------------------------------------

*09.04.2006 14:24 -&gt;Ñîõðàíèì èäåíòèôèêàòîð ìíîæåñòâà òîâàðîâ
This.nTvrSetID = tnTvrSetID
*------------------------------------------------------------------------------

*05.08.2005 15:23 -&gt;Îáíîâèì Grid
ThisForm.grdTvrInSet._RSRequery()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl


DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		ThisForm.uRetVal = lvTvrInSetView.TvrID
		ThisForm.Hide()
	CASE tnKeyCode = 27
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*04.08.2005 10:45 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*04.08.2005 10:45 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*04.08.2005 10:50 -&gt; Îòêðûâàåì Local View ñ êàðòèíêàìè
USE lvTvrInSetView IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3>ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>âûáîð òîâàðà èç íàáîðà òîâàðîâ</reserved7>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00VGWHD</uniqueid>
		<timestamp>928467988</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdTvrInSet</objname>
		<parent>frmselectitem</parent>
		<properties>ColumnCount = 2
FontSize = 12
HeaderHeight = 1
Height = 425
Panel = 1
ReadOnly = .T.
RecordSource = "lvTvrInSetView"
RowHeight = 22
ScrollBars = 2
Top = 25
Width = 355
HighlightStyle = 2
Name = "grdTvrInSet"
Column1.FontSize = 12
Column1.ColumnOrder = 1
Column1.ControlSource = "lvTvrInSetView.Num_Cnt"
Column1.Width = 27
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.FontSize = 12
Column2.ColumnOrder = 2
Column2.ControlSource = "lvTvrInSetView.TvrNM"
Column2.Width = 297
Column2.ReadOnly = .T.
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _rsrequery
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: grdTvrInSet._RSRequery
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñïèñêà âûáðàííûõ òîâàðîâ
*------------------------------------------------------------------------------
WITH This

*09.04.2006 14:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = ThisForm.nTvrSetID
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
REQUERY([lvTvrInSetView])

SELECT lvTvrInSetView
REPLACE Num_cnt WITH STR(RECNO(),2,0) ALL
GO top
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

*22.07.2005 14:31 -&gt;Âîññòàíîâèì ïîçèöèþ â Grid-å
.column1.header1.DblClick()
.PositionRecall()
.column1.txtgrd1.SetFocus()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************



ENDPROC
PROCEDURE handlekey
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

WITH This

DO CASE

	CASE tnKeyCode &gt; 47 AND tnKeyCode &lt;58 AND tnShiftAltCtrl = 0	&amp;&amp;UPArrow
		
		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		KEYBOARD '{ENTER}'
		
	CASE tnKeyCode = 5 AND tnShiftAltCtrl = 0	&amp;&amp;UPArrow
		
		KEYBOARD '{BACKSPACE}'
		KEYBOARD '{BACKSPACE}'
		KEYBOARD '{BACKSPACE}'
		
		*22.04.2004 11:44 -&gt;Âûïîëíÿåì êîìàíäó ïåðåõîäà ê ïðåäûäóùåé çàïèñè
		.HandleMsg([PREV])

	OTHERWISE
		
		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		

ENDCASE



ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0IJGUB</uniqueid>
		<timestamp>883192392</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmselectitem.grdTvrInSet.Column1</parent>
		<properties>Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0ZH6GD</uniqueid>
		<timestamp>883131927</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmselectitem.grdTvrInSet.Column1</parent>
		<properties>Left = 13
ReadOnly = .T.
Top = 10
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F42</uniqueid>
		<timestamp>882214781</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmselectitem.grdTvrInSet.Column2</parent>
		<properties>FontSize = 12
Alignment = 2
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0ZJKZZ</uniqueid>
		<timestamp>883131483</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmselectitem.grdTvrInSet.Column2</parent>
		<properties>Height = 23
Left = 105
Top = 10
Width = 100
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z9BHL</uniqueid>
		<timestamp>928467988</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmselectitem</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Width = 355
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CL6G</uniqueid>
		<timestamp>928467988</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmselectitem</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselectitem</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2780O3WWM</uniqueid>
		<timestamp>928467993</timestamp>
		<class>frmselectitem</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmselectitmatr</objname>
		<parent/>
		<properties>Height = 467
Width = 355
DoCreate = .T.
Name = "frmselectitmatr"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
grdTvrInSet.COLUMN1.Header1.Name = "Header1"
grdTvrInSet.COLUMN1.Txtgrd1.Name = "Txtgrd1"
grdTvrInSet.COLUMN1.Name = "COLUMN1"
grdTvrInSet.COLUMN2.Header1.Name = "Header1"
grdTvrInSet.COLUMN2.Text1.Name = "Text1"
grdTvrInSet.COLUMN2.Name = "COLUMN2"
grdTvrInSet.Height = 407
grdTvrInSet.Left = 0
grdTvrInSet.Top = 25
grdTvrInSet.Width = 355
grdTvrInSet.ZOrderSet = 4
grdTvrInSet.Name = "grdTvrInSet"
lblCaption.ZOrderSet = 5
lblCaption.Name = "lblCaption"
ImgCaption.ZOrderSet = 6
ImgCaption.Name = "ImgCaption"
</properties>
		<protected/>
		<methods>PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: .GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
				*--Ïîêàæåì äàííûå ïî êàðòå
			*.Parent.nCltId = lvCardViewByCardCode.CardOwnerID
			LOCAL ltAccesEnd, llChild
			SELECT lvTvrInSetView
			ltAccesEnd =  CTOT(SUBSTR(TTOC(DATETIME()),1,11)+STR(lvTvrInSetView.qnt2,2,0)+':00:00')
			llChild    =  LIKE('*ÄÅÒÑÊ*',UPPER(lvTvrInSetView.TvrNm))
			USE lvAccessWind IN 0 NODATA
	        CURSORSETPROP([BUFFERING],3,[lvAccessWind])
			INSERT INTO lvAccessWind (CardId,                     CardCode,           AccesStart, AccesEnd,;
									  Child ,CardOwnerID);
			                  VALUES (lvCardViewByCardCode.CardId,ALLTRIM(tccardcode),DATETIME(),ltAccesEnd,;
			                  		  llChild,lvCardViewByCardCode.CardOwnerID)
			TABLEUPDATE(1,.t.,'lvAccessWind')
			USE IN lvAccessWind
		ELSE
			NODEFAULT
			MESSAGEBOX('Êàðòà ïîñòîðîííÿÿ. Îáðàòèòåñü ê Àäìèíèñòðàòîðó',0+48,'Ïîäãîòîâêà áèëåòà',5000)
			ThisForm.uRetVal = 0
			ThisForm.Hide()

			RETURN .f.
	ENDIF
ENDWITH
RETURN .t.
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE grdTvrInSet.KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl
WITH This

DO CASE

	CASE tnKeyCode &gt; 47 AND tnKeyCode &lt;58 AND tnShiftAltCtrl = 0	&amp;&amp;UPArrow
		
		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		KEYBOARD '{ENTER}'
		
	OTHERWISE
		
		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		

ENDCASE



ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl
DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		ThisForm.uRetVal = lvTvrInSetView.Price
		pTvrNm = lvTvrInSetView.TvrNm
		ThisForm.Hide()
*!*			MESSAGEBOX('Ïîäíåñèòå áèëåò ê ñ÷èòûâàòåëþ',0+64,'Ïîäãîòîâêà áèëåòà',3000)
	CASE tnKeyCode = 27
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		FrmPosEdit::keyPress(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
DODEFAULT()
USE IN lvTvrInSetView

USE lvTvrInMatrView IN 0 NODATA ALIAS lvTvrInSetView
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>*getcardinfo Ïîëó÷àåì ñâåäåíèÿ ïî êàðòå
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>âûáîð òîâàðà ïî ìàòðèöå</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2790ND7P8</uniqueid>
		<timestamp>928467993</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmselectitmatr</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontSize = 12
WordWrap = .T.
Alignment = 2
Caption = "Âûáåðèòå âðåìåííîé òàðèô. Ïîäíåñèòå áèëåò-êàðòó äëÿ ïðîãðàììèðîâàíèÿ."
Height = 72
Left = 57
Top = 374
Width = 240
ForeColor = 255,128,0
ZOrderSet = 0
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmselectitmatr</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>929276465</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmproxcardretu</objname>
		<parent/>
		<properties>DataSession = 1
Height = 187
Width = 539
ShowWindow = 1
DoCreate = .T.
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
ntvrsetid = 0
qntcard = 0
tncheckid = 0
nchecktypeid = 1
Name = "frmproxcardretu"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: .GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM,lDayQnt

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF
	SET DATABASE TO BASIS
	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
				*--Ïîêàæåì äàííûå ïî êàðòå
			*.Parent.nCltId = lvCardViewByCardCode.CardOwnerID
					*** ïîìå÷àåì, ÷òî êàðòà ñäàíà íàçàä
					USE IN SELECT('lvCardEdit')
					_PARAM = lvCardViewByCardCode.CardId
					USE lvCardEdit IN 0
					CURSORSETPROP([BUFFERING],3,[lvCardEdit])
					SELECT lvCardEdit
					IF RECCOUNT('lvCardEdit')=1
							IF !ISNULL(lvCardEdit.CardActivationDate)
								REPLACE lvCardEdit.CardActivationDate WITH NULL
								TABLEUPDATE(1,.t.,'lvCardEdit')
							ELSE
								MESSAGEBOX('Êàðòà óæå íåàêòèâíà, îòëîæèòå åå â ñòîðîíó',0+48,'Ïðîáëåìà ñ âîçâðàòîì çàëîãà çà ýòó êàðòó')
								RETURN .t.
							ENDIF
						ELSE
							MESSAGEBOX('Êàðòà íå áûëà çàôèêñèðîâàíà ðàíåå, îòëîæèòå åå â ñòîðîíó',0+48,'Ïðîáëåìà ñ âîçâðàòîì çàëîãà çà ýòó êàðòó')
					ENDIF
			this.qntcard = this.qntcard+1
			this.lbl1.Refresh()
		ELSE
			NODEFAULT
			MESSAGEBOX('Êàðòà ïîñòîðîííÿÿ. Îáðàòèòåñü ê Àäìèíèñòðàòîðó',0+48,'Ïîäãîòîâêà áèëåòà',5000)
	ENDIF
ENDWITH
RETURN .t.
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmProxCard.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnScrFrmID,tcTvrSetNM&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS tnCheckID,nCheckTypeID &amp;&amp;,tcTvrSetNM

*04.08.2005 11:46 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
frm::Init()
*----------------------------------------------------------------------------
this.tncheckid  = tnCheckID
this.nchecktypeid = nCheckTypeID
*10.04.2006 09:44 -&gt;Ïîêàæåì â çàãîëîâêå ôîðìû íàçâàíèÿ íàáîðà òîâàðîâ
	This.lblCaption.Caption = 'Ïîäñ÷åò êàðò äëÿ âîçâðàòà'
*------------------------------------------------------------------------------
this.lbl1.Refresh()
*09.04.2006 14:24 -&gt;Ñîõðàíèì èäåíòèôèêàòîð ìíîæåñòâà òîâàðîâ
*------------------------------------------------------------------------------
this.olecommprox1._open()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl
DO CASE
	CASE tnKeyCode = 13
		NODEFAULT
		ThisForm.uRetVal = this.qntcard
		ThisForm.Hide()
	CASE tnKeyCode = 27 AND this.qntcard=0
		NODEFAULT
		ThisForm.uRetVal = 0
		ThisForm.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	**	FrmPosEdit::keyPress(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------
this.qntcard = 0

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
qntcard Êîëè÷åñòâî îñòàâøèõñÿ êàðò
tncheckid íîìåð ÷åêà, ñ êîòîðûì ðàáîòàåì
nchecktypeid òèï ÷åêà 1 - ïðîäàæà, 2 - âîçâðàò
*getcardinfo Ïîëó÷àåì èíôîðìàöèþ ïî ñ÷èòêå êàðòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ïðîãðàììèðîâàíèå âîçâðàòà ïðîêñèìèòè êàðò</reserved7>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z9BHL</uniqueid>
		<timestamp>929276465</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmproxcardretu</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Left = 0
Top = 0
Width = 540
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CL6G</uniqueid>
		<timestamp>929276465</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmproxcardretu</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B13X7NS</uniqueid>
		<timestamp>929276978</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>frmproxcardretu</parent>
		<properties>Top = 156
Left = 55
Height = 24
Width = 432
FontBold = .T.
FontSize = 12
Caption = "Ïî îêîí÷àíèè íàæìèòå Enter"
Name = "Cmd1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.Hide()
thisform.Release()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B180QUU</uniqueid>
		<timestamp>929276465</timestamp>
		<class>label</class>
		<classloc/>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmproxcardretu</parent>
		<properties>FontBold = .T.
FontSize = 16
WordWrap = .T.
Alignment = 2
Caption = "Lbl1"
Height = 96
Left = 132
Top = 48
Width = 289
Name = "Lbl1"
</properties>
		<protected/>
		<methods>PROCEDURE Refresh
	thisform.lbl1.Caption = 'Ñ÷èòàíî êàðò äëÿ âîçâðàòà:'+ ;
ALLTRIM(STR(thisform.qntcard,10,0))
DODEFAULT()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B13X7NU</uniqueid>
		<timestamp>929276465</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmproxcardretu</parent>
		<properties>Top = 48
Left = 24
Height = 48
Width = 58
Enabled = .T.
ZOrderSet = 7
lautosave = .F.
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***
LOCAL lcMsg
lcMsg = THIS._Read()
IF EMPTY(lcMsg)
	RETURN
ENDIF
WITH this.Parent
	IF .getcardinfo(lcMsg)
*!*			WAIT WINDOW 'Ïðîãðàììèðóåòñÿ áèëåò:'+lcMsg+ ' ...' TIMEOUT 0.5
*!*			MESSAGEBOX('Áèëåò çàïðîãàìèðîâàí',0+64,'Ïîäãîòîâêà áèëåòà',800)
*!*			WAIT CLEAR
	ENDIF
ENDWITH
**KEYBOARD '{ENTER}'

ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA71agsHsgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmproxcardretu</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM106QSG</uniqueid>
		<timestamp>930188015</timestamp>
		<class>frmpos</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmposdyna</objname>
		<parent/>
		<properties>Height = 581
DoCreate = .T.
Name = "frmposdyna"
CNTSUMMARY.txtReceived.Left = 280
CNTSUMMARY.txtReceived.Top = 37
CNTSUMMARY.txtReceived.Width = 305
CNTSUMMARY.txtReceived.Name = "txtReceived"
CNTSUMMARY.txtDelivery.Left = 280
CNTSUMMARY.txtDelivery.Top = 74
CNTSUMMARY.txtDelivery.Width = 305
CNTSUMMARY.txtDelivery.Name = "txtDelivery"
CNTSUMMARY.lblTvrPrice.Left = 206
CNTSUMMARY.lblTvrPrice.Top = 75
CNTSUMMARY.lblTvrPrice.Name = "lblTvrPrice"
CNTSUMMARY.Lbl1.Left = 168
CNTSUMMARY.Lbl1.Top = 38
CNTSUMMARY.Lbl1.Name = "Lbl1"
CNTSUMMARY.Top = 468
CNTSUMMARY.Left = 5
CNTSUMMARY.Width = 585
CNTSUMMARY.Height = 106
CNTSUMMARY.ZOrderSet = 0
CNTSUMMARY.Name = "CNTSUMMARY"
CNTSALE.txtTvrNM.Left = 0
CNTSALE.txtTvrNM.Width = 585
CNTSALE.txtTvrNM.Name = "txtTvrNM"
CNTSALE.txtTvrQnt.InputMask = "99999"
CNTSALE.txtTvrQnt.Left = 78
CNTSALE.txtTvrQnt.Top = 74
CNTSALE.txtTvrQnt.Name = "txtTvrQnt"
CNTSALE.txtTvrPrice.Left = 385
CNTSALE.txtTvrPrice.Width = 200
CNTSALE.txtTvrPrice.Name = "txtTvrPrice"
CNTSALE.Lbl1.Left = 325
CNTSALE.Lbl1.Top = 75
CNTSALE.Lbl1.Name = "Lbl1"
CNTSALE.Lbl2.Left = 0
CNTSALE.Lbl2.Name = "Lbl2"
CNTSALE.txtPLU.Width = 585
CNTSALE.txtPLU.Name = "txtPLU"
CNTSALE.Top = 468
CNTSALE.Left = 5
CNTSALE.Width = 585
CNTSALE.Height = 106
CNTSALE.ZOrderSet = 1
CNTSALE.Name = "CNTSALE"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
shtrih.Name = "shtrih"
grdchecktransview.Column1.Header1.Name = "Header1"
grdchecktransview.Column1.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column1.Name = "Column1"
grdchecktransview.Column2.Header1.Name = "Header1"
grdchecktransview.Column2.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column2.Width = 230
grdchecktransview.Column2.Name = "Column2"
grdchecktransview.Column3.Header1.Name = "Header1"
grdchecktransview.Column3.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column3.Width = 59
grdchecktransview.Column3.Name = "Column3"
grdchecktransview.Column4.Header1.Name = "Header1"
grdchecktransview.Column4.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column4.Width = 80
grdchecktransview.Column4.Name = "Column4"
grdchecktransview.Column5.Header1.Name = "Header1"
grdchecktransview.Column5.Txtgrd1.Name = "Txtgrd1"
grdchecktransview.Column5.Width = 95
grdchecktransview.Column5.Name = "Column5"
grdchecktransview.Height = 394
grdchecktransview.Left = 5
grdchecktransview.Panel = 1
grdchecktransview.Width = 585
grdchecktransview.ZOrderSet = 6
grdchecktransview.Name = "grdchecktransview"
cntclock.lblClock.Name = "lblClock"
cntclock.tmrClock.Name = "tmrClock"
cntclock.Left = 401
cntclock.ZOrderSet = 7
cntclock.Name = "cntclock"
lblCheckStatus.Height = 30
lblCheckStatus.Left = 259
lblCheckStatus.Top = 0
lblCheckStatus.Width = 107
lblCheckStatus.ZOrderSet = 8
lblCheckStatus.Name = "lblCheckStatus"
lblUserNM.ZOrderSet = 9
lblUserNM.Name = "lblUserNM"
txtPosMode.BorderStyle = 0
txtPosMode.Height = 32
txtPosMode.Left = 5
txtPosMode.SpecialEffect = 1
txtPosMode.Top = 429
txtPosMode.Width = 249
txtPosMode.Name = "txtPosMode"
txtCheckSum.Height = 32
txtCheckSum.Left = 359
txtCheckSum.Top = 429
txtCheckSum.Width = 231
txtCheckSum.ZOrderSet = 10
txtCheckSum.Name = "txtCheckSum"
lblCheckNo.ZOrderSet = 11
lblCheckNo.Name = "lblCheckNo"
lblCheckSum.Left = 279
lblCheckSum.ZOrderSet = 12
lblCheckSum.Name = "lblCheckSum"
olecommscanner.Top = 468
olecommscanner.Left = 552
olecommscanner.Height = 48
olecommscanner.Width = 58
olecommscanner.Name = "olecommscanner"
linedisplay.Top = 428
linedisplay.Left = 316
linedisplay.Height = 33
linedisplay.Width = 33
linedisplay.Name = "linedisplay"
</properties>
		<protected/>
		<methods>PROCEDURE checkfinalization
*24.01.2007 11:43 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*12.05.2006 15:16 -&gt;Ïîêàæåì îñíîâíîå ìåíþ
.grdMenuView._rsRequery(.nMainSet)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE checkreturnmode
*09.02.2007 12:30 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*27.04.2006 10:08 -&gt;Âåðíåì îñíîâíîå ìåíþ
.grdMenuView._rsRequery(.nMainSet)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checksummaryprepare
*24.01.2007 11:31 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*24.01.2007 11:31 -&gt;Ðàáîòà ñ ýêðàííûì ìåíþ
IF This.lSummaryMode

	*12.05.2006 15:16 -&gt;Ïîêàæåì òèïû îïëàòû
	This.grdMenuView._rsRequery(.nPaySet)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checksummaryreset
*24.01.2007 11:31 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*12.05.2006 15:16 -&gt;Ïîêàæåì îñíîâíîå ìåíþ
.grdMenuView._rsRequery(.nMainSet)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE CNTSUMMARY.txtReceived.KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

WITH This.Parent.Parent

*16.04.2006 11:55 -&gt;Îáðàáîòàåì âûáîð ïîëüçîâàòåëÿ
DO CASE

	CASE tnKeyCode = 28
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL1])
	CASE tnKeyCode = -1
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL2])
	CASE tnKeyCode = -2
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL3])
	CASE tnKeyCode = -3
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL4])
	CASE tnKeyCode = -4
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL5])
	CASE tnKeyCode = -5
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL6])
	CASE tnKeyCode = -6
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL7])
	CASE tnKeyCode = -7
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL8])
	CASE tnKeyCode = -8
		NODEFAULT
		.grdMenuView._HandleCustomMsg([CELL9])
		***
		
	OTHERWISE
	
		*21.04.2006 10:57 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		RETURN
		*------------------------------------------------------------------------------
	
ENDCASE

NODEFAULT

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*25.09.2006 17:00 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
IF DODEFAULT()

	*23.01.2007 11:35 -&gt;Ïîêàæåì ðåæèì
	This.SetPosMode(3) &amp;&amp;This.KeyLock.KeyPosition)
	*------------------------------------------------------------------------------

	*25.09.2006 17:01 -&gt;Îáíîâèì ìåíþ
	This.grdMenuView._rsRequery(This.nMainSet)
	*------------------------------------------------------------------------------

ELSE

	RETURN .F.

ENDIF
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE keyeventhandler
*------------------------------------------------------------------------------
* Notes...........: Îáðàáîòêà íàæàòèÿ êëàâèø
*------------------------------------------------------------------------------
LPARAMETERS tnKeyCode

*20.10.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   llEventClear, ;
		lcPOSFuncMsg, ;
		lcPOSEnabledMode
***
llEventClear = DODEFAULT(tnKeyCode)
*------------------------------------------------------------------------------

*24.01.2007 11:45 -&gt;Åñëè êëàâèøà îáðàáîòàíà - âûõîäèì
IF llEventClear
	RETURN llEventClear
ELSE
	llEventClear = .T.
ENDIF
*------------------------------------------------------------------------------

WITH This

*20.10.2006 09:31 -&gt;Èùåì êîä íàæàòîé êëàâèøè è ïûòàåìñÿ îáðàáîòàòü
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
lcPOSEnabledMode = ICASE(EMPTY(lvPOSKeyMap.POSEnabledMode),[0],ISNULL(lvPOSKeyMap.POSEnabledMode),[0],ALLTRIM(lvPOSKeyMap.POSEnabledMode))
***

DO CASE

	CASE tnKeyCode = 28
		.grdMenuView._HandleCustomMsg([CELL1])
	CASE tnKeyCode = -1
		.grdMenuView._HandleCustomMsg([CELL2])
	CASE tnKeyCode = -2
		.grdMenuView._HandleCustomMsg([CELL3])
	CASE tnKeyCode = -3
		.grdMenuView._HandleCustomMsg([CELL4])
	CASE tnKeyCode = -4
		.grdMenuView._HandleCustomMsg([CELL5])
	CASE tnKeyCode = -5
		.grdMenuView._HandleCustomMsg([CELL6])
	CASE tnKeyCode = -6
		.grdMenuView._HandleCustomMsg([CELL7])
	CASE tnKeyCode = -7
		.grdMenuView._HandleCustomMsg([CELL8])
	CASE tnKeyCode = -8
		.grdMenuView._HandleCustomMsg([CELL9])
		***

	CASE lcPOSFuncMsg == [ESC]		AND ;	&amp;&amp; F11
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.grdMenuView._rsRequery(.nMainSet)
		***
	CASE lcPOSFuncMsg == [SELECT]	AND ;	&amp;&amp; Shift-F5 - âûáîð
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSelectSet)
		ENDIF
		***
	CASE lcPOSFuncMsg == [SPEC]		AND ;	&amp;&amp; Shift-F6 - ñïåö. ôóíêöèè
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSpecialSet)
		ENDIF
		***
	OTHERWISE
		llEventClear = .F.
ENDCASE
*------------------------------------------------------------------------------

RETURN llEventClear

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE msghandler
LPARAMETERS tcPOSFuncMsg, ;
			tcPOSEnabledMode

*20.10.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   llEventClear, ;
		lcPOSFuncMsg, ;
		lcPOSEnabledMode
***
llEventClear = DODEFAULT(tcPOSFuncMsg,tcPOSEnabledMode)
*------------------------------------------------------------------------------

*24.01.2007 11:26 -&gt;Åñëè ñîîáùåíèå îáðàáîòàíî - âûõîäèì
IF llEventClear
	RETURN llEventClear
ELSE
	llEventClear = .T.
ENDIF
*------------------------------------------------------------------------------

*20.10.2006 15:47 -&gt;
lcPOSFuncMsg	 = ALLTRIM(tcPOSFuncMsg)
lcPOSEnabledMode = ICASE(EMPTY(tcPOSEnabledMode),[0],ISNULL(tcPOSEnabledMode),[0],ALLTRIM(tcPOSEnabledMode))
*------------------------------------------------------------------------------

WITH This

DO CASE

	CASE lcPOSFuncMsg == [ESC]		AND ;	&amp;&amp; F11
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.grdMenuView._rsRequery(.nMainSet)
		***
	CASE lcPOSFuncMsg == [SELECT]	AND ;	&amp;&amp; Shift-F5 - âûáîð
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSelectSet)
		ENDIF
		***
	CASE lcPOSFuncMsg == [SPEC]		AND ;	&amp;&amp; Shift-F6 - ñïåö. ôóíêöèè
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSpecialSet)
		ENDIF
		***
	OTHERWISE
		llEventClear = .F.
ENDCASE
*------------------------------------------------------------------------------

RETURN llEventClear

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE olecommscanner.OnComm
*** ActiveX Control Event ***
SET STEP ON
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>pos - ñ ôóíêö êíîïêàèì ñáîêó</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMF</uniqueid>
		<timestamp>927689079</timestamp>
		<class>grdmenuview</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdMenuView</objname>
		<parent>frmposdyna</parent>
		<properties>Enabled = .F.
Height = 580
Left = 595
RecordSource = "lvPOSFuncInSetView"
Top = 0
Width = 145
ZOrderSet = 4
Name = "grdMenuView"
Column1.Header1.Name = "Header1"
Column1.Edt1.Enabled = .F.
Column1.Edt1.Name = "Edt1"
Column1.ControlSource = "lvPOSFuncInSetView.NM"
Column1.Enabled = .F.
Column1.Width = 143
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
LPARAMETERS	tcAddTvrType

*11.04.2006 09:45 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnTvrID, lnPrice
PUBLIC pTvrNm,pnQntTvr
thisform.pctvrname=[]
pTvrNm = []
*------------------------------------------------------------------------------
lnPrice = 0
*11.04.2006 09:45 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
IF thisform.cntsale.txtTvrQnt.value # 0
pnQntTvr = thisform.cntsale.txtTvrQnt.value
ENDIF
lnTvrID = DODEFAULT(tcAddTvrType)
*------------------------------------------------------------------------------
DO CASE
CASE tcAddTvrType = [MATRIX] AND lnTvrID #0
		lnPrice = lnTvrID
		lnTvrID = lvPOSFuncInSetView.ID
		thisform.pctvrname = pTvrNm
ENDCASE
RELEASE pTvrNm,pnQntTvr
*11.04.2006 09:48 -&gt;Ïîëó÷àåì èíôîðìàöèþ î òîâàðå è ïîêàçûâàåì íà ôîðìå
IF lnTvrID # 0
	This.Parent.GetTvr(lnTvrID,lnPrice)
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMI</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img1</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f5.gif
Height = 50
Left = 743
Top = 301
Width = 50
ZOrderSet = 13
Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F5}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMJ</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img2</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f6.gif
Height = 50
Left = 743
Top = 375
Width = 50
ZOrderSet = 14
Name = "Img2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F6}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFML</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img3</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f1.gif
Height = 50
Left = 743
Top = 9
Width = 50
ZOrderSet = 15
Name = "Img3"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F1}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMM</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img5</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f3.gif
Height = 50
Left = 743
Top = 155
Width = 50
ZOrderSet = 16
Name = "Img5"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F3}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMN</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img6</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f4.gif
Height = 50
Left = 743
Top = 228
Width = 50
ZOrderSet = 17
Name = "Img6"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F4}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMO</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img7</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f7.gif
Height = 50
Left = 743
Top = 447
Width = 50
ZOrderSet = 18
Name = "Img7"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F7}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMP</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img8</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f8.gif
Height = 50
Left = 743
Top = 520
Width = 50
ZOrderSet = 19
Name = "Img8"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F8}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WM10EFMR</uniqueid>
		<timestamp>930188015</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img4</objname>
		<parent>frmposdyna</parent>
		<properties>Picture = ..\graphic\f2.gif
Height = 50
Left = 743
Top = 82
Width = 50
ZOrderSet = 20
Name = "Img4"
</properties>
		<protected/>
		<methods>PROCEDURE Click
DODEFAULT()
KEYBOARD '{F2}'
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28A119XII</uniqueid>
		<timestamp>930188015</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmposdyna</parent>
		<properties>FontSize = 18
Caption = "F10 - Èòîãî ïî ÷åêó"
Height = 30
Left = 3
Top = 431
Width = 217
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmposdyna</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
Arial, 1, 11, 7, 18, 14, 39, 4, 0
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW12FP5V</uniqueid>
		<timestamp>930832594</timestamp>
		<class>frmposedit</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmproxcard</objname>
		<parent/>
		<properties>DataSession = 1
Height = 468
Width = 660
ShowWindow = 1
DoCreate = .T.
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
ntvrsetid = 0
qntcard = 0
tncheckid = 0
nchecktypeid = 1
Name = "frmproxcard"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: .GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM,lDayQnt ,ltAccesEnd, lOneWay

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF
	SET DATABASE TO BASIS
	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
				*--Ïîêàæåì äàííûå ïî êàðòå
			*.Parent.nCltId = lvCardViewByCardCode.CardOwnerID
			IF this.nCheckTypeID = 1
					DO CASE
						CASE (UPPER(SUBSTR(lvCardViewByCardCode.CardNo,1,1))='Ä' AND !tmpCard.Child) OR (UPPER(SUBSTR(lvCardViewByCardCode.CardNo,1,1))&lt;&gt;'Ä' AND tmpCard.Child)
		   						MESSAGEBOX('Ïîìåíÿéòå òèï êàðòû (Äåòñêàÿ,Âçðîñëàÿ)',0+62,'Íå òîò âèä êàðòû')
		   						NODEFAULT
		   						RETURN .t.
						CASE UPPER(SUBSTR(tmpCard.TvrNm,3,2))='ÄÍ' AND VAL(SUBSTR(tmpCard.TvrNm,1,2))&gt;0
								* êàðòà íà íåñêîëüêî äíåé
								lDayQnt = VAL(SUBSTR(tmpCard.TvrNm,1,2))
								ltAccesEnd =  DATETIME()+lDayQnt *60*60*24
						CASE UPPER(SUBSTR(tmpCard.TvrNm,3,2))='ÏÎ' AND VAL(SUBSTR(tmpCard.TvrNm,1,2))&gt;0
								* êàðòà íà 1 ïîäúåì
								lOneWay = .t.
								lDayQnt = 200
								ltAccesEnd =  DATETIME()+lDayQnt *60*60*24
						OTHERWISE
								* ñòàíäàðòíàÿ êàðòà
								ltAccesEnd =  CTOT(SUBSTR(TTOC(DATETIME()),1,11)+STR(tmpCard.Qnt-1,2,0)+':59:00')
					ENDCASE
					
					USE lvAccessWind IN 0 NODATA
			        CURSORSETPROP([BUFFERING],3,[lvAccessWind])
					INSERT INTO lvAccessWind (CardId,                     CardCode,           AccesStart, AccesEnd,;
											  Child ,        CardOwnerID,OneWay,TvrId,AccMoney);
					                  VALUES (lvCardViewByCardCode.CardId,ALLTRIM(tccardcode),DATETIME(),ltAccesEnd,;
					                  		  tmpCard.Child,lvCardViewByCardCode.CardOwnerID,lOneWay,tmpCard.TvrId,tmpCard.CheckTransPrc )
					TABLEUPDATE(1,.t.,'lvAccessWind')
					USE IN lvAccessWind
					USE IN SELECT('lvCardEdit')
					
					_PARAM = lvCardViewByCardCode.CardId
					USE lvCardEdit IN 0
					CURSORSETPROP([BUFFERING],3,[lvCardEdit])
					IF !(ISNULL(lvCardEdit.CardActivationDate) OR EMPTY(lvCardEdit.CardActivationDate))
					   **** îòíèìàåì 1 çàëîã
					    USE IN SELECT('lvCheckTransView')
					    _PARAM = this.tncheckid
					    USE lvCheckTransView IN 0
					    SELECT lvCheckTransView
					    LOCATE ALL FOR lvCheckTransView.CheckTransTvrID = -3 AND lvCheckTransView.CheckTransQnt &gt;0
					    IF FOUND()
					    USE IN SELECT('lvCheckTransEdit')
					    _PARAM = lvCheckTransView.CheckTransUID
					    USE lvCheckTransEdit IN 0
					    CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
					    SELECT lvCheckTransEdit
					        IF lvCheckTransEdit.CheckTransQnt &gt;1
					      		 REPLACE lvCheckTransEdit.CheckTransQnt WITH lvCheckTransEdit.CheckTransQnt-1 NEXT 1 IN lvCheckTransEdit
					      		 REPLACE lvCheckTransView.CheckTransQnt WITH lvCheckTransView.CheckTransQnt-1 NEXT 1 IN lvCheckTransView
					      		ELSE
					      		 DELETE NEXT 1  IN lvCheckTransEdit
					      		 DELETE NEXT 1  IN lvCheckTransView
		    	      		ENDIF
		    	      		TABLEUPDATE(1,.T.,[lvCheckTransEdit])
		    	      		USE IN lvCheckTransEdit
		    	      		*WAIT WINDOW 'Îäíè çàëîã îòíÿò' TIMEOUT 1
					    ENDIF
					ENDIF
					**** ñòàâèì , ÷òî êàðòà âûäàíà íà ðóêè ãîñòþ
						SELECT lvCardEdit
						REPLACE lvCardEdit.CardActivationDate WITH DATETIME()
						TABLEUPDATE(1,.t.,'lvCardEdit')
				ELSE
					*** ïîìå÷àåì, ÷òî êàðòà ñäàíà íàçàä
					USE IN SELECT('lvCardEdit')
					_PARAM = lvCardViewByCardCode.CardId
					USE lvCardEdit IN 0
					CURSORSETPROP([BUFFERING],3,[lvCardEdit])
					SELECT lvCardEdit
					IF RECCOUNT('lvCardEdit')=1
							REPLACE lvCardEdit.CardActivationDate WITH NULL
							TABLEUPDATE(1,.t.,'lvCardEdit')
						ELSE
							MESSAGEBOX('Êàðòà íå áûëà çàôèêñèðîâàíà ðàíåå, îòëîæèòå åå â ñòîðîíó',0+48,'Ïðîáëåìà ñ âîçâðàòîì çàëîãà çà ýòó êàðòó')
					ENDIF
			ENDIF
			this.qntcard = this.qntcard-1
		    IF (this.qntcard &lt;= 0 AND RECNO('tmpCard')=RECCOUNT('tmpCard'))
				USE IN TmpCard
				this.olecommprox1._close()
				ThisForm.uRetVal = 1
				ThisForm.Hide()
				RETURN .t.
			ENDIF
			IF (this.qntcard &lt;= 0 AND RECNO('tmpCard')&lt;RECCOUNT('tmpCard'))
			  SELECT tmpCard
			  SKIP 1
			  this.qntcard = tmpCard.TvrQnt
			ENDIF
			thisform.lbl1.Refresh()
		ELSE
			NODEFAULT
			MESSAGEBOX('Êàðòà ïîñòîðîííÿÿ. Îáðàòèòåñü ê Àäìèíèñòðàòîðó',0+48,'Ïîäãîòîâêà áèëåòà',5000)
	ENDIF
ENDWITH
RETURN .t.
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmProxCard.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnScrFrmID,tcTvrSetNM&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS tnCheckID,nCheckTypeID &amp;&amp;,tcTvrSetNM

*04.08.2005 11:46 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
frm::Init()
*----------------------------------------------------------------------------
this.tncheckid  = tnCheckID
this.nchecktypeid = nCheckTypeID
*10.04.2006 09:44 -&gt;Ïîêàæåì â çàãîëîâêå ôîðìû íàçâàíèÿ íàáîðà òîâàðîâ
	This.lblCaption.Caption = 'Ïðîãðàììèðîâàíèå Êàðò íà ïîäüåìíèê'
*------------------------------------------------------------------------------
this.lbl1.Refresh()
*09.04.2006 14:24 -&gt;Ñîõðàíèì èäåíòèôèêàòîð ìíîæåñòâà òîâàðîâ
*------------------------------------------------------------------------------
this.olecommprox1._open()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS tnKeyCode, tnShiftAltCtrl
DO CASE

*!*		CASE tnKeyCode = 13
*!*			NODEFAULT
*!*			ThisForm.uRetVal = lvTvrInSetView.Price
*!*			pTvrNm = lvTvrInSetView.TvrNm
*!*			ThisForm.Hide()
*!*			MESSAGEBOX('Ïîäíåñèòå áèëåò ê ñ÷èòûâàòåëþ',0+64,'Ïîäãîòîâêà áèëåòà',3000)
	CASE tnKeyCode = 27
		RETURN
		NODEFAULT
		ThisForm.uRetVal = 0
		USE IN tmpCard
		ThisForm.Hide()
	OTHERWISE
	
		*10.04.2006 09:27 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	**	FrmPosEdit::keyPress(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDCASE
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: frmTvrSetEditSet.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------
USE tmpCard IN 0
SELECT tmpCard
this.qntcard = tmpCard.TvrQnt


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3>ntvrsetid &lt;public/runtime&gt; Èäåíòèôèêàòîð íàáîðà òîâàðîâ
qntcard Êîëè÷åñòâî îñòàâøèõñÿ êàðò
tncheckid íîìåð ÷åêà, ñ êîòîðûì ðàáîòàåì
nchecktypeid òèï ÷åêà 1 - ïðîäàæà, 2 - âîçâðàò
*getcardinfo Ïîëó÷àåì èíôîðìàöèþ ïî ñ÷èòêå êàðòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ïðîãðàììèðîâàíèå ïðîêñèìèòè êàðò</reserved7>
		<reserved8>..\include\comselctl_v1_oleseltreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00VGWHD</uniqueid>
		<timestamp>930832594</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdTvrInSet</objname>
		<parent>frmproxcard</parent>
		<properties>ColumnCount = 2
FontSize = 18
HeaderHeight = 1
Height = 332
Left = 0
Panel = 1
ReadOnly = .T.
RecordSource = "tmpCard"
RowHeight = 31
ScrollBars = 2
Top = 24
Width = 658
HighlightStyle = 2
Name = "grdTvrInSet"
Column1.FontSize = 18
Column1.ColumnOrder = 1
Column1.ControlSource = "tmpCard.TvrNM"
Column1.Width = 439
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.FontSize = 18
Column2.ColumnOrder = 2
Column2.ControlSource = "tmpCard.TvrQnt"
Column2.Width = 82
Column2.ReadOnly = .T.
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _rsrequery
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Tovar_v1.vcx
* Class.Module....: grdTvrInSet._RSRequery
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñïèñêà âûáðàííûõ òîâàðîâ
*------------------------------------------------------------------------------
WITH This

*09.04.2006 14:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = ThisForm.nTvrSetID
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
REQUERY([lvTvrInSetView])

SELECT lvTvrInSetView
REPLACE Num_cnt WITH STR(RECNO(),2,0) ALL
GO top
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

*22.07.2005 14:31 -&gt;Âîññòàíîâèì ïîçèöèþ â Grid-å
.column1.header1.DblClick()
.PositionRecall()
.column1.txtgrd1.SetFocus()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************



ENDPROC
PROCEDURE handlekey
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

WITH This

DO CASE

	CASE tnKeyCode = 5 AND tnShiftAltCtrl = 0	&amp;&amp;UPArrow
		
		KEYBOARD '{BACKSPACE}'
		KEYBOARD '{BACKSPACE}'
		KEYBOARD '{BACKSPACE}'
		
		*22.04.2004 11:44 -&gt;Âûïîëíÿåì êîìàíäó ïåðåõîäà ê ïðåäûäóùåé çàïèñè
		.HandleMsg([PREV])

	OTHERWISE
		
		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------
		

ENDCASE



ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0IJGUB</uniqueid>
		<timestamp>930501745</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmproxcard.grdTvrInSet.Column1</parent>
		<properties>FontSize = 18
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0ZH6GD</uniqueid>
		<timestamp>927835855</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmproxcard.grdTvrInSet.Column1</parent>
		<properties>FontSize = 18
ControlSource = "tmpCard.TvrNM"
Left = 13
ReadOnly = .T.
Top = 10
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L00W6F42</uniqueid>
		<timestamp>927835855</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmproxcard.grdTvrInSet.Column2</parent>
		<properties>FontSize = 18
Alignment = 2
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SL0ZJKZZ</uniqueid>
		<timestamp>927835855</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmproxcard.grdTvrInSet.Column2</parent>
		<properties>FontSize = 18
ControlSource = "tmpCard.TvrQnt"
Height = 23
Left = 105
Top = 10
Width = 100
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90Z9BHL</uniqueid>
		<timestamp>930832594</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCaption</objname>
		<parent>frmproxcard</parent>
		<properties>AutoSize = .F.
FontSize = 16
Alignment = 2
Height = 25
Left = 0
Top = 0
Width = 659
ForeColor = 255,255,255
BackColor = 128,128,128
Name = "lblCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CL6G</uniqueid>
		<timestamp>930832594</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgCaption</objname>
		<parent>frmproxcard</parent>
		<properties>Picture = ..\graphic\food.bmp
Stretch = 2
BorderStyle = 1
Height = 25
Width = 25
Name = "ImgCaption"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B13X7NS</uniqueid>
		<timestamp>930832594</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>frmproxcard</parent>
		<properties>Top = 437
Left = 467
Height = 24
Width = 108
Enabled = .F.
Visible = .F.
Name = "Cmd1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.Hide()
thisform.Release()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B13X7NU</uniqueid>
		<timestamp>930832594</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmproxcard</parent>
		<properties>Top = 367
Left = 59
Height = 48
Width = 58
Enabled = .T.
ZOrderSet = 7
lautosave = .F.
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***
LOCAL lcMsg
lcMsg = THIS._Read()
IF EMPTY(lcMsg)
	RETURN
ENDIF
WITH this.Parent
	IF .getcardinfo(lcMsg)
*!*			WAIT WINDOW 'Ïðîãðàììèðóåòñÿ áèëåò:'+lcMsg+ ' ...' TIMEOUT 0.5
*!*			MESSAGEBOX('Áèëåò çàïðîãàìèðîâàí',0+64,'Ïîäãîòîâêà áèëåòà',800)
*!*			WAIT CLEAR
	ENDIF
ENDWITH
**KEYBOARD '{ENTER}'

ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBJiwvEMMgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_27B180QUU</uniqueid>
		<timestamp>930832594</timestamp>
		<class>label</class>
		<classloc/>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmproxcard</parent>
		<properties>FontBold = .T.
FontSize = 16
WordWrap = .T.
Alignment = 2
Caption = "Lbl1"
Height = 96
Left = 167
Top = 367
Width = 289
Name = "Lbl1"
</properties>
		<protected/>
		<methods>PROCEDURE Refresh
thisform.lbl1.Caption = 'Ïîäíåñòè ê ïðîãðàììàòîðó '+ ;
IIF(tmpCard.Child,'ÄÅÒÑÊ. ','ÂÇÐÎÑË. ')+;
ALLTRIM(STR(thisform.qntcard,10,0))+ ' êàðòû(ó)'
IF   thisform.nCheckTypeID = 2
	thisform.lbl1.Caption = 'Ïîäíåñòè ê ïðîãðàììàòîðó '+ ;
ALLTRIM(STR(thisform.qntcard,10,0))+ ' êàðòû(ó) äëÿ âîçâðàòà'
ENDIF

DODEFAULT()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmproxcard</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X20TUDK9</uniqueid>
		<timestamp>931025239</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmkkmstatus</objname>
		<parent/>
		<properties>Height = 75
Width = 350
ShowWindow = 1
DoCreate = .T.
AutoCenter = .T.
BorderStyle = 2
Caption = "Îøèáêà ÊÊÌ"
Closable = .F.
MaxButton = .F.
MinButton = .F.
okkm = 
uretval = 0
Name = "frmkkmstatus"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Destroy
This.OKKM.SetAllowErrorMsgFlag(.T.)
ENDPROC
PROCEDURE Init
LPARAMETERS toKKM

*11.10.2006 13:56 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.10.2006 15:24 -&gt;Ñîõðàíèì ïàðàìåòðû
This.oKKM = toKKM
*------------------------------------------------------------------------------

This.oKKM.SetAllowErrorMsgFlag(.F.)

This.StatusRefresh()

*16.10.2006 15:24 -&gt;Ðàçðåøèì îïðîñ ñîñòîÿíèÿ
This.Timer.Enabled = .T.
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

*18.10.2006 11:02 -&gt;Âûõîä
IF nKeyCode = 48 &amp;&amp; 0

	ThisForm.uRetVal = .F.
	ThisForm.Hide()

ENDIF
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE statusrefresh
WITH This
SET STEP ON
*11.10.2006 17:04 -&gt;Ïîëó÷èì ïîäðåæèì ÊÊÌ
lnECRAdvancedMode = .oKKM.GetECRAdvancedMode(.T.)
*------------------------------------------------------------------------------

*11.10.2006 17:10 -&gt;Àíàëèçèðóåì ïîäðåæèì
DO CASE
	CASE BETWEEN(.oKKM.ErrorCode,-6,-1)
		.lblMode.Caption = [Ïðîâåðêà ñâÿçè ñ ÊÊÌ...]
		.oKKM.Beep()
		RETURN .F.
	CASE INLIST(lnECRAdvancedMode,1,2)
		.lblMode.Caption = [Âñòàâüòå ðóëîí áóìàãè â ÊÊÌ...]
		RETURN .F.
	CASE lnECRAdvancedMode = 3
		.lblMode.Caption = [Ïðîäîëæåíèå ïå÷àòè...]
		.oKKM.ContinuePrint()
		RETURN .F.
	CASE INLIST(lnECRAdvancedMode,4,5)
		RETURN .F.
	OTHERWISE
		***
		.lblMode.Caption = [Ñáðîñ ÷åêà...]
		***
		RETURN .T.
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>okkm ññûëêà íà îáúåêò ÔÐ
uretval
*statusrefresh Îáíîâëåíèå äàííûõ î ñòàòóñå ÊÊÌ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X90O4XCN</uniqueid>
		<timestamp>931025239</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmkkmstatus</parent>
		<properties>Top = 36
Left = 75
Height = 36
Width = 200
SpecialEffect = 0
ZOrderSet = 0
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X20TX0O5</uniqueid>
		<timestamp>931025239</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>Timer</objname>
		<parent>frmkkmstatus</parent>
		<properties>Top = 36
Left = 0
Height = 23
Width = 23
Enabled = .F.
Interval = 1000
Name = "Timer"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
IF This.Parent.StatusRefresh()

	This.Enabled = .F.

	This.Parent.uRetVal = .T.
	This.Parent.Hide()

ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>931025239</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblMode</objname>
		<parent>frmkkmstatus</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontSize = 12
Caption = "Ðåæèì:"
Height = 22
Left = 10
Top = 7
Width = 330
ZOrderSet = 4
Name = "lblMode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X90NPXVA</uniqueid>
		<timestamp>931025239</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblExit</objname>
		<parent>frmkkmstatus</parent>
		<properties>AutoSize = .F.
FontBold = .T.
WordWrap = .T.
Alignment = 2
Caption = "Íàæìèòå '0' äëÿ âûõîäà èç ïðîãðàììû"
Height = 32
Left = 77
Top = 38
Width = 195
ZOrderSet = 5
Name = "lblExit"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmkkmstatus</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RT00AU5R</uniqueid>
		<timestamp>931025540</timestamp>
		<class>frmposview</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmpos__</objname>
		<parent/>
		<properties>DefHeight = 
Height = (600-SYSMETRIC(9))
Width = 800
ShowWindow = 2
DoCreate = .T.
AutoCenter = .T.
BorderStyle = 2
Caption = "POS òåðìèíàë"
ControlBox = .F.
Closable = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
WindowType = 1
ntvrid = 0
lsummarymode = .F.
ncheckid = 0
nsalesid = 0
nchecktypeid = 1
lstornomode = .F.
ncashno = 0
ncashierid = 0
nprctypeid = 0
ldiscisgiven = .F.
nmainset = 0
nspecialset = 0
nselectset = 0
npayset = 0
ntvrqnt = 1
nposmode = 0
ndisctvrid = 0
ldiscmode = .F.
nlastcheckseconds = 0
ncltid = 0
pctvrname = 
checkonline = .T.
checkid = 0
Name = "frmpos"
cstmsghandler.Top = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
</properties>
		<protected>key2msg
</protected>
		<methods>PROCEDURE addtvr
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.ADDTVR
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå òîâàðíîé ïîçèöèè â ÷åê
*------------------------------------------------------------------------------

*16.04.2006 11:35 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcOldAlias, ;
		lnRoundPos, ;
		recMix ,;
		cntFor ,;
		_PARAM ,;
		nTvrQnt
***
lcOldAlias = ALIAS()
*------------------------------------------------------------------------------

WITH This

*11.04.2006 13:02 -&gt;Ïðîâåðÿåì äîñòóïíîñòü äîáàâëåíèÿ
IF .nTvrID = 0 OR .lStornoMode OR .lSummaryMode OR .lDiscIsGiven OR .lDiscMode
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------
.nTvrQnt = .cntsale.txtTvrQnt.Value
*11.04.2006 13:04 -&gt;Äîáàâëÿåì ïîçèöèþ â ÷åê

_PARAM = This.nTvrID

USE lvTvrMix IN 0
recMix = RECCOUNT('lvTvrMix')+1
IF RECCOUNT('lvTvrMix')=0
	USE IN lvTvrMix
ENDIF
nTvrQnt = .nTvrQnt
FOR cntFor = 1 TO recMix

	IF cntFor &gt;1
		SELECT lvTvrMix
		GO cntFor-1
		.nTvrID = lvTvrMix.TvrIdMix
		.cntSale.txtTvrPrice.Value = lvTvrMix.Price
		.nTvrQnt = lvTvrMix.TvrQnt * nTvrQnt
		.cntSale.txtTvrNM.Value = lvTvrMix.TvrNm
	ENDIF
		APPEND BLANK IN lvCheckTransView
			REPLACE ;
				lvCheckTransView.CheckTransType		WITH [ÏÐÎÄÀÆÀ], ;
				lvCheckTransView.CheckTransTypeSign WITH 1, ;
				lvCheckTransView.CheckTransTvrID	WITH .nTvrID, ;
				lvCheckTransView.TvrNM				WITH .cntSale.txtTvrNM.Value, ;
				lvCheckTransView.CheckTransQnt		WITH .nTvrQnt, ;
				lvCheckTransView.CheckTransPrc		WITH .cntSale.txtTvrPrice.Value ;
			IN lvCheckTransView
			***
			TABLEUPDATE(0,.T.,[lvCheckTransView])
			*------------------------------------------------------------------------------
			this.pctvrname=[]
			*11.04.2006 13:10 -&gt;Îáíîâèì ñóììó ÷åêà
			.CalcCheckSum()
			*------------------------------------------------------------------------------

		IF cntFor &gt;1
			*03.11.2006 09:45 -&gt;Ïîêàæåì ïîçèöèþ íà äèñïëåå ïîêóïàòåëÿ
			lnRoundPos = IIF(lvCheckTransView.CheckTransQnt = ROUND(lvCheckTransView.CheckTransQnt,0),0,3)
			***
			.LineDisplay.ClearText()
			.LineDisplay.Write(0,0,lvCheckTransView.TvrNM)
			.LineDisplay.Write(1,0,ALLTRIM(STR(lvCheckTransView.CheckTransQnt,10,lnRoundPos)) + [*] + ;
								   ALLTRIM(STR(lvCheckTransView.CheckTransPrc,10,2)) + [=] + ;
								   ALLTRIM(STR(ROUND(MTON(lvCheckTransView.CheckTransPrc)*lvCheckTransView.CheckTransQnt,2),12,2)), ;
								   1)
			*------------------------------------------------------------------------------
		ENDIF
*12.04.2006 14:13 -&gt;Ñîõðàíÿåì òðàíçàêöèþ â ÁÄ
.StoreCheckTrans()
ENDFOR

USE IN SELECT('lvTvrMix')

*11.04.2006 12:26 -&gt;Ñáðîñèì êîëè÷åñòâî
.nTvrQnt = 1.000
.cntSale.txtTvrQnt.Value = CAST(.nTvrQnt AS N(10,3))
.cntSale.txtTvrQnt.Refresh()
*------------------------------------------------------------------------------

*11.04.2006 13:14 -&gt;Îáíîâèòü ñîäåðæèìîå ÷åêà
.grdCheckTransView.Refresh()
*------------------------------------------------------------------------------

*------------------------------------------------------------------------------

*16.04.2006 11:35 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------
*this.cntsummary.olecommprox1._open()
.cntSale.txtTvrQnt.Enabled = .t.
.cntSale.txtTvrQnt.SetFocus()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE calcchecksum
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.CALCCHECKSUM
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðàñ÷åò ñóììû ÷åêà
*------------------------------------------------------------------------------

*11.04.2006 11:37 -&gt;Ðàññ÷èòàåì ñóììó ÷åêà
SELECT ;
	SUM(CheckTransTypeSign*ROUND(CheckTransQnt*MTON(CheckTransPrc),2)) AS CheckSum ;
FROM lvCheckTransView ;
INTO CURSOR curCheckSum
*------------------------------------------------------------------------------

*11.04.2006 11:39 -&gt;Ïîêàæåì ñóììó ÷åêà
This.txtCheckSum.Value = curCheckSum.CheckSum
This.txtCheckSum.Refresh()
*------------------------------------------------------------------------------

*11.04.2006 11:39 -&gt;Çàêðîåì êóðñîð
USE IN SELECT([curCheckSum])
*******************************************************************************
******************************** END PROCEDURE ********************************
*******************************************************************************
ENDPROC
PROCEDURE cashincome
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.DiscSelect
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âíåñåíèå â êàññó
*------------------------------------------------------------------------------

*18.10.2006 12:29 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSumm
*------------------------------------------------------------------------------

WITH This

*18.10.2006 12:29 -&gt;Âíåñåíèå â êàññó òîëüêî ïðè çàêðûòîì ÷åêå
IF .nCheckID &lt;&gt; 0
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*18.10.2006 12:30 -&gt;Ïîëó÷èì ñóììó âíåñåíèÿ
lnSumm = oMgrPOS.Do([POS],[CASHSUM],1,.cntSale.Top - 2,.cntSale.Width)
*------------------------------------------------------------------------------

*18.10.2006 14:00 -&gt;Ïðîâåðèì ñóììó
IF lnSumm &lt;= 0 THEN
	RETURN
ENDIF
*------------------------------------------------------------------------------

*18.10.2006 12:31 -&gt;Ðåãèñòðèðóåì âíåñåíèå
.Shtrih.CashIncome(lnSumm)
*------------------------------------------------------------------------------

*16.04.2006 10:26 -&gt;
IF .Shtrih.ErrorCode # 0
	
	*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ âíåñåíèè äåíåã â êàññó.])
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*************************************************************************ÓÙÓÙÜ
ENDPROC
PROCEDURE cashoutcome
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.DiscSelect
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âûïëàòà èç êàññû
*------------------------------------------------------------------------------

*18.10.2006 12:29 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSumm
*------------------------------------------------------------------------------

WITH This

*18.10.2006 12:35 -&gt;Âûïëàòà èç êàññû òîëüêî ïðè çàêðûòîì ÷åêå
IF .nCheckID &lt;&gt; 0
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*18.10.2006 12:35 -&gt;Ïîëó÷èì ñóììó âûïëàòà
lnSumm = oMgrPOS.Do([POS],[CASHSUM],2,.cntSale.Top - 2,.cntSale.Width)
*------------------------------------------------------------------------------

*18.10.2006 14:00 -&gt;Ïðîâåðèì ñóììó
IF lnSumm &lt;= 0 THEN
	RETURN
ENDIF
*------------------------------------------------------------------------------

*18.10.2006 12:35 -&gt;Ðåãèñòðèðóåì âíåñåíèå
.Shtrih.CashOutcome(lnSumm)
*------------------------------------------------------------------------------

*18.10.2006 12:35 -&gt;
IF .Shtrih.ErrorCode # 0
	
	*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ âûïëàòà äåíåã èç êàññû.])
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*************************************************************************ÓÙÓÙÜ
ENDPROC
PROCEDURE changeuser
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPOS.ChangeUser
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñìåíà ïîëüçîâàòåëÿ/áëîêèðîâêà
*------------------------------------------------------------------------------

*14.04.2006 10:28 -&gt;Çàâåðøàåì ðàáîòó
IF This.nCheckID = 0
	oApp.lUserChange = .T.
	CLEAR EVENTS
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE checkfinalization
*------------------------------------------------------------------------------
* Project.........: POS.pjx
* Library.........: POS_v1.vcx
* Class.Module....: FRMPOS.CHECKFINALIZATION
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðåõîä ê ñëåäóþùåìó ÷åêó
*------------------------------------------------------------------------------

WITH This

*12.04.2006 11:26 -&gt;Îáíîâèì Grid ñ ñîäåðæèìûì ÷åêà
.nCheckID = 0
.grdCheckTransView._rsRequery(.nCheckID)
*------------------------------------------------------------------------------

*12.04.2006 13:12 -&gt;Ñáðîñèì ñóììó ïî ÷åêó
.txtCheckSum.Value = 0.00
*------------------------------------------------------------------------------

*12.04.2006 10:59 -&gt;Ðàçðåøèì ðàáîòó ñ êîíòåéíåðîèì ïðîäàæ
.cntSale.Enabled = .T.
.cntSale.Visible = .T.
.cntSale.txtPLU.Enabled = .T.
*------------------------------------------------------------------------------

*12.04.2006 11:04 -&gt;Çàïðåòèì ðàáîòó ñ êîíòåéíåðîì èòîãà
.cntSummary.txtReceived.Value = 0.00
.cntSummary.txtDelivery.Value = 0.00
.cntSummary.txtReceived.Enabled = .F.
.cntSummary.Enabled = .F.
.cntSummary.Visible = .F.
*------------------------------------------------------------------------------

*12.04.2006 11:10 -&gt;Ïîêàæåì, ÷òî âûøëè èç ðåæèìà èòîãà ïî ÷åêó
.lSummaryMode = .F.
*------------------------------------------------------------------------------

*12.04.2006 12:42 -&gt;Îáíîâèì ñòàòóñ ÷åêà
.nCheckTypeID = 1
.SetCheckStatus()
*------------------------------------------------------------------------------

*03.11.2006 12:21 -&gt;Áëàãîäàðèì ïîêóïàòåëÿ
.LineDisplay.ClearText()
.LineDisplay.Write(0,0,[Ñïàñèáî],2)
.LineDisplay.Write(1,0,[çà ïîêóïêó!],2)
*------------------------------------------------------------------------------

.nLastCheckSeconds = SECONDS()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checkreset
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.CHECKRESET
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñáðîñ ÷åêà
*------------------------------------------------------------------------------
WITH This

*16.04.2006 10:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnCheckID
***
lnCheckID = .nCheckID
*------------------------------------------------------------------------------

IF RECCOUNT([lvCheckTransView])#0

	*12.04.2006 18:34 -&gt;Ñáðîñèì ÷åê íà ÔÐ
				*!*		.Shtrih.CancelCheck()
				*!*		*------------------------------------------------------------------------------

				*!*		*16.04.2006 10:26 -&gt;
				*!*		IF .Shtrih.ErrorCode # 0
				*!*		
				*!*			*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
				*!*			.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ñáðîñå ÷åêà. ] + ;
				*!*					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				*!*					  [×åê   # ] + ALLTRIM(STR(lnCheckID)), .T.)
				*!*			*------------------------------------------------------------------------------
				*!*			
				*!*		ENDIF
	*------------------------------------------------------------------------------
		IF lvCheckTransView.CheckTransTvrID &lt;&gt; -4
			IF !MESSAGEBOX('Îòìåíèòü ýòîò ÷åê?',4+48,'Îòìåíà ÷åêà')=6
				RETURN
			ENDIF
		ELSE
			IF .nCheckTypeID = 2
			RETURN
			ENDIF
		ENDIF

	*24.01.2007 13:03 -&gt;Ïðè ðàáîòå áåç ÔÐ ñäåëàåì ñîîòâåòñòâóþùóþ îòìåòêó
				*!*		IF NOT .Shtrih.GetProp([lEnabled])

				*!*			.KKMErrorHandler([×åê ñôîðìèðîâàí áåç ÔÐ.] + ;
				*!*					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				*!*					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13))
	
		spSetCheckAttribute(.nCheckID,cnNoFisc)

				*!*		ENDIF
	*------------------------------------------------------------------------------

	*10.10.2006 16:27 -&gt;Ïîìå÷àåì, ÷òî ÷åê íîðìàëüíî çàâåðøåí
	spResetCheckAttribute(.nCheckID,cnNotCompleted)
	*------------------------------------------------------------------------------

	*12.04.2006 15:32 -&gt;Ñáðîñèì ÷åê
	spCheckReset(.nCheckID)	
	*------------------------------------------------------------------------------

	*12.04.2006 11:26 -&gt;Îáíîâèì Grid ñ ñîäåðæèìûì ÷åêà
	.nCheckID = 0
	.grdCheckTransView._rsRequery(.nCheckID)
	*------------------------------------------------------------------------------
	
	*12.04.2006 13:12 -&gt;Ñáðîñèì ñóììó ïî ÷åêó
	.txtCheckSum.Value = NTOM(0)
	*------------------------------------------------------------------------------
	
	*12.04.2006 10:59 -&gt;Ðàçðåøèì ðàáîòó ñ êîíòåéíåðîèì ïðîäàæ
	.cntSale.txtTvrNM.Value	 = []
	.cntSale.txtTvrQnt.Value = 1.000
	.cntSale.txtTvrPrice.Value = 0.00
	.cntSale.Enabled	 = .T.
	.cntSale.Visible	 = .T.
	.cntSale.txtPLU.Enabled	 = .T.
	.nTvrQnt = 1.000
	*------------------------------------------------------------------------------

	*12.04.2006 11:04 -&gt;Çàïðåòèì ðàáîòó ñ êîíòåéíåðîì èòîãà
	.cntSummary.txtReceived.Value = 0.00
	.cntSummary.txtReceived.Enabled = .F.
	.cntSummary.Enabled = .F.
	.cntSummary.Visible = .F.
	*------------------------------------------------------------------------------

	*12.04.2006 11:10 -&gt;Ïîêàæåì, ÷òî âûøëè èç ðåæèìà èòîãà ïî ÷åêó
	.lSummaryMode = .F.
	*------------------------------------------------------------------------------

	*12.04.2006 12:42 -&gt;Îáíîâèì ñòàòóñ ÷åêà
	.nCheckTypeID = 1
	.SetCheckStatus()
	*------------------------------------------------------------------------------
	
	.lDiscIsGiven = .F.
	This.aPaySum = 0

ENDIF

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE checkretucheck
*------------------------------------------------------------------------------
* Project.........: POS.pjx
* Library.........: POS_v1.vcx
* Class.Module....: FRMPOS.CHECKRetuCheck
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðåõîä ê ñëåäóþùåìó ÷åêó
*------------------------------------------------------------------------------

WITH This

*12.04.2006 11:26 -&gt;Îáíîâèì Grid ñ ñîäåðæèìûì ÷åêà
*!*	.nCheckID = 0
*!*	.grdCheckTransView._rsRequery(.nCheckID)
*------------------------------------------------------------------------------

*12.04.2006 13:12 -&gt;Ñáðîñèì ñóììó ïî ÷åêó
*!*	.txtCheckSum.Value = 0.00
*!*	*------------------------------------------------------------------------------

*12.04.2006 10:59 -&gt;Ðàçðåøèì ðàáîòó ñ êîíòåéíåðîèì ïðîäàæ
.cntSale.Enabled = .T.
.cntSale.Visible = .T.
.cntSale.txtPLU.Enabled = .T.
*------------------------------------------------------------------------------

*12.04.2006 11:04 -&gt;Çàïðåòèì ðàáîòó ñ êîíòåéíåðîì èòîãà
.cntSummary.txtReceived.Value = 0.00
.cntSummary.txtDelivery.Value = 0.00
.cntSummary.txtReceived.Enabled = .F.
.cntSummary.Enabled = .F.
.cntSummary.Visible = .F.
*------------------------------------------------------------------------------

*12.04.2006 11:10 -&gt;Ïîêàæåì, ÷òî âûøëè èç ðåæèìà èòîãà ïî ÷åêó
.lSummaryMode = .F.
*------------------------------------------------------------------------------

*12.04.2006 12:42 -&gt;Îáíîâèì ñòàòóñ ÷åêà
*!*	.nCheckTypeID = 1
*!*	.SetCheckStatus()
*------------------------------------------------------------------------------

*03.11.2006 12:21 -&gt;Áëàãîäàðèì ïîêóïàòåëÿ
*!*	.LineDisplay.ClearText()
*!*	.LineDisplay.Write(0,0,[Ñïàñèáî],2)
*!*	.LineDisplay.Write(1,0,[çà ïîêóïêó!],2)
*!*	*------------------------------------------------------------------------------

.nLastCheckSeconds = SECONDS()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checkreturnmode
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CheckReturnMode
* Called by.......: &lt;Thsi.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðåõîä â ðåæèì ôîðìèðîâàíèÿ ÷åêà âîçâðàòà
*------------------------------------------------------------------------------

WITH This

*12.04.2006 12:40 -&gt;Óñòàíîâèì òèï ÷åêà
.nCheckTypeID = 2
*------------------------------------------------------------------------------

*12.04.2006 12:41 -&gt;Îáíîâèì ñòàòóñ ÷åêà
.SetCheckStatus()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checksalemode
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CheckSaleMode
* Called by.......: &lt;Thsi.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðåõîä â ðåæèì ôîðìèðîâàíèÿ ÷åêà ïðîäàæè
*------------------------------------------------------------------------------

WITH This

*12.04.2006 12:40 -&gt;Óñòàíîâèì òèï ÷åêà
.nCheckTypeID = 1
*------------------------------------------------------------------------------

*12.04.2006 12:41 -&gt;Îáíîâèì ñòàòóñ ÷åêà
.SetCheckStatus()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checksummary
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CheckSummary
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èòîã ïî ÷åêó
*------------------------------------------------------------------------------
*24.01.2007 17:10 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnCheckNo
*------------------------------------------------------------------------------

WITH This

IF .txtCheckSum.Value &lt;= .cntSummary.txtReceived.Value

	*12.04.2006 11:14 -&gt;Ïîêàæåì ñóììó ñäà÷è
	.cntSummary.txtDelivery.Value = .cntSummary.txtReceived.Value - .txtCheckSum.Value
	*------------------------------------------------------------------------------

	*12.04.2006 11:16 -&gt;Ïå÷àòàåì èòîã ÷åêà
	.Shtrih.CloseCheck(.cntSummary.txtReceived.Value,.aPaySum[1,2],.aPaySum[1,3],.aPaySum[1,4])
	*------------------------------------------------------------------------------

	*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
	
		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13))
	
		RETURN
		
	ENDIF
	*------------------------------------------------------------------------------

	*24.01.2007 13:03 -&gt;Ïðè ðàáîòå áåç ÔÐ ñäåëàåì ñîîòâåòñòâóþùóþ îòìåòêó
	IF NOT .Shtrih.GetProp([lEnabled])

		.KKMErrorHandler([×åê ñôîðìèðîâàí áåç ÔÐ.] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13))

		spSetCheckAttribute(.nCheckID,cnNoFisc)
	ELSE
	
*!*			WAIT WINDOW 'Æäåì-ñ...' TIMEOUT 5
*!*		
*!*			lnCheckNo = .Shtrih.GetOperationReg(148)
*!*			spStoreCheckNumber(.nCheckID,lnCheckNo)	
	
	ENDIF
	*------------------------------------------------------------------------------

	*10.10.2006 16:27 -&gt;Ïîìå÷àåì, ÷òî ÷åê íîðìàëüíî çàâåðøåí
	spResetCheckAttribute(.nCheckID,cnNotCompleted)
	*------------------------------------------------------------------------------

	*03.11.2006 11:42 -&gt;Ïîêàæåì íà äèñïëåå ïîêóïàòåëÿ ðàñ÷åò
	.LineDisplay.ClearText()
	.LineDisplay.Write(0,0,[ÏÎËÓ×ÅÍÎ:]+STR(.cntSummary.txtReceived.Value,10,2),1)
	.LineDisplay.Write(1,0,[ÑÄÀ×À   :]+STR(.cntSummary.txtDelivery.Value,10,2),1)
	*------------------------------------------------------------------------------

	*16.04.2006 11:52 -&gt;Çàïðåòèì ïîëå ñ ïîëó÷åííîé ñóììîé
	.cntSummary.txtReceived.Enabled = .F.
	.nCheckTypeID = 1
	*------------------------------------------------------------------------------
	
	.lDiscIsGiven = .F.
	This.aPaySum  = 0

ELSE

	*16.04.2006 11:45 -&gt;Ïîêàæåì ïðåäóïðåæäåíèå î íåäîñòàþùåé ñóììå îïëàòû
	MESSAGEBOX([Ñóììà îïëàòû ìåíüøå èòîãà ïî ÷åêó.],16,[Ïðåäóïðåæäåíèå])
	*------------------------------------------------------------------------------
	
ENDIF

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE checksummaryprepare
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CheckSummaryPrepare
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èòîã ïî ÷åêó
*------------------------------------------------------------------------------

WITH This

*15.04.2006 10:21 -&gt;Åñëè ÷åê íå íà÷àò èëè íåò ïîçèöèé â ÷åêå - â ðåæèì èòîãà íå ïåðåõîäèì
IF .nCheckID = 0 OR RECCOUNT(.grdCheckTransView.RecordSource)=0
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*26.09.2006 10:01 -&gt;Ñáðîñèì àòðèáóòû ïîñëåäíåé ïîçèöèè ÷åêà
.ClearPos()
*------------------------------------------------------------------------------

*12.04.2006 10:59 -&gt;Çàïðåòèì ðàáîòó ñ êîíòåéíåðîèì ïðîäàæ
.cntSale.txtPLU.Enabled = .F.
.cntSale.Enabled = .F.
.cntSale.Visible = .F.
*------------------------------------------------------------------------------
LOCAL llAddOrder, ;
	lnFrmTypeID, ;
	lnDefClt, ;
	lnDefEmiClt, ;
	lnTblPar, ;
	lnNewFrmID,;
	lcCardUpId

*** ïðîèçâîäèì îáðàáîòêó Ïðîêñè-êàðò
thisform.progProxCard()

nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
*16.09.2007 18:10 -&gt;Îïëàòà ñ÷åòà êëèåíòà
_PARAM = .nCheckID
USE lvCheckTransView IN 0 ALIAS lvCheckTransView1
SELECT * FROM lvCheckTransView1 INTO TABLE tmp\lvCheckTransViewTmp
USE IN lvCheckTransViewTmp
USE IN lvCheckTransView1
lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],0 ,nPayVarNum,this.nCheckTypeID,this.ncheckid  )
USE IN SELECT('lvCheckTransViewTmp')
ERASE TMP\lvCheckTransViewTmp.dbf
*12.04.2006 11:04 -&gt;Ðàçðåøèì ðàáîòó ñ êîíòåéíåðîì èòîãà
this.ncheckid = 0
IF !thisform.checkonline
	IF lRetVal
	    thisform.checkfinalization()
	   ELSE
	    thisform.CHECKRetuCheck() &amp;&amp;CHecksummaryreset()	
ENDIF
RETURN
ENDIF
.cntSummary.Enabled = .T.
.cntSummary.Visible = .T.
*------------------------------------------------------------------------------

*12.04.2006 11:06 -&gt;Ñóììà îïëàòû ïî óìîë÷àíèþ ðàâíà ñóììå ÷åêà
.cntSummary.txtReceived.Value = .txtCheckSum.Value
.cntSummary.txtReceived.Enabled = (.nCheckTypeID = 1)
.cntSummary.txtReceived.SetFocus()
*------------------------------------------------------------------------------

*12.04.2006 11:10 -&gt;Ïîêàæåì, ÷òî ðàáîòàåì â ðåæèìå èòîãà ïî ÷åêó
.lSummaryMode = .T.
*------------------------------------------------------------------------------

*03.11.2006 12:16 -&gt;Ïîêàæåì íà äèñïëåå èòîãî ïî ÷åêó
.LineDisplay.ClearText()
.LineDisplay.Write(0,0,[ÈÒÎÃÎ   :]+STR(.txtCheckSum.Value,10,2),1)
*------------------------------------------------------------------------------
ENDWITH
RETURN
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************










llAddOrder = .f.

IF llAddOrder
	*** Äîáàâëÿåì çàêàç (øàïêó)
	
	*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
	lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))
	
	*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
	lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))
	lnDefClt = 1551
	*--ïîëó÷èì êîä êëèåíòà - îïåðàòîðà
	lnDefEmiClt = spUserClt()
	
	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))
	lnTblPar = 71
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	SELECT lvFrmEdit
	APPEND BLANK
	*------------------------------------------------------------------------------
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnDefEmiClt, ;
		 lvFrmEdit.DevCltId WITH lnDefEmiClt, ;
		 lvFrmEdit.PointEmiOUID WITH lnTblPar, ;
		 lvFrmEdit.FrmTypeID WITH 22, ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
		
	IF TABLEUPDATE(1,.T.,[lvFrmEdit])
	lnNewFrmID = spGetLastIncrementedID([lvFrmEdit])

					*** Äîáàâëÿåì ïîçèöèè
					USE IN SELECT([lvOrderTvrEdit])
					USE lvOrderTvrEdit IN 0 NODATA
					CURSORSETPROP([BUFFERING],5,[lvOrderTvrEdit])

					INSERT INTO lvOrderTvrEdit (FrmID, TvrId, MsuId, TvrQnt, TvrPrcSale) ;
					SELECT lnNewFrmID AS FrmID, CheckTransTvrID AS TvrId, 1 AS MsuId, ;
					        CheckTransQnt AS TvrQnt, CheckTransPrc AS TvrPrcSale ;
					FROM lvCheckTransView

					IF !TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
					    MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ ïîçèöèé çàêàçà ïðîèçîøëà îøèáêà',0+16,'Ïðåäóïðåæäåíèå')
					    *RETURN .f.
					ENDIF
ELSE
	    MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ çàãîëîâêà çàêàçà ïðîèçîøëà îøèáêà',0+16,'Ïðåäóïðåæäåíèå')
	    *RETURN .f.
	ENDIF
			*!*			IF TYPE('lnNewFrmID')='N' AND lnNewFrmID&gt;0
			*!*				nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
			*!*				*16.09.2007 18:10 -&gt;Îïëàòà ñ÷åòà êëèåíòà
			*!*				lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],lnNewFrmID ,nPayVarNum,1,0 )
			*!*			ENDIF
ENDIF

ENDPROC
PROCEDURE checksummaryreset
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CheckSummaryReset
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âûõîä èç ðåæèìà èòîãà ïî ÷åêó
*------------------------------------------------------------------------------

WITH This

*12.04.2006 11:06 -&gt;Ñóììà îïëàòû ïî óìîë÷àíèþ ðàâíà ñóììå ÷åêà
.cntSummary.txtReceived.Value = 0.00
.cntSummary.txtDelivery.Value = 0.00
.cntSummary.txtReceived.Enabled = .F.
*------------------------------------------------------------------------------

*12.04.2006 11:04 -&gt;Çàïðåòèì ðàáîòó ñ êîíòåéíåðîì èòîãà
.cntSummary.Enabled = .F.
.cntSummary.Visible = .F.
*------------------------------------------------------------------------------

*12.04.2006 10:59 -&gt;Ðàçðåøèì ðàáîòó ñ êîíòåéíåðîèì ïðîäàæ
.cntSale.Enabled = .T.
.cntSale.Visible = .T.
.cntSale.txtPLU.Enabled = .T.
*------------------------------------------------------------------------------

*12.04.2006 11:10 -&gt;Ïîêàæåì, ÷òî ðàáîòàåì â ðåæèìå ïðîäàæ
.lSummaryMode = .F.
*------------------------------------------------------------------------------

*03.11.2006 12:19 -&gt;Óáåðåì èòîãî ñ äèñïëåÿ ïîêóïàòåëÿ èòîãî
.LineDisplay.ClearText()
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE clearpos
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.ClearPos
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Î÷èñòêà íîâîé ïîçèöèè ÷åêà
*------------------------------------------------------------------------------

WITH This

*12.04.2006 18:50 -&gt;Ïðîâåðèì, åñòü ëè âûáðàííûé òîâàð
IF .nTvrID = 0
	RETURN
ENDIF
*------------------------------------------------------------------------------

*12.04.2006 18:51 -&gt;Ñáðîñèì àòðèáóòû òîâàðà
.nTvrID  = 0
.nTvrQnt = 1.000
.cntSale.txtPLU.Value		= []
.cntSale.txtTvrNM.Value		= []
.cntSale.txtTvrQnt.Value	= 1.000
.cntSale.txtTvrPrice.Value  = 0.00
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE closeday
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.CloseDay
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàêðûòèå ñìåíû
*------------------------------------------------------------------------------

*29.04.2006 16:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSalesID, ;
		lnStartSeconds, ;
		lnCurrSeconds
*------------------------------------------------------------------------------

WITH This

*12.04.2006 13:59 -&gt;Ïðîâåðèì íåîáõîäèìîñòü çàêðûòèÿ ñìåíû
IF .nSalesID = 0
	lnSalesID = spGetOpenDay(.nCashNo,.T.)
	IF lnSalesID &gt; 0
		.nSalesID = lnSalesID
	ELSE
		MESSAGEBOX([Ëîêàëüíàÿ ñìåíà çàêðûòà.],64,[Çàêðûòèå ñìåíû])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------

*12.04.2006 14:01 -&gt;Çàêðûâàåì ëîêàëüíûé äåíü
IF spSaleCloseDay(.nSalesID,.nCashNo)

	**.Shtrih.SetAllowErrorMsgFlag(.F.)

	*13.04.2006 16:22 -&gt;Ïå÷àòàåì Z-îò÷åò
	.Shtrih.CloseShift()
	*------------------------------------------------------------------------------

*!*		*13.10.2006 13:36 -&gt;Æäåì îêîí÷àíèÿ ïå÷àòè Z-îò÷åòà
*!*		lnStartSeconds = SECONDS()
*!*		lnCurrSeconds  = SECONDS()

*!*		.Shtrih.PrintString([*])
*!*		
*!*		DO WHILE .Shtrih.ErrorCode = 80
*!*		
*!*			IF lnCurrSeconds # SECONDS()
*!*				lnCurrSeconds = SECONDS()
*!*				WAIT WINDOW [Èäåò ïå÷àòü Z-îò÷åòà ... ]+STR(lnCurrSeconds-lnStartSeconds,6) NOWAIT NOCLEAR
*!*			ENDIF

*!*			.Shtrih.PrintString([*])
*!*			
*!*		ENDDO
*!*		*------------------------------------------------------------------------------

*!*		.Shtrih.SetAllowErrorMsgFlag(.T.)

*!*		*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
*!*		IF .Shtrih.ErrorCode # 0

*!*			.KKMErrorHandler([Îøèáêà ] + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + ;
*!*					  [ ïðè ïå÷àòè Z-îò÷åòà. Ñìåíà #] + ALLTRIM(STR(.nSalesID)) + CHR(13))

*!*		ENDIF
*!*		*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*16.04.2006 10:16 -&gt;Ñáðîñèì íîìåð ñìåíû(ïðîäàæ)
.nSalesID = 0
*------------------------------------------------------------------------------

*29.04.2006 16:52 -&gt;Âûõîäèì
.ChangeUser()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE continueprint
*17.08.2006 16:51 -&gt;Âûäàåì êîìàíäó ïðîäîëæåíèÿ ïå÷àòè
This.Shtrih.ContinuePrint()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE discselect
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.DISCSELECT
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñêèäêà íà ÷åê
*------------------------------------------------------------------------------

*22.04.2006 11:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnDiscCardID, ;
		lcDiscNM, ;
		lnDiscRate, ;
		_PARAM
*------------------------------------------------------------------------------

WITH This

*15.04.2006 10:21 -&gt;Åñëè ÷åê íå íà÷àò èëè íåò ïîçèöèé â ÷åêå - ñêèäêó íå äàåì
IF .nCheckID = 0 OR RECCOUNT(.grdCheckTransView.RecordSource) = 0
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*22.04.2006 11:47 -&gt;Ïîëó÷èì ID äèñêîíòíîé êàðòû
.lDiscMode = .T.
lnDiscCardID = oMgrPOS.Do([POS],[DISC],.cntSale.Top - 2,.cntSale.Width)
.lDiscMode = .F.
*------------------------------------------------------------------------------

*22.04.2006 11:48 -&gt;Ïîëó÷èì òèï ñêèäêè è ðàçìåð ñêèäêè
USE IN SELECT([lvDiscInfoByDiscCardID])
_PARAM = lnDiscCardID
USE lvDiscInfoByDiscCardID IN 0
*------------------------------------------------------------------------------

*22.04.2006 12:13 -&gt;Îïðåäåëÿåì èìÿ ñêèäêè
lcDiscNM = lvDiscInfoByDiscCardID.DiscNM
*------------------------------------------------------------------------------

*22.04.2006 12:00 -&gt;Îïðåäåëÿåì ðàçìåð ñêèäêè
DO CASE
	CASE lvDiscInfoByDiscCardID.DiscTypeID = 1 &amp;&amp; ïðîöåíòíàÿ ñêèäêà
		lnDiscRate = ROUND(.txtCheckSum.Value*lvDiscInfoByDiscCardID.DiscRate/100,2)
	CASE lvDiscInfoByDiscCardID.DiscTypeID = 2 &amp;&amp; ñêèäêà íà ñóììó
		lnDiscRate = lvDiscInfoByDiscCardID.DiscRate
	OTHERWISE
		RETURN
ENDCASE
*------------------------------------------------------------------------------

*22.04.2006 12:04 -&gt;Ïðè íóëåâîé ñêèäêå - âûõîäèì
IF lnDiscRate = 0
	RETURN
ENDIF
*------------------------------------------------------------------------------

*22.04.2006 12:15 -&gt;Óìåíüøàåì ñóììó ÷åêà
IF .txtCheckSum.Value &lt; lnDiscRate
	MESSAGEBOX([Íåëüçÿ ïðèìåíèòü äàííóþ ñêèäêó íà ÷åê.],48,[Âíèìàíèå],10000)
	RETURN 0
ENDIF
*------------------------------------------------------------------------------

*22.04.2006 15:33 -&gt;Ïðèâÿçûâàåì äèñêîííóþ êàðòó ê ÷åêó
spBindDisc(.nCheckID,lnDiscCardID)
*------------------------------------------------------------------------------

*22.04.2006 12:40 -&gt;Äîáàâëÿåì ïîçèöèþ ñêèäêè  â ÷åê
APPEND BLANK IN lvCheckTransView
REPLACE ;
	lvCheckTransView.CheckTransType		WITH [ÑÊÈÄÊÀ], ;
	lvCheckTransView.CheckTransTypeSign WITH -1, ;
	lvCheckTransView.CheckTransTvrID	WITH .nDiscTvrID, ;
	lvCheckTransView.TvrNM				WITH lcDiscNM, ;
	lvCheckTransView.CheckTransQnt		WITH 1, ;
	lvCheckTransView.CheckTransPrc		WITH lnDiscRate ;
IN lvCheckTransView
***
TABLEUPDATE(0,.T.,[lvCheckTransView])
*------------------------------------------------------------------------------

*22.04.2006 13:58 -&gt;Îáíîâèì Grid ñ òðàíçàêöèÿìè
.grdCheckTransView.Refresh()
*------------------------------------------------------------------------------

*22.04.2006 12:42 -&gt;Îáíîâèì ñóììó ÷åêà
.CalcCheckSum()
*------------------------------------------------------------------------------

*22.04.2006 12:36 -&gt;Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
USE IN SELECT([lvCheckTransEdit])
_PARAM = .nCheckID
USE lvCheckTransEdit IN 0
CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
*------------------------------------------------------------------------------

*22.04.2006 12:36 -&gt;Äîáàâëÿåì òðàíçàêöèþ
APPEND BLANK IN lvCheckTransEdit
REPLACE ;
	lvCheckTransEdit.CheckTransUID		WITH RECCOUNT([lvCheckTransView]), ;
	lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
	lvCheckTransEdit.CheckTransTypeID	WITH 7, ;
	lvCheckTransEdit.CheckTransTvrId	WITH .nDiscTvrID, ;
	lvCheckTransEdit.CheckTransQnt		WITH 1, ;
	lvCheckTransEdit.CheckTransPrc		WITH lnDiscRate ;
IN lvCheckTransEdit
***
TABLEUPDATE(0,.T.,[lvCheckTransEdit])
*------------------------------------------------------------------------------

*22.04.2006 12:03 -&gt;Ðåãèñòðèðóåì ñêèäêó íà ÔÐ
.Shtrih.CheckDiscount(lnDiscRate,lcDiscNM)
*------------------------------------------------------------------------------

*22.04.2006 12:04 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
			  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))))
			
	*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
	spSetCheckAttribute(.nCheckID,cnFiscFail)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

.lDiscIsGiven = .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE gettvr
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.GetTvr
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tnTvrID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î òîâàðå
*------------------------------------------------------------------------------
LPARAMETERS tnTvrID, tnPrice
IF PARAMETERS() = 1
	tnPrice = 0
ENDIF
IF tnTvrID = -4  &amp;&amp; îôîðìëÿåì âîçâðàò çàëîãà çà êàðòû
	IF RECCOUNT('lvCheckTransView')&gt;0
		MESSAGEBOX('Â ÷åêå ñ âîçâðàòîì çàëîãà íåäîïóñòèìû äðóãèå ïîçèöèè ...',0+48,'Äîáàâëåíèå âîçâðàòà îòêëîíåíî')
		RETURN
	ENDIF
	this.retuproxcard()
	IF this.cntsale.txtTvrQnt.Value = 0
		THIS.CHeckreset()
		this.cntsale.txtTvrQnt.Value = 1
		RETURN
	ENDIF
	this.checkreturnmode()
ENDIF
*11.04.2006 12:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnTvrPrc, ;
		_PARAM , ;
		_PARAM1, ;
		_PARAM2, ;
		_PARAM_PRCTYPE
***
lnTvrPrc = 0
_PARAM	 = tnTvrID
*------------------------------------------------------------------------------

*11.04.2006 13:00 -&gt;Ñîõðàíèì ID òîâàðà
This.nTvrID = tnTvrID
*------------------------------------------------------------------------------
_PARAM_PRCTYPE = 1
*11.04.2006 12:00 -&gt;Ïîëó÷èì èíôîðìàöèþ î òîâàðå
USE IN SELECT([lvTovarInfo])
USE lvTovarInfo IN 0
*------------------------------------------------------------------------------

*11.04.2006 12:02 -&gt;Ïîëó÷èì èíôîðìàöèþ î öåíå íà òîâàð
USE IN SELECT([lvPriceTvr])
***

*05.05.2006 09:41 -&gt;Ïîëó÷èì öåíó ïî ïðàéñó
_PARAM1 = This.nTvrID
_PARAM2 = This.nPrcTypeID
USE lvPriceTvr IN 0
***

*05.05.2006 09:41 -&gt;Åñëè öåíà íóëåâàÿ - ïîëó÷èì öåíó èç ïðàéñà ïî óìîë÷àíèþ
IF lvPriceTvr.Price = 0
	USE IN SELECT([lvPriceTvrDef])
	***
	
	USE lvPriceTvrDef IN 0
	lnTvrPrc = lvPriceTvrDef.Price	
	
ELSE
	lnTvrPrc = lvPriceTvr.Price
ENDIF
*------------------------------------------------------------------------------

*11.04.2006 12:26 -&gt;Ïîêàæåì íàèìåíîâàíèå òîâàðà,êîëè÷åñòâî,öåíó
This.cntSale.txtTvrNM.Value    = IIF(EMPTY(this.pctvrname),lvTovarInfo.TvrNM,this.pctvrname)
*This.cntSale.txtTvrQnt.Value   = 1.000
This.cntSale.txtTvrPrice.Value = IIF(tnPrice=0,lnTvrPrc,tnPrice)
*------------------------------------------------------------------------------

*16.04.2006 11:33 -&gt;Äîáàâèì òîâàð
.AddTvr()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Init
*29.04.2006 16:28 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSalesID, ;
		_PARAM
*------------------------------------------------------------------------------
this.CheckOnLine = .f.
*11.05.2006 16:36 -&gt;Èíèöèàëèçèðóåì ìàññèâ äëÿ íàêðïëåíèÿ ñóìì îïëàò
This.aPaySum = 0
*------------------------------------------------------------------------------

*13.10.2006 10:19 -&gt;Ïðîâåðèì íàëè÷èå îòñóòñòâèÿ ñâÿçè ñ ÊÊÌ
This.Shtrih.Beep()
IF This.Shtrih.ErrorCode # 0

	*16.04.2006 10:22 -&gt;Çàïèøåì  èíôîðìàöèþ â Log
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ] + PADL(ALLTRIM(STR(This.Shtrih.ErrorCode)),3) + ;
			  [ ïðè çàïóñêå POS ïðîãðàììû] + CHR(13), [KKM.LOG], 1)
	*------------------------------------------------------------------------------
	
	This.ChangeUser()
	
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*11.04.2006 11:41 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*13.04.2006 16:49 -&gt;Ïîëó÷èì íîìåð êàññû
This.nCashNo = VAL(oRes.GetParam([POS],[CASH_NO]))
this.Caption =[Êàññà ¹ ]+ STR(This.nCashNo,5,0)
*------------------------------------------------------------------------------

*24.04.2006 13:39 -&gt;Ïîëó÷èì ID íåîáõîäèìûõ ìíîæåñòâ
This.nMainSet	 = VAL(oRes.GetParam([SET],[MAIN]))
This.nSpecialSet = VAL(oRes.GetParam([SET],[SPECIAL]))
This.nSelectSet  = VAL(oRes.GetParam([SET],[SELECT]))
This.nPaySet	 = VAL(oRes.GetParam([SET],[PAY]))
*------------------------------------------------------------------------------

*17.10.2006 15:41 -&gt;Ïîëó÷èì ID òîâàðà-ñêèäêè
This.nDiscTvrID	 = VAL(oRes.GetParam([POS],[DISCTVRID]))
*------------------------------------------------------------------------------

*11.04.2006 11:42 -&gt;Ñ÷èòàåì ñóììó ÷åêà
This.CalcCheckSum()
*------------------------------------------------------------------------------

*12.04.2006 13:30 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð íå çàêðûòîé ñìåíû
lnSalesID = spGetOpenDay(This.nCashNo)
*------------------------------------------------------------------------------

*12.04.2006 13:34 -&gt;Ïðîâåðèì êîððåêòíîñòü äàííûõ î ïðîäàæàõ
DO CASE
	CASE lnSalesID = -1
		MESSAGEBOX([Äåíü óæå çàêðûò.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
		oApp.lUserChange = .T.
		RETURN .F.
	CASE INLIST(lnSalesID,-2,-3)
		MESSAGEBOX([Îñòàëèñü íå çàêðûòûìè áîëåå îäíîãî äíÿ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
		RETURN .F.
	CASE lnSalesID = -4
		*12.04.2006 13:55 -&gt;Åñëè ñìåíà îòêðûòà áîëåå ñóòîê, òðåáóåì çàêðûòü åå
		IF MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
					  [áîëåå 24 ÷àñîâ.Íåîáõîäèìî çàêðûòü ñìåíó?],32,[Ñìåíà],15000) = 1
			***
		    This.CloseDay()
			***
		ENDIF
		*------------------------------------------------------------------------------
		RETURN .F.
	CASE lnSalesID = -5
		MESSAGEBOX([Íåèçâåcòíàÿ îøèáêà],16,[Îøèáêà])
		RETURN .F.
ENDCASE
*------------------------------------------------------------------------------

*17.10.2006 13:10 -&gt;Îòîáðàçèì ðåæèì
This.SetPosMode(3)
*------------------------------------------------------------------------------

*03.11.2006 12:59 -&gt;Ïîêàæåì äàòó íà äèñïëåå ïîêóïàòåëÿ
This.LineDisplay.ClearText()
This.LineDisplay.Write(0,0,[Ñåãîäíÿ],2)
This.LineDisplay.Write(1,0,DTOC(DATE()),2)
***
This.nLastCheckSeconds = SECONDS()
*------------------------------------------------------------------------------

*!*	ThisForm.lblUserNM.Caption = spUserClt(1)
*!*	ThisForm.lblUserNM.Refresh
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE inputqnt
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_Ì1.vcx
* Class.Module....: frmPos.InputQnt
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ââîä êîëè÷åñòâà òîâàðà
*------------------------------------------------------------------------------

WITH This

*11.04.2006 13:50 -&gt;Ðàçðåøèì ïîëå äëÿ ââîäà êîëè÷åñòâà òîâàðà è ïåðåéäåì òóäà
IF !.lStornoMode AND !.lSummaryMode &amp;&amp;AND .nTvrID = 0
	This.cntSale.txtTvrQnt.Enabled = .T.
	This.cntSale.txtTvrQnt.SetFocus()
ENDIF
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE key2msg
LPARAMETERS tnKeyCode

*26.01.2007 12:58 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcPOSFuncMsg, ;
		lcPOSEnabledMode
*------------------------------------------------------------------------------

*20.10.2006 09:31 -&gt;Èùåì êîä íàæàòîé êëàâèøè
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
lcPOSEnabledMode = ICASE(EMPTY(lvPOSKeyMap.POSEnabledMode),[0],ISNULL(lvPOSKeyMap.POSEnabledMode),[0],ALLTRIM(lvPOSKeyMap.POSEnabledMode))
***

RETURN IIF(lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode),lcPOSFuncMsg,[])
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE keyeventhandler
*------------------------------------------------------------------------------
* Notes...........: Îáðàáîòêà íàæàòèÿ êëàâèø
*------------------------------------------------------------------------------
LPARAMETERS tnKeyCode

*20.10.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   llEventClear, ;
		lcPOSFuncMsg, ;
		lcPOSEnabledMode
***
llEventClear = .T.
*------------------------------------------------------------------------------
WITH This

*22.04.2006 13:38 -&gt;×åê çàêîí÷åí - îæèäàíèå ïåðåõîäà ê íîâîìó ÷åêó
IF .lSummaryMode AND !.cntSummary.txtReceived.Enabled AND tnKeyCode#13
	RETURN
ENDIF
*------------------------------------------------------------------------------

*20.10.2006 09:31 -&gt;Èùåì êîä íàæàòîé êëàâèøè è ïûòàåìñÿ îáðàáîòàòü
SELECT lvPOSKeyMap
LOCATE FOR PosKeyCode = tnKeyCode
lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
lcPOSEnabledMode = ICASE(EMPTY(lvPOSKeyMap.POSEnabledMode),[0],ISNULL(lvPOSKeyMap.POSEnabledMode),[0],ALLTRIM(lvPOSKeyMap.POSEnabledMode))
*------------------------------------------------------------------------------
*22.04.2006 12:32 -&gt;Åñëè ñêèäêà ïðåäîñòàâëåíà, òî ÷åê ìîæíî ëèáî çàâåðøèòü, ëèáî ñáðîñèòü
IF .lDiscIsGiven AND tnKeyCode#13 AND !INLIST(lcPOSFuncMsg,[SUMMARY],[CHKRST])
	RETURN
ENDIF
*------------------------------------------------------------------------------

DO CASE

	CASE tnKeyCode = 13
		NODEFAULT
		
		IF .lSummaryMode
			IF .cntSummary.txtReceived.Enabled OR .nCheckTypeID = 2
				.CheckSummary()
			ELSE
				.CheckFinalization()
			ENDIF
		ELSE
			*.AddTvr()
		ENDIF
		***

	CASE lcPOSFuncMsg == [ERROR]	AND ;	&amp;&amp; F12
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.StornoTvrPrepare()
		***
	CASE lcPOSFuncMsg == [SUMMARY]	AND ;	&amp;&amp; Shift-F3 - èòîã
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.CheckSummaryPrepare()
		***
	CASE lcPOSFuncMsg == [CHKRST]	AND ;	&amp;&amp; Shift-F4 - ñáðîñ ÷åêà
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.CheckReset()
		***
	CASE lcPOSFuncMsg == [CLEAR]	AND ;	&amp;&amp; Shift-F7- î÷èñòèòü
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.ClearPos()
		***
	CASE lcPOSFuncMsg == [QNT]		AND ;	&amp;&amp; Shift-F8 - êîëè÷åñòâî
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.InputQnt()
		***
	CASE lcPOSFuncMsg == [BLOCK]	AND ;	&amp;&amp; Shift-F10
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.ChangeUser()
		***
	CASE lcPOSFuncMsg == [DISC]		AND ;	&amp;&amp; Ctrl-F2 - Ñêèäêè
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.DiscSelect()
		***
	CASE lcPOSFuncMsg == [EXIT]	AND ;	&amp;&amp; âûõîä
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.Shutdown()
		***
	CASE lcPOSFuncMsg == [CHKRET]	AND ;	&amp;&amp; âûõîä
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.CheckReturnMode()
		***
	OTHERWISE
		llEventClear = .F.
ENDCASE
*------------------------------------------------------------------------------

RETURN llEventClear

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE KeyPress
*------------------------------------------------------------------------------
* Project.........: POS.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.KEYPRESS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;nKeyCode, nShiftAltCtrl&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáðàáîòêà íàæàòèÿ êëàâèø
*------------------------------------------------------------------------------
LPARAMETERS tnKeyCode, tnShiftAltCtrl

*25.09.2006 17:34 -&gt;Âûçîâåì îáðàáîò÷èê ñîáûòèé
IF This.KeyEventHandler(tnKeyCode)
		NODEFAULT
ENDIF
*------------------------------------------------------------------------------
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE kkmerrorhandler

LPARAMETERS tcErrorMsg, ;
			tlNoReset

*11.10.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnECRAdvancedMode, ;
		lnCheckID, ;
		loStatus
***
lnCheckID = This.nCheckID
*------------------------------------------------------------------------------

WITH This

*11.10.2006 16:53 -&gt;Ñîõðàíèì ñîîáùåíèå â ëîãå
IF VARTYPE(tcErrorMsg) == [C]
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + tcErrorMsg,[KKM.LOG],1)
ENDIF
*------------------------------------------------------------------------------

*24.01.2007 13:03 -&gt;Ïðè ðàáîòå áåç ÔÐ - âûõîäèì
IF NOT .Shtrih.GetProp([lEnabled])
	RETURN
ENDIF
*------------------------------------------------------------------------------

*16.10.2006 15:38 -&gt;
loStatus = oApp.CreateObject([frmKKMStatus;pos_v1.vcx],.Shtrih)

loStatus.Show(1)

IF loStatus.uRetVal
	IF NOT tlNoReset
		.CheckReset()
	ELSE
		.Shtrih.CancelCheck()
	ENDIF
ELSE
	.Shutdown(.T.)
ENDIF
*------------------------------------------------------------------------------

*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
spSetCheckAttribute(.nCheckID,cnFiscFail)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Load
LOCAL	lnGoodGroupCnt, ;
		lcGoodGroupNM

*10.04.2006 09:52 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS SHARED
ENDIF
***
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*09.04.2006 14:48 -&gt;Çàãðóçèì ìåíþ ïî óìîë÷àíèþ
USE lvPOSFuncInSetView IN 0 NODATA
*------------------------------------------------------------------------------

*11.04.2006 10:20 -&gt;Îòêðîåì LV ñ ñîäåðæèìûì ÷åêîâ
USE lvCheckTransView IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE msghandler
LPARAMETERS tcPOSFuncMsg, ;
			tcPOSEnabledMode

*20.10.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   llEventClear, ;
		lcPOSFuncMsg, ;
		lcPOSEnabledMode
***
llEventClear = .T.
*------------------------------------------------------------------------------

*20.10.2006 15:47 -&gt;
lcPOSFuncMsg	 = ALLTRIM(tcPOSFuncMsg)
lcPOSEnabledMode = ICASE(EMPTY(tcPOSEnabledMode),[0],ISNULL(tcPOSEnabledMode),[0],ALLTRIM(tcPOSEnabledMode))
*------------------------------------------------------------------------------

WITH This

DO CASE

	CASE lcPOSFuncMsg == [ESC]		AND ;	&amp;&amp; F11
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.grdMenuView._rsRequery(.nMainSet)
		***
	CASE lcPOSFuncMsg == [ERROR]	AND ;	&amp;&amp; F12
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.StornoTvrPrepare()
		***
	CASE lcPOSFuncMsg == [SUMMARY]	AND ;	&amp;&amp; Shift-F3 - èòîã
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.CheckSummaryPrepare()
		***
	CASE lcPOSFuncMsg == [CHKRST]	AND ;	&amp;&amp; Shift-F4 - ñáðîñ ÷åêà
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.CheckReset()
		***
	CASE lcPOSFuncMsg == [SELECT]	AND ;	&amp;&amp; Shift-F5 - âûáîð
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSelectSet)
		ENDIF
		***
	CASE lcPOSFuncMsg == [SPEC]		AND ;	&amp;&amp; Shift-F6 - ñïåö. ôóíêöèè
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		IF .nCheckID = 0
			.grdMenuView._rsRequery(.nSpecialSet)
		ENDIF
		***
	CASE lcPOSFuncMsg == [CLEAR]	AND ;	&amp;&amp; Shift-F7- î÷èñòèòü
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.ClearPos()
		***
	CASE lcPOSFuncMsg == [QNT]		AND ;	&amp;&amp; Shift-F8 - êîëè÷åñòâî
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.InputQnt()
		***
	CASE lcPOSFuncMsg == [BLOCK]	AND ;	&amp;&amp; Shift-F10
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.ChangeUser()
		***
	CASE lcPOSFuncMsg == [DISC]		AND ;	&amp;&amp; Ctrl-F2 - Ñêèäêè
		 (lcPOSEnabledMode == [0] OR INLIST(.nPosMode,&amp;lcPOSEnabledMode))
		.DiscSelect()
		***
	OTHERWISE
		llEventClear = .F.
ENDCASE
*------------------------------------------------------------------------------

RETURN llEventClear

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE opendrawer
WITH This

*11.05.2006 18:18 -&gt;Ïå÷àòàåì íóëåâîé ÷åê
This.Shtrih.CheckSaleTran([Îòêðûòèå äåíåæíîãî ÿùèêà],0,0)
This.Shtrih.CloseCheck(0)

*22.04.2006 12:04 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè îòêðûòèè äåíåæíîãî ÿùèêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ])
			
	*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
	spSetCheckAttribute(.nCheckID,cnFiscFail)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE paymentselect
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FrmPos.PaymentSelect
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;tnPaymentTypeID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîïèëíèìòåëüíûå âèäû îïëàòû ÷åêà
*------------------------------------------------------------------------------
LPARAMETERS tnPaymentTypeID

*11.05.2006 11:24 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnPaymentTypeID, ;
		lcPaymentTypeNM, ;
		lcPaymentObjNM, ;
		lnPaymentTypeRate, ;
		lnPaymentID, ;
		_PARAM
*------------------------------------------------------------------------------

WITH This

*11.05.2006 11:27 -&gt;Ïîëó÷èì ID òèïà îïëàòû
lnPaymentTypeID = tnPaymentTypeID
*------------------------------------------------------------------------------

*11.05.2006 13:47 -&gt;Ïîëó÷èì äàííûå î òèïå îïëàòû
USE IN SELECT([lvPaymentTypeInfo])
***
_PARAM = lnPaymentTypeID
USE lvPaymentTypeInfo IN 0
*------------------------------------------------------------------------------

*11.05.2006 11:33 -&gt;Ïîëó÷èì èìÿ òèïà îïëàòû
lcPaymentTypeNM = ALLTRIM(lvPaymentTypeInfo.NM)
*------------------------------------------------------------------------------

*11.05.2006 11:35 -&gt;Îïðåäåëÿåì èìÿ îáúåêòà äëÿ ðàáîòû ñäàííûì òèïîì îïëàòû
lcPaymentObjNM = ALLTRIM(lvPaymentTypeInfo.ObjDesc)
*------------------------------------------------------------------------------

*11.05.2006 11:36 -&gt;Îïðåäåëÿåì ñóììó ïî äàííîìó òèïó îïëàòû
lnPaymentTypeRate = IIF(lvPaymentTypeInfo.Rate=0,.txtCheckSum.Value,lvPaymentTypeInfo.Rate)
*------------------------------------------------------------------------------

*11.05.2006 17:11 -&gt;Ïðè îòñóòñòâèè îáúåêòà ðàáîòû ñ îïëàòîé - âûõîäèì
IF EMPTY(lcPaymentObjNM)
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*11.05.2006 16:53 -&gt;Ïîëó÷èì ñóììó îïëàòû
lnPaymentID = oMgrPOS.Do([POS],[PAYMENTSUM],lcPaymentObjNM,.nCheckID,lnPaymentTypeID,lcPaymentTypeNM,lnPaymentTypeRate,526-SYSMETRIC(9))
*------------------------------------------------------------------------------

*11.05.2006 11:37 -&gt;Ïðè îòñóòñòâèè îïëàòû - âûõîäèì
IF lnPaymentID = 0
	RETURN
ELSE
	_PARAM = lnPaymentID
ENDIF
*------------------------------------------------------------------------------

*16.05.2006 10:25 -&gt;Ïîëó÷àåì îïëàòó ïî ÷åêó
USE IN SELECT([lvCheckPaymentView])
USE lvCheckPaymentView IN 0
***
lnPaymentTypeSum = lvCheckPaymentView.CheckPaymentPrcSum
*------------------------------------------------------------------------------

*11.05.2006 12:03 -&gt;Óìåíüøàåì ñóììó ÷åêà
IF This.txtCheckSum.Value &lt; lnPaymentTypeSum
	MESSAGEBOX([Ñóììà áåçíàëè÷íîé îïëàòû ïåðåâûøàåò ñóììó ÷åêà.],48,[Âíèìàíèå],10000)
	RETURN 0
ELSE
	This.cntSummary.txtReceived.Value = This.cntSummary.txtReceived.Value - lnPaymentTypeSum
ENDIF
*------------------------------------------------------------------------------

*11.05.2006 12:04 -&gt;Äîáàâëÿåì ïîçèöèþ òèïà îïëàòû  â ÷åê
APPEND BLANK IN lvCheckTransView
REPLACE ;
	lvCheckTransView.CheckTransType		WITH [ÎÏËÀÒÀ], ;
	lvCheckTransView.CheckTransTypeSign WITH -1, ;
	lvCheckTransView.CheckTransTvrID	WITH 0, ;
	lvCheckTransView.TvrNM				WITH lcPaymentTypeNM, ;
	lvCheckTransView.CheckTransQnt		WITH lvCheckPaymentView.CheckPaymentQnt, ;
	lvCheckTransView.CheckTransPrc		WITH ROUND(lvCheckPaymentView.CheckPaymentPrcSum/lvCheckPaymentView.CheckPaymentQnt,2) ;
IN lvCheckTransView
***
TABLEUPDATE(0,.T.,[lvCheckTransView])
*------------------------------------------------------------------------------

*11.05.2006 12:06 -&gt;Îáíîâèì Grid ñ òðàíçàêöèÿìè
This.grdCheckTransView.Refresh()
*------------------------------------------------------------------------------

*11.05.2006 12:06 -&gt;Îáíîâèì ñóììó ÷åêà
.CalcCheckSum()
*------------------------------------------------------------------------------

*11.05.2006 12:07 -&gt;Ñîõðàíÿåì ñóììó îïëàòû
.aPaySum[1,lnPaymentTypeID] = .aPaySum[1,lnPaymentTypeID] + lnPaymentTypeSum
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************




ENDPROC
PROCEDURE progproxcard
LOCAL lcCardUpId
lcCardUpId = ALLT(oRes.GetParam([POS],[CARDUP]))
IF EMPTY(ALLTRIM(lcCardUpId))
	RETURN
ENDIF


SELECT CheckTransTvrID AS TvrId, TvrNM , ;
CheckTransQnt AS TvrQnt, ;
VAL(SUBSTR(TvrNm,LEN(ALLTRIM(TvrNm))-1,LEN(ALLTRIM(TvrNm)))) AS Qnt, ;
LIKE('*ÄÅÒÑÊ*',UPPER(TvrNm)) AS Child , CheckTransPrc;
FROM lvCheckTransView ;
WHERE CheckTransTvrID IN (&amp;lcCardUpId) ;
ORDER BY 2 ;
INTO TABLE TMP\tmpCard

*  GROUP BY TvrNM , Qnt ;

IF _Tally &lt;1
RETURN
ENDIF
USE IN tmpCard
llOperateResult = oApp.DoModalFormRetValObj([frmproxcard;pos_v1.vcx],thisform.ncheckid,this.nCheckTypeID)
USE IN SELECT('tmpCard')
ERASE TMP\tmpCard.dbf

					
ENDPROC
PROCEDURE reportx
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPOS.ReportX
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü X-îò÷åòà
*------------------------------------------------------------------------------
*16.04.2006 10:21 -&gt;Ïå÷àòàåì X-î÷åò
This.Shtrih.ReportX()
*------------------------------------------------------------------------------

*!*	*22.04.2006 12:04 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
*!*	IF This.Shtrih.ErrorCode # 0

*!*		.KKMErrorHandler([Îøèáêà ] + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + ;
*!*				  [ ïðè ïå÷àòè X-îò÷åòà. Ñìåíà #] + ALLTRIM(STR(.nSalesID)))
*!*				
*!*		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
*!*		spSetCheckAttribute(.nCheckID,cnFiscFail)
*!*		*------------------------------------------------------------------------------

*!*	ENDIF
*!*	*------------------------------------------------------------------------------

*!*	*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE retuproxcard
LOCAL llOperateResult
SELECT space(20) as cardcode ;
FROM lvCheckTransView ;
WHERE .f. ;
INTO TABLE TMP\tmpCard
USE IN tmpCard
llOperateResult = oApp.DoModalFormRetValObj([frmproxcardretu;pos_v1.vcx],thisform.ncheckid,this.nCheckTypeID)
USE IN SELECT('tmpCard')
ERASE TMP\tmpCard.dbf
IF llOperateResult &gt;0
		this.cntsale.txtTvrQnt.Value=llOperateResult
	  ELSE
		this.cntsale.txtTvrQnt.Value=llOperateResult
ENDIF

ENDPROC
PROCEDURE selectprice
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_v1.vcx
* Class.Module....: frmPOS.SelectPrice
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âûáîð ïðàéñ-ëèñòà
*------------------------------------------------------------------------------

*13.04.2006 19:11 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnPrcTypeID
*------------------------------------------------------------------------------

*13.04.2006 19:12 -&gt;Çàïóñòèì ôîðìó âûáîðà ïðàéñ-ëèñòà
lnPrcTypeID = oApp.DoModalFormRetValObj([frmselprctype;pos_v1.vcx],This.nPrcTypeID)
*------------------------------------------------------------------------------

*13.04.2006 19:13 -&gt;Ñîæðàíÿåì âûáðàííûé ïðàéñ-ëèñò
IF lnPrcTypeID # 0
	This.nPrcTypeID = lnPrcTypeID
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE setcheckstatus
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.SETCHECKSTATUS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îòîáðàæåíèå ñòàòóñà ÷åêà
*------------------------------------------------------------------------------

WITH This

*12.04.2006 12:11 -&gt;Âûñòàâëÿåì ñòàòóñ ÷åêà
DO CASE
	CASE .nCheckTypeID = 1
		.lblCheckStatus.Caption = [Ïðîäàæà]
	CASE .nCheckTypeID = 2
		.lblCheckStatus.Caption = [Âîçâðàò]
ENDCASE
***

IF .lStornoMode
	.lblCheckStatus.Caption = .lblCheckStatus.Caption + [(ñòîðíî)]
ENDIF
*------------------------------------------------------------------------------

*12.04.2006 12:17 -&gt;Îáíîâèì èçîáðàæåíèå ñòàòóñà
.lblCheckStatus.Refresh()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE setposmode
LPARAMETERS tnPosMode

*17.10.2006 12:55 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcModeDesc
*------------------------------------------------------------------------------

*17.10.2006 12:53 -&gt;Ñîõðàíèì íîâûé ðåæèì
This.nPosMode = tnPosMode
*------------------------------------------------------------------------------

*17.10.2006 12:54 -&gt;Îòîáðàçèì íîâûé ðåæèì
DO CASE
	CASE tnPosMode = 1	&amp;&amp; L
		lcModeDesc = [ÇÀÁËÎÊÈÐÎÂÀÍ]
	CASE tnPosMode = 2 &amp;&amp; R
		lcModeDesc = spUserClt(1)
	CASE tnPosMode = 3 &amp;&amp; S
		lcModeDesc = spUserClt(1)
*		lcModeDesc = [ÑÈÑ.ÀÄÌÈÍ.]
	CASE tnPosMode = 4 &amp;&amp; Ex
		lcModeDesc = [ÒÅÕÍÎËÎÃÈ×.]
	OTHERWISE
		lcModeDesc = []
ENDCASE
***
This.lblUserNM.Caption = lcModeDesc
*------------------------------------------------------------------------------


ENDPROC
PROCEDURE shutdown
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPOS.Shutdown
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tlForce&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàâåðøåíèå ðàáîòû
*------------------------------------------------------------------------------
LPARAMETERS tlForce

*14.04.2006 10:28 -&gt;Çàâåðøàåì ðàáîòó
IF tlForce OR This.nCheckID = 0
	oApp.lUserChange = .F.
	CLEAR EVENTS
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE storechecktrans
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPOS.StoreCheckTrans
* Called by.......: &lt;This.AddTvr();This.StornoTvr()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå òðàíçàêöèè ÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM
*------------------------------------------------------------------------------

WITH This

*12.04.2006 14:17 -&gt;Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------

*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*12.04.2006 14:18 -&gt;Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,.nCheckTypeID,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	.lblCheckNo.Caption = PADL(ALLTRIM(STR(CheckParam.CheckNo)),6,[ ])
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*12.04.2006 15:19 -&gt;Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
USE IN SELECT([lvCheckTransEdit])
_PARAM = .nCheckID
USE lvCheckTransEdit IN 0
CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
*------------------------------------------------------------------------------

*12.04.2006 15:29 -&gt;Äîáàâëÿåì òðàíçàêöèþ
APPEND BLANK IN lvCheckTransEdit
REPLACE ;
	lvCheckTransEdit.CheckTransUID		WITH RECCOUNT([lvCheckTransView]), ;
	lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
	lvCheckTransEdit.CheckTransTypeID	WITH IIF(.lStornoMode,2,1), ;
	lvCheckTransEdit.CheckTransTvrId	WITH lvCheckTransView.CheckTransTvrID, ;
	lvCheckTransEdit.CheckTransQnt		WITH lvCheckTransView.CheckTransQnt, ;
	lvCheckTransEdit.CheckTransPrc		WITH lvCheckTransView.CheckTransPrc ;
IN lvCheckTransEdit
***
TABLEUPDATE(0,.T.,[lvCheckTransEdit])
*------------------------------------------------------------------------------

*12.04.2006 17:22 -&gt;Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
IF this.CheckOnLine
IF .lStornoMode
	.Shtrih.CheckSaleStorno(lvCheckTransView.TvrNM,lvCheckTransView.CheckTransQnt,lvCheckTransView.CheckTransPrc)
ELSE
	IF .nCheckTypeID = 1
		.Shtrih.CheckSaleTran(lvCheckTransView.TvrNM,lvCheckTransView.CheckTransQnt,lvCheckTransView.CheckTransPrc)
	ELSE
		.Shtrih.CheckSaleReturn(lvCheckTransView.TvrNM,lvCheckTransView.CheckTransQnt,lvCheckTransView.CheckTransPrc)
	ENDIF
ENDIF
*------------------------------------------------------------------------------

*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13))

ENDIF
*------------------------------------------------------------------------------
ENDIF
.nLastCheckSeconds = 0

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE stornobreak
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.StornoBreak
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âûõîä èç ðåæèìà ñòîðíèðîâàíèÿ
*------------------------------------------------------------------------------

WITH This

*11.04.2006 17:18 -&gt;Çàêîí÷èì ñòîðíèðîâàíèå
.grdCheckTransView.HighlightStyle = 0
.grdCheckTransView.Enabled  = .F.
.cntSale.txtTvrQnt.Enabled  = .T.
.cntSale.txtTvrQnt.SetFocus()
.cntSale.txtTvrQnt.Enabled  = .F.
.lStornoMode = .F.
*------------------------------------------------------------------------------

*12.04.2006 12:24 -&gt;Ïîêàæåì ñòàòóñ ÷åêà
.SetCheckStatus()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE stornotvr
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.StornoTvr
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñòîðíèðîâàíèå òîâàðíîé ïîçèöèè â ÷åê
*------------------------------------------------------------------------------

WITH This

*11.04.2006 16:57 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   laCheckTrans[1]
*------------------------------------------------------------------------------

*11.04.2006 17:13 -&gt;Åñëè òðàíçàêöèÿ ïîìå÷åíà(ñòîðíèðîâàíà èëè òðàíçàêöèÿ - ñòîðíî), òî âûõîäèì
IF lvCheckTransView.Mark
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------
IF !this.CheckOnLine
			SELECT lvCheckTransView
			DELETE NEXT 1
			TABLEUPDATE(0,.T.,[lvCheckTransView])
			IF RECCOUNT([lvCheckTransView])=0
				this.checksalemode()
			ENDIF
	ELSE
			*11.04.2006 13:02 -&gt;Áåðåì òðàíçàêöèþ ïðîäàæè
			SELECT lvCheckTransView
			REPLACE lvCheckTransView.Mark WITH .T.
			SCATTER TO laCheckTrans
			*------------------------------------------------------------------------------

			*11.04.2006 13:04 -&gt;Äîáàâëÿåì ïîçèöèþ â ÷åê
			APPEND BLANK IN lvCheckTransView
			GATHER FROM laCheckTrans
			REPLACE ;
				lvCheckTransView.CheckTransType		WITH [ÑÒÎÐÍÎ], ;
				lvCheckTransView.CheckTransTypeSign WITH -1 ;
			IN lvCheckTransView
			***
			TABLEUPDATE(0,.T.,[lvCheckTransView])

			.StoreCheckTrans()
			*------------------------------------------------------------------------------
ENDIF

*11.04.2006 13:10 -&gt;Îáíîâèì ñóììó ÷åêà
.CalcCheckSum()
*------------------------------------------------------------------------------

*11.04.2006 13:14 -&gt;Îáíîâèòü ñîäåðæèìîå ÷åêà
.grdCheckTransView.Refresh()
*------------------------------------------------------------------------------

*12.04.2006 15:31 -&gt;Ñîõðàíèì òðàíçàêöèþ
*------------------------------------------------------------------------------

*11.04.2006 17:18 -&gt;Çàêîí÷èì ñòîðíèðîâàíèå
.grdCheckTransView.HighlightStyle = 0
.grdCheckTransView.Enabled  = .F.
.cntSale.txtTvrQnt.Enabled  = .T.
.cntSale.txtTvrQnt.SetFocus()
.cntSale.txtTvrQnt.Enabled  = .F.
.lStornoMode = .F.
*------------------------------------------------------------------------------

*12.04.2006 12:24 -&gt;Ïîêàæåì ñòàòóñ ÷åêà
.SetCheckStatus()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

RETURN

*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.StornoTvr
* Called by.......: &lt;This.KeyPress&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñòîðíèðîâàíèå òîâàðíîé ïîçèöèè â ÷åê
*------------------------------------------------------------------------------

WITH This

*11.04.2006 16:57 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   laCheckTrans[1]
*------------------------------------------------------------------------------

*11.04.2006 17:13 -&gt;Åñëè òðàíçàêöèÿ ïîìå÷åíà(ñòîðíèðîâàíà èëè òðàíçàêöèÿ - ñòîðíî), òî âûõîäèì
IF lvCheckTransView.Mark
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*11.04.2006 13:02 -&gt;Áåðåì òðàíçàêöèþ ïðîäàæè
SELECT lvCheckTransView
REPLACE lvCheckTransView.Mark WITH .T.
SCATTER TO laCheckTrans
*------------------------------------------------------------------------------

*11.04.2006 13:04 -&gt;Äîáàâëÿåì ïîçèöèþ â ÷åê
APPEND BLANK IN lvCheckTransView
GATHER FROM laCheckTrans
REPLACE ;
	lvCheckTransView.CheckTransType		WITH [ÑÒÎÐÍÎ], ;
	lvCheckTransView.CheckTransTypeSign WITH -1 ;
IN lvCheckTransView
***
TABLEUPDATE(0,.T.,[lvCheckTransView])
*------------------------------------------------------------------------------

*11.04.2006 13:10 -&gt;Îáíîâèì ñóììó ÷åêà
.CalcCheckSum()
*------------------------------------------------------------------------------

*11.04.2006 13:14 -&gt;Îáíîâèòü ñîäåðæèìîå ÷åêà
.grdCheckTransView.Refresh()
*------------------------------------------------------------------------------

*12.04.2006 15:31 -&gt;Ñîæðàíèì òðàíçàêöèþ
.StoreCheckTrans()
*------------------------------------------------------------------------------

*11.04.2006 17:18 -&gt;Çàêîí÷èì ñòîðíèðîâàíèå
.grdCheckTransView.HighlightStyle = 0
.grdCheckTransView.Enabled  = .F.
.cntSale.txtTvrQnt.Enabled  = .T.
.cntSale.txtTvrQnt.SetFocus()
.cntSale.txtTvrQnt.Enabled  = .F.
.lStornoMode = .F.
*------------------------------------------------------------------------------

*12.04.2006 12:24 -&gt;Ïîêàæåì ñòàòóñ ÷åêà
.SetCheckStatus()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE stornotvrprepare
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: frmPos.StornoTvrPrepare
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñòîðíèðîâàíèå ïîçèöèè ÷åêà
*------------------------------------------------------------------------------

WITH This

*11.04.2006 14:05 -&gt;Ïåðåõîäèì íà Grid ñ ñîäåðæèìûì ÷åêà
IF RECCOUNT([lvCheckTransView])#0 &amp;&amp;AND .nTvrID = 0
	.grdCheckTransView.HighlightStyle = 2
	.grdCheckTransView.Enabled  = .T.
	.grdCheckTransView.SetFocus()
	.lStornoMode = .T.
	
	*12.04.2006 12:24 -&gt;Ïîêàæåì ñòàòóñ ÷åêà
	.SetCheckStatus()
ENDIF
*------------------------------------------------------------------------------
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>14</reserved2>
		<reserved3>ntvrid ID ïîñëåäíåãî äîáàâëåííîãî â ÷åê òîâàðà
lsummarymode ðàáîòà ñ èòîãîì ïî ÷åêó
ncheckid èäåíòèôèêàòîð ÷åêà
nsalesid ID ëîãà ïðîäàæ
nchecktypeid òèï ÷åêà
lstornomode Ðåæèì ñòîðíèðîâàíèÿ
ncashno íîìåð êàññû
ncashierid èäåíòèôèêàòîð êàññèðà
nprctypeid ïðàéñ
ldiscisgiven ñêèäêà ïî ÷åêó ïðåäîñòàâëåíà
nmainset Îñíîâíîå ìåíþ
nspecialset ñïåö. ôóíêöèè
nselectset Âûáîð
npayset òèïû îïëàò
ntvrqnt êîëè÷åñòâî òîâàðà â ïîñëåäíåé ïîçèöèè ÷åêà
nposmode
ndisctvrid ID òîâàðà-ñêèäêè
ldiscmode
nlastcheckseconds ñåêóíäû â ìîìåíò îòáèòèÿ ïîñëåäíåãî ÷åêà
ncltid Êîä ïîêóïàòåëÿ: èùåì ïî êàðòå
pctvrname Íàçâàíèå òîâàðà, îòëè÷íîå îò ñïðàâî÷íîãî (ïðè ïðîäàæå òàðèôîâ) 
checkonline ÷åê ïå÷àòàåòñÿ ïðè ñîñòàâëåíèè ïîñòðî÷íî - èíà÷å: ÷åê ïå÷àòàåì ïîñëå ïîäâåäåíèÿ èòîãîâ  - ñðàçó âåñü
checkid Íîìåð ÷åêà
*gettvr äîáàâëåíèå èíôîðìàöèè î òîâàðå
*calcchecksum ðàñ÷åò ñóììû ÷åêà
*addtvr äîáàâëåíèå òîâàðíîé ïîçèöèè â ÷åê
*inputqnt Ââîä êîëè÷åñòâà òîâàðà
*stornotvrprepare ïîäãîòîâêà ñòîðíèðîâàíèÿ ïîçèöèè ÷åêà
*stornotvr Ñòîðíèðîâàíèå
*checksummaryprepare èòîã ïî ÷åêó
*checksummary èòîã ïî ÷åêó
*setcheckstatus Îòîáðàæåíèå ñòàòóñà ÷åêà
*stornobreak âûõîä èç ðåæèìà ñòîðíèðîâàíèÿ
*checkreturnmode ïåðåõîä â ðåæèì ôîðìèðîâàíèÿ ÷åêà âîçâðàòà
*checkreset ñáðîñ ÷åêà
*closeday çàêðûòèå ñìåíû
*storechecktrans ñîõðàíåíèå òðàíçàêöèè ÷åêà
*clearpos 
*shutdown çàâåðøåíèå ðàáîòû
*reportz Ïå÷àòü Z-îò÷åòà
*reportx ïå÷àòü X-îò÷åòà
*checksalemode ïåðåâîä â ðåæèì ôîðìèðîâàíèÿ ÷åêà ïðîäàæè
*selectprice âûáîð ïðàéñ-ëèñòà
*changeuser ñìåíà ïîëüçîâàòåëÿ/áëîêèðîâêà
*checksummaryreset Âûõîä èç ðåæèìà èòîãà ïî ÷åêó
*checkfinalization ïåðåõîä ê ñëåäóþùåìó ÷åêó
*discselect 
*paymentselect âûáîð òèïà îïëàòû
^apaysum[1,4] Ñóììû ïî ðàçíûì òèïàì îïëàò
*opendrawer îòêðûòèå äåíåæíîãî ÿùèêà
*continueprint ïðîäîëæåíèå ïå÷àòè ÷åêà
*keyeventhandler 
*kkmerrorhandler îáðàáîòêà îøèáîê ÊÊÌ
*setposmode Óñòàíîâêà ðåæèìà Pos-ïðîãðàììû
*cashincome âíåñåíèå â êàññó
*cashoutcome âûïëàòà èç êàññû
*msghandler 
*key2msg ïðåîáðàçîâàíèå êîäîâ êëàâèø â ñîîáùåíèÿ
*progproxcard Ïîãðàììèðóåì ïðîêñè-êàðòû äëÿ åæîâîé
*checkretucheck Âîçâðàùàåìñÿ ê èìåþùèìóñÿ ÷åêó
*retuproxcard Ïîäñ÷åò êîëè÷åñòâà ïðîêñèìèòè êàðò
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\cash.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WN0KI10T</uniqueid>
		<timestamp>930832538</timestamp>
		<class>cntsummary</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntSummary</objname>
		<parent>frmpos__</parent>
		<properties>Top = 468
Left = 5
ZOrderSet = 0
Name = "cntSummary"
txtReceived.Name = "txtReceived"
txtDelivery.Name = "txtDelivery"
lblTvrPrice.Name = "lblTvrPrice"
Lbl1.Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WJ0XXTO4</uniqueid>
		<timestamp>930832538</timestamp>
		<class>cntsale</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntSale</objname>
		<parent>frmpos__</parent>
		<properties>Top = 468
Left = 5
ZOrderSet = 1
Name = "cntSale"
txtTvrNM.Name = "txtTvrNM"
txtTvrQnt.Name = "txtTvrQnt"
txtTvrPrice.Name = "txtTvrPrice"
Lbl1.Name = "Lbl1"
Lbl2.Name = "Lbl2"
txtPLU.Name = "txtPLU"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S010UT0N</uniqueid>
		<timestamp>881625462</timestamp>
		<class>shtrih</class>
		<classloc>kkms.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>Shtrih</objname>
		<parent>frmpos__</parent>
		<properties>Top = 0
Left = 36
Name = "Shtrih"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0M1WJJ</uniqueid>
		<timestamp>927898877</timestamp>
		<class>grdchecktransview</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdCheckTransView</objname>
		<parent>frmpos__</parent>
		<properties>DefHeight = 
Enabled = .F.
Height = (413-SYSMETRIC(9))
Left = 5
Panel = 1
RecordSource = "lvCheckTransView"
Top = 31
Width = 790
ZOrderSet = 5
Name = "grdCheckTransView"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Enabled = .F.
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.ControlSource = "lvCheckTransView.CheckTransType"
Column1.Enabled = .F.
Column1.Width = 87
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Enabled = .F.
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.ControlSource = "lvCheckTransView.TvrNM"
Column2.Enabled = .F.
Column2.Width = 375
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Enabled = .F.
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.ControlSource = "lvCheckTransView.CheckTransQnt"
Column3.Enabled = .F.
Column3.Width = 80
Column3.Name = "Column3"
Column4.Header1.Name = "Header1"
Column4.Txtgrd1.Enabled = .F.
Column4.Txtgrd1.Name = "Txtgrd1"
Column4.ControlSource = "ROUND(MTON(lvCheckTransView.CheckTransPrc),2)"
Column4.Enabled = .F.
Column4.Width = 95
Column4.Name = "Column4"
COLUMN5.Header1.Name = "Header1"
COLUMN5.Txtgrd1.Enabled = .F.
COLUMN5.Txtgrd1.Name = "Txtgrd1"
COLUMN5.ControlSource = "ROUND(MTON(lvCheckTransView.CheckTransPrc)*lvCheckTransView.CheckTransQnt,2)"
COLUMN5.Enabled = .F.
COLUMN5.Width = 119
COLUMN5.Name = "COLUMN5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0MX105</uniqueid>
		<timestamp>930832538</timestamp>
		<class>cntclock</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntClock</objname>
		<parent>frmpos__</parent>
		<properties>Left = 606
ZOrderSet = 6
Name = "cntClock"
lblClock.Name = "lblClock"
tmrClock.Name = "tmrClock"
</properties>
		<protected/>
		<methods>PROCEDURE tick
WITH This.Parent

IF .nLastCheckSeconds # 0 AND SECONDS()-.nLastCheckSeconds &gt; 60

	.nLastCheckSeconds = 0
	.LineDisplay.ClearText()

ENDIF

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>930832538</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCheckStatus</objname>
		<parent>frmpos__</parent>
		<properties>AutoSize = .F.
FontSize = 18
Caption = "Ïðîäàæà"
Height = 30
Left = 332
Width = 270
ZOrderSet = 7
Name = "lblCheckStatus"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0NN34B</uniqueid>
		<timestamp>930832538</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblUserNM</objname>
		<parent>frmpos__</parent>
		<properties>AutoSize = .F.
FontSize = 18
Caption = "Êàññèð"
Height = 30
Left = 5
Width = 247
ZOrderSet = 8
Name = "lblUserNM"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*11.04.2006 11:01 -&gt;Ïîëó÷èì èìÿ ïîëüçîâàòåëÿ
This.Caption = spUserClt(1)
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S00L5IAF</uniqueid>
		<timestamp>894527334</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCheckSum</objname>
		<parent>frmpos__</parent>
		<properties>FontSize = 18
Alignment = 1
Enabled = .F.
Height = 32
Left = 507
Top = 429
Width = 286
DisabledForeColor = 0,0,0
ZOrderSet = 9
Name = "txtCheckSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S30NK8EM</uniqueid>
		<timestamp>930832538</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCheckNo</objname>
		<parent>frmpos__</parent>
		<properties>FontBold = .T.
FontSize = 12
Caption = ""
Height = 22
Left = 67
Top = 440
Visible = .F.
Width = 2
ZOrderSet = 10
Name = "lblCheckNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0O89JL</uniqueid>
		<timestamp>930832538</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCheckSum</objname>
		<parent>frmpos__</parent>
		<properties>FontSize = 18
Caption = "Ñóììà"
Left = 424
Top = 430
ZOrderSet = 11
Name = "lblCheckSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X80RIW31</uniqueid>
		<timestamp>909662697</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPosMode</objname>
		<parent>frmpos__</parent>
		<properties>FontSize = 18
BorderStyle = 0
Enabled = .F.
Height = 32
Left = 5
Top = 429
Width = 264
DisabledForeColor = 0,0,0
ZOrderSet = 9
Name = "txtPosMode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X70OP8DP</uniqueid>
		<timestamp>930832538</timestamp>
		<class>olecommscanner</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleCommScanner</objname>
		<parent>frmpos__</parent>
		<properties>Top = 465
Left = 756
Height = 48
Width = 58
Enabled = .F.
cbindobj = This.Parent.cntSale
Name = "OleCommScanner"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

WITH This.Parent

IF .lStornoMode OR .lSummaryMode OR .lDiscIsGiven OR .lDiscMode

	NODEFAULT
	This._Read()
	
ELSE

	*27.10.2006 18:25 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
	DODEFAULT()
	*------------------------------------------------------------------------------
	
ENDIF



ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDYyqsQM8gBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAD8AAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XP0KV78U</uniqueid>
		<timestamp>930832538</timestamp>
		<class>linedisplay</class>
		<classloc>opos_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>LineDisplay</objname>
		<parent>frmpos__</parent>
		<properties>Top = 428
Left = 316
Height = 33
Width = 33
Name = "LineDisplay"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDYyqsQM8gBAwAAAMAAAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAA/v////7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8CAbnMHrjSEat0AEAFTDcZAAMAAGkDAABpAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = c:\develop\ncr\opos\oposlinedisplay.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmpos__</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 18, 11, 28, 21, 64, 6, 1
Arial, 0, 12, 7, 19, 15, 43, 3, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
