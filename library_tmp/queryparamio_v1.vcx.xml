<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IM0Q45PH</uniqueid>
		<timestamp>0</timestamp>
		<class>cst</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstqphidden</objname>
		<parent/>
		<properties>Name = "cstqphidden"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPIDCTLGRID.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tcVarName, tuVarValue

WITH This
	
	*11.05.2005 12:12 -&gt;Ñîõðàíèì èìÿ ïåðåìåííîé è å¸ çíà÷åíèå
	.cVarName  = tcVarName
	.uVarValue = tuVarValue
	*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPIDCTLGRID.QUERYPARAMSET
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cVarName,.uVarValue)
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>cvarname
uvarvalue
*queryparamset 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cstqphidden</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18T02LNY1</uniqueid>
		<timestamp>926654825</timestamp>
		<class>cst</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>queryparammgr</objname>
		<parent/>
		<properties>Name = "queryparammgr"
</properties>
		<protected>arraysearchbyonecol
arraysearchbytwocol
</protected>
		<methods>PROCEDURE arraysearchbyonecol
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.ARRAYSEARCHBYONECOL
* Called by.......: &lt;Misc Int Calls&gt;
* Parameters......: &lt;tcArrayName,teSearchColumn,tuSearchValue[,teReturnColumn]&gt;
* Returns.........: &lt;luReturnValue {.NULL.,lnCurrSRef,.aParamArray(lnCurrSRes,teReturnColumn)}&gt;
* Notes...........: &lt;protected/nouser/default&gt; Óíèâåðñàëüíûé ïîèñê â ìàññèâå ïî îäíîé êîëîíêå.
*-------------------------------------------------------
LPARAMETERS tcArrayName, ;
			teSearchColumn, ;
			tuSearchValue, ;
			teReturnColumn

WITH This

*24.05.2004 02:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnCurrSRef, ;
		luReturnValue
***
luReturnValue = .NULL.		
*------------------------------------------------------------------------------

*24.05.2004 02:07 -&gt;Âûïîëíÿåì ïîèñê
IF !ISNULL(&amp;tcArrayName)
	FOR lnCurrSRef = 1 TO ALEN(&amp;tcArrayName,1)
	
		*24.05.2004 02:16 -&gt;Ñðàâíèâàåì çíà÷åíèå ñîîòâåòñòâóþùåé êîëîíêè ìàññèâà ñ çàïðîøåííûìè çíà÷åíèÿìè
		IF	TYPE([&amp;tcArrayName(lnCurrSRef,teSearchColumn)]) == TYPE([tuSearchValue]) AND ;
			&amp;tcArrayName(lnCurrSRef,teSearchColumn) == tuSearchValue
			*{
			
			*24.05.2004 02:19 -&gt;Ñîõðàíÿåì òðåáóåìîå çíà÷åíèå è âûõîäèì èç ïîèñêà
			IF TYPE([teReturnColumn])==[N]
				luReturnValue = &amp;tcArrayName(lnCurrSRef,teReturnColumn)
			ELSE
				luReturnValue = lnCurrSRef
			ENDIF
			***
			EXIT
			*------------------------------------------------------------------------------
			
			*}	
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDFOR &amp;&amp; lnCurrSRef = 1 TO ALEN(&amp;tcArrayName,1)
ENDIF
*------------------------------------------------------------------------------

*24.05.2004 02:22 -&gt;Âîçâðàùàåì ðåçóëüòàò
RETURN luReturnValue
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
* ÎÏÈÑÀÍÈÅ ÏÀÐÀÌÅÒÐÎÂ
* 1. tcArrayName - èìÿ ìàññèâà. Ññûëêà íà ìàññèâ ìîæåò õðàíèòñÿ â ñâ-âå äàííîãî îáúåêòà,
*    â ñâ-âå äðóãîãî îáúåêòà èëè ïåðåìåííîé.
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ñâ-âå îáúåêòà: tcArrayName = [.ArrayName].
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ñâ-âå äðóãîãî îáúåêòà: tcArrayName = [ObjectName.ArrayName].
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ïåðåìåííîé: tcArrayName = [paArrayName].
* 2. teSearchColumn  - èíäåêñ ïîèñêîâîé êîëîíêè ìàññèâà, â êîòîðîé îñóùåñòâëÿåòñÿ ïîèñê tuSearchValue.
* 3. tuSearchValue   - çíà÷åíèå, êîòîðîå èùåòñÿ â teSearchColumn.
* 4. teReturnColumn  - îïöèîíàëüíûé èíäåêñ êîëîíêè ìàñèèâà, çíà÷åíèå êîòîðîé âîçâðàùàåòñÿ ïðè óñïåøíîì ïîèñêå.
*-----------------------------------------------------------------------------------
* Ìåòîä îñóùåñòâëÿåò ïîèñê â äâóìåðíîì ìàññèâå tcArrayName â êîëîíêå teSearchColumn çíà÷åíèÿ tuSearchValue.
* Åñëè ïîèñê óñïåøåí - âîçâðàùÿåòñÿ èíäåêñ ñòðîêè ìàññèâà ëèáî çíà÷åíèå êîëîíêè teReturnColumn ñîîòâåòñòâóþùåé ñòðîêè.
* Åñëè ïîèñê íåóñïåøåí - âîçâðàùàåòñÿ NULL.
*-----------------------------------------------------------------------------------
ENDPROC
PROCEDURE arraysearchbytwocol
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.ARRAYSEARCHBYTWOCOL
* Called by.......: &lt;Misc Int Calls&gt;
* Parameters......: &lt;tcArrayName,teSearchColumn1,tuSearchValue1,teSearchColumn2,tuSearchValue2[,teReturnColumn]&gt;
* Returns.........: &lt;luReturnValue {.NULL.,lnCurrSRef,.aParamArray(lnCurrSRes,teReturnColumn)}&gt;
* Notes...........: &lt;protected/nouser/default&gt; Óíèâåðñàëüíûé ïîèñê â ìàññèâå ïî äâóì êîëîíêàì.
*-------------------------------------------------------
LPARAMETERS tcArrayName, ;
			teSearchColumn1, ;
			tuSearchValue1, ;
			teSearchColumn2, ;
			tuSearchValue2, ;
			teReturnColumn

WITH This

*24.05.2004 02:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnCurrSRef, ;
		luReturnValue
***
luReturnValue = .NULL.		
*------------------------------------------------------------------------------

*24.05.2004 02:07 -&gt;Âûïîëíÿåì ïîèñê
IF !ISNULL(&amp;tcArrayName)
	FOR lnCurrSRef = 1 TO ALEN(&amp;tcArrayName,1)
	
		*24.05.2004 02:16 -&gt;Ñðàâíèâàåì çíà÷åíèå ñîîòâåòñòâóþùèõ êîëîíîê ìàññèâà ñ çàïðîøåííûìè çíà÷åíèÿìè
		IF	TYPE([&amp;tcArrayName(lnCurrSRef,teSearchColumn1)]) == TYPE([tuSearchValue1]) AND ;
			&amp;tcArrayName(lnCurrSRef,teSearchColumn1) == tuSearchValue1 AND ;
			TYPE([&amp;tcArrayName(lnCurrSRef,teSearchColumn2)]) == TYPE([tuSearchValue2]) AND ;
			&amp;tcArrayName(lnCurrSRef,teSearchColumn2) == tuSearchValue2
			*{
			
			*24.05.2004 02:19 -&gt;Ñîõðàíÿåì òðåáóåìîå çíà÷åíèå è âûõîäèì èç ïîèñêà
			IF TYPE([teReturnColumn])==[N]
				luReturnValue = &amp;tcArrayName(lnCurrSRef,teReturnColumn)
			ELSE
				luReturnValue = lnCurrSRef
			ENDIF
			***
			EXIT
			*------------------------------------------------------------------------------
			
			*}	
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDFOR &amp;&amp; lnCurrSRef = 1 TO ALEN(&amp;tcArrayName,1)
ENDIF
*------------------------------------------------------------------------------

*24.05.2004 02:22 -&gt;Âîçâðàùàåì ðåçóëüòàò
RETURN luReturnValue
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
* ÎÏÈÑÀÍÈÅ ÏÀÐÀÌÅÒÐÎÂ
* 1. tcArrayName - èìÿ ìàññèâà. Ññûëêà íà ìàññèâ ìîæåò õðàíèòñÿ â ñâ-âå äàííîãî îáúåêòà,
*    â ñâ-âå äðóãîãî îáúåêòà èëè ïåðåìåííîé.
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ñâ-âå îáúåêòà: tcArrayName = [.ArrayName].
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ñâ-âå äðóãîãî îáúåêòà: tcArrayName = [ObjectName.ArrayName].
*    Åñëè ññûëêà íà ìàññèâ õðàíèòñÿ â ïåðåìåííîé: tcArrayName = [paArrayName].
* 2. teSearchColumn1 - èíäåêñ ïåðâîé ïîèñêîâîé êîëîíêè ìàññèâà, â êîòîðîé îñóùåñòâëÿåòñÿ ïîèñê tuSearchValue1.
* 3. tuSearchValue1  - çíà÷åíèå, êîòîðîå èùåòñÿ â teSearchColumn1.
* 4. teSearchColumn2 - èíäåêñ âòîðîé ïîèñêîâîé êîëîíêè ìàññèâà, â êîòîðîé îñóùåñòâëÿåòñÿ ïîèñê tuSearchValue2.
* 5. tuSearchValue2  - çíà÷åíèå, êîòîðîå èùåòñÿ â teSearchColumn2.
* 6. teReturnColumn  - îïöèîíàëüíûé èíäåêñ êîëîíêè ìàñèèâà, çíà÷åíèå êîòîðîé âîçâðàùàåòñÿ ïðè óñïåøíîì ïîèñêå.
*-----------------------------------------------------------------------------------
* Ìåòîä îñóùåñòâëÿåò ïîèñê â äâóìåðíîì ìàññèâå tcArrayName â êîëîíêàõ teSearchColumn1 è teSearchColumn2
* çíà÷åíèÿ tuSearchValue1 è tuSearchValue2 ñîîòâåòñòâåííî.
* Åñëè ïîèñê óñïåøåí - âîçâðàùÿåòñÿ èíäåêñ ñòðîêè ìàññèâà ëèáî çíà÷åíèå êîëîíêè teReturnColumn ñîîòâåòñòâóþùåé ñòðîêè.
* Åñëè ïîèñê íåóñïåøåí - âîçâðàùàåòñÿ NULL.
*-----------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------

*24.05.2004 02:10 -&gt;"Çàíóëèì" ìàññèâ .aParamArray
This.aParamArray = .NULL.
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE paramget
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.PARAMGET
* Called by.......: &lt;Misc Ext Calls&gt;
* Parameters......: &lt;tcQryParSID,tcParamNM&gt;
* Returns.........: &lt;luReturnValue {.NULL.,luParamValue}&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS	tcQryParSID,tcParamNM
*24.05.2004 02:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcParamNM, ;
		luReturnValue
***		
lcParamNM = UPPER(ALLTRIM(tcParamNM))
*------------------------------------------------------------------------------

*24.05.2004 13:35 -&gt;Èùåì ïàðàìåòð â ñåññèè
luReturnValue = This.ArraySearchByTwoCol([.aParamArray],cnPARAM_SID,tcQryParSID,cnPARAM_NAME,lcParamNM,cnPARAM_VALUE)
*------------------------------------------------------------------------------

*24.05.2004 13:39 -&gt;Âåðíåì çíà÷åíèå
RETURN luReturnValue
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************


ENDPROC
PROCEDURE paramsessiondestroy
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.PARAMSESSIONDESTROY
* Called by.......: &lt;Misc Ext Calls&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Óäàëåíèå ñåññèè ðàáîòû ñ ïàðàìåòðàìè.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*24.05.2004 13:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnFoundParamSRef, ;
		lcTmpTableNM
*------------------------------------------------------------------------------

*24.05.2004 13:48 -&gt;Óäàëÿåì âñå ïàðàìåòðû èç ñåññèè ðàáîòû ñ ïàðàìåòðàìè
DO WHILE .T.
	
	*24.05.2004 13:50 -&gt;Âûïîëíÿåì ïîèñê ïàðàìåòðà çàäàííîé ñåññèè äàííûõ
	lnFoundParamSRef = .ArraySearchByOneCol([.aParamArray],cnPARAM_SID,tcQryParSID)
	*------------------------------------------------------------------------------
	
	*24.05.2004 13:50 -&gt;Åñëè ïàðàìåòð íàéäåí - óäàëÿåì, èíà÷å âûõîäèì
	IF !ISNULL(lnFoundParamSRef)
		
		*24.05.2004 02:35 -&gt;Åñëè òèï ñóùåñòâóþùåãî ïàðàìåòðà - [TT] (TemporaryTable)
		IF .aParamArray(lnFoundParamSRef,cnPARAM_TYPE) == [TT]
			
			*24.05.2004 02:36 -&gt;Íåîáõîäèìî óäàëèòü âðåìåííóþ òàáëèöó
			lcTmpTableNM = .aParamArray(lnFoundParamSRef,cnPARAM_VALUE)
			***
			IF USED(lcTmpTableNM)
				USE IN (lcTmpTableNM)
			ENDIF
			***
			IF FILE([tmp\]+lcTmpTableNM+[.dbf])	
				ERASE ([tmp\]+lcTmpTableNM+[.dbf])
			ENDIF	
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*24.05.2004 13:52 -&gt;Óäàëÿåì ïàðàìåòð
		ADEL(.aParamArray,lnFoundParamSRef)
		*------------------------------------------------------------------------------
		
		*14.12.2003 19:12 -&gt;Åñëè ïîñëåäíÿÿ ñòðîêó "çàíóëèì" ìàññèâ, èíà÷å - óæìåì
		IF ALEN(.aParamArray,1) = 1
			.aParamArray = .NULL.
		ELSE
			DIMENSION .aParamArray(ALEN(.aParamArray,1)-1,cnPARAM_ARRAY_COLS)
		ENDIF	
		*------------------------------------------------------------------------------
		
	ELSE
		
		*24.05.2004 13:55 -&gt;Âûõîäèì èç ïîèñê ïàðàìåòðîâ ñåññèè
		EXIT
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ENDDO
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE paramset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: GENERAL_V1.VCX
* Class.Module....: QUERYPARAM.PARAMSET
* Called by.......: &lt;Misc Ext Calls&gt;
* Parameters......: &lt;tuQryParSID,tcParamNM,tuParamValue[,tcParamType]&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü ïàðàìåòðà ñåññèè ðàáîòû ñ ïàðàìåòðàìè.
*-------------------------------------------------------
LPARAMETERS	tuQryParSID,tcParamNM,tuParamValue,tcParamType

WITH This

*24.05.2004 02:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParSID, ;
		lcParamNM, ;
		luParamValue, ;
		lcParamType, ;
		luExistParamSRef, ;
		lnParamSRef, ;
		lcTmpTableNM, ;
		lcSourceTable, ;
		llSourceTableUsed, ;
		lcTargetTable
*------------------------------------------------------------------------------

*27.05.2004 14:32 -&gt;Îáðàáîòàåì èñõîäíûå äàííûå
luQryParSID = tuQryParSID
lcParamNM	= UPPER(ALLTRIM(tcParamNM))
lcParamType = IIF(TYPE([tcParamType])==[C],UPPER(ALLTRIM(tcParamType)),TYPE([tuParamValue]))
*------------------------------------------------------------------------------

*24.05.2004 02:30 -&gt;Ïðîâåðÿåì ñóùåñòâóåò óæå â äàííîé ñåññèè ïàðàìåòð ñ òàêèì èìåíåì èëè íåò
luExistParamSRef = .ArraySearchByTwoCol([.aParamArray],cnPARAM_SID,luQryParSID,cnPARAM_NAME,lcParamNM)
***
IF !ISNULL(luExistParamSRef)	&amp;&amp;ñóùåñòâóåò

	*24.05.2004 02:40 -&gt;Ñîõðàíÿåì èíäåêñ ñòðîêè äëÿ äàëüíåéøåé çàïèñè èíôîðìàöèè
	lnParamSRef = luExistParamSRef
	*------------------------------------------------------------------------------
	
	*24.05.2004 02:35 -&gt;Åñëè òèï ñóùåñòâóþùåãî ïàðàìåòðà - [TT] (TemporaryTable)
	IF .aParamArray(luExistParamSRef,cnPARAM_TYPE) == [TT] AND !EMPTY(.aParamArray(luExistParamSRef,cnPARAM_VALUE))
		
		*24.05.2004 02:36 -&gt;Óäàëèòü âðåìåííóþ òàáëèöó ïåðåä ïåðåçàïèñüþ
		lcTmpTableNM = .aParamArray(luExistParamSRef,cnPARAM_VALUE)
		***
		IF USED(lcTmpTableNM)
			USE IN (lcTmpTableNM)
		ENDIF
		***
		IF FILE([tmp\]+lcTmpTableNM+[.dbf])	
			ERASE ([tmp\]+lcTmpTableNM+[.dbf])
		ENDIF	
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE &amp;&amp;íå ñóùåñòâóåò
	
	*24.05.2004 02:40 -&gt;Ñîçäàåì ïàðàìåòð
	IF ISNULL(.aParamArray)
		lnParamSRef = 1
	ELSE
		lnParamSRef = ALEN(.aParamArray,1)+1
	ENDIF
	***
	DIMENSION .aParamArray(lnParamSRef,cnPARAM_ARRAY_COLS)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*24.05.2004 02:56 -&gt;Åñëè òèï çàïèñûâàåìîãî ïàðàìåòðà - [TT] (TemporaryTable)
IF lcParamType == [TT] AND !EMPTY(tuParamValue)
	
	*27.05.2004 14:43 -&gt;Çàïîìèíàåì áûëà ëè îòêðûòà èñõîäíàÿ òàáëèöà
	lcSourceTable 	  = tuParamValue
	llSourceTableUsed = USED(lcSourceTable)
	*------------------------------------------------------------------------------

	*24.05.2004 02:57 -&gt;Ñîçäàåì êîïèþ èñõîäíîé òàáëèöû
	lcTargetTableNM = [_qp]+SYS(2015)
	SELECT * FROM (lcSourceTable) INTO TABLE ([tmp\]+lcTargetTableNM+[.dbf])
	*------------------------------------------------------------------------------
	
	*27.05.2004 14:54 -&gt;Åñëè èñõîäíàÿ òàáëèöà íå áûëà îòêðûòà - çàêðûâàåì
	IF !llSourceTableUsed
		USE IN IIF(USED(lcSourceTable),lcSourceTable,0)
	ENDIF	
	*------------------------------------------------------------------------------

	*27.05.2004 13:43 -&gt;Çàêðîåì òàáëèöó-êîïèþ, ò.ê. çàïðîñ ìîæåò âûïîëíÿòñÿ â äðóãîé ñåññèè äàííûõ
	USE IN IIF(USED(lcTargetTableNM),lcTargetTableNM,0)
	*------------------------------------------------------------------------------
	
	*27.05.2004 15:00 -&gt;Â êà÷åñòâå çíà÷åíèÿ ïàðàìåòðà áóäåì çàïèñûâàò èìÿ òàáëèöû-êîïèè
	luParamValue = lcTargetTableNM
	*------------------------------------------------------------------------------

ELSE

	*24.05.2004 03:00 -&gt;Â êà÷åñòâå çíà÷åíèÿ ïàðàìåòðà çàïèñûâàåì ïåðåäàííîå çíà÷åíèå
	luParamValue = tuParamValue
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

*24.05.2004 02:50 -&gt;Çàïèñûâàåì ïàðàìåòð
.aParamArray(lnParamSRef,cnPARAM_SID)	= luQryParSID
.aParamArray(lnParamSRef,cnPARAM_NAME)	= lcParamNM
.aParamArray(lnParamSRef,cnPARAM_VALUE)	= luParamValue
.aParamArray(lnParamSRef,cnPARAM_TYPE)	= lcParamType
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*paramset &lt;public/nouser/default&gt; Çàïèñü ïàðàìåòðà ñåññèè ðàáîòû ñ ïàðàìåòðàìè.
*paramget &lt;public/nouser/default&gt; ×òåíèå ïàðàìåòðà ñåññèè ðàáîòû ñ ïàðàìåòðàìè.
*arraysearchbyonecol &lt;protected/nouser/default&gt; Óíèâåðñàëüíûé ïîèñê â ìàññèâå ïî îäíîé êîëîíêå.
*arraysearchbytwocol &lt;protected/nouser/default&gt; Óíèâåðñàëüíûé ïîèñê â ìàññèâå ïî äâóì êîëîíêàì.
^aparamarray[1,0] &lt;protected/runtime&gt; Ìàññèâ, õðàíÿùèé ïðàìàìåòðû.
*paramsessiondestroy &lt;public/nouser/default&gt; Óäàëåíèå ñåññèè ðàáîòû ñ ïàðàìåòðàìè.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\general_v1_queryparam.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>queryparammgr</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586249</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpcheck</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
lqryparisrequired = .F.
cqryparvarnmenabled = 
nqryparid = 0
Name = "cntqpcheck"
</properties>
		<protected>cqryparvarnmvalue
lqryparisrequired
cqryparvarnmenabled
qrylast
</protected>
		<methods>PROCEDURE Click
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
		*25.05.2004 17:14 -&gt;Âûñòàâèì ïî óìîë÷àíèþ òåêóùóþ äàòó â îáîèõ ïîëÿõ
		.cntTxtCtlCalendarStartDate.txtText.Value = DATE()
		.cntTxtCtlCalendarEndDate.txtText.Value = DATE()
	ELSE
		.cntTxtCtlCalendarStartDate.txtText.Value = CTOD(ALLTRIM(SUBSTR(lcQryParValue,1,AT(';',lcQryParValue)-1)))
		.cntTxtCtlCalendarEndDate.txtText.Value = CTOD(ALLTRIM(SUBSTR(lcQryParValue,AT(';',lcQryParValue)+1)))
ENDIF
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nQryParID = tnQryParID

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcRSFieldNameID
*------------------------------------------------------------------------------

*07.07.2005 11:45 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPCheck
USE IN IIF(USED([lvQryParCheckPropByQryParID]),[lvQryParCheckPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParCheckPropByQryParID IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì è îáðàáàòûâàåì îáùèå ïàðàìåòðû ôèëüòðà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
	ELSE
	.qrylast()
ENDIF
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkValue.Caption		= ALLTRIM(lvQryParCheckPropByQryParID.Caption)
.chkValue.TextChange	= lvQryParCheckPropByQryParID.TextChange
.chkValue.TextChecked	= ALLTRIM(lvQryParCheckPropByQryParID.TextChecked)
.chkValue.TextUnChecked	= ALLTRIM(lvQryParCheckPropByQryParID.TextUnChecked)
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE LostFocus
DODEFAULT()
this.qrylastset()
ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
	ELSE
		this.chkQryParEnabled.Value = VAL(lcQryParValue)
ENDIF
*------------------------------------------------------------------------------


ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue

lcQryParValue = ALLTRIM(STR(this.chkQryParEnabled.Value,10,0))

_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPCheck.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------


*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèå ïàðàìåòðà
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.chkValue.Value = IIF(luQryParValue,1,0)
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------


ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.QUERYPARAMSET
* Called by.......: &lt;tcQryParSID&gt;
* Parameters......: &lt;tn&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkValue.Value=1,.T.,.F.))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
cqryparvarnmenabled
nqryparid
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylast 
*qrylastset 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IM0W98ML</uniqueid>
		<timestamp>949586249</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkValue</objname>
		<parent>cntqpcheck</parent>
		<properties>Top = 0
Left = 153
Height = 23
Width = 321
FontBold = .T.
AutoSize = .F.
Alignment = 0
ZOrderSet = 0
_highlightself = .T.
Name = "chkValue"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K70UMCV3</uniqueid>
		<timestamp>949586249</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpcheck</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpcheck</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HB11EY28</uniqueid>
		<timestamp>949586333</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpidctlgrid</objname>
		<parent/>
		<properties>Width = 474
cqryparvarnmenabled = 
cqryparvarnmvalue = 
lnocheckonlostfocus = .F.
lqryparisrequired = .F.
nqryparid = 0
Name = "cntqpidctlgrid"
txtText.Height = 23
txtText.Left = 152
txtText.Top = 0
txtText.Width = 277
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 429
cmdShow.Picture = ..\graphic\comidctlgrid.bmp
cmdShow.TabStop = .T.
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 452
cmdClear.TabStop = .T.
cmdClear.Name = "cmdClear"
CmdTree.Top = 1
CmdTree.Left = 405
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected>cqryparvarnmenabled
cqryparvarnmvalue
lnocheckonlostfocus
lqryparisrequired
qrylast
qrylastset
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPIDCTLGRID.CHECKCORRECT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*26.05.2004 02:06 -&gt;Åñëè ðàçðåøåíî ïðîâåðÿòü êîððåêòíîñòü, íå âûáðàíî íå îäíîãî ýëåìåíòà ==&gt; Chk âûêëþ÷èì
IF	!.lNoCheckOnLostFocus AND ;
	.Value = 0

	*07.07.2005 14:01 -&gt;Åñëè îáÿçàòåëüíûé ïàðàìåòð âûáîðêè
	IF  .lQryParIsRequired
	
		*07.07.2005 14:02 -&gt;Âûâåäåì ñîîáùåíèå è ïðîñòàâèì òåêóùèå äàòû
		=MESSAGEBOX('Íåîáõîäèìî âûáðàòü ýëåìåíò èç ñïèñêà',48,'Ïàðàìåòð: '+This.chkQryParEnabled.Caption)
		*------------------------------------------------------------------------------
	
	ELSE
		
		*07.07.2005 15:45 -&gt;Îòêëþ÷èì ïàðàìåòð âûáîðêè
		.chkQryParEnabled.Value = 0
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************	
ENDPROC
PROCEDURE cmdClear.Click
*28.09.2005 09:53 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE cmdShow.Click
*28.09.2005 09:53 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParam_v1.vcx
* Class.Module....: CntQPSelCtlGrid.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nQryParID = tnQryParID

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*07.07.2005 11:45 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPSelCtlGrid
USE IN IIF(USED([lvQryParIdCtlPropByQryParID]),[lvQryParIdCtlPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParIdCtlPropByQryParID IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì è îáðàáàòûâàåì îáùèå ïàðàìåòðû ôèëüòðà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
* Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
*******************************************************************************

*25.05.2004 17:14 -&gt;Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
IF !EMPTY(lvQryParIdCtlPropByQryParID.RSAliasNM)
	
	*30.06.2005 16:38 -&gt;Ïàðàìåòðèçóåì ïðåäñòàâëåíèå äëÿ îáúåêòà (ïðè íåîáõîäèìîñòè)
	IF !EMPTY(lvQryParIdCtlPropByQryParID.RSAliasParamPropName)
		
		*30.06.2005 16:39 -&gt;Âû÷èñëÿåì çíà÷åíèå ïàðàìåòðà
		_PARAM = EVAL(lvQryParIdCtlPropByQryParID.RSAliasParamPropName)
		*------------------------------------------------------------------------------
		
		*30.06.2005 16:39 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â îòäåëüíîì Alias-e
		._RSAliasName = [_rs] + SYS(2015)
		***
		USE (lvQryParIdCtlPropByQryParID.RSAliasNM) IN 0 ALIAS (._RSAliasName)
		*------------------------------------------------------------------------------
		
	ELSE
		
		*30.06.2005 16:42 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â Alias-å ïî óìîë÷àíèþ
		._RSAliasName = ALLTRIM(lvQryParIdCtlPropByQryParID.RSAliasNM)
		***
		IF !USED(._RSAliasName)
			USE (._RSAliasName) IN 0
		ENDIF	
		*------------------------------------------------------------------------------		
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:47 -&gt;Çàïîëíÿåì îñòàëüíûå ñâîéñòâà îáúåêòà
IF !EMPTY(lvQryParIdCtlPropByQryParID.RSFieldNMID)
	._RSFieldNameID = ALLTRIM(lvQryParIdCtlPropByQryParID.RSFieldNMID)
ENDIF
***
IF !EMPTY(lvQryParIdCtlPropByQryParID.RSFieldNMText)
	._RSFieldNameText = ALLTRIM(lvQryParIdCtlPropByQryParID.RSFieldNMText)
ENDIF
***
IF !EMPTY(lvQryParIdCtlPropByQryParID.SelectObject)
	._SelectObject = ALLTRIM(lvQryParIdCtlPropByQryParID.SelectObject)
ENDIF
***
IF !EMPTY(lvQryParIdCtlPropByQryParID.ShowTextEmpty)
	._ShowTextEmpty = ALLTRIM(lvQryParIdCtlPropByQryParID.ShowTextEmpty)
ENDIF
*------------------------------------------------------------------------------

*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

*26.05.2004 02:25 -&gt;Ïðîâåðèì âñå ëè íåîáõîäèìûå äëÿ ðàáîòû ïàðàìåòðû çàïîëíåíû
IF	!EMPTY(._RSAliasName) AND ;
	!EMPTY(._RSFieldNameID) AND ;
	!EMPTY(._RSFieldNameText) AND ;
	!EMPTY(._SelectObject)
	*{
	.Refresh()
	*}
ELSE
	*{
	.SetEnabled(.F.)
	*}
ENDIF	
*------------------------------------------------------------------------------
.qrylast()
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPIDCTLGRID.LOSTFOCUS
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------

*26.05.2004 02:10 -&gt;Ïðîâåðèì êîððåêòíîñòü çàïîëíåíèÿ
This.CheckCorrect()
this.qrylastset()
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
	ELSE
		this.setvalue(VAL(lcQryParValue))
ENDIF
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
IF ISNULL(this.value)
		lcQryParValue = .null.
	ELSE
		lcQryParValue = STR(this.value,16,0)
ENDIF
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlGrid.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèÿ ïàðàìåòðà
		luQryParValue  = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.SetValue(luQryParValue)
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPIDCTLGRID.QUERYPARAMSET
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt;Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------
*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.Value,[]),[])
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE showselectobject
This.lNoCheckOnLostFocus = .T.
DODEFAULT()
This.lNoCheckOnLostFocus = .F.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ èìÿ âðåìåííîé òàáëèöû ñ âûáðàííûìè èäåíòèôèêàòîðàìè.
lnocheckonlostfocus &lt;protected/runtime&gt; Ôëàã, çàïðåùàþùèé ïðîâåðêó çíà÷åíèÿ êîððåêòíîñòè ïðè ïîòåðå îáúåêòîì ôîêóñà -  èñïîëüçóåòñÿ ïðè îòîáðàæåíèè îáúåêòà äëÿ âûáîðà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
nqryparid
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylast 
*qrylastset 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HB122CE0</uniqueid>
		<timestamp>949586333</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpidctlgrid</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CHKQRYPARENABLED._HANDLEANYCHANGE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:16 -&gt;Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.cmdShow.Enabled = .T.
	.Parent.cmdShow.SetFocus()
	.Parent.cmdClear.Enabled = .T.
	.Parent.txtText.Enabled = .T.
ELSE
	.Parent.cmdShow.Enabled = .F.
	.Parent.cmdClear.Enabled = .F.
	.Parent.txtText.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpidctlgrid</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NM105A5D</uniqueid>
		<timestamp>949586370</timestamp>
		<class>cntidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpidctltree</objname>
		<parent/>
		<properties>Width = 474
cqryparvarnmenabled = 
cqryparvarnmvalue = 
lqryparisrequired = .F.
_rsfieldnameimageindex = 
_rsfieldnameimageselectedindex = 
_rsfieldnameparentid = 
_rsfieldnameparentflag = 
_parentonly = .T.
lnocheckonlostfocus = .F.
nqryparid = 0
Name = "cntqpidctltree"
txtText.Height = 23
txtText.Left = 153
txtText.Top = 0
txtText.Width = 274
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 429
cmdShow.TabStop = .T.
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 452
cmdClear.TabStop = .T.
cmdClear.Name = "cmdClear"
CmdTree.Top = 0
CmdTree.Left = 406
CmdTree.Name = "CmdTree"
</properties>
		<protected>cqryparvarnmenabled
cqryparvarnmvalue
lqryparisrequired
lnocheckonlostfocus
qrylast
qrylastset
</protected>
		<methods>PROCEDURE checkcorrect
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.CheckCorrect
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*------------------------------------------------------------------------------
WITH This

*26.05.2004 02:06 -&gt; Åñëè ðàçðåøåíî ïðîâåðÿòü êîððåêòíîñòü, íå âûáðàíî íå îäíîãî ýëåìåíòà ==&gt; Chk âûêëþ÷èì
IF !.lNoCheckOnLostFocus AND ;
	.Value = 0

	*07.07.2005 14:01 -&gt; Åñëè îáÿçàòåëüíûé ïàðàìåòð âûáîðêè
	IF  .lQryParIsRequired

		*07.07.2005 14:02 -&gt; Âûâåäåì ñîîáùåíèå
		=MESSAGEBOX('Íåîáõîäèìî âûáðàòü ýëåìåíò äåðåâà',48,'Ïàðàìåòð: ' + This.chkQryParEnabled.Caption)
		*------------------------------------------------------------------------------
	
	ELSE
		
		*07.07.2005 15:45 -&gt; Îòêëþ÷èì ïàðàìåòð âûáîðêè
		.chkQryParEnabled.Value = 0
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE cmdClear.Click
*28.09.2005 09:53 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE cmdShow.Click
*28.09.2005 09:53 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: CntQPIDCtlTree.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà
*------------------------------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nQryParID = tnQryParID

*25.05.2004 17:00 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*07.07.2005 11:45 -&gt; Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt; Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPIDCtlTree
USE IN IIF(USED([lvQryParIdCtlTreePropByQryParID]),[lvQryParIdCtlTreePropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParIdCtlTreePropByQryParID IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt; Ñîõðàíÿåì è îáðàáàòûâàåì îáùèå ïàðàìåòðû ôèëüòðà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
* Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
*******************************************************************************

*25.05.2004 17:14 -&gt;Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSAliasNM)
	
	*30.06.2005 16:38 -&gt;Ïàðàìåòðèçóåì ïðåäñòàâëåíèå äëÿ îáúåêòà (ïðè íåîáõîäèìîñòè)
	IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSAliasParamPropName)
		
		*30.06.2005 16:39 -&gt;Âû÷èñëÿåì çíà÷åíèå ïàðàìåòðà
		_PARAM = EVAL(lvQryParIdCtlTreePropByQryParID.RSAliasParamPropName)
		*------------------------------------------------------------------------------
		
		*30.06.2005 16:39 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â îòäåëüíîì Alias-e
		._RSAliasName = [_rs] + SYS(2015)
		***
		USE (lvQryParIdCtlTreePropByQryParID.RSAliasNM) IN 0 ALIAS (._RSAliasName)
		*------------------------------------------------------------------------------
		
	ELSE
		
		*30.06.2005 16:42 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â Alias-å ïî óìîë÷àíèþ
		._RSAliasName = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSAliasNM)
		***
		IF !USED(._RSAliasName)
			USE (._RSAliasName) IN 0
		ENDIF	
		*------------------------------------------------------------------------------		
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:47 -&gt; Çàïîëíÿåì îñòàëüíûå ñâîéñòâà îáúåêòà
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMID)
	._RSFieldNameID = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMID)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMParentID)
	._RSFieldNameParentID = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMParentID)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMParentFlag)
	._RSFieldNameParentFlag = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMParentFlag)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMText)
	._RSFieldNameText = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMText)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMImageIndex)
	._RSFieldNameImageIndex = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMImageIndex)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.RSFieldNMImageSelectedIndex)
	._RSFieldNameImageSelectedIndex = ALLTRIM(lvQryParIdCtlTreePropByQryParID.RSFieldNMImageSelectedIndex)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.ParentOnly)
	._ParentOnly = lvQryParIdCtlTreePropByQryParID.ParentOnly
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.SelectObject)
	._SelectObject = ALLTRIM(lvQryParIdCtlTreePropByQryParID.SelectObject)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.ShowTextEmpty)
	._ShowTextEmpty = ALLTRIM(lvQryParIdCtlTreePropByQryParID.ShowTextEmpty)
ENDIF
***
IF !EMPTY(lvQryParIdCtlTreePropByQryParID.ShowTextNotFound)
	._ShowTextNotFound = ALLTRIM(lvQryParIdCtlTreePropByQryParID.ShowTextNotFound)
ENDIF
*------------------------------------------------------------------------------

*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

*26.05.2004 02:25 -&gt; Ïðîâåðèì âñå ëè íåîáõîäèìûå äëÿ ðàáîòû ïàðàìåòðû çàïîëíåíû
IF	!EMPTY(._RSAliasName) AND ;
	!EMPTY(._RSFieldNameID) AND ;
	!EMPTY(._RSFieldNameParentID) AND ;
	!EMPTY(._RSFieldNameParentFlag) AND ;
	!EMPTY(._RSFieldNameText) AND ;
	!EMPTY(._RSFieldNameImageIndex) AND ;
	!EMPTY(._RSFieldNameImageSelectedIndex) AND ;
	!EMPTY(._ParentOnly) AND ;	
	!EMPTY(._SelectObject)
	*{
	.Refresh()
	*}
ELSE
	*{
	.SetEnabled(.F.)
	*}
ENDIF	
*------------------------------------------------------------------------------
.qrylast()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.LostFocus
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*------------------------------------------------------------------------------

*26.05.2004 02:10 -&gt; Ïðîâåðèì êîððåêòíîñòü çàïîëíåíèÿ
This.CheckCorrect()
This.qrylastset()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
	ELSE
		this.setvalue(VAL(lcQryParValue))
ENDIF
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
lcQryParValue = STR(this.value,16,0)
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------


*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèå ïàðàìåòðà
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.SetValue(luQryParValue)
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------


ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.QueryParamSet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.Value,[]),[])
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE showselectobject
This.lNoCheckOnLostFocus = .T.
DODEFAULT()
This.lNoCheckOnLostFocus = .F.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ èìÿ âðåìåííîé òàáëèöû ñ âûáðàííûìè èäåíòèôèêàòîðàìè.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
_rsfieldnameimageindex
_rsfieldnameimageselectedindex
_rsfieldnameparentid
_rsfieldnameparentflag
_parentonly
lnocheckonlostfocus &lt;protected/runtime&gt; Ôëàã, çàïðåùàþùèé ïðîâåðêó çíà÷åíèÿ êîððåêòíîñòè ïðè ïîòåðå îáúåêòîì ôîêóñà -  èñïîëüçóåòñÿ ïðè îòîáðàæåíèè îáúåêòà äëÿ âûáîðà.
nqryparid
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylast 
*qrylastset 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NM115A4R</uniqueid>
		<timestamp>949586370</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpidctltree</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: chkQryParEnabled._HandleAnyChange
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:16 -&gt; Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.cmdShow.Enabled = .T.
	.Parent.cmdShow.SetFocus()
	.Parent.cmdClear.Enabled = .T.
	.Parent.txtText.Enabled = .T.
ELSE
	.Parent.cmdShow.Enabled = .F.
	.Parent.cmdClear.Enabled = .F.
	.Parent.txtText.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpidctltree</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586406</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqprange</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmenabled = 
cqryparvarnmsign = 
Name = "cntqprange"
</properties>
		<protected>cqryparvarnmvalue
cqryparvarnmsign
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.CheckCorrect
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:20 -&gt; Åñëè ïîëå ïóñòîå
IF	EMPTY(.Txt.Value) OR EMPTY(.cmbSign.Value)
	
	*21.07.2005 18:22 -&gt; Îòêëþ÷èì ôèëüòð
	.chkQryParEnabled.Value = 0
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------	
			
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This

*21.07.2005 18:16 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lnOldDecimals, ;
		lcDataType
***
lnOldDecimals = SET([DECIMALS])
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*22.07.2004 16:13 -&gt; Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPTXT
USE IN IIF(USED([lvQryParTXTPropByQryParID]),[lvQryParTXTPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParTXTPropByQryParID IN 0
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.cQryParVarNMSign	      = ALLTRIM(lvQryParByQryParId.QryParVarNMValue2)
*------------------------------------------------------------------------------

*25.07.2004 09:35 -&gt; Çàäà¸ì íà÷àëüíîå çíà÷åíèå òåêñòîâîãî ïîëÿ â çàâèñèìîñòè îò òèïà äàííûõ
lcDataType = UPPER(lvQryParTXTPropByQryParId.Type)
***
DO CASE
	CASE lcDataType = [C]
		*{
		.Txt.Value = SPACE(lvQryParTXTPropByQryParId.Width)
		*}
	CASE lcDataType = [I]
		*{
		SET DECIMALS TO 0
		***
		.Txt.Value = VAL(STRTRAN(SPACE(lvQryParTXTPropByQryParId.Width),[ ],[0]))
		***
		SET DECIMALS TO &amp;lnOldDecimals
		*}	
	CASE lcDataType = [N]
		*{
		SET DECIMALS TO lvQryParTXTPropByQryParId.Decimal
		***
		.Txt.Value = VAL(STRTRAN(SPACE(lvQryParTXTPropByQryParId.Width),[ ],[0]))
		***
		SET DECIMALS TO &amp;lnOldDecimals
		*}
	OTHERWISE
		*{
		.Txt.Value = SPACE(lvQryParTXTPropByQryParId.Width)
		*}
ENDCASE
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.LostFocus
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
This.CheckCorrect()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèå ïàðàìåòðîâ
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.Txt.Value = luQryParValue
		ENDIF
		*------------------------------------------------------------------------------		
	
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue2)
		***
		IF !ISNULL(luQryParValue)
			.cmbSign.Value = luQryParValue
		ENDIF
		*------------------------------------------------------------------------------		

	ENDIF
	*------------------------------------------------------------------------------


ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.QueryParamSet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*21.07.2005 18:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*21.07.2005 18:18 -&gt; Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.Txt.Value,[]))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMSign,IIF(.chkQryParEnabled.Value=1,.cmbSign.Value,[]))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà, â êîòîðîì çíà÷åíèå îãðàíè÷åíèÿ.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
cqryparvarnmsign çíàê îãðàíè÷åíèÿ
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>949586406</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqprange</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: chkQryParEnabled._HandleAnyChange
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:13 -&gt; Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îáúåêòîâ
IF .Value = 1
	.Parent.Txt.Enabled		= .T.
	.Parent.Txt.SetFocus()
	.Parent.cmbSign.Enabled = .T.
ELSE
	.Parent.Txt.Enabled		= .F.
	.Parent.cmbSign.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IM0Q45PH</uniqueid>
		<timestamp>949586406</timestamp>
		<class>cmb</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>combobox</baseclass>
		<objname>cmbSign</objname>
		<parent>cntqprange</parent>
		<properties>FontSize = 11
RowSourceType = 1
RowSource = "&gt;,&gt;=,=,#,&lt;=,&lt;"
FirstElement = 1
Height = 23
Left = 155
NumberOfElements = 0
Top = 0
Width = 57
ZOrderSet = 1
Name = "cmbSign"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KL13640C</uniqueid>
		<timestamp>949586406</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt</objname>
		<parent>cntqprange</parent>
		<properties>Format = "R"
Height = 23
Left = 212
Top = 0
Width = 261
ZOrderSet = 2
Name = "Txt"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqprange</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 11, 7, 17, 14, 40, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18T0ZZPE1</uniqueid>
		<timestamp>949586434</timestamp>
		<class>cntselctlgrid</class>
		<classloc>comselctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpselctlgrid</objname>
		<parent/>
		<properties>Width = 474
cqryparvarnmenabled = 
cqryparvarnmvalue = 
lnocheckonlostfocus = .F.
lqryparisrequired = .F.
Name = "cntqpselctlgrid"
txtText.Height = 23
txtText.Left = 153
txtText.Top = 0
txtText.Width = 273
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 428
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 451
cmdClear.Name = "cmdClear"
</properties>
		<protected>cqryparvarnmenabled
cqryparvarnmvalue
lqryparisrequired
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSELCTLGRID.CHECKCORRECT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*26.05.2004 02:06 -&gt;Åñëè ðàçðåøåíî ïðîâåðÿòü êîððåêòíîñòü
IF	!.lNoCheckOnLostFocus AND ;
	 .nSelectedItemCount = 0
	
	*07.07.2005 14:01 -&gt;Åñëè îáÿçàòåëüíûé ïàðàìåòð âûáîðêè
	IF  .lQryParIsRequired
	
		*07.07.2005 14:02 -&gt;Âûâåäåì ñîîáùåíèå è ïðîñòàâèì òåêóùèå äàòû
		=MESSAGEBOX('Íåîáõîäèìî âûáðàòü õîòÿ áû îäèí ýëåìåíò èç ñïèñêà',48,'Ïàðàìåòð: '+This.chkQryParEnabled.Caption)
		*------------------------------------------------------------------------------
	
	ELSE
		
		*07.07.2005 15:45 -&gt;Îòêëþ÷èì ïàðàìåòð âûáîðêè
		.chkQryParEnabled.Value = 0
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************	
ENDPROC
PROCEDURE cmdClear.Click
*28.09.2005 09:50 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE cmdShow.Click
*28.09.2005 09:50 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParam_v1.vcx
* Class.Module....: CntQPSelCtlGrid.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcRSFieldNameID
*------------------------------------------------------------------------------

*28.09.2005 09:46 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*07.07.2005 11:45 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPSelCtlGrid
USE IN IIF(USED([lvQryParSelCtlPropByQryParID]),[lvQryParSelCtlPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParSelCtlPropByQryParID IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì è îáðàáàòûâàåì îáùèå ïàðàìåòðû ôèëüòðà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
* Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
*******************************************************************************

*25.05.2004 17:14 -&gt;Ïîäãîòàâëèâàåì èñòî÷íèê äàííûõ äëÿ îáúåêòà
IF !EMPTY(lvQryParSelCtlPropByQryParID.RSAliasNM)
	
	*30.06.2005 16:38 -&gt;Ïàðàìåòðèçóåì ïðåäñòàâëåíèå äëÿ îáúåêòà (ïðè íåîáõîäèìîñòè)
	IF !EMPTY(lvQryParSelCtlPropByQryParID.RSAliasParamPropName)
		
		*30.06.2005 16:39 -&gt;Âû÷èñëÿåì çíà÷åíèå ïàðàìåòðà
		_PARAM = EVAL(lvQryParSelCtlPropByQryParID.RSAliasParamPropName)
		*------------------------------------------------------------------------------
		
		*30.06.2005 16:39 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â îòäåëüíîì Alias-e
		._RSAliasName = [_rs] + SYS(2015)
		***
		USE (lvQryParSelCtlPropByQryParID.RSAliasNM) IN 0 ALIAS (._RSAliasName)
		*------------------------------------------------------------------------------
		
	ELSE
		
		*30.06.2005 16:42 -&gt;Îòêðûâàåì ïðåäñòàâëåíèå â Alias-å ïî óìîë÷àíèþ
		._RSAliasName = ALLTRIM(lvQryParSelCtlPropByQryParID.RSAliasNM)
		***
		IF !USED(._RSAliasName)
			USE (._RSAliasName) IN 0
		ENDIF	
		*------------------------------------------------------------------------------		
		
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:47 -&gt;Çàïîëíÿåì îñòàëüíûå ñâîéñòâà îáúåêòà
IF !EMPTY(lvQryParSelCtlPropByQryParID.RSFieldNMID)
	._RSFieldNameID = ALLTRIM(lvQryParSelCtlPropByQryParID.RSFieldNMID)
ENDIF
***
IF !EMPTY(lvQryParSelCtlPropByQryParID.RSFieldNMText)
	._RSFieldNameText = ALLTRIM(lvQryParSelCtlPropByQryParID.RSFieldNMText)
ENDIF
***
IF !EMPTY(lvQryParSelCtlPropByQryParID.SelectObject)
	._SelectObject = ALLTRIM(lvQryParSelCtlPropByQryParID.SelectObject)
ENDIF
***
IF !EMPTY(lvQryParSelCtlPropByQryParID.ShowTextEmpty)
	._ShowTextEmpty = ALLTRIM(lvQryParSelCtlPropByQryParID.ShowTextEmpty)
ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:44 -&gt;Îáðàáàòûâàåì ñâîéñòâî SelectAllByDefault
IF lvQryParSelCtlPropByQryParID.SelectAllByDefault

	*23.05.2004 20:00 -&gt;Ñîçäàåì òàáëèöó äëÿ îáúåêòà
	.cSelectedItemTableNM = [_si] + SYS(2015)
	lcRSFieldNameID = ._RSFieldNameID
	SELECT &amp;lcRSFieldNameID AS ID FROM (._RSAliasName) INTO TABLE ([tmp\]+.cSelectedItemTableNM+[.dbf])
	*------------------------------------------------------------------------------
	
	*27.05.2004 14:09 -&gt;Ò.ê. ïðè ñîçäàíèè - îòêðûòà EXCLU - çàêðîåì òàáëèöó
	USE IN IIF(USED(.cSelectedItemTableNM),.cSelectedItemTableNM,0)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

*26.05.2004 02:25 -&gt;Ïðîâåðèì âñå ëè íåîáõîäèìûå äëÿ ðàáîòû ïàðàìåòðû çàïîëíåíû
IF	!EMPTY(._RSAliasName) AND ;
	!EMPTY(._RSFieldNameID) AND ;
	!EMPTY(._RSFieldNameText) AND ;
	!EMPTY(._SelectObject)
	*{
	.Refresh()
	*}
ELSE
	*{
	.SetEnabled(.F.)
	*}
ENDIF	
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSELCTLGRID.LOSTFOCUS
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------

*26.05.2004 02:10 -&gt;Ïðîâåðèì êîððåêòíîñòü çàïîëíåíèÿ
This.CheckCorrect()
*------------------------------------------------------------------------------

*28.09.2005 09:49 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.QUERYPARAMSET
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt;Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.cSelectedItemTableNM,[]),[TT])
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE showselectobject
This.lNoCheckOnLostFocus = .T.
DODEFAULT()
This.lNoCheckOnLostFocus = .F.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ èìÿ âðåìåííîé òàáëèöû ñ âûáðàííûìè èäåíòèôèêàòîðàìè.
lnocheckonlostfocus &lt;protected/runtime&gt; Ôëàã, çàïðåùàþùèé ïðîâåðêó çíà÷åíèÿ êîððåêòíîñòè ïðè ïîòåðå îáúåêòîì ôîêóñà -  èñïîëüçóåòñÿ ïðè îòîáðàæåíèè îáúåêòà äëÿ âûáîðà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18T0ZZPE1</uniqueid>
		<timestamp>949586434</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpselctlgrid</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CHKQRYPARENABLED._HANDLEANYCHANGE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:16 -&gt;Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.cmdShow.Enabled = .T.
	.Parent.cmdShow.SetFocus()
	.Parent.cmdClear.Enabled = .T.
	.Parent.txtText.Enabled = .T.
ELSE
	.Parent.cmdShow.Enabled = .F.
	.Parent.cmdClear.Enabled = .F.
	.Parent.txtText.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpselctlgrid</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586469</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpsumrange</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmvalue2 = 
cqryparvarnmenabled = 
lqryparisrequired = .F.
Name = "cntqpsumrange"
</properties>
		<protected>cqryparvarnmvalue
cqryparvarnmvalue2
lqryparisrequired
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSUMRANGE.CHECKCORRECT
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:49 -&gt;Åñëè îáà ïîëÿ íå ïóñòû è Start &gt; End ==&gt; ïîìåíÿåì ìåñòàìè
IF	.txtStartSum.Value &gt; .txtEndSum.Value
	
	*25.05.2004 17:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lnStartSum
	*------------------------------------------------------------------------------
			
	*25.05.2004 17:50 -&gt;Ïîìåíÿåì ìåñòàìè
	lnStartSum = .txtStartSum.Value
	.txtStartSum.Value = .txtEndSum.Value
	.txtEndSum.Value = lnStartSum
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSUMRANGE.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*------------------------------------------------------------------------------
LPARAMETERS tnQryParID

WITH This

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lnOldDecimals
***
lnOldDecimals = SET([DECIMALS])
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.cQryParVarNMValue2       = ALLTRIM(lvQryParByQryParId.QryParVarNMValue2)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------

*02.07.2007 10:36 -&gt; Âûñòàâèì çíà÷åíèÿ ïî óìîë÷àíèþ äëÿ ïîëåé
SET DECIMALS TO 2
***
.txtStartSum.Value = 0000000000.00
.txtEndSum.Value = 0000000000.00
***
SET DECIMALS TO &amp;lnOldDecimals
*------------------------------------------------------------------------------

*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSUMRANGE.LOSTFOCUS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
This.CheckCorrect()
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: CNTQPSUMRANGE.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue, ;
		luQryParValue2
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèÿ ïàðàìåòðà
		luQryParValue  = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		luQryParValue2 = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue2)
		***
		IF !ISNULL(luQryParValue)
			.txtStartSum.Value = luQryParValue
		ENDIF
		***
		IF !ISNULL(luQryParValue2)
			.txtEndSum.Value = luQryParValue2
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPSUMRANGE.QUERYPARAMSET
* Called by.......: &lt;tcQryParSID&gt;
* Parameters......: &lt;tn&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt;Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.txtStartSum.Value,NTOM(0)))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue2,IIF(.chkQryParEnabled.Value=1,.txtEndSum.Value,NTOM(0)))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
cqryparvarnmvalue2 &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ êîíå÷íàÿ äàòà ïåðèîäà.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>949586469</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpsumrange</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CHKQRYPARENABLED._HANDLEANYCHANGE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:16 -&gt;Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.lblFrom.Enabled = .T.
	.Parent.txtStartSum.Enabled = .T.
	.Parent.txtStartSum.SetFocus()
	.Parent.lblTo.Enabled = .T.
	.Parent.txtEndSum.Enabled = .T.
ELSE
	.Parent.lblFrom.Enabled = .F.
	.Parent.txtStartSum.Enabled = .F.
	.Parent.lblTo.Enabled = .F.
	.Parent.txtEndSum.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18T0ZZPE1</uniqueid>
		<timestamp>949586469</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFrom</objname>
		<parent>cntqpsumrange</parent>
		<properties>FontBold = .T.
Caption = "ñ"
Left = 157
Top = 4
ZOrderSet = 1
Name = "lblFrom"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCY</uniqueid>
		<timestamp>949586469</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblTo</objname>
		<parent>cntqpsumrange</parent>
		<properties>FontBold = .T.
Caption = "ïî"
Left = 314
Top = 4
ZOrderSet = 3
Name = "lblTo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586469</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtStartSum</objname>
		<parent>cntqpsumrange</parent>
		<properties>Format = "R"
Height = 23
Left = 166
Top = 0
Width = 144
Name = "txtStartSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_24G0MHKEE</uniqueid>
		<timestamp>949586469</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtEndSum</objname>
		<parent>cntqpsumrange</parent>
		<properties>Format = "R"
Left = 329
Top = 0
Width = 144
Name = "txtEndSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpsumrange</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586485</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqptop100</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmenabled = 
Name = "cntqptop100"
</properties>
		<protected>cqryparvarnmvalue
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.CheckCorrect
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:20 -&gt; Åñëè ïîëå ïóñòîå
IF	EMPTY(.cmbOrder.Value)
	
	*21.07.2005 18:22 -&gt; Îòêëþ÷èì ôèëüòð
	.chkQryParEnabled.Value = 0
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------	
			
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This

*21.07.2005 18:16 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.LostFocus
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
This.CheckCorrect()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèå ïàðàìåòðà
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.cmbOrder.Value = VAL(luQryParValue)
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------


ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.QueryParamSet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*21.07.2005 18:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*21.07.2005 18:18 -&gt; Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,VAL(.cmbOrder.Value),0))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>949586485</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqptop100</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: chkQryParEnabled._HandleAnyChange
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:13 -&gt; Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îáúåêòîâ
IF .Value = 1
	.Parent.cmbOrder.Enabled = .T.
	.Parent.cmbOrder.SetFocus()
ELSE
	.Parent.cmbOrder.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IM0Q45PH</uniqueid>
		<timestamp>949586485</timestamp>
		<class>cmb</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>combobox</baseclass>
		<objname>cmbOrder</objname>
		<parent>cntqptop100</parent>
		<properties>BoundColumn = 2
ColumnCount = 2
ColumnWidths = "170,0"
RowSourceType = 1
RowSource = "MAX ïî ñóììå,1,MAX ïî êîëè÷åñòâó,2,MIN ïî ñóììå,3,MIN ïî êîëè÷åñòâó,4"
FirstElement = 1
Height = 23
ColumnLines = .F.
Left = 154
NumberOfElements = 0
Top = 0
Width = 320
Name = "cmbOrder"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqptop100</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>949586503</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqptxt</objname>
		<parent/>
		<properties>Width = 474
Height = 25
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmenabled = 
Name = "cntqptxt"
</properties>
		<protected>cqryparvarnmvalue
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.CheckCorrect
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:20 -&gt; Åñëè ïîëå ïóñòîå
IF	EMPTY(.Txt.Value)
	
	*21.07.2005 18:22 -&gt; Îòêëþ÷èì ôèëüòð
	.chkQryParEnabled.Value = 0
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------	
			
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE getcardcode
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

*--ïðîâåðèì, íå çàáëîêèðîâàí ëè ââîä
IF thisform.lReadOnly
	MESSAGEBOX([Èçìåíåíèå äàííûõ ìåíåäæåðîì íå ïðåäóñìîòðåíî.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.cntCltID.SetValue(lvCardViewByCardCode.CltID)
		.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð VIP êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspCltSAccID WITH lvCardViewByCardCode.CardID
				
		*--Äîáàâèì âîçìîæíîñòü âûáðàòü òèï îïëàòû VIP êàðòîé
		thisform.addVIP()
	ENDIF
	thisform.cmdpay.Click()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This

*21.07.2005 18:16 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lnOldDecimals, ;
		lcDataType
***
lnOldDecimals = SET([DECIMALS])
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*22.07.2004 16:13 -&gt; Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPTXT
USE IN IIF(USED([lvQryParTXTPropByQryParID]),[lvQryParTXTPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParTXTPropByQryParID IN 0
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
*------------------------------------------------------------------------------

*25.07.2004 09:35 -&gt; Çàäà¸ì íà÷àëüíîå çíà÷åíèå òåêñòîâîãî ïîëÿ â çàâèñèìîñòè îò òèïà äàííûõ
lcDataType = UPPER(lvQryParTXTPropByQryParId.Type)
***
DO CASE
	CASE lcDataType = [C]
		*{
		.Txt.Value = SPACE(lvQryParTXTPropByQryParId.Width)
		*}
	CASE lcDataType = [I]
		*{
		SET DECIMALS TO 0
		***
		.Txt.Value = VAL(STRTRAN(SPACE(lvQryParTXTPropByQryParId.Width),[ ],[0]))
		***
		SET DECIMALS TO &amp;lnOldDecimals
		*}	
	CASE lcDataType = [N]
		*{
		SET DECIMALS TO lvQryParTXTPropByQryParId.Decimal
		***
		.Txt.Value = VAL(STRTRAN(SPACE(lvQryParTXTPropByQryParId.Width),[ ],[0]))
		***
		SET DECIMALS TO &amp;lnOldDecimals
		*}
	OTHERWISE
		*{
		.Txt.Value = SPACE(lvQryParTXTPropByQryParId.Width)
		*}
ENDCASE
*------------------------------------------------------------------------------

*21.07.2005 18:16 -&gt; Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.LostFocus
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
This.CheckCorrect()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPIDCtlTree.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèå ïàðàìåòðà
		luQryParValue = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.Txt.Value = luQryParValue
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------


ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPTXT.QueryParamSet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*21.07.2005 18:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*21.07.2005 18:18 -&gt; Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.Txt.Value,[]))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*getcardcode 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>949586503</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqptxt</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: chkQryParEnabled._HandleAnyChange
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*21.07.2005 18:13 -&gt; Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îáúåêòîâ
IF .Value = 1
	.Parent.Txt.Enabled = .T.
	.Parent.Txt.SetFocus()	
	.Parent.olecommprox1._open()
ELSE
	.Parent.Txt.Enabled = .F.
	.Parent.olecommprox1._close()
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KL13640C</uniqueid>
		<timestamp>949586503</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt</objname>
		<parent>cntqptxt</parent>
		<properties>Format = "R"
Height = 23
Left = 155
Top = 0
Width = 318
Name = "Txt"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2710K3J64</uniqueid>
		<timestamp>927156947</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>cntqptxt</parent>
		<properties>Top = 8
Left = 8
Height = 16
Width = 38
ZOrderSet = 37
lautosave = .F.
cbindobj = this.parent.txt
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	*------------------------------------------------------------------------------

	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
*	This.Parent.GetCardInfo(lcMsg)
	this.Parent.txt.Value=lcMsg
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAtcA3GpsgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqptxt</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N0ZT8IA</uniqueid>
		<timestamp>949586528</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmidctltree</objname>
		<parent/>
		<properties>DataSession = 1
Height = 322
Width = 512
DoCreate = .T.
AutoCenter = .T.
Caption = "Âûáîð ãðóïïû"
Icon = ..\graphic\frmidctltree.ico
Name = "frmidctltree"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: GLOBAL.PJX
* Library.........: COMCTL_V1.VCX
* Class.Module....: FRMCALENDAR._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;.cntCancelSaveRetValEval.CmdOk.Click();.cntCancelSaveRetValEval.CmdCancel.Click()&gt;
* Parameters......: &lt;tcMsg&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ôîðìèðîâàíèå çíà÷åíèÿ .uRetVal.
*-------------------------------------------------------
LPARAMETERS	tcMsg

WITH This

*15.01.2004 16:46 -&gt;Ïðè ñîõðàíåíèè óêàçûâàåì â uRetVal íîìåð ñòðîêè â may_base.
IF tcMsg=[OK]
	.uRetVal = ThisForm.oleTreeView.nValue
	.Hide()
ELSE
	.uRetVal = .F.
	.Hide()
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: COMIDCTL_V1.VCX
* Class.Module....: FRMIDCTLTREE.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;toParentObject, toParentForm&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;sysevent&gt; Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS	toParentObject, ;
			toParentForm

*01.04.2004 12:29 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

*01.04.2004 11:27 -&gt;Óñòàíîâèì ñåññèþ äàííûõ
IF TYPE([toParentForm.DataSessionId])==[N]
	SET DATASESSION TO toParentForm.DataSessionId
ENDIF	
*------------------------------------------------------------------------------

*08.11.2005 17:31 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvBmpsList IN 0
*------------------------------------------------------------------------------

*08.11.2005 17:31 -&gt; Ïåðåäàåì ïàðàìåòðû âûçûâàþùåãî îáúåêòà äåðåâó
ThisForm.oleTreeView._RSAliasName = toParentObject._RSAliasName
ThisForm.oleTreeView._RSFieldNameID = toParentObject._RSFieldNameID
ThisForm.oleTreeView._RSFieldNameParentID = toParentObject._RSFieldNameParentID
ThisForm.oleTreeView._RSFieldNameParentFlag = toParentObject._RSFieldNameParentFlag
ThisForm.oleTreeView._RSFieldNameText = toParentObject._RSFieldNameText
ThisForm.oleTreeView._RSFieldNameImageIndex = toParentObject._RSFieldNameImageIndex
ThisForm.oleTreeView._RSFieldNameImageSelectedIndex = toParentObject._RSFieldNameImageSelectedIndex
ThisForm.oleTreeView._ParentOnly = toParentObject._ParentOnly
*------------------------------------------------------------------------------

*01.04.2004 11:28 -&gt;Âûçîâåì èíèöèàëèçàöèþ äåðåâà
ThisForm.oleTreeView.Init(.T.)
*------------------------------------------------------------------------------

*01.04.2004 11:28 -&gt;Ïåðåéäåì íà ýëåìåíò ñ èäåíòèôèêàòîðîì, ïåðåäàííûì â êà÷åñòâå ïàðàìåòðà
IF TYPE([toParentObject.Value])==[N]
	ThisForm.oleTreeView.OperateSelect(toParentObject.Value)
ENDIF	
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0OPN39</uniqueid>
		<timestamp>949586528</timestamp>
		<class>oleimagelist</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Oleimagelist</objname>
		<parent>frmidctltree</parent>
		<properties>Top = 185
Left = 37
Height = 100
Width = 100
ZOrderSet = 3
Name = "Oleimagelist"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALBHwSjGpsgBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PjdpYap0bEK/AQhAQKo2nIUM0EggAAADtAwAA7QMAAIB+4eYCAAUAIAAAAAAAAADAwMAA//8AAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIADmjgAAAAAAAGyOAAAAAAAA6I8AAAAAAABojwAAAAAAAOqQAAAAAAAAcJAAAAAAAAABAACAAAAAAHqSAAAAAAAADJQAAAAAAACElAAAAAAAAAKVAAAAAAAAjJUAAAAAAAAElwAAAAAAAASWAAAAAAAAqEocAAYAAAD/////BQAAgAAAAAAAAAAAAAAAAAAAAAAImgAAAAAAAIiZAAAAAAAAjJoAAAAAAACyNQAAAAAAAJacAAAAAAAATIMAAAAAAAAEmwAAAAAAABCdAAAAAAAAkFgAAAAAAACYPQAAAAAAAI6dAAAAAAAAGp4AAAAAAABYiwAAAAAAAPCLAAAAAAAAHDcAAAAAAACkNgAAAAAAAOYdAAAAAAAA3jgAAAAAAABqOQAAAAAAAAo6AAAAAAAAtjoAAAAAAACAjQAAAAAAAF47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1570UBSIO</uniqueid>
		<timestamp>949586528</timestamp>
		<class>oletreeview</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>oleTreeView</objname>
		<parent>frmidctltree</parent>
		<properties>Top = 0
Left = 0
Height = 288
Width = 510
TabIndex = 1
ZOrderSet = 4
_imagelistobject = .parent.Oleimagelist.object
_imgalias = lvBmpsList
_imgfieldnameindex = BmpID
_imgfieldnamefilename = BmpFileNM
Name = "oleTreeView"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: GLOBAL.PJX
* Library.........: COMCTL_V1.VCX
* Class.Module....: OLETREEVIEW.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tlAllowInit&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîçäíÿÿ èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tlAllowInit
			
*15.01.2004 14:30 -&gt;Åñëè ïàðàìåòð ïåðåäàí - âûïîëíÿåì èíèöèàëèçàöèþ
IF PCOUNT()=1 AND TYPE([tlAllowInit])==[L] AND tlAllowInit
	DODEFAULT()
ENDIF
*------------------------------------------------------------------------------
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALBHwSjGpsgBAwAAAEACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZgAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+i6BMHCoUbEK/AQhAQKo2nIUM0EggAAAC2NAAAxB0AAI5+4eYCAAUAIgAAAH0gaWaNAQAAAQAAAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAAAAYAAAAAAAAABQAAgOzpEgABAAAAXAAf3uy9AQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAHAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N10O0O9</uniqueid>
		<timestamp>949586528</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled</objname>
		<parent>frmidctltree</parent>
		<properties>Top = 295
Left = 306
ZOrderSet = 5
Name = "Cntcancelsavehandled"
CMDCANCEL.Name = "CMDCANCEL"
CMDOK.Name = "CMDOK"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmidctltree</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>959144781</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpbott</objname>
		<parent/>
		<properties>Width = 474
Height = 27
BorderWidth = 0
cqryparvarnmvalue = 
lqryparisrequired = .F.
cqryparvarnmenabled = 
nqryparid = 0
Name = "cntqpbott"
</properties>
		<protected>cqryparvarnmvalue
lqryparisrequired
cqryparvarnmenabled
qrylastset
</protected>
		<methods>PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nQryParID = tnQryParID

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcRSFieldNameID
*------------------------------------------------------------------------------

*07.07.2005 11:45 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì ïàðàìåòðû ôèëüòðà cntQPCheck
USE IN IIF(USED([lvQryParCheckPropByQryParID]),[lvQryParCheckPropByQryParID],0)
***
_PARAM = tnQryParID
USE lvQryParCheckPropByQryParID IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì è îáðàáàòûâàåì îáùèå ïàðàìåòðû ôèëüòðà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
	ELSE
	.qrylast()
ENDIF
*------------------------------------------------------------------------------


ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE LostFocus
DODEFAULT()
this.QryLastSet()

ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
	ELSE
		this.chkQryParEnabled.Value = VAL(lcQryParValue)
ENDIF
*------------------------------------------------------------------------------


ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue

lcQryParValue = ALLTRIM(STR(this.chkQryParEnabled.Value,10,0))

_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPCheck.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.QUERYPARAMSET
* Called by.......: &lt;tcQryParSID&gt;
* Parameters......: &lt;tn&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This
*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
cqryparvarnmenabled
nqryparid
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylastset 
*qrylast 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K70UMCV3</uniqueid>
		<timestamp>959144781</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpbott</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 468
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpbott</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U12VKCQ</uniqueid>
		<timestamp>961302871</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqueryparam</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
Name = "cntqueryparam"
</properties>
		<protected/>
		<methods>PROCEDURE Destroy
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQueryParam.Destroy
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå îáúåêòà
*------------------------------------------------------------------------------

*09.11.2005 15:23 -&gt; Óäàëÿåì ñåññèþ ïàðàìåòðîâ
This.QueryParamUnSet()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQUERYPARAM.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîçäàíèå èäåíòèôèêàòîðà ñåññèè ïàðàìåòðîâ.
*-------------------------------------------------------

*26.05.2004 20:35 -&gt;Ñîçäàíèå èäåíòôèôêàòîðà ñåññèè ïàðàìåòðîâ
This.cQryParSID = SYS(2015)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************


ENDPROC
PROCEDURE paramobjectcreate
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQUERYPARAM.PARAMOBJECTCREATE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;teParentObjectType, tnParentObjectID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîçäàíèå (çàãðóçêà) îáúåêòîâ äëÿ ââîäà ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	teParentObjectType,tnParentObjectID

WITH This

*25.05.2004 22:34 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcOldClassLib, ;
		lnPQObjectCounter, ;
		lnPQObjectLastBottom, ;
		lcObjName, ;
		lcClassName, ;
		lcLibName, ;
		lcLibAlias, ;
		llLibLoad, ;
		lnDeltaHeight
***
lcOldClassLib = SET([CLASSLIB])
lnPQObjectCounter = 0
lnPQObjectLastBottom = 0
lnDeltaHeight = 0
*------------------------------------------------------------------------------

*25.05.2004 21:30 -&gt;Â çàâèñèìîñòè îò òèïà îáúåêòîâ (íà ýòàïå íàïèñàíèÿ ìåòîäà SrcFrm èëè Report) - ðàçíûå LV
DO CASE

	CASE teParentObjectType = __QPOTYPE_SCRFRM
	
		*25.05.2004 21:36 -&gt;Îòêðûâàåì Alias äëÿ ñïèñêà ïàðàìåòðîâ, îòôèëüòðîâàííûé ïî ýêðàííîé ôîðìå
		USE IN IIF(USED([lvQryParList]),[lvQryParList],0)
		***
		_PARAM = tnParentObjectID
		USE lvQryParListByScrFrm IN 0 ALIAS lvQryParList
		*------------------------------------------------------------------------------
	
	CASE teParentObjectType = __QPOTYPE_REPORT
		
		*25.05.2004 22:31 -&gt;Îòêðûâàåì Alias äëÿ ñïèñêà ïàðàìåòðîâ, îòôèëüòðîâàííûé ïî îò÷åòó
		USE IN IIF(USED([lvQryParList]),[lvQryParList],0)
		***
		_PARAM = tnParentObjectID
		USE lvQryParListByRpt IN 0 ALIAS lvQryParList
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------	

*25.05.2004 22:34 -&gt;Ïîäãðóæàåì îáúåêòû
SELECT lvQryParList
SCAN ALL

	*25.05.2004 22:40 -&gt;Ñôîðìèðóåì èìåíÿ êëàññà îáúåêà, èìÿ áèáëèîòåêè, èìÿ îáúåêòà
	lnPQObjectCounter = lnPQObjectCounter + 1
	***
	lcObjName	= [PQObject]+ALLTRIM(STR(lnPQObjectCounter))
	lcClassName = IIF([;]$lvQryParList.QryParTypeObjDesc, ;
						ALLTRIM(SUBSTR(lvQryParList.QryParTypeObjDesc,1,AT([;],lvQryParList.QryParTypeObjDesc)-1)), ;
						ALLTRIM(lvQryParList.QryParTypeObjDesc))
	lcLibName 	= IIF([;]$lvQryParList.QryParTypeObjDesc, ;
						ALLTRIM(SUBSTR(lvQryParList.QryParTypeObjDesc,AT([;],lvQryParList.QryParTypeObjDesc)+1)), ;
						[])
	*------------------------------------------------------------------------------
	
	*25.05.2004 23:02 -&gt;Åñëè óêàçàíà áèáëèîòåêà ðàñïîëîæåíèÿ îáúåêòà - óáåäèìñÿ â çàãðóçêå áèáëèîòåêè
	IF !EMPTY(lcLibName)
		
		*25.05.2004 22:50 -&gt;Çàãðóçèì áèáëèîòåêó
		lcLibAlias  = [_SL_]+lcLibName
		***
		IF !(lcLibAlias$SET([CLASSLIB]))
			SET CLASSLIB TO (lcLibName) ALIAS (lcLibAlias) ADDITIVE
			llLibLoad = .T.
		ELSE
			llLibLoad = .F.	
		ENDIF
		***
		lcClassName = lcLibAlias+[.]+lcClassName
		*------------------------------------------------------------------------------
	
	ENDIF
	*------------------------------------------------------------------------------
		
	*25.05.2004 22:59 -&gt;Äîáàâèì îáúåêò
	.AddObject(lcObjName,lcClassName,lvQryParList.QryParID)
	*------------------------------------------------------------------------------
	
	*25.05.2004 23:05 -&gt;Åñëè çàãðóæàëè áèáëèîòåêó - âûãðóçèì	
	IF llLibLoad
		RELEASE CLASSLIB ALIAS (lcLibAlias)
		***
		IF SET([CLASSLIB])#lcOldClasslib &amp;&amp;òàêîå ïðîèñõîäèò, êîãäà çàíóæàåòñÿ óæå çàãðóæåííàÿ áèáëèîòåêà â äðóãîé Alias
			SET CLASSLIB TO &amp;lcOldClasslib
		ENDIF		
	ENDIF
	*------------------------------------------------------------------------------
	
	*25.05.2004 23:00 -&gt;Íàñòðîèì îòîáðàæåíèå îáúåêòà
	lcObjName = [.]+lcObjName
	***
	&amp;lcObjName..Top  = lnPQObjectLastBottom
	lnPQObjectLastBottom = lnPQObjectLastBottom + &amp;lcObjName..Height + 1
	***
	&amp;lcObjName..Visible = .T.
	*------------------------------------------------------------------------------
	
	*25.05.2004 22:35 -&gt;Óáåäèìñÿ ÷òî âûáðàí íóæíûé Alias
	SELECT lvQryParList
	*------------------------------------------------------------------------------

ENDSCAN
*------------------------------------------------------------------------------

*11.05.2005 16:07 -&gt;Èçìåíèì âûñîòó êîíòåéíåðà
.Height = IIF(lnPQObjectLastBottom&gt;0,lnPQObjectLastBottom-1,0)
*------------------------------------------------------------------------------

*11.05.2005 16:02 -&gt;Âûçîâåì ïîëüçîâàòåëüñêóþ îáðàáîòêó èçìåíåíèÿ ðàçìåðîâ êîíòåéíåðà
._HandleCntHeightChange(.Height)
*------------------------------------------------------------------------------


ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE paramobjectcreatehidden
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQueryParam.ParamObjectCreateHidden
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcVarName,tuVarValue&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîçäàíèå (çàãðóçêà) ñêðûòûõ îáúåêòîâ äëÿ ïåðåäà÷è ïàðàìåòðîâ âûáîðêè
*-------------------------------------------------------
LPARAMETERS	tcVarName,tuVarValue

WITH This

*25.05.2004 22:34 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcOldClassLib, ;
		llLibLoad
***
lcOldClassLib = SET([CLASSLIB])
*------------------------------------------------------------------------------
		
*25.05.2004 22:50 -&gt;Çàãðóçèì áèáëèîòåêó
IF !([_SL_QUERYPARAMIO_V1]$SET([CLASSLIB]))
	SET CLASSLIB TO QueryParamIO_v1 ALIAS _SL_QUERYPARAMIO_V1 ADDITIVE
	llLibLoad = .T.
ELSE
	llLibLoad = .F.	
ENDIF
*------------------------------------------------------------------------------

*25.05.2004 22:59 -&gt;Äîáàâèì îáúåêò
.AddObject(SYS(2015),[_SL_QUERYPARAMIO_V1.cstQPHidden],tcVarName,tuVarValue)
*------------------------------------------------------------------------------
	
*25.05.2004 23:05 -&gt;Åñëè çàãðóæàëè áèáëèîòåêó - âûãðóçèì	
IF llLibLoad
	RELEASE CLASSLIB ALIAS _SL_QUERYPARAMIO_V1
	***
	IF SET([CLASSLIB])#lcOldClasslib &amp;&amp;òàêîå ïðîèñõîäèò, êîãäà çàíóæàåòñÿ óæå çàãðóæåííàÿ áèáëèîòåêà â äðóãîé Alias
		SET CLASSLIB TO &amp;lcOldClasslib
	ENDIF		
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE paramobjectremove
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQUERYPARAM.PARAMOBJECTREMOVE
* Called by.......: &lt;Ext Calls&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå îáúåêòîâ êîíòåéíåðà.
*-------------------------------------------------------
WITH This

*11.05.2005 16:23 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnOldHeight
***
lnOldHeight = .Height
*------------------------------------------------------------------------------

*26.05.2004 01:16 -&gt;Óäàëÿåì âñå îáúåêòû
FOR lnControlCounter = .ControlCount TO 1 STEP -1
	IF	UPPER(.Controls(lnControlCounter).Class) # [CSTQPHIDDEN] AND ;
		UPPER(.Controls(lnControlCounter).Class) # [SHP]
		***
		.RemoveObject(.Controls(lnControlCounter).Name)
		***
	ENDIF
ENDFOR
*------------------------------------------------------------------------------

*11.05.2005 16:24 -&gt;Èçìåíèì ðàçìåð êîíòåéíåðà
.Height = 0
*------------------------------------------------------------------------------

*11.05.2005 16:02 -&gt;Âûçîâåì ïîëüçîâàòåëüñêóþ îáðàáîòêó èçìåíåíèÿ ðàçìåðîâ êîíòåéíåðà
._HandleCntHeightChange(-lnOldHeight)
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQueryParam.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèé ïàðàìåòðîâ èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
WITH This

*26.05.2004 20:27 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	loObject
*------------------------------------------------------------------------------

*26.05.2004 20:27 -&gt; Âûïîëíÿåì îäíîèìåííûé ìåòîä äëÿ âñåõ îáúåêòîâ äëÿ ïîëó÷åíèÿ ïàðàìåòðîâ
FOR EACH loObject IN .Controls
	IF PEMSTATUS(loObject,[QueryParamGet],5)
		loObject.QueryParamGet(.cQryParSID)
	ENDIF
ENDFOR
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQUERYPARAM.QUERYPARAMSET
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðîâ â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
WITH This

*26.05.2004 20:27 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	loObject
*------------------------------------------------------------------------------

*26.05.2004 20:27 -&gt;Âûïîëíÿåì îäíîèìåííûé ìåòîä äëÿ âñåõ îáúåêòîâ äëÿ ââîäà ïàðàìåòðîâ
FOR EACH loObject IN .Controls
	IF PEMSTATUS(loObject,[QueryParamSet],5)
		loObject.QueryParamSet(.cQryParSID)
	ENDIF
ENDFOR
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE queryparamunset
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQueryParam.QueryParamUnSet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå ñåññèè ïàðàìåòðîâ
*------------------------------------------------------------------------------

*27.05.2004 18:42 -&gt;Óäàëèì àññîöèèðîâàííóþ îáúåêòîì ñåññèþ äàííûõ
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSessionDestroy(This.cQryParSID)
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>cqryparsid &lt;public/runtime&gt; Èäåíòèôèêàòîð ñåññèè ïàîàìåòðîâ.
*paramobjectcreate &lt;public/nouser/default&gt; Ñîçäàíèå îáúåêòîâ äëÿ ââîäà ïàðàìåòðîâ ôèëüòðà.
*paramobjectremove &lt;public/nouser/default&gt; Óäàëåíèå îáúåêòîâ äëÿ ââîäà ïàðàìåòðîâ ôèëüòðà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*paramobjectcreatehidden 
*_handlecntheightchange Ïîëüçîâàòåëüñêàÿ îáðàáîòêà èçìåíåíèÿ ðàçìåðîâ êîíòåéíåðà
*queryparamunset &lt;public/nouser/default&gt; Óäàëåíèå ñåññèè ïàðàìåòðîâ èç ìåíåäæåðà ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèé ïàðàìåòðîâ èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\qryparparobjtypes.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqueryparam</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>961972672</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpdate</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmvalue2 = 
cqryparvarnmenabled = 
lqryparisrequired = .F.
nqryparid = 0
Name = "cntqpdate"
</properties>
		<protected>cqryparvarnmvalue
cqryparvarnmvalue2
lqryparisrequired
qrylast
qrylastset
</protected>
		<methods>PROCEDURE checkcorrect
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDate.CheckCorrect
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*------------------------------------------------------------------------------
WITH This

*09.03.2006 17:14 -&gt; Åñëè îáà ïîëÿ ïóñòû
IF	EMPTY(.cntTxtCtlCalendarDate.txtText.Value)
	
	*09.03.2006 17:14 -&gt; Åñëè îáÿçàòåëüíûé ïàðàìåòð âûáîðêè
	IF  .lQryParIsRequired
	
		*09.03.2006 17:14 -&gt; Âûâåäåì ñîîáùåíèå è ïðîñòàâèì òåêóùèå äàòû
		=MESSAGEBOX('Íåîáõîäèìî âûáðàòü äàòó',48,'Ïàðàìåòð: '+This.chkQryParEnabled.Caption)
		.cntTxtCtlCalendarDate.txtText.Value = DATE()
		*------------------------------------------------------------------------------
	
	ELSE
		
		*09.03.2006 17:15 -&gt; Îòêëþ÷èì ôèëüòð
		.chkQryParEnabled.Value = 0
		*------------------------------------------------------------------------------
	
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDate.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*------------------------------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nQryParID = tnQryParID

*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*09.03.2006 17:12 -&gt; Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------
.qrylast()
*------------------------------------------------------------------------------

*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDate.LostFocus
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*------------------------------------------------------------------------------
This.CheckCorrect()
this.qrylastset()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
		*09.03.2006 17:13 -&gt; Âûñòàâèì ïî óìîë÷àíèþ òåêóùóþ äàòó â îáîèõ ïîëÿõ
		.cntTxtCtlCalendarDate.txtText.Value = DATE()
	ELSE
		.cntTxtCtlCalendarDate.txtText.Value = CTOD(ALLTRIM(lcQryParValue))
ENDIF
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
lcQryParValue = DTOC(this.cntTxtCtlCalendarDate.txtText.Value)

_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDate.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.03.2006 17:09 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.03.2006 17:10 -&gt; Ñ÷èòàåì çíà÷åíèÿ ïàðàìåòðà
		luQryParValue  = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		***
		IF !ISNULL(luQryParValue)
			.cntTxtCtlCalendarDate.txtText.Value = luQryParValue
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDate.QueryParamSet
* Called by.......: &lt;tcQryParSID&gt;
* Parameters......: &lt;tn&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt;Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*09.03.2006 17:10 -&gt; Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.cntTxtCtlCalendarDate.txtText.Value,CTOD([])))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
cqryparvarnmvalue2 &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ êîíå÷íàÿ äàòà ïåðèîäà.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ àêòèâíîñòè ïàðàìåòðà âûáîðêè
nqryparid
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylast 
*qrylastset 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>949586268</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpdate</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: chkQryParEnabled._HandleAnyChange
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*09.03.2006 17:20 -&gt; Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.cntTxtCtlCalendarDate.SetEnabled(.T.)
	.Parent.cntTxtCtlCalendarDate.SetFocus()
ELSE
	.Parent.cntTxtCtlCalendarDate.SetEnabled(.F.)
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCF</uniqueid>
		<timestamp>949586268</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCtlCalendarDate</objname>
		<parent>cntqpdate</parent>
		<properties>Top = 0
Left = 152
ZOrderSet = 2
Name = "cntTxtCtlCalendarDate"
TXTTEXT.Name = "TXTTEXT"
CMDSHOW.Name = "CMDSHOW"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2HS10XP78</uniqueid>
		<timestamp>961972672</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdToday</objname>
		<parent>cntqpdate</parent>
		<properties>Top = -1
Left = 374
Height = 25
Caption = "\&lt;Ñåãîäíÿ"
Name = "cmdToday"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.cntTxtCtlCalendarDate.txtText.Value= DATE()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpdate</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0WJAK1</uniqueid>
		<timestamp>964979081</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntqpdaterange</objname>
		<parent/>
		<properties>Width = 474
Height = 23
BorderWidth = 0
cqryparvarnmvalue = 
cqryparvarnmvalue2 = 
cqryparvarnmenabled = 
lqryparisrequired = .F.
nqryparid = 0
Name = "cntqpdaterange"
</properties>
		<protected>cqryparvarnmvalue
cqryparvarnmvalue2
lqryparisrequired
qrylast
qrylastset
</protected>
		<methods>PROCEDURE checkcorrect
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.CHECKCORRECT
* Called by.......: &lt;.SetParamToMgr(); Valid()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:47 -&gt;Åñëè îáà ïîëÿ ïóñòû
IF	EMPTY(.cntTxtCtlCalendarStartDate.txtText.Value) AND ;
	EMPTY(.cntTxtCtlCalendarEndDate.txtText.Value)
	
	*07.07.2005 14:01 -&gt;Åñëè îáÿçàòåëüíûé ïàðàìåòð âûáîðêè
	IF  .lQryParIsRequired
	
		*07.07.2005 14:02 -&gt;Âûâåäåì ñîîáùåíèå è ïðîñòàâèì òåêóùèå äàòû
		=MESSAGEBOX('Íåîáõîäèìî âûáðàòü õîòÿ áû îäíó äàòó',64,'Ïàðàìåòð: '+This.chkQryParEnabled.Caption)
		.cntTxtCtlCalendarStartDate.txtText.Value = DATE()
		.cntTxtCtlCalendarEndDate.txtText.Value = DATE()
		*------------------------------------------------------------------------------
	
	ELSE
		
		*07.07.2005 14:04 -&gt;Îòêëþ÷èì ôèëüòð
		.chkQryParEnabled.Value = 0
		*------------------------------------------------------------------------------
	
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------	
			
*25.05.2004 17:49 -&gt;Åñëè îáà ïîëÿ íå ïóñòû è Start &gt; End ==&gt; ïîìåíÿåì ìåñòàìè
*!*	IF	!EMPTY(.cntTxtCtlCalendarStartDate.txtText.Value) AND ;
*!*		!EMPTY(.cntTxtCtlCalendarEndDate.txtText.Value) AND ;
*!*		.cntTxtCtlCalendarStartDate.txtText.Value &gt; .cntTxtCtlCalendarEndDate.txtText.Value
*!*		
*!*		*25.05.2004 17:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
*!*		LOCAL	ldStartDate
*!*		*------------------------------------------------------------------------------
*!*				
*!*		*25.05.2004 17:50 -&gt;Ïîìåíÿåì ìåñòàìè
*!*		ldStartDate = .cntTxtCtlCalendarStartDate.txtText.Value
*!*		.cntTxtCtlCalendarStartDate.txtText.Value = .cntTxtCtlCalendarEndDate.txtText.Value
*!*		.cntTxtCtlCalendarEndDate.txtText.Value = ldStartDate
*!*		*------------------------------------------------------------------------------
*!*		
*!*	ENDIF
*!*	*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnQryParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ îáúåêòà.
*-------------------------------------------------------
LPARAMETERS tnQryParID

WITH This
.nqryparid = tnQryParID
*25.05.2004 17:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*25.05.2004 17:00 -&gt;Ïîëó÷èì îáùèå ïàðàìåòðû ôèëüòðà
USE IN IIF(USED([lvQryParByQryParId]),[lvQryParByQryParId],0)
***
_PARAM = tnQryParID
USE lvQryParByQryParId IN 0
*------------------------------------------------------------------------------

*25.05.2004 17:02 -&gt;Ñîõðàíÿåì äàííûå â ñâîéñòàõ îáúåêòà
.chkQryParEnabled.Caption = ALLTRIM(lvQryParByQryParId.QryParObjCaption)
.cQryParVarNMEnabled      = ALLTRIM(lvQryParByQryParId.QryParVarNMEnabled)
.cQryParVarNMValue        = ALLTRIM(lvQryParByQryParId.QryParVarNMValue)
.cQryParVarNMValue2       = ALLTRIM(lvQryParByQryParId.QryParVarNMValue2)
.lQryParIsRequired        = lvQryParByQryParId.QryParIsRequired
***
IF .lQryParIsRequired
	.chkQryParEnabled.Value = 1
	.chkQryParEnabled.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------

.qrylast()
*25.05.2004 17:18 -&gt;Âûçîâåì ìåòîä _HandleAnyChange äëÿ Chkbox-a äëÿ àêòóàëèçàöèè ñîñòîÿíèÿ
.chkQryParEnabled._HandleAnyChange()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE LostFocus
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.LOSTFOCUS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîâåðêà êîððåêòíîñòè çàïîëíåíèÿ.
*-------------------------------------------------------
This.CheckCorrect()
This.QryLastSet()
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE qrylast
**** Method QryLast
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
lcQryParValue = QryLast.QryParValue
USE IN QryLast
WITH This
IF ISNULL(lcQryParValue) OR EMPTY(ALLTRIM(lcQryParValue))
		*25.05.2004 17:14 -&gt;Âûñòàâèì ïî óìîë÷àíèþ òåêóùóþ äàòó â îáîèõ ïîëÿõ
		.cntTxtCtlCalendarStartDate.txtText.Value = DATE()
		.cntTxtCtlCalendarEndDate.txtText.Value = DATE()
	ELSE
		.cntTxtCtlCalendarStartDate.txtText.Value = CTOD(ALLTRIM(SUBSTR(lcQryParValue,1,AT(';',lcQryParValue)-1)))
		.cntTxtCtlCalendarEndDate.txtText.Value = CTOD(ALLTRIM(SUBSTR(lcQryParValue,AT(';',lcQryParValue)+1)))
ENDIF
ENDWITH
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE qrylastset
**** Method QryLastSet
LOCAL _PARAM, _PARAM1, _PARAM2,lcQryParValue
lcQryParValue = DTOC(this.cntTxtCtlCalendarStartDate.txtText.Value) + ;
	';'+DTOC(This.cntTxtCtlCalendarEndDate.txtText.Value)

_PARAM  = This.nQryParID
_PARAM1 = oApp.nUserKod
IF USED([RptTreeView])
	_PARAM2	=[r]+ALLTRIM(STR(RptTreeView.RptId,12,0))
ENDIF
IF USED([lvScrFrmInfo])
	_PARAM2	=[s]+ALLTRIM(STR(lvScrFrmInfo.ScrFrmId,12,0))
ENDIF
IF VARTYPE(_PARAM2)&lt;&gt;'C'
	_PARAM2 = ''
ENDIF
USE QryLast IN 0
CURSORSETPROP([BUFFERING],3,[QryLast])
SELECT QryLast
IF RECCOUNT([QryLast])&lt;1
	INSERT INTO QryLast (QryParId,User_,FrmId,QryParValue) VALUES (_PARAM,_PARAM1,_PARAM2,lcQryParValue)
ELSE
	IF ALLTRIM(QryLast.QryParValue)&lt;&gt;ALLTRIM(lcQryParValue)
		REPLACE QryLast.QryParValue WITH ALLTRIM(lcQryParValue), QryLast.Stamp_ WITH DATETIME() IN QryLast
		TABLEUPDATE(0,.t.,'QryLast')
	ENDIF
ENDIF
USE IN QryLast
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE queryparamget
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: QueryParamIO_v1.vcx
* Class.Module....: cntQPDateRange.QueryParamGet
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcQryParSID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*------------------------------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*09.11.2005 15:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luQryParEnabled, ;
		luQryParValue, ;
		luQryParValue2
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt; Ñ÷èòàåì ïàðàìåòðû èç ìåíåäæåðà
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)

	*09.11.2005 15:49 -&gt; Ñ÷èòàåì ïåðåìåííóþ àêòèâíîñòè ïàðàìåòðà
	luQryParEnabled = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMEnabled)
	***
	.chkQryParEnabled.Value = IIF(luQryParEnabled,1,0)
	*------------------------------------------------------------------------------
	
	*09.11.2005 15:50 -&gt; Åñëè ïàðàìåòð àêòèâåí
	IF !ISNULL(luQryParEnabled) AND TYPE([luQryParEnabled])==[L] AND luQryParEnabled

		*09.11.2005 15:52 -&gt; Ñ÷èòàåì çíà÷åíèÿ ïàðàìåòðà
		luQryParValue  = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue)
		luQryParValue2 = oQryParMgr.ParamGet(tcQryParSID,.cQryParVarNMValue2)
		***
		IF !ISNULL(luQryParValue)
			.cntTxtCtlCalendarStartDate.txtText.Value = luQryParValue
		ENDIF
		***
		IF !ISNULL(luQryParValue2)
			.cntTxtCtlCalendarEndDate.txtText.Value = luQryParValue2
		ENDIF
		*------------------------------------------------------------------------------		
	
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*26.05.2004 20:18 -&gt; Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE queryparamset
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CNTQPDATERANGE.QUERYPARAMSET
* Called by.......: &lt;tcQryParSID&gt;
* Parameters......: &lt;tn&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*-------------------------------------------------------
LPARAMETERS	tcQryParSID

WITH This

*26.05.2004 20:18 -&gt;Âûçîâåì ìåòîä ïðîâåðêè êîððåêòíîñòè ïàðàìåòðîâ
.CheckCorrect()
*------------------------------------------------------------------------------

*26.05.2004 20:16 -&gt;Çàïèøåì ïàðàìåòðû â ìåíåäæåð
IF TYPE([oQryParMgr])==[O] AND !ISNULL(oQryParMgr)
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMEnabled,IIF(.chkQryParEnabled.Value=1,.T.,.F.))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue,IIF(.chkQryParEnabled.Value=1,.cntTxtCtlCalendarStartDate.txtText.Value,CTOD([])))
	oQryParMgr.ParamSet(tcQryParSID,.cQryParVarNMValue2,IIF(.chkQryParEnabled.Value=1,.cntTxtCtlCalendarEndDate.txtText.Value,CTOD([])))
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>cqryparvarnmvalue &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ íà÷àëüíàÿ äàòà ïåðèîäà.
cqryparvarnmvalue2 &lt;protected/runtime&gt; Èìÿ ïàðàìåòðà â êîòîðîì õðàíèòñÿ êîíå÷íàÿ äàòà ïåðèîäà.
cqryparvarnmenabled &lt;protected/runtime&gt; Èìÿ ïåðåìåííîé àêòèâíîñòè ôèëüòðà.
lqryparisrequired &lt;protected/runtime&gt; Ïðèçíàê êîíòðîëÿ îáÿçàòåëüíîñòè ïàðàìåòðà âûáîðêè
nqryparid Èäåíòèôôèêàòîð ïàðàìåòðà
*checkcorrect &lt;public/nouser/default&gt; Ïðîâåðêà êîððåêòíîñòè ââîäà.
*queryparamset &lt;public/nouser/default&gt; Çàïèñü çíà÷åíèÿ ïàðàìåòðà â îáúåêò - ìåíåäæåð ïàðàìåòðîâ.
*queryparamget &lt;public/nouser/default&gt; ×òåíèå çíà÷åíèÿ ïàðàìåòðà èç îáúåêòà - ìåíåäæåðà ïàðàìåòðîâ.
*qrylast Ïîëó÷àåì ïîñëåäíåå çíà÷åíèå èç áàçû äàííûõ
*qrylastset Óñòàíàâëèâàåì ïîñëåäíåå çíà÷åíèå â áàçó äàííûõ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCE</uniqueid>
		<timestamp>964979081</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkQryParEnabled</objname>
		<parent>cntqpdaterange</parent>
		<properties>Top = 0
Left = 0
Height = 23
Width = 154
FontBold = .T.
AutoSize = .F.
Alignment = 0
Style = 1
ZOrderSet = 0
Name = "chkQryParEnabled"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: QUERYPARAM_V1.VCX
* Class.Module....: CHKQRYPARENABLED._HANDLEANYCHANGE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ.
*-------------------------------------------------------
WITH This

*25.05.2004 17:16 -&gt;Îòêëþ÷èì/âêëþ÷èì äîñòóïíîñòü îñòàëüíûõ îáúåêòîâ
IF .Value = 1
	.Parent.lblFrom.Enabled = .T.
	.Parent.cntTxtCtlCalendarStartDate.SetEnabled(.T.)
	.Parent.cntTxtCtlCalendarStartDate.SetFocus()
	.Parent.lblTo.Enabled = .T.
	.Parent.cntTxtCtlCalendarEndDate.SetEnabled(.T.)
	.Parent.cmdToday.Enabled = .T.
ELSE
	.Parent.lblFrom.Enabled = .F.
	.Parent.cntTxtCtlCalendarStartDate.SetEnabled(.F.)
	.Parent.lblTo.Enabled = .F.
	.Parent.cntTxtCtlCalendarEndDate.SetEnabled(.F.)
	.Parent.cmdToday.Enabled = .F.
ENDIF
*------------------------------------------------------------------------------	

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18T0ZZPE1</uniqueid>
		<timestamp>949586289</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFrom</objname>
		<parent>cntqpdaterange</parent>
		<properties>FontBold = .T.
Caption = "ñ"
Left = 156
Top = 4
ZOrderSet = 1
Name = "lblFrom"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCF</uniqueid>
		<timestamp>959205066</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCtlCalendarStartDate</objname>
		<parent>cntqpdaterange</parent>
		<properties>Top = 0
Left = 168
Width = 96
Height = 27
ZOrderSet = 2
Name = "cntTxtCtlCalendarStartDate"
TXTTEXT.Name = "TXTTEXT"
CMDSHOW.Name = "CMDSHOW"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCY</uniqueid>
		<timestamp>949586289</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblTo</objname>
		<parent>cntqpdaterange</parent>
		<properties>FontBold = .T.
Caption = "ïî"
Left = 263
Top = 4
ZOrderSet = 3
Name = "lblTo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18U0XRPCO</uniqueid>
		<timestamp>959205066</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCtlCalendarEndDate</objname>
		<parent>cntqpdaterange</parent>
		<properties>Top = 0
Left = 278
Width = 94
Height = 27
ZOrderSet = 4
Name = "cntTxtCtlCalendarEndDate"
TXTTEXT.Name = "TXTTEXT"
CMDSHOW.Name = "CMDSHOW"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IM0Q45PH</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdToday</objname>
		<parent>cntqpdaterange</parent>
		<properties>Top = -1
Left = 375
Height = 25
Caption = "\&lt;Ñåãîäíÿ"
Name = "cmdToday"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.cntTxtCtlCalendarStartDate.txtText.Value= DATE()
This.Parent.cntTxtCtlCalendarEndDate.txtText.Value= DATE()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntqpdaterange</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
