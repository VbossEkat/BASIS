<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptadd</objname>
		<parent/>
		<properties>Height = 184
Width = 370
DoCreate = .T.
BorderStyle = 2
Caption = "Äîáàâëåíèå îò÷åòà/ãðóïïû"
Icon = ..\graphic\frmrptadd.ico
Name = "frmrptadd"
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTADD._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*01.04.2004 12:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*01.04.2004 12:06 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]

	*01.04.2004 12:06 -&gt;Ïðîèçâîäèì ñîõðàíåíèå
	llResSave = .cstDataWork.Save([lvRptEdit])
	*------------------------------------------------------------------------------
	
	*21.01.2004 20:01 -&gt;Îáðàáàòûâàåì ðåçóëüòàòû ñîõðàíåíèÿ
	IF llResSave
		.uRetVal = spGetLastIncrementedID([lvRptEdit])
		.Hide()
	ELSE
		*01.04.2004 18:42 -&gt;Ïîïûòàåìñÿ îáðàáîòàòü îøèáêó ñîõðàíåíèÿ
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
			RETURN .T.	&amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
		ELSE	
			*01.04.2004 18:40 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*01.04.2004 18:40 -&gt;Îòìåíÿåì èçìåíåíèÿ
			.cstDataWork.Restore([lvRptEdit])
			.uRetVal = .F.
			.Hide()	
			*------------------------------------------------------------------------------
		ENDIF	
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE
	*01.04.2004 12:09 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptEdit])
	.uRetVal = .F.
	.Hide()
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: REPORT_ADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tuRptParID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìàû (âûñòàâëåíèå èäåíòèôèêàòîðà ðîäèòåëñêîé ãðóïïû)
*-------------------------------------------------------
LPARAMETERS	tuRptParID

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

*20.01.2004 19:01 -&gt;Âûñòàâèì Defult êîä ðîäèòåëÿ
IF TYPE([tuRptParID])==[N]
	ThisForm.cntIdCtlTreeRptParent.SetValue(tuRptParID)
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTADD.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*01.04.2004 14:42 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*13.01.2004 20:01 -&gt;Îòêðûâàåì ñïðàâî÷íèêè
USE lvRptCntTreeView IN 0
USE lvRptBmps IN 0
USE lvRptTypeList IN 0
*------------------------------------------------------------------------------

*01.04.2004 11:49 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ è äîáàâèì ïóñòóþ ñòðîêó
USE lvRptEdit IN 0 NODATA
APPEND BLANK IN lvRptEdit
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>12</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0NBQ19</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptType</objname>
		<parent>frmrptadd</parent>
		<properties>FontBold = .T.
Caption = "Òèï:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 3
Name = "lblRptType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0N6JGO</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridRptType</objname>
		<parent>frmrptadd</parent>
		<properties>Top = 5
Left = 115
TabIndex = 2
ZOrderSet = 4
_controlsource = lvRptEdit.RptTypeID
_controlsourcetype = 1
_rsaliasname = lvRptTypeList
_rsfieldnameid = RptTypeID
_rsfieldnametext = RptTypeNM
Name = "cntIdCtlGridRptType"
txtText._highlightobject = ThisForm.lblRptType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNM</objname>
		<parent>frmrptadd</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 5
Name = "lblRptNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C140GJG</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenRptNM</objname>
		<parent>frmrptadd</parent>
		<properties>Top = 33
Left = 115
TabIndex = 4
ZOrderSet = 6
Name = "cntTxtCalcLenRptNM"
txtText.ControlSource = "lvRptEdit.RptNM"
txtText._highlightobject = .Parent.lblLen;ThisForm.lblRptNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptParent</objname>
		<parent>frmrptadd</parent>
		<properties>FontBold = .T.
Caption = "Ñîñòîèò â ãðóïïå:"
Left = 5
Top = 64
TabIndex = 5
ZOrderSet = 7
Name = "lblRptParent"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C14AMD7</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlTreeRptParent</objname>
		<parent>frmrptadd</parent>
		<properties>Top = 61
Left = 115
TabIndex = 6
ZOrderSet = 8
_rsaliasname = lvRptCntTreeView
_rsfieldnameid = RptID
_rsfieldnametext = RptNM
_controlsource = lvRptEdit.RptParID
_controlsourcetype = 1
_selectobject = frmidctltreerptcnt;report_v1;report.app
Name = "cntIdCtlTreeRptParent"
txtText._highlightobject = ThisForm.lblRptParent
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNote</objname>
		<parent>frmrptadd</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 107
TabIndex = 7
ZOrderSet = 9
Name = "lblRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>0</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtRptNote</objname>
		<parent>frmrptadd</parent>
		<properties>Height = 53
Left = 115
TabIndex = 8
Top = 89
Width = 200
ZOrderSet = 10
ControlSource = "lvRptEdit.RptNote"
IntegralHeight = .T.
_highlightobject = ThisForm.lblRptNote
Name = "edtRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptadd</parent>
		<properties>Height = 0
Left = 0
Top = 147
Width = 370
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptadd</parent>
		<properties>Height = 0
Left = 0
Top = 148
Width = 370
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptadd</parent>
		<properties>Top = 154
Left = 160
TabIndex = 9
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptadd</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptfrmadd</objname>
		<parent/>
		<properties>Height = 201
Width = 370
DoCreate = .T.
BorderStyle = 2
Caption = "Ïå÷àòíîå ïðåäñòàâëåíèå - Äîáàâëåíèå"
Icon = ..\graphic\frmrptfrmadd.ico
Name = "frmrptfrmadd"
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMADD._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*08.07.2004 15:21 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*11.07.2004 18:57 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	_PARAM, ;
			lcTmpFileNM, ;
			llResSave
	*------------------------------------------------------------------------------

	*11.07.2004 18:57 -&gt;Ñêîïèðóåì âûáðàííûé øàáëîí â íîâîå ïå÷àòíîå ïðåäñòàâëåíèå
	USE IN IIF(USED([lvRptFrmTemplate]),[lvRptFrmTemplate],0)
	***
	_PARAM = .cntIdCtlGridRptFrmTemplate.Value
	USE lvRptFrmTemplate IN 0
	***
	lcTmpFileNM = [tmp\]+SYS(2015)
	***
	SELECT lvRptFrmTemplate
	COPY MEMO RptFrmTemplateFRX TO (lcTmpFileNM+[.FRX])
	COPY MEMO RptFrmTemplateFRT TO (lcTmpFileNM+[.FRT])
	***
	SELECT lvRptFormEdit
	APPEND MEMO RptFrmFRX FROM (lcTmpFileNM+[.FRX]) OVERWRITE
	APPEND MEMO RptFrmFRT FROM (lcTmpFileNM+[.FRT]) OVERWRITE
	***
	ERASE (lcTmpFileNM+[.FRX])
	ERASE (lcTmpFileNM+[.FRT])
	***
	USE IN IIF(USED([lvRptFrmTemplate]),[lvRptFrmTemplate],0)
	*------------------------------------------------------------------------------
	
	*08.07.2004 15:21 -&gt;Ïðîèçâîäèì ñîõðàíåíèå
	llResSave = .cstDataWork.Save([lvRptFormEdit])
	*------------------------------------------------------------------------------
	
	*08.07.2004 15:21 -&gt;Îáðàáàòûâàåì ðåçóëüòàòû ñîõðàíåíèÿ
	IF llResSave
		*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
		.uRetVal = spGetLastIncrementedID([lvRptFormEdit])
		*------------------------------------------------------------------------------
	ELSE
		*08.07.2004 15:21 -&gt;Ïîïûòàåìñÿ îáðàáîòàòü îøèáêó ñîõðàíåíèÿ
		IF .cstDataWork.HandleSaveFail()	&amp;&amp;åñëè îøèáêà îáðàáîòàíà
			*08.07.2004 15:22 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		ELSE
		
			*08.07.2004 15:23 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*08.07.2004 15:23 -&gt;Îòìåíÿåì èçìåíåíèÿ
			.cstDataWork.Restore([lvRptFormEdit])
			.uRetVal = .F.
			*------------------------------------------------------------------------------
		ENDIF	
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------
ELSE

	*08.07.2004 15:23 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptFormEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 15:24 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tnRptID

*08.07.2004 15:19 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

*08.07.2004 15:18 -&gt;Çàïèøåì èäåíòèôèêàòîð îò÷åòà
REPLACE lvRptFormEdit.RptID WITH tnRptID
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMADD.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*08.07.2004 15:25 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*11.07.2004 18:48 -&gt;Îòêðîåì LV ñî ñïèñêîì øàáëîíîâ
USE lvRptFrmTemplateList IN 0
*------------------------------------------------------------------------------

*08.07.2004 15:25 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ è äîáàâèì ïóñòóþ ñòðîêó
USE lvRptFormEdit IN 0 NODATA
APPEND BLANK IN lvRptFormEdit
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>14</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmNM</objname>
		<parent>frmrptfrmadd</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptFrmNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C140GJG</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenRptFrmNM</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Top = 5
Left = 115
ZOrderSet = 4
Name = "cntTxtCalcLenRptFrmNM"
txtText.ControlSource = "lvRptFormEdit.RptFrmNM"
txtText._highlightobject = .Parent.lblLen;ThisForm.lblRptFrmNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A00R69EE</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmNote</objname>
		<parent>frmrptfrmadd</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 51
ZOrderSet = 5
Name = "lblRptFrmNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>0</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtRptFrmNote</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Height = 53
Left = 115
Top = 33
Width = 200
ZOrderSet = 6
ControlSource = "lvRptFormEdit.RptFrmNote"
IntegralHeight = .T.
_highlightobject = ThisForm.lblRptFrmNote
Name = "edtRptFrmNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A00R69EE</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmSavePrnEnv</objname>
		<parent>frmrptfrmadd</parent>
		<properties>FontBold = .T.
Caption = "Íàñòð. ïðèíòåðà:"
Left = 5
Top = 113
ZOrderSet = 7
Name = "lblRptFrmSavePrnEnv"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkFrmSavePrnEnv</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Top = 113
Left = 115
FontBold = .T.
ControlSource = "lvRptFormEdit.RptFrmSavePrnEnv"
ZOrderSet = 8
_highlightobject = ThisForm.lblRptFrmSavePrnEnv
textchange = .T.
textchecked = Ñîõðàíÿòü
textunchecked = Íå ñîõðàíÿòü
Name = "chkFrmSavePrnEnv"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A00R69EE</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmIsModify</objname>
		<parent>frmrptfrmadd</parent>
		<properties>FontBold = .T.
Caption = "Ðåæèì:"
Left = 5
Top = 91
ZOrderSet = 7
Name = "lblRptFrmIsModify"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkRptFrmIsModify</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Top = 91
Left = 115
FontBold = .T.
ControlSource = "lvRptFormEdit.RptFrmIsModify"
ZOrderSet = 8
_highlightobject = ThisForm.lblRptFrmIsModify
textchange = .T.
textchecked = Ðåäàêòèðîâàíèå
textunchecked = Èñïîëíåíèå
Name = "chkRptFrmIsModify"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A20WOW8I</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmTemplate</objname>
		<parent>frmrptfrmadd</parent>
		<properties>FontBold = .T.
Caption = "Øàáëîí:"
Left = 5
Top = 139
ZOrderSet = 9
Name = "lblRptFrmTemplate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A20WOW8J</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridRptFrmTemplate</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Top = 136
Left = 115
ZOrderSet = 10
_rsaliasname = lvRptFrmTemplateList
_rsfieldnameid = RptFrmTemplateID
_rsfieldnametext = RptFrmTemplateNM
value = 1
Name = "cntIdCtlGridRptFrmTemplate"
txtText._highlightobject = ThisForm.lblRptFrmTemplate
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Height = 0
Left = 0
Top = 164
Width = 370
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Height = 0
Left = 0
Top = 165
Width = 370
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptfrmadd</parent>
		<properties>Top = 171
Left = 160
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptfrmadd</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptfrmexp</objname>
		<parent/>
		<properties>Height = 70
Width = 370
DoCreate = .T.
BorderStyle = 2
Caption = "Ïå÷àòíîå ïðåäñòàâëåíèå - Ýêñïîðò"
Icon = ..\graphic\frmrptfrmexp.ico
nrptfrmid = 0
Name = "frmrptfrmexp"
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEXPIMP._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*02.04.2004 16:51 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*10.07.2004 22:02 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcExpFileNM
	***
	lcExpFileNM = UPPER(ALLTRIM(.txtRptFrmFileNM.Value))
	IF RIGHT(lcExpFileNM,4)==[.FRX]
		lcExpFileNM = SUBSTR(lcExpFileNM,1,LEN(lcExpFileNM)-4)
	ENDIF
	*------------------------------------------------------------------------------
	
	*10.07.2004 22:00 -&gt;Ïðîâåðèì, ÷òî áû áûë çàäàí ôàéë äëÿ
	IF EMPTY(lcExpFileNM)
		=MESSAGEBOX([Íå çàäàíî èìÿ ôàéëà äëÿ ýêñïîðòà!],48,[Ïðåäóïðåæäåíèå...])
		.cmdRptFrmFileGet.Click()
		RETURN .T.
	ENDIF
	*------------------------------------------------------------------------------
	
	*10.07.2004 22:04 -&gt;Âûïîëíèì ýêñïîðò
	COPY MEMO lvRptFormInfo.RptFrmFRX TO (lcExpFileNM+[.FRX])
	COPY MEMO lvRptFormInfo.RptFrmFRT TO (lcExpFileNM+[.FRT])
	*------------------------------------------------------------------------------
	
	*10.07.2004 22:32 -&gt;Çàïèñûâàåì èíôîðìàöèþ îá îò÷åòå
	DELETE FROM (lcExpFileNM+[.FRX]) WHERE platform == [BASIS]
	INSERT INTO (lcExpFileNM+[.FRX]) (platform, name, comment) VALUES ([BASIS],lvRptFormInfo.RptFrmNM,lvRptFormInfo.RptFrmNote)
	*------------------------------------------------------------------------------
	
	*10.07.2004 22:21 -&gt;Ñîõðàíèì ðåçóëüòàò
	.uRetVal = .T.
	*------------------------------------------------------------------------------
	
ELSE
	*10.07.2004 22:21 -&gt;Ñîõðàíèì ðåçóëüòàò
	.uRetVal = .F.
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

*07.07.2004 17:28 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEXP.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tuRptFrmID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tnRptFrmID

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

*10.07.2004 21:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*10.07.2004 21:48 -&gt;Ñîõðàíèì èäåíòèôèêòîð ïå÷àòíîé ôîðìû
This.nRptFrmID = tnRptFrmID
*------------------------------------------------------------------------------

*10.07.2004 21:54 -&gt;Îòêðîåì LV ñ èíôîðìàöèåé îá îò÷åòå (ñ MEMO)
_PARAM = tnRptFrmID
USE lvRptFormInfo IN 0
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*08.07.2004 15:25 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>nrptfrmid Èäåòèôèêàòîð ïå÷àòíîãî ïðåäñòàâëåíèÿ
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmFileNM</objname>
		<parent>frmrptfrmexp</parent>
		<properties>FontBold = .T.
Caption = "Ôàéë:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptFrmFileNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptfrmexp</parent>
		<properties>Height = 0
Left = 0
Top = 34
Width = 370
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptfrmexp</parent>
		<properties>Top = 40
Left = 160
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptfrmexp</parent>
		<properties>Height = 0
Left = 0
Top = 33
Width = 370
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A30X91RE</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtRptFrmFileNM</objname>
		<parent>frmrptfrmexp</parent>
		<properties>Enabled = .F.
Left = 115
Top = 5
Width = 200
DisabledForeColor = 0,0,0
_highlightobject = ThisForm.lblRptFrmFileNM
Name = "txtRptFrmFileNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A30X91RF</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdRptFrmFileGet</objname>
		<parent>frmrptfrmexp</parent>
		<properties>Top = 5
Left = 319
Height = 23
Width = 23
Picture = ..\graphic\cmdopen.bmp
Caption = ""
Name = "cmdRptFrmFileGet"
</properties>
		<protected/>
		<methods>PROCEDURE Click
ThisForm.txtRptFrmFileNM.Value = PUTFILE([],ALLTRIM(lvRptFormInfo.RptFrmNM),[FRX])
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptfrmexp</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18L1B4NYC</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptqryparindexedit</objname>
		<parent/>
		<properties>Height = 137
Width = 355
DoCreate = .T.
Caption = "Ïîðÿäîê âõîæäåíèÿ ïàðàìåòðîâ îò÷¸òà"
Icon = ..\graphic\frmqryparselect.ico
Name = "frmrptqryparindexedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParIndexEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;.cmdCancel.Click();.cmdOk.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*-------------------------------------------------------
LPARAMETERS tcMessage

*28.03.2005 17:43 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

WITH This

*04.04.2005 17:03 -&gt; Ñîõðàíèì ðåçóëüòàò
IF tcMessage == [OK]

	*04.04.2005 17:22 -&gt; Ïðîèçâîäèì èíäåêñèðîâàíèå
	SELECT lvRptQryParIndexEdit
	SCAN ALL
		IF RptQryParIndex # .LstRptQryPar.ItemIDToIndex(RptQryParIndex)
			REPLACE RptQryParIndex WITH .LstRptQryPar.ItemIDToIndex(RptQryParIndex)
		ENDIF
	ENDSCAN
	*------------------------------------------------------------------------------

	*24.01.2005 12:06 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå
	llDataWasChanged = .cstDataWork.DataChanged([lvRptQryParIndexEdit],.T.)
	*------------------------------------------------------------------------------
		
	*24.01.2005 12:07 -&gt; Åñëè äàííûå áûëè èçìåíåíû
	IF llDataWasChanged
			
		*24.01.2005 12:08 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
		llResSave = .cstDataWork.Save([lvRptQryParIndexEdit])
		*------------------------------------------------------------------------------
			
		*24.01.2005 12:08 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptQryParIndexEdit])
			ENDIF
		ENDIF
		*------------------------------------------------------------------------------

		*25.07.2004 10:56 -&gt; Âîçâðàùàþ ðåçóëüòàò
		.uRetVal = llResSave
		*------------------------------------------------------------------------------

	ELSE
		*{
		.cstDataWork.Restore([lvRptQryParIndexEdit])
		.uRetVal = .F.
		*}
	ENDIF
	*------------------------------------------------------------------------------

ELSE
	*{
	.cstDataWork.Restore([lvRptQryParIndexEdit])
	.uRetVal = .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*04.04.2005 17:20 -&gt; Ñêðîåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParIndexEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*-------------------------------------------------------
LPARAMETERS tnRptID

*21.01.2005 17:45 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnCounter, ;
		lcSourceStr
***
lcSourceStr = []
*------------------------------------------------------------------------------

*21.01.2005 17:45 -&gt; Ïåðå÷èòàåì Local View ñ äàííûìè äëÿ òåêóùåãî îò÷åòà
PRIVATE	_PARAM
_PARAM = tnRptId
***
REQUERY([lvRptQryParIndexEdit])
*------------------------------------------------------------------------------

WITH This.LstRptQryPar

*21.01.2005 17:47 -&gt; Âîçüìåì äàííûå äëÿ ListBox èç LocalView
.RowSource = [lvRptQryParIndexEdit.QryParNM]
.RowSourceType = 2
*------------------------------------------------------------------------------

*21.01.2005 17:48 -&gt; Çàïèøåì äàííûå ListBox'à â ñòðîêó-èñòî÷íèê
FOR lnCounter = 1 TO .ListCount
	lcSourceStr = lcSourceStr + ALLTRIM(.List(lnCounter)) + [,]
ENDFOR
*------------------------------------------------------------------------------

*21.01.2005 17:49 -&gt; Îáðàáîòàåì ïîëó÷åííóþ ñòðîêó-èñòî÷íèê (óäàëèì ïîñëåäíþþ çàïÿòóþ)
IF LEN(lcSourceStr) &gt; 0
	lcSourceStr = LEFT(lcSourceStr,LEN(lcSourceStr)-1)
ELSE
	lcSourceStr = [ ]
ENDIF
*------------------------------------------------------------------------------

*21.01.2005 17:47 -&gt; Èçìåíèì èñòî÷íèê äàííûõ ListBox'à è ïîäöåïèì ê íåìó äàííûå ñîõðàíåííûå â ñòðîêå-èñòî÷íèêå
.RowSourceType = 1
.RowSource = lcSourceStr
*------------------------------------------------------------------------------

*21.01.2005 17:52 -&gt; Ïîäêëþ÷èì îïöèþ, ïîçâîëÿþùóþ èçìåíÿòü ïîðÿäîê äàííûõ â ListBox'å
.MoverBars = .T.
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParIndexEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ
*-------------------------------------------------------

*16.05.2004 22:10 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.04.2005 17:12 -&gt; Îòêðûâàåì LocalView
USE Basis!lvRptQryParIndexEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],5,[lvRptQryParIndexEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_18L1BE4FO</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptqryparindexedit</parent>
		<properties>Top = 107
Left = 145
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0ZNX4H</uniqueid>
		<timestamp>0</timestamp>
		<class>lstrptqrypar</class>
		<classloc>report_v1.vcx</classloc>
		<baseclass>listbox</baseclass>
		<objname>LstRptQryPar</objname>
		<parent>frmrptqryparindexedit</parent>
		<properties>Height = 80
Left = 5
TabIndex = 6
Top = 22
Width = 345
Name = "LstRptQryPar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0ZQGU4</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptQryPar</objname>
		<parent>frmrptqryparindexedit</parent>
		<properties>AutoSize = .F.
Alignment = 2
Caption = "Ïàðàìåòð îò÷¸òà"
Left = 5
Top = 5
Width = 345
TabIndex = 5
Name = "lblRptQryPar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptqryparindexedit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdrptqrypar</objname>
		<parent/>
		<properties>ColumnCount = 1
Height = 100
RecordSource = "lvRptQryParView"
Width = 345
nrptid = 0
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Óäàëèòü
Name = "grdrptqrypar"
Column1.ControlSource = "lvRptQryParView.QryParNM"
Column1.Width = 310
Column1.Name = "Column1"
</properties>
		<protected>nrptid
</protected>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: GrdRptQryPar._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå ïàðàìåòðà ê îò÷åòó
*-------------------------------------------------------
WITH This

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ñîçäàíèÿ íîâîãî ïå÷àòíîãî ïðåäñòàâëåíèÿ
luAddRes = oMgrRpt.Do([RPTQRYPAR],[ADD],.nRptID,RECCOUNT([lvRptQryParView])+1)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luAddRes])==[N]
	
	*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïàðàìåòðîâ îò÷åòà
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	SELECT lvRptQryParView
	LOCATE FOR lvRptQryParView.RptQryParID = luAddRes
	*------------------------------------------------------------------------------

	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: GrdRptQryPar._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå ïàðàìåòðà îò÷åòà
*-------------------------------------------------------
WITH This

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrRpt.Do([RPTQRYPAR],[DELE],lvRptQryParView.RptQryParID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luDeleRes])==[L] AND luDeleRes
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïàðàìåòðîâ îò÷åòà
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: grdRptQryPar._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå ñïèñêà ïàðàìåòðîâ îò÷åòà (èçìåíåíèå ïîðÿäêà)
*------------------------------------------------------------------------------
WITH This

*11.07.2004 15:58 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luIndexRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ èçìåíåíèÿ ïîðÿäêà âõîæäåíèÿ ïàðàìåòðîâ âûáîðêè
luIndexRes = oMgrRpt.Do([RPTQRYPAR],[EDIT],.nRptID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû èíäåêñèðîâàíèÿ
IF TYPE([luIndexRes])==[L] AND luIndexRes

	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïàðàìåòðîâ âûáîðêè
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
	
ENDPROC
PROCEDURE _gethandledstandartmsglist
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: GrdRptQryPar._GetHandledStandartMsgList
* Called by.......: &lt;.RefreshHandledStandartMsgList();.RightClick()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;lcHandledStandartMsgList&gt;
* Notes...........: Çàïðåòèì âñå ñòàíäàðòíûå îïåðàöèè, åñëè êîä îò÷åòà 0 (ïðè ðàáîòå ñ ãðóïïîé)
*-------------------------------------------------------
RETURN IIF(This.nRptID#0,DODEFAULT(),[])
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: GrdRptQryPar._RSRequery
* Called by.......: &lt;External Call's&gt;
* Parameters......: &lt;tnRptId&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
LPARAMETERS	tnRptId

*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE	_PARAM
*------------------------------------------------------------------------------

WITH This

*08.07.2004 14:20 -&gt;Ñîõðàíèì èäåíòèôèêàòîð îò÷åòà
.nRptID = tnRptId
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
IF .nRptId = 0

	*12.01.2004 19:09 -&gt;Îòêðûâàåì LocalView ïóñòûì
	USE IN lvRptQryParView
	USE Basis!lvRptQryParView IN 0 NODATA
	*------------------------------------------------------------------------------
	
ELSE

	*25.03.2004 12:13 -&gt;Îòêðûâàåì ñ äàííûìè äëÿ òåêóùåãî ïàðàìåòðà îò÷åòà
	_PARAM = .nRptId
	REQUERY([lvRptQryParView])
	*------------------------------------------------------------------------------
	
ENDIF	
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>nrptid &lt;protected/runtime&gt; Èäåíòèôèêàòîð îò÷åòà, äëÿ êîòîðîãî îòîáðàæàþòñÿ ïàðàìåòðû âûáîðêè.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\report_v1_grdrptform.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdrptqrypar.Column1</parent>
		<properties>Alignment = 2
Caption = "Ïàðàìåòð îò÷¸òà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL12N27J</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdrptqrypar.Column1</parent>
		<properties>ControlSource = "lvRptQryParView.QryParNM"
Left = 49
Top = 35
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdrptqrypar</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A00R69EE</uniqueid>
		<timestamp>0</timestamp>
		<class>lst</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>listbox</baseclass>
		<objname>lstrptqrypar</objname>
		<parent/>
		<properties>Height = 100
MoverBars = .T.
Width = 345
BoundTo = .T.
nrptid = 0
Name = "lstrptqrypar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nrptid &lt;protected/runtime&gt; Èäåíòèôèêàòîð îò÷åòà, äëÿ êîòîðîãî îòîáðàæàþòñÿ ïàðàìåòðû âûáîðêè.
*_rsrequery 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\base_v1_grd.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>lstrptqrypar</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_153153G34</uniqueid>
		<timestamp>0</timestamp>
		<class>tlbfrm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>toolbar</baseclass>
		<objname>tlbrptfrm</objname>
		<parent/>
		<properties>Caption = "Íàâèãàöèÿ"
Height = 31
Left = 6
Top = 6
Width = 80
Name = "tlbrptfrm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15315FIN8</uniqueid>
		<timestamp>0</timestamp>
		<class>cmdtlbfrm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdToolBarModi</objname>
		<parent>tlbrptfrm</parent>
		<properties>Top = 5
Left = 5
Picture = ..\graphic\rptfrmmodi.bmp
ToolTipText = "Ðåäàòèðîâàòü ôîðìó"
ZOrderSet = 0
_msg = MODI
Name = "cmdToolBarModi"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1540Q2UT0</uniqueid>
		<timestamp>0</timestamp>
		<class>spr</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>separator</baseclass>
		<objname>spr1</objname>
		<parent>tlbrptfrm</parent>
		<properties>Top = 5
Left = 32
Height = 0
Width = 0
Name = "spr1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1540Q2UT5</uniqueid>
		<timestamp>0</timestamp>
		<class>cmdtlbfrm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdToolBarExp</objname>
		<parent>tlbrptfrm</parent>
		<properties>Top = 5
Left = 32
Picture = ..\graphic\rtpfrmexp.bmp
ToolTipText = "Ýêñïîðò îò÷åòà â ôàéë"
ZOrderSet = 5
_msg = EXP
Name = "cmdToolBarExp"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1540RQZL3</uniqueid>
		<timestamp>0</timestamp>
		<class>cmdtlbfrm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdToolBarImp</objname>
		<parent>tlbrptfrm</parent>
		<properties>Top = 5
Left = 53
Picture = ..\graphic\rptfrmimp.bmp
ToolTipText = "Èìïîðò îò÷åòà èç ôàéëà"
ZOrderSet = 6
_msg = IMP
Name = "cmdToolBarImp"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>tlbrptfrm</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>926056114</timestamp>
		<class>frmidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmidctltreerptcnt</objname>
		<parent/>
		<properties>DoCreate = .T.
Name = "frmidctltreerptcnt"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
CSTDATAWORK.Name = "CSTDATAWORK"
oleimagelist.Top = 185
oleimagelist.Left = 37
oleimagelist.Height = 100
oleimagelist.Width = 100
oleimagelist.Name = "oleimagelist"
oletreeview.Height = 175
oletreeview.Width = 320
oletreeview._rsaliasname = lvRptCntTreeView
oletreeview._rsfieldnameid = RptID
oletreeview._rsfieldnameparentid = RptParID
oletreeview._rsfieldnametext = RptNM
oletreeview._imagelistobject = .parent.Oleimagelist.object
oletreeview._rsfieldnameparentflag = RptIsCnt
oletreeview._imgalias = lvRptBmps
oletreeview._imgfieldnamefilename = BmpFileNM
oletreeview._imgfieldnameindex = BmpId
oletreeview._rsfieldnameimageindex = BmpId
oletreeview._rsfieldnameimageselectedindex = SelBmpId
oletreeview._parentonly = .F.
oletreeview.Name = "oletreeview"
cntcancelsavehandled.cmdCancel.Name = "cmdCancel"
cntcancelsavehandled.cmdOK.Name = "cmdOK"
cntcancelsavehandled.Name = "cntcancelsavehandled"
</properties>
		<protected/>
		<methods>PROCEDURE oletreeview._handleanychange
*-------------------------------------------------------
* Project.........: .PJX
* Library.........: .VCX
* Class.Module....: OLETREEVIEW._HANDLEANYCHANGE
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\comctl_v1_oletreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmidctltreerptcnt</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2BP11JKY7</uniqueid>
		<timestamp>946966635</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptimport</objname>
		<parent/>
		<properties>Height = 568
Width = 743
DoCreate = .T.
Caption = "Èìïîðò Òèïîâ îò÷åòîâ èç äðóãîé áàçû"
Name = "frmrptimport"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LOCAL lnConnectHandle ,lnSqlExeResult
lnConnectHandle = SQLCONNECTBAS()

IF lnConnectHandle &gt; 0
	lnSqlExeResult = 0
	DO WHILE (lnSqlExeResult = 0) AND (lnSqlExeResult # -1)
		lnSqlExeResult = SQLEXEC(lnConnectHandle, ;
			[SELECT *,0 AS _mark FROM Report Order By RptId],[ListReportForm])
	ENDDO
	***
	IF lnSqlExeResult = -1
		spHandleODBCError()
		SQLDISCONNECT(lnConnectHandle)
	ENDIF
	SELECT ListReportForm
	BROW	
ELSE
this.uretval=.f.
RETURN .f.
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2BP12OKQO</uniqueid>
		<timestamp>946966635</timestamp>
		<class>cntcancelsaveunhandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsaveunhandled1</objname>
		<parent>frmrptimport</parent>
		<properties>Top = 538
Left = 438
Width = 301
Height = 25
Name = "Cntcancelsaveunhandled1"
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 126
cmdOk.Height = 25
cmdOk.Width = 172
cmdOk.Caption = "Èìïîðòèðîâàòü (Ctrl+Enter)"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptimport</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>958363119</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptfrmedit</objname>
		<parent/>
		<properties>Height = 173
Width = 470
DoCreate = .T.
BorderStyle = 2
Caption = "Ïå÷àòíîå ïðåäñòàâëåíèå"
Icon = ..\graphic\frmrptfrmedit.ico
Name = "frmrptfrmedit"
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
Img1.Name = "Img1"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEDIT._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*02.04.2004 16:51 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*02.04.2004 16:51 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]

	*07.07.2004 17:29 -&gt;Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå / êîïèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*07.07.2004 17:35 -&gt;Óäàëèì çàïèñü
		DELETE IN lvRptFormEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*07.07.2004 12:09 -&gt;Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå îá îò÷åòå
		llDataWasChanged = .cstDataWork.DataChanged([lvRptFormEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	
	
	*07.07.2004 12:12 -&gt;Åñëè äàííûå áûëè èçìåíåíû
	IF llDataWasChanged
		
		*02.04.2004 16:59 -&gt;Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ òîâàðà
		llResSave = .cstDataWork.Save([lvRptFormEdit])
		*------------------------------------------------------------------------------
		
		*02.04.2004 17:00 -&gt;Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptFormEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------
	ELSE
		.cstDataWork.Restore([lvRptFormEdit])
	ENDIF	
	*------------------------------------------------------------------------------
	
	*03.02.2004 16:30 -&gt;Ñîõðàíÿåì ðåçóëüòàòû è ñêðûâàåì ôîðìó
	IF .cRequestedOperation == [COPY]
		.uRetVal = IIF(llResSave,spGetLastIncrementedID([lvRptFormEdit]),.F.)
	ELSE
		.uRetVal = llResSave
	ENDIF	
	*------------------------------------------------------------------------------
ELSE

	*21.01.2004 20:01 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptFormEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

*07.07.2004 17:28 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEDIT.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnRptFrmID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnRptFrmID

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

WITH This

*07.07.2004 17:25 -&gt;Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*01.04.2004 19:11 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.cntCancelSaveHandled.cmdOk.Enabled = .F.
	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
	CASE .cRequestedOperation == [COPY]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
ENDCASE
*------------------------------------------------------------------------------

*09.07.2004 12:00 -&gt;Åñëè êîïèðîâàíèå - âûïîëíèì ïðîöåäóðó êîïèðîâàíèÿ
IF .cRequestedOperation == [COPY]

	*09.07.2004 12:04 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias, ;
			laReplaceArray[1]
	***
	lcOldAlias= ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:00 -&gt;Ïåðå÷èòàåì Alias äëÿ ðåäàêòèðîâàíèÿ ñ êîïèðóåìûì ïå÷àòíûì ïðåäñòàâëåíèåì
	_PARAM = tnRptFrmID
	REQUERY([lvRptFormEdit])
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:03 -&gt;Ñîõðàíèì ñîäåðæèìîå
	SELECT lvRptFormEdit
	***
	SCATTER TO laReplaceArray
	***
	COPY MEMO RptFrmFRX TO tmp\tmprptfrmcopy.frx
	COPY MEMO RptFrmFRT TO tmp\tmprptfrmcopy.frt
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:11 -&gt;Ïåðå÷èòàåì Alias ïóñòûì è äîáàâèì äàííûå
	USE IN IIF(USED([lvRptFormEdit]),[lvRptFormEdit],0)
	USE lvRptFormEdit IN 0 NODATA
	SELECT lvRptFormEdit
	CURSORSETPROP([BUFFERING],3)
	APPEND BLANK
	***
	GATHER FROM laReplaceArray
	***
	APPEND MEMO RptFrmFRX FROM tmp\tmprptfrmcopy.frx
	APPEND MEMO RptFrmFRT FROM tmp\tmprptfrmcopy.frt
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:35 -&gt;Óêàæåì  â íàèìåíîâàíèè, ÷òî êîïèÿ
	REPLACE RptFrmNM WITH [Êîïèÿ ]+RptFrmNM IN lvRptFormEdit
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:28 -&gt;Óáüåì âðåìåííûå ôàéëû
	IF FILE([tmp\tmprptfrmcopy.frt])
		ERASE tmp\tmprptfrmcopy.frt
	ENDIF
	***
	IF FILE([tmp\tmprptfrmcopy.frx])
		ERASE tmp\tmprptfrmcopy.frx
	ENDIF
	*------------------------------------------------------------------------------
	
	*09.07.2004 12:05 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
ELSE
	
	*02.04.2004 15:34 -&gt;Ïåð÷èòàåì Alias äëÿ ðåäàêòèðîâàíèÿ
	LOCAL 	_PARAM
	_PARAM = tnRptFrmID
	REQUERY([lvRptFormEdit])
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMEDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*08.07.2004 15:25 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*08.07.2004 15:25 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ è äîáàâèì ïóñòóþ ñòðîêó
USE lvRptFormEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>13</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmNM</objname>
		<parent>frmrptfrmedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptFrmNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C140GJG</uniqueid>
		<timestamp>958363119</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenRptFrmNM</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Top = 5
Left = 115
Width = 350
Height = 23
ZOrderSet = 4
Name = "cntTxtCalcLenRptFrmNM"
txtText.ControlSource = "lvRptFormEdit.RptFrmNM"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 323
txtText._highlightobject = .Parent.lblLen;ThisForm.lblRptFrmNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 327
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A00R69EE</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmNote</objname>
		<parent>frmrptfrmedit</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 51
ZOrderSet = 5
Name = "lblRptFrmNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>958362888</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtRptFrmNote</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Height = 53
Left = 115
Top = 33
Width = 350
ZOrderSet = 6
ControlSource = "lvRptFormEdit.RptFrmNote"
IntegralHeight = .T.
_highlightobject = ThisForm.lblRptFrmNote
Name = "edtRptFrmNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A20XK3FF</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmIsModify</objname>
		<parent>frmrptfrmedit</parent>
		<properties>FontBold = .T.
Caption = "Ðåæèì:"
Left = 5
Top = 91
ZOrderSet = 7
Name = "lblRptFrmIsModify"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>958363119</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Chk1</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Top = 93
Left = 290
FontBold = .T.
Alignment = 0
ControlSource = "lvRptFormEdit.RptFrmIsWork"
ZOrderSet = 8
textchange = .T.
textchecked = Äîñòóïåí äëÿ ðàáîòû
textunchecked = Äîñòóïåí äëÿ ðàáîòû
Name = "Chk1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>958363119</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkRptFrmIsModify</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Top = 91
Left = 115
FontBold = .T.
Alignment = 0
ControlSource = "lvRptFormEdit.RptFrmIsModify"
ZOrderSet = 8
_highlightobject = ThisForm.lblRptFrmIsModify
textchange = .T.
textchecked = Ðåäàêòèðîâàíèå
textunchecked = Èñïîëíåíèå
Name = "chkRptFrmIsModify"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1ER0WC4P5</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmSavePrnEnv</objname>
		<parent>frmrptfrmedit</parent>
		<properties>FontBold = .T.
Caption = "Íàñòð. ïðèíòåðà:"
Left = 5
Top = 113
ZOrderSet = 7
Name = "lblRptFrmSavePrnEnv"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1ER0WC4P6</uniqueid>
		<timestamp>958363119</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkFrmSavePrnEnv</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Top = 113
Left = 115
FontBold = .T.
Alignment = 0
ControlSource = "lvRptFormEdit.RptFrmSavePrnEnv"
ZOrderSet = 8
_highlightobject = ThisForm.lblRptFrmSavePrnEnv
textchange = .T.
textchecked = Ñîõðàíÿòü
textunchecked = Íå ñîõðàíÿòü
Name = "chkFrmSavePrnEnv"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Height = 0
Left = 0
Top = 134
Width = 470
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>958363119</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Height = 0
Left = 0
Top = 135
Width = 470
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>958363119</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptfrmedit</parent>
		<properties>Top = 141
Left = 260
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptfrmedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>958363702</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptcntedit</objname>
		<parent/>
		<properties>Height = 184
Width = 470
DoCreate = .T.
BorderStyle = 2
Caption = "Èíôîðìàöèÿ î ãðóïïå"
Icon = ..\graphic\frmrptcntedit.ico
crequestedoperation = 
Name = "frmrptcntedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
Img1.Name = "Img1"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*02.04.2004 16:51 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*02.04.2004 16:51 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]

	*07.07.2004 17:29 -&gt;Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*07.07.2004 17:35 -&gt;Óäàëèì çàïèñü
		DELETE IN lvRptEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*07.07.2004 12:09 -&gt;Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå îá îò÷åòå
		llDataWasChanged = .cstDataWork.DataChanged([lvRptEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	
	
	*07.07.2004 12:12 -&gt;Åñëè äàííûå áûëè èçìåíåíû
	IF llDataWasChanged
		
		*02.04.2004 16:59 -&gt;Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ òîâàðà
		llResSave = .cstDataWork.Save([lvRptEdit])
		*------------------------------------------------------------------------------
		
		*02.04.2004 17:00 -&gt;Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------
	ELSE
		.cstDataWork.Restore([lvRptEdit])
	ENDIF	
	*------------------------------------------------------------------------------
	
	*03.02.2004 16:30 -&gt;Ñîõðàíÿåì ðåçóëüòàòû è ñêðûâàåì ôîðìó
	.uRetVal = llDataWasChanged
	*------------------------------------------------------------------------------
	
ELSE

	*21.01.2004 20:01 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*07.07.2004 17:28 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnRepID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnRepID

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

WITH This

*07.07.2004 17:25 -&gt;Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*02.04.2004 15:34 -&gt;Ïåð÷èòàåì Alias äëÿ ðåäàêòèðîâàíèÿ òîâàðîâ
LOCAL _PARAM
_PARAM = tnRepID
REQUERY([lvRptEdit])
*------------------------------------------------------------------------------

*01.04.2004 19:11 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.cntCancelSaveHandled.cmdOk.Enabled = .F.
	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
***********************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*01.04.2004 14:42 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*13.01.2004 20:01 -&gt;Îòêðûâàåì ñïðàâî÷íèêè
USE lvRptCntTreeView IN 0
USE lvRptBmps IN 0
USE lvRptTypeList IN 0
*------------------------------------------------------------------------------

*01.04.2004 11:49 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ
USE lvRptEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>13</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK64</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptType</objname>
		<parent>frmrptcntedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK65</uniqueid>
		<timestamp>958363702</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridRptType</objname>
		<parent>frmrptcntedit</parent>
		<properties>Top = 5
Left = 115
Width = 352
Enabled = .F.
ZOrderSet = 4
_controlsource = lvRptEdit.RptTypeID
_controlsourcetype = 1
_rsaliasname = lvRptTypeList
_rsfieldnameid = RptTypeID
_rsfieldnametext = RptTypeNM
Name = "cntIdCtlGridRptType"
txtText.Enabled = .F.
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 307
txtText._highlightobject = ThisForm.lblRptType
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 306
cmdShow.Enabled = .F.
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 329
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK67</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNM</objname>
		<parent>frmrptcntedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 36
ZOrderSet = 5
Name = "lblRptNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK68</uniqueid>
		<timestamp>958363702</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenRptNM</objname>
		<parent>frmrptcntedit</parent>
		<properties>Top = 33
Left = 115
Width = 352
Height = 23
ZOrderSet = 6
Name = "cntTxtCalcLenRptNM"
txtText.ControlSource = "lvRptEdit.RptNM"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 308
txtText._highlightobject = .Parent.lblLen;ThisForm.lblRptNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Height = 17
lblLen.Left = 320
lblLen.Top = 3
lblLen.Width = 16
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6A</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptParent</objname>
		<parent>frmrptcntedit</parent>
		<properties>FontBold = .T.
Caption = "Ñîñòîèò â ãðóïïå:"
Left = 5
Top = 64
ZOrderSet = 7
Name = "lblRptParent"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6B</uniqueid>
		<timestamp>958363702</timestamp>
		<class>cntidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlTreeRptParent</objname>
		<parent>frmrptcntedit</parent>
		<properties>Top = 61
Left = 115
Width = 352
ZOrderSet = 8
_rsaliasname = lvRptCntTreeView
_rsfieldnameid = RptID
_rsfieldnametext = RptNM
_controlsource = lvRptEdit.RptParID
_controlsourcetype = 1
_selectobject = frmidctltreerptcnt;report_v1;report.app
Name = "cntIdCtlTreeRptParent"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 308
txtText._highlightobject = ThisForm.lblRptParent
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 306
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 329
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6C</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNote</objname>
		<parent>frmrptcntedit</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 107
ZOrderSet = 9
Name = "lblRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6D</uniqueid>
		<timestamp>0</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtRptNote</objname>
		<parent>frmrptcntedit</parent>
		<properties>Height = 53
Left = 115
Top = 89
Width = 200
ZOrderSet = 10
ControlSource = "lvRptEdit.RptNote"
IntegralHeight = .T.
_highlightobject = ThisForm.lblRptNote
Name = "edtRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6E</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptcntedit</parent>
		<properties>Height = 0
Left = 0
Top = 147
Width = 470
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6F</uniqueid>
		<timestamp>958363702</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptcntedit</parent>
		<properties>Height = 0
Left = 0
Top = 148
Width = 470
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>958363702</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptcntedit</parent>
		<properties>Top = 154
Left = 262
Width = 352
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2GC0W7M4Y</uniqueid>
		<timestamp>958363702</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Chk1</objname>
		<parent>frmrptcntedit</parent>
		<properties>Top = 103
Left = 322
Height = 17
Width = 39
FontBold = .T.
Alignment = 0
ControlSource = "lvRptEdit.RptIsVisible"
ZOrderSet = 8
textchange = .T.
textchecked = Äîñòóïåí äëÿ ðàáîòû
textunchecked = Äîñòóïåí äëÿ ðàáîòû
Name = "Chk1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptcntedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>983932559</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptedit</objname>
		<parent/>
		<properties>Height = 308
Width = 700
DoCreate = .T.
BorderStyle = 3
Caption = "Îò÷åò"
Icon = ..\graphic\frmrptedit.ico
crequestedoperation = 
Name = "frmrptedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
Img1.Name = "Img1"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*02.04.2004 16:51 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*02.04.2004 16:51 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]

	*07.07.2004 17:29 -&gt;Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*07.07.2004 17:35 -&gt;Óäàëèì çàïèñü
		DELETE IN lvRptEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*07.07.2004 12:09 -&gt;Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå îá îò÷åòå
		llDataWasChanged = .cstDataWork.DataChanged([lvRptEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	
	
	*07.07.2004 12:12 -&gt;Åñëè äàííûå áûëè èçìåíåíû
	IF llDataWasChanged
		
		*02.04.2004 16:59 -&gt;Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ òîâàðà
		llResSave = .cstDataWork.Save([lvRptEdit])
		*------------------------------------------------------------------------------
		
		*02.04.2004 17:00 -&gt;Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------
	ELSE
		.cstDataWork.Restore([lvRptEdit])
	ENDIF	
	*------------------------------------------------------------------------------
	
	*03.02.2004 16:30 -&gt;Ñîõðàíÿåì ðåçóëüòàòû è ñêðûâàåì ôîðìó
	.uRetVal = llDataWasChanged
	*------------------------------------------------------------------------------
	
ELSE

	*21.01.2004 20:01 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*07.07.2004 17:28 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnRepID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnRepID

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------

WITH This

*07.07.2004 17:25 -&gt;Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*02.04.2004 15:34 -&gt;Ïåð÷èòàåì Alias äëÿ ðåäàêòèðîâàíèÿ òîâàðîâ
LOCAL _PARAM
_PARAM = tnRepID
REQUERY([lvRptEdit])
*------------------------------------------------------------------------------

*01.04.2004 19:11 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.cntCancelSaveHandled.cmdOk.Enabled = .F.
	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
***********************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTCNTEDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*01.04.2004 14:42 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*13.01.2004 20:01 -&gt;Îòêðûâàåì ñïðàâî÷íèêè
USE lvRptCntTreeView IN 0
USE lvRptBmps IN 0
USE lvRptTypeList IN 0
*------------------------------------------------------------------------------

*01.04.2004 11:49 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ
USE lvRptEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>15</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK64</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptType</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK65</uniqueid>
		<timestamp>983932559</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridRptType</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 5
Left = 115
Width = 350
Enabled = .F.
ZOrderSet = 4
_controlsource = lvRptEdit.RptTypeID
_controlsourcetype = 1
_rsaliasname = lvRptTypeList
_rsfieldnameid = RptTypeID
_rsfieldnametext = RptTypeNM
Name = "cntIdCtlGridRptType"
txtText.Enabled = .F.
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 307
txtText._highlightobject = ThisForm.lblRptType
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 305
cmdShow.Enabled = .F.
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 328
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNM</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 36
ZOrderSet = 5
Name = "lblRptNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>983932559</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenRptNM</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 33
Left = 115
Width = 581
Height = 23
ZOrderSet = 6
Name = "cntTxtCalcLenRptNM"
txtText.ControlSource = "lvRptEdit.RptNM"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 552
txtText._highlightobject = .Parent.lblLen;ThisForm.lblRptNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 555
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6A</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptParent</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Ñîñòîèò â ãðóïïå:"
Left = 5
Top = 64
ZOrderSet = 7
Name = "lblRptParent"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6B</uniqueid>
		<timestamp>983932559</timestamp>
		<class>cntidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlTreeRptParent</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 61
Left = 115
Width = 581
Height = 23
ZOrderSet = 8
_rsaliasname = lvRptCntTreeView
_rsfieldnameid = RptID
_rsfieldnametext = RptNM
_controlsource = lvRptEdit.RptParID
_controlsourcetype = 1
_selectobject = frmidctltreerptcnt;report_v1;report.app
Name = "cntIdCtlTreeRptParent"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 533
txtText._highlightobject = ThisForm.lblRptParent
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 535
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 558
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6C</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptNote</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 107
ZOrderSet = 9
Name = "lblRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10RDK6D</uniqueid>
		<timestamp>983932559</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtRptNote</objname>
		<parent>frmrptedit</parent>
		<properties>Height = 53
Left = 115
Top = 89
Width = 581
ZOrderSet = 10
ControlSource = "lvRptEdit.RptNote"
IntegralHeight = .T.
_highlightobject = ThisForm.lblRptNote
Name = "edtRptNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10XRI9D</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptQueryType</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï âûáîðêè:"
Left = 5
Top = 174
ZOrderSet = 11
Name = "lblRptQueryType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10XRI9B</uniqueid>
		<timestamp>983932559</timestamp>
		<class>opg</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>optiongroup</baseclass>
		<objname>opgRptQueryType</objname>
		<parent>frmrptedit</parent>
		<properties>ButtonCount = 4
ControlSource = "lvRptEdit.RptQueryType"
Height = 93
Left = 115
Top = 147
Width = 174
ZOrderSet = 12
Name = "opgRptQueryType"
Option1.FontBold = .T.
Option1.Caption = "VFP Procedure / Function"
Option1.Value = 0
Option1.Height = 17
Option1.Left = 5
Option1.Top = 5
Option1.Width = 160
Option1.AutoSize = .T.
Option1.Name = "Option1"
Option2.FontBold = .T.
Option2.Caption = "Visual FoxPro SP"
Option2.Value = 0
Option2.Height = 17
Option2.Left = 5
Option2.Top = 27
Option2.Width = 115
Option2.AutoSize = .T.
Option2.Name = "Option2"
Option3.FontBold = .T.
Option3.Caption = "MS SQL Server SP"
Option3.Value = 0
Option3.Height = 17
Option3.Left = 5
Option3.Top = 49
Option3.Width = 123
Option3.AutoSize = .T.
Option3.Name = "Option3"
Option4.FontBold = .T.
Option4.Caption = "Excel + VFP Procedure"
Option4.Height = 17
Option4.Left = 5
Option4.Top = 68
Option4.Width = 147
Option4.AutoSize = .T.
Option4.Name = "Option4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>983932559</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblQueryNM</objname>
		<parent>frmrptedit</parent>
		<properties>FontBold = .T.
Caption = "Âûáîðêà:"
Left = 5
Top = 252
ZOrderSet = 13
Name = "lblQueryNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A10W3O7H</uniqueid>
		<timestamp>983932559</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenQueryNM</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 249
Left = 115
Width = 581
Height = 23
ZOrderSet = 14
Name = "cntTxtCalcLenQueryNM"
txtText.ControlSource = "lvRptEdit.RptQueryNM"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 552
txtText._highlightobject = .Parent.lblLen;ThisForm.lblQueryNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 556
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>983932559</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 278
Left = 492
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2GC0VOZM6</uniqueid>
		<timestamp>983932559</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>Chk1</objname>
		<parent>frmrptedit</parent>
		<properties>Top = 173
Left = 304
Height = 17
Width = 39
FontBold = .T.
Alignment = 0
ControlSource = "lvRptEdit.RptIsVisible"
ZOrderSet = 8
textchange = .T.
textchecked = Äîñòóïåí äëÿ ðàáîòû
textunchecked = Äîñòóïåí äëÿ ðàáîòû
Name = "Chk1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>983976195</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptview</objname>
		<parent/>
		<properties>Top = 0
Left = 12
Height = 440
Width = 700
DoCreate = .T.
Caption = "Ïå÷àòíûå ôîðìû è îò÷åòû"
Icon = ..\graphic\frmrptview.ico
WindowState = 0
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
_customtoolbar = tlbRptFrm;report_v1;report.app
_allowsaveandrestorelayout = .T.
Name = "frmrptview"
cstmsghandler.Top = 0
cstmsghandler.Left = 72
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTVIEW.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ)
*-------------------------------------------------------
DODEFAULT()

*01.04.2004 15:09 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*01.04.2004 15:10 -&gt;Îòêðûâàåì LocalView ñ êàðòèíêàìè äëÿ òèïîâ îò÷åòîâ
USE lvRptBmps IN 0
*------------------------------------------------------------------------------

*01.04.2004 15:10 -&gt;Îòêðûâàåì LocalView äëÿ äåðåâà ãðóïï îò÷åòîâ
USE lvRptCntTreeView IN 0
*------------------------------------------------------------------------------

*01.04.2004 15:10 -&gt;Îòêðûâàåì Local View äëÿ Grid-à ñî ñïèñêîì îò÷åòîâ â ãðóïïå (ïóñòîé)
USE lvRptInCntView IN 0 NODATA
*------------------------------------------------------------------------------

*01.04.2004 15:10 -&gt;Îòêðûâàåì LocalView äëÿ Grid-à ñî ñïèñêîì ïå÷àòíûõ ôîðì äëÿ îò÷åòà (ïóñòîé)
USE lvRptFormView IN 0 NODATA
*------------------------------------------------------------------------------	

*01.04.2004 15:10 -&gt;Îòêðûâàåì LocalView äëÿ Grid-à ñî ñïèñêîì ïàðàìåòðîâ äëÿ îò÷åò (ïóñòîé)
USE lvRptQryParView IN 0 NODATA
*------------------------------------------------------------------------------	

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>12</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z155736</uniqueid>
		<timestamp>982540691</timestamp>
		<class>grdrptform</class>
		<classloc>report_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdRptForm</objname>
		<parent>frmrptview</parent>
		<properties>ColumnCount = 4
Height = 108
Left = 0
Panel = 1
TabIndex = 1
Top = 332
Width = 348
ZOrderSet = 3
Name = "GrdRptForm"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.ControlSource = "lvRptFormView.RptFrmNote"
Column3.Width = 123
Column3.Name = "Column3"
Column4.ControlSource = "lvRptFormView.RptFrmID"
Column4.Name = "Column4"
</properties>
		<protected/>
		<methods>PROCEDURE _add
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _copy
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _dele
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _edit
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _handlecustommsg
LPARAMETERS tuParam
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT(tuParam)
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _info
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2MP0Q6667</uniqueid>
		<timestamp>982540691</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmrptview.GrdRptForm.Column4</parent>
		<properties>Caption = "Id"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2MP0Q6668</uniqueid>
		<timestamp>982540691</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmrptview.GrdRptForm.Column4</parent>
		<properties>BorderStyle = 0
ControlSource = "lvRptFormView.RptFrmID"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0XQ97A</uniqueid>
		<timestamp>982540691</timestamp>
		<class>grdrptqrypar</class>
		<classloc>report_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdRptQryPar</objname>
		<parent>frmrptview</parent>
		<properties>Height = 108
Left = 347
Top = 332
Width = 353
Name = "GrdRptQryPar"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _dele
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _edit
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT()
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
PROCEDURE _handlecustommsg
LPARAMETERS tuParam
ThisForm.OleTreeViewReportPar.Visible = .F.
DODEFAULT(tuParam)
ThisForm.OleTreeViewReportPar.Visible = .T.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14X14NGEE</uniqueid>
		<timestamp>983976196</timestamp>
		<class>oleimagelist</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Oleimagelist</objname>
		<parent>frmrptview</parent>
		<properties>Top = 15
Left = 221
Height = 100
Width = 100
ZOrderSet = 5
Name = "Oleimagelist"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGBxgOD3zckBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PjdpYap0bEK/AQhAQKo2nIUM0EggAAADtAwAA7QMAAIB+4eYCAAUAIAAAAAAAAADAwMAA//8AAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIADmjgAAAAAAAGyOAAAAAAAA6I8AAAAAAABojwAAAAAAAOqQAAAAAAAAcJAAAAAAAAABAACAAAAAAHqSAAAAAAAADJQAAAAAAACElAAAAAAAAAKVAAAAAAAAjJUAAAAAAAAElwAAAAAAAASWAAAAAAAAkBEdAAYAAAD/////BQAAgAAAAAAAAAAAAAAAAAAAAAAImgAAAAAAAIiZAAAAAAAAjJoAAAAAAACyNQAAAAAAAJacAAAAAAAATIMAAAAAAAAEmwAAAAAAABCdAAAAAAAAkFgAAAAAAACYPQAAAAAAAI6dAAAAAAAAGp4AAAAAAABYiwAAAAAAAPCLAAAAAAAAHDcAAAAAAACkNgAAAAAAAOYdAAAAAAAA3jgAAAAAAABqOQAAAAAAAAo6AAAAAAAAtjoAAAAAAACAjQAAAAAAAF47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0XRMJC</uniqueid>
		<timestamp>983976196</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdReport</objname>
		<parent>frmrptview</parent>
		<properties>ColumnCount = 2
DeleteMark = .F.
Height = 332
Highlight = .T.
Left = 345
RecordSource = "lvRptInCntView"
TabIndex = 3
Top = 0
Width = 355
HighlightStyle = 1
_activerowhighlight = .T.
_dynamicimagealias = lvRptBmps
_dynamicimagecolumnindex = 1
_dynamicimagefieldnamefilename = BmpFileNM
_dynamicimagefieldnameindex = BmpId
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
Name = "grdReport"
Column1.ControlSource = ""
Column1.Width = 18
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.ControlSource = ""
Column2.Width = 293
Column2.ReadOnly = .T.
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._ADD
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî îò÷åòà/ãðóïïû.
*-------------------------------------------------------

*05.04.2004 17:46 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResAddingRpt
*------------------------------------------------------------------------------

*05.04.2004 17:46 -&gt;Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewReportPar.Visible = .F.
*------------------------------------------------------------------------------

*05.04.2004 17:46 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ îò÷åòà
luResAddingRpt = oMgrRpt.Do([RPT],[ADD],ThisForm.OleTreeViewReportPar.nValue)
*------------------------------------------------------------------------------

*05.04.2004 17:46 -&gt;Âåðíåì äåðåâî
ThisForm.OleTreeViewReportPar.Visible = .T.
*------------------------------------------------------------------------------

*05.04.2004 17:47 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([luResAddingRpt])==[N] &amp;&amp;çàïèñü äîáàâëåíà
	
	*05.04.2004 17:48 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias, ;
			lnRptId, ;
			laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	lnRptId = luResAddingRpt
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:48 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì òîâàðå
	USE IN IIF(USED([lvRptInCntViewRepl]),[lvRptInCntViewRepl],0)
	_PARAM = lnRptId
	USE lvRptInCntViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:48 -&gt;Îáíîâèì äàííûå â äåðåâå, åñëè äîáàâëåííûé òîâàð ÿâëÿåòñÿ êîíòåéíåðîì
	IF lvRptInCntViewRepl.RptTypeIsCnt
		
		*05.04.2004 17:48 -&gt;Îòêðîåì Alias äëÿ îáíîâëåíèÿ lvRptCntTreeView
		USE IN IIF(USED([lvRptCntTreeViewRepl]),[lvRptCntTreeViewRepl],0)
		_PARAM = lnRptId
		USE lvRptCntTreeViewRepl IN 0
		*------------------------------------------------------------------------------
		
		*05.04.2004 17:48 -&gt;Îáíîâèì äàííûå â lvTvrCntTreeView
		SELECT lvRptCntTreeViewRepl
		SCATTER TO laReplaceArray
		SELECT lvRptCntTreeView
		APPEND BLANK
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewReportPar.OperateAdd(lnRptId)
		*------------------------------------------------------------------------------
		
		*05.04.2004 17:48 -&gt;Çàêðîåì Alias äëÿ îáíîâëåíèÿ
		USE IN lvRptCntTreeViewRepl
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Âûïîëíèì äåéñòâèÿ äëÿ îáíîâëåíèÿ lvTvrInCntView
	IF ThisForm.OleTreeViewReportPar.nValue = lvRptInCntViewRepl.RptParID
	
		*05.04.2004 17:49 -&gt;Îáíîâëÿåì äàííûå
		This._RSRequery(ThisForm.OleTreeViewReportPar.nValue)
		*------------------------------------------------------------------------------
	
	ELSE
		
		*05.04.2004 17:49 -&gt;Âûáèðàåì â äåðåâå ðîäòåëüñêóþ ãðóïïó
		ThisForm.OleTreeViewReportPar.OperateSelect(lvRptInCntViewRepl.RptParID)
		*------------------------------------------------------------------------------
		
	ENDIF		
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà äîáàâëåííûå ýëåìåíò
	SELECT lvRptInCntView
	LOCATE FOR lvRptInCntView.RptID = lnRptID
	*------------------------------------------------------------------------------

	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*05.04.2004 17:49 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvRptInCntViewRepl
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._DELE
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå èíôîðìàöèè îá îò÷åòå/ãðóïïå.
*-------------------------------------------------------

*05.04.2004 17:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnId, ;
		llIsCnt, ;
		luResDele
***
lnId = lvRptInCntView.RptId
llIsCnt = lvRptInCntView.RptTypeIsCnt
*------------------------------------------------------------------------------

*01.04.2004 18:49 -&gt;Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewReportPar.Visible = .F.
*------------------------------------------------------------------------------

*01.04.2004 18:49 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ îò÷åòà/ãðóïïû
luResDele = oMgrRpt.Do([RPT],[DELE],lnId)
*------------------------------------------------------------------------------

*01.04.2004 18:49 -&gt;Âåðíåì äåðåâî
ThisForm.OleTreeViewReportPar.Visible = .T.
*------------------------------------------------------------------------------

*05.04.2004 17:50 -&gt;Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele
	
	*07.07.2004 16:57 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:51 -&gt;Åñëè îáúåêò ÿâëÿåòñÿ êîíòåéíåðîì -&gt; óäàëèì èç äåðåâà
	IF llIsCnt
		SELECT lvRptCntTreeView
		DELETE FOR lvRptCntTreeView.RptId = lnId
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewReportPar.OperateRemove(lnId)
	ENDIF
	*------------------------------------------------------------------------------
	
	*07.07.2004 17:03 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvRptInCntView
	DELETE FOR lvRptInCntView.RptID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*07.07.2004 17:05 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:52 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._EDIT
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå îò÷åòà/ãðóïïû.
*-------------------------------------------------------

*05.04.2004 17:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnRptId, ;
		luResEdit
***
lnRptId = lvRptInCntView.RptId
*------------------------------------------------------------------------------

*05.04.2004 17:50 -&gt;Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewReportPar.Visible = .F.
*------------------------------------------------------------------------------

*05.04.2004 17:50 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ
luResEdit = oMgrRpt.Do([RPT],[EDIT],lnRptId)
*------------------------------------------------------------------------------

*05.04.2004 17:50 -&gt;Âåðíåì äåðåâî
ThisForm.OleTreeViewReportPar.Visible = .T.
*------------------------------------------------------------------------------

*05.04.2004 17:50 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEdit])==[L] AND luResEdit
	
	*05.04.2004 17:51 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias, ;
			laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:51 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òîâàðå
	USE IN IIF(USED([lvRptInCntViewRepl]),[lvRptInCntViewRepl],0)
	_PARAM = lnRptId
	USE lvRptInCntViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:51 -&gt;Îáíîâèì äàííûå â äåðåâå, åñëè òîâàð ÿâÿëÿåòñÿ êîíòåéíåðîì
	IF lvRptInCntViewRepl.RptTypeIsCnt
		
		*05.04.2004 17:48 -&gt;Îòêðîåì Alias äëÿ îáíîâëåíèÿ lvRptCntTreeView
		USE IN IIF(USED([lvRptCntTreeViewRepl]),[lvRptCntTreeViewRepl],0)
		_PARAM = lnRptId
		USE lvRptCntTreeViewRepl IN 0
		*------------------------------------------------------------------------------	
			
		*05.04.2004 17:52 -&gt;Îáíîâèì äàííûå â lvRptCntTreeView
		SELECT lvRptCntTreeViewRepl
		SCATTER TO laReplaceArray
		SELECT lvRptCntTreeView
		LOCATE FOR lvRptCntTreeView.RptID = lnRptId
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewReportPar.OperateReloadNode(lnRptId)
		*------------------------------------------------------------------------------
		
		*05.04.2004 17:52 -&gt;Çàêðîåì Alis
		USE IN lvRptCntTreeViewRepl
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:52 -&gt;Âûïîëíèì äåéñòâèÿ äëÿ îáíîâëåíèÿ lvRptInCntView
	IF ThisForm.OleTreeViewReportPar.nValue = lvRptInCntViewRepl.RptParID
		
		*23.04.2004 14:01 -&gt;Îòêëþ÷àåì èñòî÷íèê äàííûõ îò Grid-à
		.SourceKeep()
		.SourceReset()
		*------------------------------------------------------------------------------
		
		*05.04.2004 17:52 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò è
		SELECT lvRptInCntViewRepl
		SCATTER TO laReplaceArray
		SELECT lvRptInCntView
		LOCATE FOR lvRptInCntView.RptID = lnRptID
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		*------------------------------------------------------------------------------
		
		*28.04.2004 00:18 -&gt;Ïîäêëþ÷àåì èñòî÷íèê äàííûõ ê Grid-ó
		.SourceRecall()
		*------------------------------------------------------------------------------
		
	ELSE
		
		*05.04.2004 17:52 -&gt;Âûáèðàåì â äåðåâå ðîäèòåëüñêóþ ãðóïïó
		ThisForm.OleTreeViewReportPar.OperateSelect(lvRptInCntViewRepl.RptParID)
		*------------------------------------------------------------------------------
		
		*05.04.2004 17:52 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvRptInCntView
		LOCATE FOR lvRptInCntView.RptID = lnRptID
		*------------------------------------------------------------------------------
		
	ENDIF		
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:52 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*05.04.2004 17:52 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:52 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvRptInCntViewRepl
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:52 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._INFO
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòðà èíôîðìàöèè îá îò÷åòå/ãðóïïå.
*-------------------------------------------------------

*01.04.2004 18:49 -&gt;Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewReportPar.Visible = .F.
*------------------------------------------------------------------------------

*01.04.2004 18:49 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè îá îò÷åòå/ãðóïïå
oMgrRpt.Do([RPT],[INFO],lvRptInCntView.RptId)
*------------------------------------------------------------------------------

*01.04.2004 18:49 -&gt;Âåðíåì äåðåâî
ThisForm.OleTreeViewReportPar.Visible = .T.
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _refreshrelatedobjects
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._REFRESHRELATEDOBJECTS
* Called by.......: &lt;Object Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ
*-------------------------------------------------------

*01.04.2004 10:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnReportID
***
lnReportID = IIF(lvRptInCntView.RptTypeIsCnt,0,lvRptInCntView.RptId)
*------------------------------------------------------------------------------

*01.04.2004 10:35 -&gt;Îáíîâëÿåì äàííûå
ThisForm.GrdRptForm._RSRequery(lnReportID)
ThisForm.GrdRptQryPar._RSRequery(lnReportID)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: PRIMARY_DOCS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDREPORT._RSREQUERY
* Called by.......: &lt;ThisForm.OleTreeViewReportPar._HandleAnyChange()&gt;
* Parameters......: &lt;tnParentId&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à.
*-------------------------------------------------------
LPARAMETERS	tnParentId

*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE	_pnParentId	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
_PARAM = tnParentId
REQUERY([lvRptInCntView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------
._refreshrelatedobjects()
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0XRMJS</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmrptview.grdReport.Column1</parent>
		<properties>Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KF0VGJEW</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmrptview.grdReport.Column1</parent>
		<properties>Left = 11
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0XRMJU</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmrptview.grdReport.Column2</parent>
		<properties>Alignment = 2
Caption = "Îò÷¸ò"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KF0VGJF1</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmrptview.grdReport.Column2</parent>
		<properties>Left = 52
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HL0XRMJW</uniqueid>
		<timestamp>983976196</timestamp>
		<class>oletreeview</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleTreeViewReportPar</objname>
		<parent>frmrptview</parent>
		<properties>Top = 2
Left = 1
Height = 330
Width = 345
TabIndex = 2
_imagelistobject = .parent.Oleimagelist.object
_imgalias = lvRptBmps
_imgfieldnamefilename = BmpFileNM
_imgfieldnameindex = BmpId
_rsaliasname = lvRptCntTreeView
_rsfieldnameid = RptID
_rsfieldnameimageindex = BmpId
_rsfieldnameimageselectedindex = SelBmpId
_rsfieldnameparentflag = RptIsCnt
_rsfieldnameparentid = RptParID
_rsfieldnametext = RptNM
Name = "OleTreeViewReportPar"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
ThisForm.grdReport._RSRequery(This.nValue)
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBkvuD3zckBAwAAAEACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZgAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+i6BMHCoUbEK/AQhAQKo2nIUM0EggAAACoIwAAGyIAAI5+4eYCAAUAIgAAAH0gaWaNAQAAAQAAAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAAAAYAAAAAAAAABQAAgIjfEgABAAAAXAAf3uy9AQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAHAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z13WRXR</uniqueid>
		<timestamp>983977468</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdrptform</objname>
		<parent/>
		<properties>ColumnCount = 3
Height = 100
RecordSource = "lvRptFormView"
Width = 345
nrptid = 0
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;ADD;EDIT;INFO;DELE;;COPY
_handledstandartmsgpromptlist = ;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü;\-;Ñêîïèðîâàòü
_handledcustommsglist = MODI;;EXP;IMP
_handledcustommsgpromptlist = Èçìåíèòü ïðåäñòàâëåíèå;\-;Ýêñïîðò;Èìïîðò
Name = "grdrptform"
Column1.ControlSource = "lvRptFormView.RptFrmIsModifyText"
Column1.Width = 17
Column1.Name = "Column1"
Column2.ControlSource = "lvRptFormView.RptFrmNM"
Column2.Width = 150
Column2.Name = "Column2"
Column3.ControlSource = "lvRptFormView.RptFrmNote"
Column3.Width = 150
Column3.Name = "Column3"
</properties>
		<protected>nrptid
</protected>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._ADD
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîçäàíèå íîâîãî ïå÷àòíîãî ïðåäñòàâëåíèÿ
*-------------------------------------------------------

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ñîçäàíèÿ íîâîãî ïå÷àòíîãî ïðåäñòàâëåíèÿ
luAddRes = oMgrRpt.Do([RPTFRM],[ADD],This.nRptID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luAddRes])==[N]
	
	WITH This
	
	*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïå÷àòíûõ ôîðì
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà äîáàâëåííûå ýëåìåíò
	SELECT lvRptFormView
	LOCATE FOR lvRptFormView.RptFrmID = luAddRes
	*------------------------------------------------------------------------------

	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	ENDWITH
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _copy
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._COPY
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Copy()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Êîïèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*-------------------------------------------------------

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luCopyRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ
luCopyRes = oMgrRpt.Do([RPTFRM],[COPY],lvRptFormView.RptFrmID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luCopyRes])==[N]
	
	WITH This
	
	*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïå÷àòíûõ ôîðì
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà êîïèþ ýëåìåíòà
	SELECT lvRptFormView
	LOCATE FOR lvRptFormView.RptFrmID = luCopyRes
	*------------------------------------------------------------------------------

	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	ENDWITH
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._DELE
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*-------------------------------------------------------

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrRpt.Do([RPTFRM],[DELE],lvRptFormView.RptFrmID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luDeleRes])==[L] AND luDeleRes
	
	WITH This
	
	*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïå÷àòíûõ ôîðì
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	ENDWITH
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._EDIT
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*-------------------------------------------------------

*08.07.2004 13:47 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnRptFrmID, ;
		luEditRes
***
lnRptFrmID = lvRptFormView.RptFrmID
*------------------------------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ
luEditRes = oMgrRpt.Do([RPTFRM],[EDIT],lnRptFrmID)
*------------------------------------------------------------------------------

*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luEditRes])==[L] AND luEditRes
	
	WITH This
	
	*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------
	
	*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïå÷àòíûõ ôîðì
	._RSRequery(.nRptID)
	*------------------------------------------------------------------------------
	
	*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàíííûé ýëåìåíò
	SELECT lvRptFormView
	LOCATE FOR lvRptFormView.RptFrmID = lnRptFrmID
	*------------------------------------------------------------------------------

	*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------
		
	*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	ENDWITH
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _gethandledcustommsglist
*-------------------------------------------------------
* Project.........:	BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._GETHANDLEDCUSTOMMSGLIST
* Called by.......: &lt;.RefreshHandledCustiomMsgList();.RightClick()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;lcHandledStandartMsgList&gt;
* Notes...........: &lt;public/user/default&gt; Ôîðìèðîâàíèå ñïèñêà ïîëüçîâàòåëüñêèõ ñîîáùåíèé íà îñíîâàíèè
*					ñïèñêà ñîîáùåíèé, óêàçàííûõ â ñâîéñòâå ._HandledCustomMsgList, ïóòåì óäàëåíèÿ ñîîáùåíèé,
*					êîòîðûå íå ìîãóò áûòü îáðàáîòàíû â äàííîì êîíòåêñòå.
*-------------------------------------------------------
WITH This

*30.10.2003 20:37 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcHandledCustomMsgList
*------------------------------------------------------------------------------

*31.10.2003 17:20 -&gt;Äîáàâëÿåì ñëåâà è ñïðàâà ïî ; ÷òîáû êîððåêòíî îáðàáûòûâàòü "êðàéíèå" ñîîáùåíèÿ
lcHandledCustomMsgList = [;]+UPPER(ALLTRIM(._HandledCustomMsgList))+[;]
*------------------------------------------------------------------------------

*30.10.2003 20:38 -&gt;Óäàëÿåì òå ñîîáùåíèÿ èç ñïèñêà, êîòîðûå íå ìîãóò áûòü îáðàáîòàíû â äàííîì êîíòåêñòå
*** (IMP)
IF !INLIST(.eRSState,__RS_EMPTY,__RS_ONE_REC,__RS_BOF,__RS_MIDDLE,__RS_EOF) OR .nRptID = 0
	lcHandledCustomMsgList = STRTRAN(lcHandledCustomMsgList,[;IMP;],[;])
ENDIF
*** (MODI) &amp; (EXP)
IF !INLIST(.eRSState,__RS_ONE_REC,__RS_BOF,__RS_MIDDLE,__RS_EOF) OR .nRptID = 0
	lcHandledCustomMsgList = STRTRAN(lcHandledCustomMsgList,[;MODI;],[;])
	lcHandledCustomMsgList = STRTRAN(lcHandledCustomMsgList,[;EXP;],[;])	
ENDIF
*------------------------------------------------------------------------------

*31.10.2003 17:22 -&gt;Óäàëÿåì ñëåâà è ñïðàâà ; äîáàâëåííûå ðàíåå
IF !(lcHandledCustomMsgList==[;])
	lcHandledCustomMsgList = SUBSTR(lcHandledCustomMsgList,2,LEN(lcHandledCustomMsgList)-2)
ELSE
	lcHandledCustomMsgList = []
ENDIF	
*------------------------------------------------------------------------------

*11.07.2004 16:07 -&gt;Âåðíåì ñïèñîê ñîîáùåíèé
RETURN lcHandledCustomMsgList
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _gethandledstandartmsglist
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._GETHANDLEDSTANDARTMSGLIST
* Called by.......: &lt;.RefreshHandledStandartMsgList();.RightClick()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;lcHandledStandartMsgList&gt;
* Notes...........: Çàïðåòèì âñå ñòàíäàðòíûå îïåðàöèè, åñëè êîä îò÷åòà 0 (ïðè ðàáîòå ñ ãðóïïîé)
*-------------------------------------------------------
RETURN IIF(This.nRptID#0,DODEFAULT(),[])
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _handlecustommsg
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._HANDLECUSTOMMSG
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; ._HandleCustomMsg&gt;
* Parameters......: &lt;tcMsg&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå, ýêñïîðò è èìïîðò ïå÷àòíûõ ôîðì
*-------------------------------------------------------
LPARAMETERS tcMsg

*11.07.2004 16:00 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ/ýêñïîðòà/èìïîðòà
DO CASE
	CASE tcMsg = [MODI]
		
		*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ ïå÷àòíîãî ïðåäñòàâëåíèÿ
		oMgrRpt.Do([RPTFRM],[MODI],lvRptFormView.RptFrmID,lvRptInCntView.RptQtype)
		*------------------------------------------------------------------------------
		
	CASE tcMsg = [EXP]
		
		*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ýêñïîðòà ïå÷àòíîãî ïðåäñòàâëåíèÿ
		oMgrRpt.Do([RPTFRM],[EXP],lvRptFormView.RptFrmID,lvRptInCntView.RptQtype)
		*------------------------------------------------------------------------------
		
	CASE tcMsg = [IMP]
	
		*11.07.2004 15:58 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
		LOCAL	luImpRes
		*------------------------------------------------------------------------------
		
		*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ èìïîðòà ïå÷àòíîãî ïðåäñòàâëåíèÿ
		luImpRes = oMgrRpt.Do([RPTFRM],[IMP],This.nRptID,lvRptInCntView.RptQtype)
		*------------------------------------------------------------------------------
		
		*08.07.2004 14:06 -&gt;Îáðàáîòàåì ðåçóëüòàòû èìïîðòà
		IF TYPE([luImpRes])==[N]
			
			WITH This
			
			*08.07.2004 14:06 -&gt;Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
			.lNoExtendedRefresh = .T.
			*------------------------------------------------------------------------------
			
			*08.07.2004 14:06 -&gt;Ïåðå÷èòàåì ñïèñîê ïå÷àòíûõ ôîðì
			._RSRequery(.nRptID)
			*------------------------------------------------------------------------------
			
			*05.04.2004 17:49 -&gt;Ïåðåõîäèì íà èìïîðòèðîâàííûé ýëåìåíò
			SELECT lvRptFormView
			LOCATE FOR lvRptFormView.RptFrmID = luImpRes
			*------------------------------------------------------------------------------

			*05.04.2004 17:49 -&gt;Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
			.lNoExtendedRefresh = .F.
			*------------------------------------------------------------------------------
				
			*05.04.2004 17:49 -&gt;Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
			.Refresh(.T.)
			*------------------------------------------------------------------------------
			
			ENDWITH
			
		ENDIF
		*------------------------------------------------------------------------------
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._INFO
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Info()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*-------------------------------------------------------

*08.07.2004 13:50 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè
oMgrRpt.Do([RPTFRM],[INFO],lvRptFormView.RptFrmID)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: GRDRPTFORM._RSREQUERY
* Called by.......: &lt;External Call's&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå RecordSource Grid-à
*-------------------------------------------------------
LPARAMETERS	tnRptID

*08.07.2004 14:23 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

WITH This

*08.07.2004 14:20 -&gt;Ñîõðàíèì èäåíòèôèêàòîð îò÷åòà
.nRptID = tnRptId
*------------------------------------------------------------------------------

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------
*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
IF .nRptID = 0
	
	*12.01.2004 19:09 -&gt;Îòêðûâàåì LocalView ïóñòûì
	USE IN lvRptFormView
	USE Basis!lvRptFormView IN 0 NODATA
	*------------------------------------------------------------------------------
	
ELSE
	
	*25.03.2004 12:13 -&gt;Îòêðûâàåì ñ äàííûìè äëÿ òåêóùåãî òîâàðà
	_PARAM = .nRptID
	REQUERY([lvRptFormView])
	*------------------------------------------------------------------------------
	
ENDIF	
*------------------------------------------------------------------------------

*08.07.2004 14:24 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>nrptid &lt;protected/runtime&gt; Èäåíòèôèêàòîð îò÷åòà, äëÿ êîòîðîãî îòîáðàæàþòñÿ ïå÷àòíûå ïðåäñòàâëåíèÿ.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\report_v1_grdrptform.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D91</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdrptform.Column1</parent>
		<properties>Alignment = 2
Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HB10381B</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdrptform.Column1</parent>
		<properties>Left = 1
Top = 35
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D93</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdrptform.Column2</parent>
		<properties>Alignment = 2
Caption = "Íàçâàíèå"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HB10381C</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdrptform.Column2</parent>
		<properties>Left = 55
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_19Z140D95</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdrptform.Column3</parent>
		<properties>Alignment = 2
Caption = "Ïðèìå÷àíèå"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HB10381D</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdrptform.Column3</parent>
		<properties>Left = 12
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdrptform</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>983978139</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptfrmimp</objname>
		<parent/>
		<properties>Height = 70
Width = 370
DoCreate = .T.
BorderStyle = 2
Caption = "Ïå÷àòíîå ïðåäñòàâëåíèå - Èìïîðò îò÷åòà â áàçó"
Icon = ..\graphic\frmrptfrmimp.ico
ntyperpt = 0
_memberdata =      145&lt;VFPData&gt;&lt;memberdata name="nfrmid" type="property" display="nFrmId"/&gt;&lt;memberdata name="ntyperpt" type="property" display="nTypeRpt"/&gt;&lt;/VFPData&gt;

Name = "frmrptfrmimp"
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
Img1.Name = "Img1"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMIMO._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èìïîðò/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*08.07.2004 15:21 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*08.07.2004 15:21 -&gt;Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*10.07.2004 22:02 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcImpFileNM
	***
	lcImpFileNM = UPPER(ALLTRIM(.txtRptFrmFileNM.Value))
	IF RIGHT(lcImpFileNM,4)==[.FRX]
		lcImpFileNM = SUBSTR(lcImpFileNM,1,LEN(lcImpFileNM)-4)
	ENDIF
	*------------------------------------------------------------------------------
	
	*10.07.2004 22:00 -&gt;Ïðîâåðèì, ÷òî áû áûë çàäàí ôàéë äëÿ
	IF EMPTY(lcImpFileNM)
		=MESSAGEBOX([Íå çàäàí ôàéë äëÿ èìïîðòà!],48,[Ïðåäóïðåæäåíèå...])
		.cmdRptFrmFileGet.Click()
		RETURN .T.
	ENDIF
	*------------------------------------------------------------------------------
	
	*11.07.2004 00:58 -&gt;Ñäåëàåì êîïèþ ôàéëà
	lcTmpFileNM = [tmp\]+SYS(2015)
	***
	*** - 05.05.2009 20:03:50 Ãëóõîâ Â.Þ. (C) - &gt;
	IF this.nTypeRpt = 4
			COPY FILE (lcImpFileNM) TO (lcTmpFileNM+[.xls])
			lcRprFrmNM = SUBSTR(lcImpFileNM,RAT([\],lcImpFileNM)+1)
			lcRprFrmNote = [Èìïîðòèðîâàí ]+TTOC(DATETIME())
		ELSE
			COPY FILE (lcImpFileNM+[.FRX]) TO (lcTmpFileNM+[.FRX])
			COPY FILE (lcImpFileNM+[.FRT]) TO (lcTmpFileNM+[.FRT])
	
			*11.07.2004 00:28 -&gt;×èòàåì èíôîðìàöèþ î ïå÷àòíîì ïðåäñòàâëåíèè
			USE (lcTmpFileNM+[.FRX]) IN 0 ALIAS FRXToImport EXCLUSIVE
			SELECT FRXToImport
			LOCATE FOR platform = [BASIS]
			IF FOUND()
				lcRprFrmNM = ALLTRIM(FRXToImport.Name)
				lcRprFrmNote = ALLTRIM(FRXToImport.Comment)
				***
				DELETE
			ELSE
				lcRprFrmNM = SUBSTR(lcImpFileNM,RAT([\],lcImpFileNM)+1)
				lcRprFrmNote = [Èìïîðòèðîâàí ]+TTOC(DATETIME())
			ENDIF
			***
			PACK
			PACK MEMO
			USE
	ENDIF
	*------------------------------------------------------------------------------
	*------------------------------------------------------------------------------
	
	*11.07.2004 00:40 -&gt;Çàïîëíèì íàèìåíîâàíèå ïå÷àòíîé ôîðìû è êîììåíòàðèé, âûïîëíèì èìïîðò
	SELECT lvRptFormEdit
	***
	REPLACE RptFrmNM WITH lcRprFrmNM, RptFrmNote WITH lcRprFrmNote
	***

	*** - 05.05.2009 20:07:57 Ãëóõîâ Â.Þ. (C) - &gt;
	IF this.nTypeRpt = 4
			APPEND MEMO RptFrmFRX FROM (lcTmpFileNM+[.xls]) OVERWRITE
			ERASE (lcTmpFileNM+[.xls])
		ELSE
			APPEND MEMO RptFrmFRX FROM (lcTmpFileNM+[.FRX]) OVERWRITE
			APPEND MEMO RptFrmFRT FROM (lcTmpFileNM+[.FRT]) OVERWRITE
			*11.07.2004 01:01 -&gt;Óäàëèì âðåìåííûé ôàéë
			ERASE (lcTmpFileNM+[.FRX])
			ERASE (lcTmpFileNM+[.FRT])
	ENDIF
	*------------------------------------------------------------------------------
	*------------------------------------------------------------------------------
	
	
	*08.07.2004 15:21 -&gt;Ïðîèçâîäèì ñîõðàíåíèå
	llResSave = .cstDataWork.Save([lvRptFormEdit])
	*------------------------------------------------------------------------------
	
	*08.07.2004 15:21 -&gt;Îáðàáàòûâàåì ðåçóëüòàòû ñîõðàíåíèÿ
	IF llResSave
		*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
		.uRetVal = spGetLastIncrementedID([lvRptFormEdit])
		*------------------------------------------------------------------------------
	ELSE
		*08.07.2004 15:21 -&gt;Ïîïûòàåìñÿ îáðàáîòàòü îøèáêó ñîõðàíåíèÿ
		IF .cstDataWork.HandleSaveFail()	&amp;&amp;åñëè îøèáêà îáðàáîòàíà
			*08.07.2004 15:22 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		ELSE
		
			*08.07.2004 15:23 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*08.07.2004 15:23 -&gt;Îòìåíÿåì èçìåíåíèÿ
			.cstDataWork.Restore([lvRptFormEdit])
			.uRetVal = .F.
			*------------------------------------------------------------------------------
		ENDIF	
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------
ELSE

	*08.07.2004 15:23 -&gt;Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvRptFormEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 15:24 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMIMP.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tnRptID,nTypeRpt

*20.01.2004 18:58 -&gt;Default Action
DODEFAULT()
*------------------------------------------------------------------------------
this.nTypeRpt = nTypeRpt
*10.07.2004 23:35 -&gt;Îòêðîåì Alias äëÿ ðåäàêòèðîâàíèÿ è äîáàâèì ïóñòóþ çàïèñü
USE lvRptFormEdit NODATA
APPEND BLANK
*------------------------------------------------------------------------------

*10.07.2004 23:35 -&gt;Çàïèøåì èäåíòèôèêàòîð îò÷åòà
REPLACE RptID WITH tnRptID IN lvRptFormEdit
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: FRMRPTFRMIMP.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìà (îòêðûòèå ñïðàâî÷íèêîâ è Alias-à äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------
DODEFAULT()

*08.07.2004 15:25 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
ntyperpt Òèï îò÷åòà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>983978139</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblRptFrmFileNM</objname>
		<parent>frmrptfrmimp</parent>
		<properties>FontBold = .T.
Caption = "Âûáåðèòå Ôàéë:"
Left = 5
Top = 8
ZOrderSet = 3
Name = "lblRptFrmFileNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>983978139</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmrptfrmimp</parent>
		<properties>Height = 0
Left = 0
Top = 34
Width = 370
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_155143UH8</uniqueid>
		<timestamp>983978139</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptfrmimp</parent>
		<properties>Top = 40
Left = 160
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>983978139</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmrptfrmimp</parent>
		<properties>Height = 0
Left = 0
Top = 33
Width = 370
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A30X91RE</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtRptFrmFileNM</objname>
		<parent>frmrptfrmimp</parent>
		<properties>Enabled = .F.
Left = 115
Top = 5
Width = 200
DisabledForeColor = 0,0,0
_highlightobject = ThisForm.lblRptFrmFileNM
Name = "txtRptFrmFileNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1A30X91RF</uniqueid>
		<timestamp>983977710</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdRptFrmFileGet</objname>
		<parent>frmrptfrmimp</parent>
		<properties>Top = 5
Left = 319
Height = 23
Width = 23
Picture = ..\graphic\cmdopen.bmp
Caption = ""
Name = "cmdRptFrmFileGet"
</properties>
		<protected/>
		<methods>PROCEDURE Click
ThisForm.txtRptFrmFileNM.Value = GETFILE(IIF(thisform.nTypeRpt=4,[XLS],[FRX]),[Âûáåðèòå ôàéë äëÿ èìïîðòà â áàçó],[Èìïîðò])
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptfrmimp</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>983991652</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmrptqryparedit</objname>
		<parent/>
		<properties>Height = 63
Width = 439
DoCreate = .T.
AutoCenter = .T.
Caption = "Ïàðàìåòð îò÷åòà"
Closable = .F.
MaxButton = .F.
MinButton = .F.
KeyPreview = .T.
WindowType = 1
crequestedoperation = 
Name = "frmrptqryparedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Left = 22
cstresizable.Height = 17
cstresizable.Width = 15
cstresizable.Name = "cstresizable"
Img1.ZOrderSet = 0
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*13.01.2005 14:39 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*13.01.2005 14:39 -&gt; Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]

*13.01.2005 14:39 -&gt;Âûïîëíèì ðàçíûå äåéñòâèÿ äëÿ äîáàâëåíèÿ/óäàëåíèÿ ïàððàìåòðà îò÷¸òà
DO CASE	
	
	*******************************************************************************
	* Óäàëåíèå ïàðàìåòðà îò÷¸òà													  *
	*******************************************************************************
	CASE .cRequestedOperation == [DELE]
	
		*23.05.2005 15:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
		LOCAL	_PARAM, ;
				lnDeletedRptID, ;
				lnDeletedRptQryParIndex
		*------------------------------------------------------------------------------

		*23.05.2005 15:49 -&gt;Ñîõðàíèì ïàðàìåòðû óäàëÿåìîé çàïèñè
		lnDeletedRptID          = lvRptQryParEdit.RptID
		lnDeletedRptQryParIndex = lvRptQryParEdit.RptQryParIndex
		*------------------------------------------------------------------------------
			
		*23.05.2005 15:52 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ èíäåêñîâ ïàðàìåòðîâ
		USE IN IIF(USED([lvRptQryParIndexEdit]),[lvRptQryParIndexEdit],0)
		_PARAM = lnDeletedRptID
		USE lvRptQryParIndexEdit IN 0
		CURSORSETPROP([BUFFERING],5,[lvRptQryParIndexEdit])
		*------------------------------------------------------------------------------
		
		*30.11.2004 12:07 -&gt;Îòêðîåì òðàíçàêöèþ
		BEGIN TRANSACTION
		*------------------------------------------------------------------------------
		
		*13.01.2005 14:40 -&gt; Óäàëèì çàïèñü
		DELETE IN lvRptQryParEdit
		*------------------------------------------------------------------------------
		
		*24.01.2005 12:08 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
		llResSave = .cstDataWork.Save([lvRptQryParEdit])
		*------------------------------------------------------------------------------
		
		*23.05.2005 15:48 -&gt;Åñëè çàïèñü óäàëåíà óñïåøíî ïðîèçâîäèì ðåèíäåêñàöèþ îñòàâøèõñÿ ïàðàìåòðîâ
		IF llResSave
			
			*23.05.2005 15:54 -&gt;Ðåèíäåêñèðóåì ïàðàìåòðû ñ èíäåêñîì áîëüøå, ÷åì ó óäàë¸ííîãî	
			REPLACE ;
				lvRptQryParIndexEdit.RptQryParIndex WITH lvRptQryParIndexEdit.RptQryParIndex-1 ;
			IN lvRptQryParIndexEdit ;
			FOR lvRptQryParIndexEdit.RptQryParIndex &gt; lnDeletedRptQryParIndex
			*------------------------------------------------------------------------------
			
			*23.05.2005 15:57 -&gt;Ñîõðàíÿåì èçìåíåííûå èíäåêñû
			llDataWasChanged = .cstDataWork.DataChanged([lvRptQryParIndexEdit],.T.)
			IF llDataWasChanged
				
				*24.01.2005 12:08 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
				llResSave = .cstDataWork.Save([lvRptQryParIndexEdit])
				*------------------------------------------------------------------------------			
				
			ENDIF
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*23.05.2005 16:01 -&gt;Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF llResSave
			
			*23.05.2005 16:02 -&gt;Çàâåðøèì òðàíçàêöèþ
			END TRANSACTION
			*------------------------------------------------------------------------------
						
		ELSE
			
			*23.05.2005 16:03 -&gt;Îòêàòèì òðàíçàêöèþ
			ROLLBACK
			*------------------------------------------------------------------------------
			
			*23.05.2005 16:03 -&gt;Îáðàáîòàåì îøèáêó
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptQryParEdit])
			ENDIF
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*23.05.2005 16:02 -&gt;Ñîõðàíèì ðåçóëüòàòû óäàëåíèÿ
		.uRetVal = llResSave
		*------------------------------------------------------------------------------
	
	*******************************************************************************
	* Äîáàâëåíèå ïàðàìåòðà îò÷¸òà												  *
	*******************************************************************************
	CASE .cRequestedOperation == [ADD]
	
		*24.01.2005 12:08 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
		llResSave = .cstDataWork.Save([lvRptQryParEdit])
		*------------------------------------------------------------------------------

		*23.05.2005 16:01 -&gt;Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
					
			*23.05.2005 16:03 -&gt;Îáðàáîòàåì îøèáêó
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvRptQryParEdit])
			ENDIF
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*23.05.2005 16:02 -&gt;Ñîõðàíèì ðåçóëüòàòû äîáàâëåíèÿ
		IF llResSave
			.uRetVal = spGetLastIncrementedID([lvRptQryParEdit])
		ELSE
			.uRetVal = .F.
		ENDIF
		*------------------------------------------------------------------------------

	ENDCASE
	*------------------------------------------------------------------------------
	
ELSE

	*13.01.2005 14:36 -&gt; Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvRptQryParEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*13.01.2005 14:37 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation, tuParam1, tuParam2&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcRequestedOperation,tuParam1,tuParam2

*12.05.2004 00:34 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*12.05.2004 00:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*12.05.2004 03:12 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cRequestedOperation = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*12.05.2004 00:33 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]

		*12.05.2004 00:32 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		SELECT lvRptQryParEdit
		APPEND BLANK
		REPLACE RptID WITH tuParam1, ;
				RptQryParIndex WITH tuParam2
		*------------------------------------------------------------------------------

	CASE .cRequestedOperation == [DELE]

		*12.05.2004 00:31 -&gt;Çàãðóçèì äàííûå ñóùåñòâóþùåé ôóíêöèè
		_PARAM = tuParam1
		***
		REQUERY([lvRptQryParEdit])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*27.12.2004 17:04 -&gt; Îòêðîåì LV ñî ñïèñêîì äîñòóïíûõ ôóíêöèé äëÿ äàííîé ýêðàííîé ôîðìû
LOCAL 	_PARAM1, ;
		_PARAM2
_PARAM1 = lvRptQryParEdit.RptID
_PARAM2 = lvRptQryParEdit.QryParID
REQUERY([lvRptQryParList])
*------------------------------------------------------------------------------

*07.04.2005 16:29 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])
		.cntIdCtlGridQueryParamList.SetValue(lvRptQryParList.QryParID)

	CASE .cRequestedOperation == [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
		
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmRptQryParEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*-------------------------------------------------------

*13.01.2005 17:32 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*13.01.2005 17:32 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*12.01.2005 18:46 -&gt; Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ (ïóñòîé)
USE lvRptQryParEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvRptQryParEdit])
*------------------------------------------------------------------------------

*13.01.2005 17:31 -&gt; Îòêðîåì ñïðàâî÷íèêè
USE lvRptQryParList IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>uretval &lt;public/runtime&gt; Çíà÷åíèå, êîòîðîå âîçâðàùàåòñÿ âî âûçûâàâøóþ ïðîöåäóðó ïîñëå ñêðûòèÿ ôîðìû.
crequestedoperation &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
*_handlecntcancelsaveevent &lt;public/user/nodefault&gt; Îáðàáîòêà íàæàòèÿ íà êëàâèøè êîíòåéíåðà CntCancelSave. Ôîðìèðîâàíèå çíà÷åíèÿ ñâîéñòâ .uRetVal ïåðåä ñêðûòèåì ôîðìû.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB13G3TM</uniqueid>
		<timestamp>983991652</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmrptqryparedit</parent>
		<properties>Top = 36
Left = 232
TabIndex = 1
ZOrderSet = 1
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C17ZLMD</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmrptqryparedit</parent>
		<properties>Top = 0
Left = 5
Height = 17
Width = 15
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOK</uniqueid>
		<timestamp>983991652</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblQueryParam</objname>
		<parent>frmrptqryparedit</parent>
		<properties>FontBold = .T.
Caption = "Âûáîðêà:"
Left = 5
Top = 8
TabIndex = 11
ZOrderSet = 5
Name = "lblQueryParam"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOO</uniqueid>
		<timestamp>983991652</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridQueryParamList</objname>
		<parent>frmrptqryparedit</parent>
		<properties>Top = 5
Left = 65
Width = 372
Height = 24
TabIndex = 12
ZOrderSet = 6
_controlsourcetype = 1
_controlsource = lvRptQryParEdit.QryParID
_rsaliasname = lvRptQryParList
_rsfieldnameid = QryParID
_rsfieldnametext = QryParNM
Name = "cntIdCtlGridQueryParamList"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 348
txtText.ZOrderSet = 2
txtText._highlightobject = .Parent.Parent.lblQueryParam
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 349
cmdShow.ZOrderSet = 3
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.ZOrderSet = 0
cmdClear.Name = "cmdClear"
CmdTree.ZOrderSet = 1
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.ZOrderSet = 4
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmrptqryparedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_0VL0XXSOC</uniqueid>
		<timestamp>995251286</timestamp>
		<class>custom</class>
		<classloc/>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE do
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: INTERFACE.DO
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé èíòåðôåéñ áèáëèîòåêè.
*-------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequestedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10

*19.05.2004 19:23 -&gt;Ïðîâåðÿåì ïåðâûå äâà îáÿçàòåëüíûõ ïàðàìåòðà
IF 	TYPE([tcEntityName])#[C] OR EMPTY([tcEntityName]) OR ;
	TYPE([tcRequestedOperation])#[C] OR EMPTY([tcRequestedOperation])
	*{
	ASSERT .F. MESSAGE [MGRRPT.DOCOMMAND: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	*}
ENDIF	
*------------------------------------------------------------------------------

*19.05.2004 19:24 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequestedOperation, ;
		llOperateResult
***
lcEntityName = UPPER(ALLTRIM(tcEntityName))
lcRequestedOperation = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*05.04.2004 19:59 -&gt;Âûïîëíÿåì îïðåàöèþ íàä ñóùíîñòüþ
DO CASE

	*******************************************************************************
	*[RPT] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ïðîñìîòðà îò÷åòîâ						  *
	*******************************************************************************
	CASE lcEntityName == [RPT] AND lcRequestedOperation == [VIEW]
	
		*19.05.2004 19:27 -&gt;Âûïîëíÿåì îïåðàöèþ
		This.Rpt_View()
		*------------------------------------------------------------------------------		

	*******************************************************************************
	*[RPT] &amp;&amp; [ADD] - äîáàâëåíèå îò÷åòà/ãðóïïû									  *
	*******************************************************************************
	CASE lcEntityName == [RPT] AND lcRequestedOperation == [ADD]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð ðîäèòåëüñêîé ãðóïïû îò÷åòà
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.Rpt_Add(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*****************************************************************************************
	*[RPT] &amp;&amp; ([EDIT] || [INFO] || [DELE]) - ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå îò÷åòà/ãðóïïû	*
	*****************************************************************************************
	CASE lcEntityName == [RPT] AND (lcRequestedOperation == [EDIT] OR lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð îò÷åòà/ãðóïïû äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.Rpt_Edit(lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[RPTFRM] &amp;&amp; [ADD] - äîáàâëåíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ						  *
	*******************************************************************************
	CASE lcEntityName == [RPTFRM] AND lcRequestedOperation == [ADD]

		*08.07.2004 14:28 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð îò÷åòà
		*------------------------------------------------------------------------------
	
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptFrm_Add(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
		
	*****************************************************************************************************
	*[RPTFRM] &amp;&amp; ([EDIT] || [INFO] || [DELE] || [COPY]) - 	ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå/êîïèðîâàíèå*
	*														ïå÷àòíîãî ïðåäñòàâëåíèÿ						*
	*****************************************************************************************************
	CASE lcEntityName == [RPTFRM] AND (lcRequestedOperation == [EDIT] OR lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE] OR lcRequestedOperation == [COPY])

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ïå÷àòíîãî ïðåäñòàâëåíèÿ äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ/êîïèðîâàíèÿ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptFrm_Edit(lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************************
	*[RPTFRM] &amp;&amp; ([MODI]) - 	ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ							*
	*********************************************************************************************
	CASE lcEntityName == [RPTFRM] AND lcRequestedOperation == [MODI]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ïå÷àòíîãî ïðåäñòàâëåíèÿ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptFrm_Modi(tuParam1,tuParam2)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************************
	*[RPTFRM] &amp;&amp; ([EXP]) - 	ýêñïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ										*
	*********************************************************************************************
	CASE lcEntityName == [RPTFRM] AND lcRequestedOperation == [EXP]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ïå÷àòíîãî ïðåäñòàâëåíèÿ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptFrm_Exp(tuParam1,tuParam2)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************************
	*[RPTFRM] &amp;&amp; ([IMP]) - 	èìïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ										*
	*********************************************************************************************
	CASE lcEntityName == [RPTFRM] AND lcRequestedOperation == [IMP]

		*08.07.2004 14:28 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ïå÷àòíîãî ïðåäñòàâëåíèÿ
		*------------------------------------------------------------------------------

		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptFrm_Imp(tuParam1,tuParam2)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
		
	*******************************************************************************
	*[RPTQRYPAR] &amp;&amp; [ADD] - äîáàâëåíèå ïàðàìåòðîâ âûáîðêè						  *
	*******************************************************************************
	CASE lcEntityName == [RPTQRYPAR] AND lcRequestedOperation == [ADD]

		*04.03.2005 11:33 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð îò÷åòà
		* tuParam2 - èíäåêñ (ïîðÿäêîâûé íîìåð) äëÿ âíîâü äîáàâëÿåìîãî ïàðàìåòðà
		*------------------------------------------------------------------------------
	
		*04.03.2005 11:33 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptQryPar_Add(tuParam1,tuParam2)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
		
	*******************************************************************************
	*[RPTQRYPAR] &amp;&amp; [DELE] - óäàëåíèå ïàðàìåòðîâ âûáîðêè						  *
	*******************************************************************************
	CASE lcEntityName == [RPTQRYPAR] AND lcRequestedOperation == [DELE]

		*10.12.2004 18:35 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ïàðàìåòðà îò÷åòà äëÿ óäàëåíèÿ
		*------------------------------------------------------------------------------
		
		*10.12.2004 18:35 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptQryPar_Dele(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[RPTQRYPAR] &amp;&amp; ([INDEX]) - èçìåíåíèå ïîðÿäêà âõîæäåíèÿ ïàðàìåòðîâ îò÷¸òà	  *
	*******************************************************************************
	CASE lcEntityName == [RPTQRYPAR] AND lcRequestedOperation == [EDIT]

		*08.07.2004 14:28 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð îò÷åòà
		*------------------------------------------------------------------------------

		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.RptQryPar_Edit(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	OTHERWISE
	
		*19.05.2004 21:59 -&gt;Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Ê ñîæàëåíèþ çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rpt_add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPT_ADD
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tuRptParID (optional) - èäåíòèôèêàòîð ðîäèòåëüñêîé ãðóïïû îò÷åòà/ãðóïïû
* Returns.........: &lt;luResAdding&gt;
* Notes...........: Äîáàâëåíèå íîâîãî îò÷åòà.
*-------------------------------------------------------
LPARAMETERS	tuRptParID

*05.04.2004 20:02 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResAdding
*------------------------------------------------------------------------------

*05.04.2004 20:02 -&gt;Çàïóñòèì íà âûïîëíåíèå ôîðìó äîáàâëåíèÿ îò÷åòà
luResAdding = oApp.DoModalFormRetValObj([frmrptadd;report_v1.vcx;report.app],tuRptParID)
*------------------------------------------------------------------------------

*05.04.2004 20:04 -&gt;Ïðåäëîæèì ïîëüçîâàòåëþ ââåñòè äîïîëíèòåëüíûå àòðèáóòû îò÷åòà
IF 	TYPE([luResAdding])==[N]
	
	*11.07.2004 18:13 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	_PARAM, ;
			llRptTypeIsCnt
	*------------------------------------------------------------------------------
	
	*11.07.2004 18:12 -&gt;Îïðåäåëèì, ÷òî äîáàâèëè îò÷åò èëè ãðóïïó
	USE IN IIF(USED([lvRptInCntViewRepl]),[lvRptInCntViewRepl],0)
	***
	_PARAM = luResAdding
	USE Basis!lvRptInCntViewRepl IN 0
	***
	llRptTypeIsCnt = lvRptInCntViewRepl.RptTypeIsCnt
	***
	USE IN IIF(USED([lvRptInCntViewRepl]),[lvRptInCntViewRepl],0)
	*------------------------------------------------------------------------------
	
	*11.07.2004 18:14 -&gt;Åñëè äîáàâèëè îò÷åò - ïðåäëîæèì ðåäàêòèðîâàíèå
	IF !llRptTypeIsCnt AND MESSAGEBOX([Îïðåäåëèòü äîïîëíèòåëüíûå àòðèáóòû îò÷åòà?],36,[Âîïðîñ...]) = 6
				
		*05.04.2004 20:09 -&gt;Âûïîëíÿåì îïåðàöèþ ðåäàêòèðîâàíèÿ òîâàðà
		This.Do([RPT],[EDIT],luResAdding)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*05.04.2004 20:05 -&gt;Âåðíåì ðåçóëüòàò îïåðàöèè
RETURN luResAdding
*------------------------------------------------------------------------------
		
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rpt_edit
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPT_EDIT
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tcRequestedOperation,tnRepID&gt;
* Returns.........: &lt;luResEdit&gt;
* Notes...........: Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå îò÷åòà/ãðóïïû.
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnRepID
		
*06.07.2004 16:09 -&gt;Ïðîâåðèì ïàðàìåòð
IF TYPE([tnRepID])#[N] OR EMPTY(tnRepID)
	ASSERT .F. MESSAGE [MGRREPORT.RPT_EDIT: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF	
*------------------------------------------------------------------------------
		
*03.02.2004 16:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcOldDataBase, ;
		lcOldAlias, ;
		lcEditObjDesc, ;
		luResEdit
***
lcOldDataBase = SET([DATABASE])
lcOldAlias 	  = ALIAS()
*------------------------------------------------------------------------------
		
*06.04.2004 12:07 -&gt;Îïðåäåëÿåì èìÿ ôîðìû èñïîëüçóåìîé äëÿ ðåäàêòèðîâàíèÿ
USE IN IIF(USED([lvRptTypeInfoMgr]),[lvRptTypeInfoMgr],0)
***
_PARAM = tnRepID
***
USE Basis!lvRptTypeInfoMgr IN 0
***
IF RECCOUNT([lvRptTypeInfoMgr]) # 1
	ASSERT .F. MESSAGE [MGRREPORT.RPT_EDIT: íåâîçìîæíî îïðåäåëèòü òèï îò÷åòà]
	RETURN .F.
ENDIF
***
lcEditObjDesc = lvRptTypeInfoMgr.RptTypeObjDesc
***
USE IN IIF(USED([lvRptTypeInfoMgr]),[lvRptTypeInfoMgr],0)
*------------------------------------------------------------------------------

*11.07.2004 16:35 -&gt;Âîññòàíîâèì òåêóùóþ áàçó äàííûõ
IF !EMPTY(lcOldDatabase) AND DBUSED(lcOldDatabase) AND lcOldDatabase#SET([DATABASE])
	SET DATABASE TO (lcOldDatabase)
ENDIF
*------------------------------------------------------------------------------

*11.07.2004 16:35 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
	SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------
		
*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ îò÷åòà/ãðóïïû
luResEdit = oApp.DoModalFormRetValObj(lcEditObjDesc,tcRequestedOperation,tnRepID)
*------------------------------------------------------------------------------		

*06.07.2004 16:26 -&gt;Ñîîáùèì ðåçóëüòàò ðåäàêòèðîâàíèÿ		
RETURN luResEdit
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rpt_view
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPT_VIEW
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàïóñê ôîðìû äëÿ ïðîñìîòðà îò÷åòîâ.
*-------------------------------------------------------

*12.05.2004 14:07 -&gt;Çàïóñêàåì ôîðìó äëÿ ïðîñìîòðà äîêóìåíòîâ
oApp.ExecuteScrFormByObjDesc([frmrptview;report_v1.vcx;report.app])
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rptfrm_add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPTFRM_ADD
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;luAddRes&gt;
* Notes...........: Äîáàâëåíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ äëÿ îò÷åòà.
*-------------------------------------------------------
LPARAMETERS	tnRptID

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptID])#[N] OR EMPTY(tnRptID)
	ASSERT .F. MESSAGE [MGRREPORT.RPTFRM_ADD: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes
*------------------------------------------------------------------------------

*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ äîáàâëåíèÿ ïå÷àòíîãî ïðåäñòàâëåíèÿ
luAddRes = oApp.DoModalFormRetValObj([frmrptfrmadd;report_v1.vcx;report.app],tnRptID)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò äîáàâëåíèÿ
RETURN luAddRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE rptfrm_edit
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPTFRM_EDIT
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tcRequestedOperation,tnRptFrmID&gt;
* Returns.........: &lt;luEditRes&gt;
* Notes...........: Ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ äëÿ îò÷åòà.
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnRptFrmID

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptFrmID])#[N] OR EMPTY(tnRptFrmID)
	ASSERT .F. MESSAGE [MGRREPORT.RPTFRM_EDIT: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luEditRes
*------------------------------------------------------------------------------

*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ ïå÷àòíîãî ïðåäñòàâëåíèÿ
luEditRes = oApp.DoModalFormRetValObj([frmrptfrmedit;report_v1.vcx;report.app],tcRequestedOperation,tnRptFrmID)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò ðåäàêòèðîâàíèÿ ïðîñìîòðà
RETURN luEditRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE rptfrm_exp
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPTFRM_EXP
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptFrmID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ýêñïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ
*-------------------------------------------------------
LPARAMETERS tnRptFrmID,tnParam2

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptFrmID])#[N] OR EMPTY(tnRptFrmID)
	ASSERT .F. MESSAGE [MGRREPORT.RPTFRM_EXP: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luExpRes
*------------------------------------------------------------------------------

*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ ýêñïîðòà ïå÷àòíîãî ïðåäñòàâëåíèÿ
luExpRes = oApp.DoModalFormRetValObj([frmrptfrmexp;report_v1.vcx;report.app],tnRptFrmID)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò ðåäàêòèðîâàíèÿ ïðîñìîòðà
RETURN luExpRes
*------------------------------------------------------------------------------	

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rptfrm_imp
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPTFRM_IMP
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;luImpRes&gt;
* Notes...........: Èìïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*-------------------------------------------------------
LPARAMETERS	tnRptID,nQtype

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptID])#[N] OR EMPTY(tnRptID)
	ASSERT .F. MESSAGE [MGRREPORT.RPTFRM_IMP: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luImpRes
*------------------------------------------------------------------------------

*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ èìïîðòà ïå÷àòíîãî ïðåäñòàâëåíèÿ
luImpRes = oApp.DoModalFormRetValObj([frmrptfrmimp;report_v1.vcx;report.app],tnRptID,nQtype)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò äîáàâëåíèÿ
RETURN luImpRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
***********************************************************************************
ENDPROC
PROCEDURE rptfrm_modi
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: REPORT_V1.VCX
* Class.Module....: MGRREPORT.RPTFRM_MODI
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptFrmID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ
*-------------------------------------------------------
LPARAMETERS tnRptFrmID,nQtype

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptFrmID])#[N] OR EMPTY(tnRptFrmID)
	ASSERT .F. MESSAGE [MGRREPORT.RPTFRM_MODI: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*11.07.2004 16:33 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcOldDataBase, ;
		lcOldAlias
***
lcOldDataBase = SET([DATABASE])
lcOldAlias = ALIAS()
*------------------------------------------------------------------------------

*20.05.2004 20:56 -&gt;Îòêðûâàåì LV ñ èíôîðìàöèåé î îò÷åòå
USE IN IIF(USED([lvRptFormInfo]),[lvRptFormInfo],0)
***
_PARAM = tnRptFrmID
USE Basis!lvRptFormInfo IN 0
*-----------------------------------------------------------------------------

*11.07.2004 16:29 -&gt;Âûïîëíÿåì âûãðóçêó îò÷åòà â ôàéë
SELECT lvRptFormInfo
***
*** - 06.05.2009 09:41:17 Ãëóõîâ Â.Þ. (C) - &gt;
IF nQtype = 4
		COPY MEMO lvRptFormInfo.RptFrmFRX TO tmp\tmp.xls
		
		objExcel = CreateObject("Excel.Application")
		objWorkbook = objExcel.Workbooks.Open(FULLPATH('tmp\tmp.xls'))
		objExcel.Visible = .t.
	ELSE
		COPY MEMO lvRptFormInfo.RptFrmFRX TO tmp\tmp.frx
		COPY MEMO lvRptFormInfo.RptFrmFRT TO tmp\tmp.frt
		*------------------------------------------------------------------------------

		*11.07.2004 16:29 -&gt;Ïîäêëþ÷àåì ðåñóðñíûé ôàéë äëÿ ïå÷àòè åñëè åñòü
		lcOldResourceFile = SET([RESOURCE],1)
		***
		IF FILE([prn_res.dbf]) AND FILE([prn_res.fpt])
			COPY FILE prn_res.dbf TO tmp\prnres.dbf
			COPY FILE prn_res.fpt TO tmp\prnres.fpt
			***
			SET RESOURCE TO tmp\prnres.dbf
		ENDIF	
		*------------------------------------------------------------------------------
			
		*20.05.2004 22:08 -&gt;Âûïîëíÿåì ìîäèôèêàöèþ îò÷åòà
		MODIFY REPORT ([tmp\tmp.frx])
		*------------------------------------------------------------------------------

		*23.05.2004 04:31 -&gt;Âîññòàíàâëèâàåì êîíôèãóðàöèþ ðåñóðñíîãî ôàéëà
		SET RESOURCE TO &amp;lcOldResourceFile
		***
		IF FILE([tmp\prnres.dbf])
			ERASE tmp\prnres.dbf
		ENDIF
		IF FILE([tmp\prnres.fpt])
			ERASE tmp\prnres.fpt
		ENDIF
		*------------------------------------------------------------------------------
ENDIF
	
*23.05.2004 02:44 -&gt;Åñëè ïîëüçîâàòåëü ðåøèë ñîõðàíèòü ôîðìó îò÷åòà
IF MESSAGEBOX([Ñîõðàíèòü îòðåäàêòèðîâàííûé îò÷åò â ñèñòåìå?],32+4,[Ïîäòâåðæäåíèå...]) = 6
			*23.05.2004 02:45 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ ôîðìû îò÷åòà
			USE IN IIF(USED([lvRptFormEdit]),[lvRptFormEdit],0)
			***
			_PARAM = tnRptFrmID
			USE Basis!lvRptFormEdit IN 0
			CURSORSETPROP([BUFFERING],3,[lvRptFormEdit])
			*------------------------------------------------------------------------------

	IF nQtype &lt;&gt; 4
			*20.05.2004 22:08 -&gt;Óïàêóåì ôàéë îò÷åòà
			USE ([tmp\tmp.frx]) IN 0 ALIAS RptFrmPack EXCLUSIVE
			SELECT RptFrmPack
			PACK
			USE IN RptFrmPack
			*------------------------------------------------------------------------------
			
			*20.05.2004 22:13 -&gt;Ñîõðàíÿåì îò÷åò â ñèñòåìå
			SELECT lvRptFormEdit
			***
			APPEND MEMO lvRptFormEdit.RptFrmFRX FROM tmp\tmp.frx OVERWRITE
			APPEND MEMO lvRptFormEdit.RptFrmFRT FROM tmp\tmp.frt OVERWRITE
		ELSE
			APPEND MEMO lvRptFormEdit.RptFrmFRX FROM tmp\tmp.xls OVERWRITE
	ENDIF
	*------------------------------------------------------------------------------
	
	*23.05.2004 02:51 -&gt;Ñîõðàíÿåì îò÷åò
	llres = TABLEUPDATE(1,.T.,[lvRptFormEdit])
	*------------------------------------------------------------------------------
	
	*11.07.2004 16:31 -&gt;Çàêðîåì LV äëÿ ðåäàêòèðîâàíèÿ
	USE IN IIF(USED([lvRptFormEdit]),[lvRptFormEdit],0)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*11.07.2004 16:47 -&gt;Óäàëèì ôàéëû îò÷åòà
IF FILE([tmp\tmp.xls])
	ERASE tmp\tmp.xls
ENDIF
IF FILE([tmp\tmp.frx])
	ERASE tmp\tmp.frx
ENDIF
IF FILE([tmp\tmp.frt])
	ERASE tmp\tmp.frt
ENDIF
*------------------------------------------------------------------------------
	
*20.05.2004 20:56 -&gt;Çàêðûâàåì LV ñ èíôîðìàöèåé î îò÷åòå
USE IN IIF(USED([lvRptFormInfo]),[lvRptFormInfo],0)
*------------------------------------------------------------------------------

*11.07.2004 16:36 -&gt;Âîññòàíîâèì òåêóùóþ áàçó äàííûõ
IF !EMPTY(lcOldDatabase) AND DBUSED(lcOldDatabase) AND lcOldDatabase#SET([DATABASE])
	SET DATABASE TO (lcOldDatabase)
ENDIF
*------------------------------------------------------------------------------

*11.07.2004 16:36 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
	SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------

RETURN .T.
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rptqrypar_add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: Interface.RptQryPar_Add
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptID,tnRptQryParIndex&gt;
* Returns.........: &lt;luAddRes&gt;
* Notes...........: Äîáàâëåíèå ïàðàìåòðîâ ê îò÷åòó
*-------------------------------------------------------
LPARAMETERS	tnRptID,tnRptQryParIndex

*04.03.2005 11:34 -&gt; Ïðîâåðèì ïàðàìåòðû
IF 	TYPE([tnRptID])#[N] OR EMPTY(tnRptID) OR ;
	TYPE([tnRptQryParIndex])#[N] OR EMPTY(tnRptQryParIndex)
	***
	ASSERT .F. MESSAGE [Interface.RptQryPar_Add: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà]
	RETURN .F.
	***
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL luAddRes
*------------------------------------------------------------------------------

*04.03.2005 11:34 -&gt; Çàïóñêàåì ôîðìó äëÿ äîáàâëåíèÿ ïàðàìåòðîâ îò÷åòà
luAddRes = oApp.DoModalFormRetValObj([frmrptqryparedit;report_v1.vcx;report.app],[ADD],tnRptID,tnRptQryParIndex)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò äîáàâëåíèÿ
RETURN luAddRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rptqrypar_dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: Interface.RptQryPar_Dele
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptQryParID&gt;
* Returns.........: &lt;luDeleRes&gt;
* Notes...........: Óäàëåíèå ïàðàìåòðà îò÷¸òà
*-------------------------------------------------------
LPARAMETERS	tnRptQryParID

*04.03.2005 11:34 -&gt; Ïðîâåðèì ïàðàìåòðû
IF 	TYPE([tnRptQryParID])#[N] OR EMPTY(tnRptQryParID)
	***
	ASSERT .F. MESSAGE [Interface.RptQryPar_Dele: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà]
	RETURN .F.
	***
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL luDeleRes
*------------------------------------------------------------------------------

*04.03.2005 11:34 -&gt; Çàïóñêàåì ôîðìó äëÿ äîáàâëåíèÿ ïàðàìåòðîâ îò÷åòà
luDeleRes = oApp.DoModalFormRetValObj([frmrptqryparedit;report_v1.vcx;report.app],[DELE],tnRptQryParID)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò äîáàâëåíèÿ
RETURN luDeleRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE rptqrypar_edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: Interface.RptQryPar_Index
* Called by.......: &lt;.Do()&gt;
* Parameters......: &lt;tnRptID&gt;
* Returns.........: &lt;luIndexRes&gt;
* Notes...........: Èçìåíåíèå ïîðÿäêà âõîæäåíèÿ ïàðàìåòðîâ îò÷¸òà.
*-------------------------------------------------------
LPARAMETERS	tnRptID

*11.07.2004 16:19 -&gt;Ïðîâåðèì ïàðàìåòðû
IF TYPE([tnRptID])#[N] OR EMPTY(tnRptID)
	ASSERT .F. MESSAGE [Interface.RptQryPar_Edit: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà]
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*08.07.2004 14:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luIndexRes
*------------------------------------------------------------------------------

*06.04.2004 12:16 -&gt;Çàïóñêàåì ôîðìó äëÿ èìïîðòà ïå÷àòíîãî ïðåäñòàâëåíèÿ
luIndexRes = oApp.DoModalFormRetValObj([frmrptqryparindexedit;report_v1.vcx;report.app],tnRptID)
*------------------------------------------------------------------------------		

*08.07.2004 14:32 -&gt;Âåðíåì ðåçóëüòàò èíäåêñèðîâàíèÿ
RETURN luIndexRes
*------------------------------------------------------------------------------		

************************************************************************************
**********************************  END OF METHOD **********************************
***********************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*rpt_view 
*rpt_add 
*rpt_edit 
*rptfrm_add Äîáàâëåíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*rptfrm_edit Ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ.
*rptfrm_modi Ðåäàêòèðîâàíèå ïå÷àòíîãî ïðåäñòàâëåíèÿ (ReportDesigner)
*rptfrm_exp Ýêñïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ
*rptfrm_imp Èìïîðò ïå÷àòíîãî ïðåäñòàâëåíèÿ
*rptqrypar_edit Ðåäàêòèðîâàíèå ïàðàìåòðîâ îò÷¸òà.
*rptqrypar_add Äîáàâëåíèå ïàðàìåòðîâ îò÷¸òà.
*do 
*rptqrypar_dele 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ìåíåäæåð áèáëèîòåêè Report_v1</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
