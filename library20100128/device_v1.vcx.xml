<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicedriveredit</objname>
		<parent/>
		<properties>Height = 149
Width = 385
DoCreate = .T.
BorderStyle = 2
Caption = "Äðàéâåð"
crequestedoperation = 
Name = "frmdevicedriveredit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceDriverEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*08.07.2005 11:39 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*08.07.2005 11:39 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]

	*08.07.2005 11:39 -&gt; Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*08.07.2005 11:39 -&gt; Óäàëèì çàïèñü
		DELETE IN lvDeviceDriverEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------

	ELSE

		*08.07.2005 11:39 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå îá óñòðîéñòâå
		llDataWasChanged = .cstDataWork.DataChanged([lvDeviceDriverEdit],.T.)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------	

	*08.07.2005 11:40 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
	IF llDataWasChanged
		
		*08.07.2005 11:40 -&gt; Âûñòàâëÿåì ôëàã ìîäèôèêàöèè äàííûõ è ïðîèçâîäèì ñîõðàíåíèå
		llResSave = .cstDataWork.Save([lvDeviceDriverEdit])
		*------------------------------------------------------------------------------
		
		*08.07.2005 11:40 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvDeviceDriverEdit])
			ENDIF
		ENDIF
		*------------------------------------------------------------------------------
		
	ELSE

		*08.07.2005 11:41 -&gt; Îòìåíèì èçìåíåíèÿ
		.cstDataWork.Restore([lvDeviceDriverEdit])
		llResSave = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*08.07.2005 11:40 -&gt; Âîçâðàùàåì ðåçóëüòàò
	.uRetVal = llResSave
	*------------------------------------------------------------------------------

ELSE

	*08.07.2005 11:41 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvDeviceDriverEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*08.07.2005 11:41 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceDriverEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnDeviceDriverID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnDeviceDriverID

*08.07.2005 11:34 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;2
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceDriverEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*08.07.2005 11:34 -&gt; Ïðîâåðÿåì òèï ïåðåäàííûõ ïàðàìåòðîâ
IF TYPE([tcRequestedOperation])#[C] OR TYPE([tnDeviceDriverID])#[N]
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceDriverEdit.Init: íåâåðíûé òèï ïåðåäàííîãî ïàðàìåòðà.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*08.07.2005 11:37 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*08.07.2005 11:37 -&gt; Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*08.07.2005 11:37 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*08.07.2005 11:38 -&gt; Çàãðóçèì äàííûå â lvDeviceDriverEdit
_PARAM = tnDeviceDriverID
***
REQUERY([lvDeviceDriverEdit])
*------------------------------------------------------------------------------
		
*08.07.2005 11:38 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])

	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.

	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceDriverEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*08.07.2005 11:33 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*08.07.2005 11:33 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*08.07.2005 11:33 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvDeviceModelList IN 0
*------------------------------------------------------------------------------

*08.07.2005 11:34 -&gt; Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ (ïóñòîé)
USE lvDeviceDriverEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>9</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridDeviceModel</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>Top = 5
Left = 130
Enabled = .F.
TabIndex = 2
_controlsource = lvDeviceDriverEdit.DeviceModelID
_controlsourcetype = 1
_rsaliasname = lvDeviceModelList
_rsfieldnameid = DeviceModelID
_rsfieldnametext = DeviceModelNM
Name = "cntIdCtlGridDeviceModel"
txtText.Enabled = .F.
txtText._highlightobject = .Parent.Parent.lblDeviceModel
txtText.Name = "txtText"
cmdShow.Enabled = .F.
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceDriverVersion</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>Top = 33
Left = 130
TabIndex = 4
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceDriverVersion"
txtText.ControlSource = "lvDeviceDriverEdit.DeviceDriverVersion"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceDriverVersion
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K80OR73A</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceDriverAppDescriptor</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>Top = 61
Left = 130
TabIndex = 6
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceDriverAppDescriptor"
txtText.ControlSource = "lvDeviceDriverEdit.DeviceDriverAppDescriptor"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceDriverAppDescriptor
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11DWJS</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceDriverVersion</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>FontBold = .T.
Caption = "Âåðñèÿ äðàéâåðà:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 7
Name = "lblDeviceDriverVersion"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceModel</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>FontBold = .T.
Caption = "Ìîäåëü óñòðîéñòâà:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 7
Name = "lblDeviceModel"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K80OR73C</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceDriverAppDescriptor</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>FontBold = .T.
Caption = "Äåñêðèïòîð:"
Left = 5
Top = 64
TabIndex = 5
ZOrderSet = 7
Name = "lblDeviceDriverAppDescriptor"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>Top = 119
Left = 175
TabIndex = 8
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K10LUYTO</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDeviceDriverINI</objname>
		<parent>frmdevicedriveredit</parent>
		<properties>Top = 89
Left = 5
Height = 25
Width = 375
FontBold = .T.
Caption = "Äîïîëíèòåëüíûå íàñòðîéêè óñòðîéñòâà"
TabIndex = 7
Name = "cmdDeviceDriverINI"
</properties>
		<protected/>
		<methods>PROCEDURE Click
MODIFY MEMO lvDeviceDriverEdit.DeviceDriverINI NOWAIT
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicedriveredit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K70PVLWL</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicedriversetup</objname>
		<parent/>
		<properties>Height = 70
Width = 340
DoCreate = .T.
BorderStyle = 2
Caption = "Óñòàíîâêà äðàéâåðà"
Name = "frmdevicedriversetup"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: CSTDEVICEDRIVERSETUP._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;.cntCancelSaveHandled.cmdOk.Click;.cntCancelSaveHandled.cmdCancel.Click&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*11.08.2005 17:59 -&gt;Îáðàáîòàåì ñîîáùåíèå
IF tcMessage == .cntCancelSaveHandled._OKMsg
	
	*11.08.2005 18:00 -&gt;Ïðîâåðèì, ÷òî ôàéë âûáðàí
	IF EMPTY(.txtDriverINF.Value)
		MESSAGEBOX([Âûáåðèòå ôàéë äðàéâåðà],48,[Ïðåäóïðåæäåíèå])
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------
	
	*11.08.2005 18:02 -&gt;Ïðîâåðèì, ÷òî ôàéë ñóùåñòâóåò
	IF !FILE(.txtDriverINF.Value)
		MESSAGEBOX([Ôàéë äðàéâåðà ]+.txtDriverINF.Value+[ íå íàéäåí],48,[Ïðåäóïðåæäåíèå])
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------
	
	*11.08.2005 18:03 -&gt;Âûïîëíèì óñòàíîâêó äðàéâåðà
	.uRetVal = .Setup(.txtDriverINF.Value)
	*------------------------------------------------------------------------------
	
	*11.08.2005 18:05 -&gt;Îáðàáîòàåì ðåçóëüòàò óñòàíîâêè äðàéâåðà
	IF TYPE([.uRetVal])#[N] OR EMPTY(.uRetVal)
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------

ELSE
	
	*11.08.2005 18:04 -&gt;Ñîõðàíèì íåóñïåõ
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*11.08.2005 18:04 -&gt;Ñêðîåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceDriverSetup.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*14.10.2005 09:39 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*11.08.2005 17:57 -&gt;Îêðîåì ÁÄ
IF !DBUSED([Basis])
	OPEN DATABASE Basis
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE setup
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: cstDeviceDriverSetup.Setup
* Called by.......: &lt;~&gt;
* Parameters......: &lt;tcInfFile&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Óñòàíîâêà äðàéâåðà
*-------------------------------------------------------
LPARAMETERS tcInfFile

WITH This

*06.07.2005 17:42 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcDriverSourceDir, ;
		lcDeviceTypeDescriptor, ;
		lcDeviceTypeNM, ;
		llDeviceTypeIsCnt, ;
		lcDeviceTypeBMPFileNM, ;
		lcDeviceTypeSelBMPFileNM, ;
		lcDeviceModelDescriptor, ;
		lcDeviceModelNM, ;
		llDeviceModelGlobalAccess, ;
		lcDeviceDriverVersion, ;
		lcDeviceDriverAppDescriptor, ;
		lcDefaultINI, ;
		lnDeviceTypeID, ;
		lnDeviceModelID, ;
		lnDeviceDriverID, ;
		lnFunctionCounter, ;
		lnFunctionCount, ;
		lcFuncDescriptor, ;
		lcFuncName, ;
		lcFuncBmpFileNM, ;
		llCustomFuncIsExist
*------------------------------------------------------------------------------

*04.07.2005 12:03 -&gt; Ïðîâåðÿåì âûáðàí ëè ôàéë
IF EMPTY(tcInfFile)
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*04.07.2005 12:02 -&gt; Ïðîâåðÿåì íàëè÷èå ôàéëà
IF !FILE(tcInfFile)
	MESSAGEBOX([Ôàéë ]+ALLTRIM(tcInfFile)+[ íå íàéäåí],48,[Ïðåäóïðåæäåíèå])
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*10.08.2005 14:09 -&gt;Îïðåäåëèì êàòàëîã â êîòîðîì ëåæèò äðàéâåð
lcDriverSourceDir = SUBSTR(tcInfFile,1,RAT([\],tcInfFile))
*------------------------------------------------------------------------------

*06.07.2005 17:42 -&gt; Ñ÷èòûâàåì äàííûå èç inf-ôàéëà
lcDeviceTypeDescriptor		= UPPER(ALLTRIM(oRes.GetParam([DEVICETYPE],[Descriptor],tcInfFile)))
lcDeviceTypeNM				= ALLTRIM(oRes.GetParam([DEVICETYPE],[Name],tcInfFile))
llDeviceTypeIsCnt           = (VAL(ALLTRIM(oRes.GetParam([DEVICETYPE],[IsCnt],tcInfFile))) = 1)
lcDeviceTypeBMPFileNM       = ALLTRIM(oRes.GetParam([DEVICETYPE],[BmpFileNM],tcInfFile))
lcDeviceTypeSelBMPFileNM    = ALLTRIM(oRes.GetParam([DEVICETYPE],[SelBmpFileNM],tcInfFile))
***
lcDeviceModelDescriptor		= UPPER(ALLTRIM(oRes.GetParam([DEVICEMODEL],[Descriptor],tcInfFile)))
lcDeviceModelNM				= ALLTRIM(oRes.GetParam([DEVICEMODEL],[Name],tcInfFile))
llDeviceModelGlobalAccess   = (VAL(ALLTRIM(oRes.GetParam([DEVICEMODEL],[Name],tcInfFile))) = 1)
***
lcDeviceDriverVersion		= ALLTRIM(oRes.GetParam([DRIVER],[Version],tcInfFile))
lcDeviceDriverAppDescriptor	= ALLTRIM(oRes.GetParam([DRIVER],[AppDescriptor],tcInfFile))
lcDefaultINI				= ALLTRIM(oRes.GetParam([DRIVER],[DefaultINI],tcInfFile))
***
lnFunctionCount             = VAL(ALLTRIM(oRes.GetParam([FUNCTION],[FunctionCount],tcInfFile)))
*------------------------------------------------------------------------------

*10.08.2005 16:18 -&gt;Óñòàíîâèì òèï óñòðîéñòâà
lnDeviceTypeID = .SetupDeviceType(lcDeviceTypeDescriptor, ;
								  lcDeviceTypeNM, ;
								  llDeviceTypeIsCnt, ;
								  lcDeviceTypeBMPFileNM, ;
								  lcDeviceTypeSelBMPFileNM, ;
								  lcDriverSourceDir)
***
IF TYPE([lnDeviceTypeID])#[N] OR EMPTY(lnDeviceTypeID)
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*10.08.2005 16:22 -&gt;Óñòàíîâèì ìîäåëü óñòðîéñòâà
lnDeviceModelID = .SetupDeviceModel(lcDeviceModelDescriptor, ;
									lcDeviceModelNM, ;
									llDeviceModelGlobalAccess, ;
									lnDeviceTypeID)
***
IF TYPE([lnDeviceModelID])#[N] OR EMPTY(lnDeviceModelID)
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*10.08.2005 16:23 -&gt;Óñòàíîâèì äðàéâåð
lnDeviceDriverID = .SetupDeviceDriver(lcDeviceDriverVersion, ;
									  lcDeviceDriverAppDescriptor, ;
									  lcDefaultINI, ;
									  lnDeviceModelID, ;
									  lcDriverSourceDir)
***
IF TYPE([lnDeviceDriverID])#[N] OR EMPTY(lnDeviceDriverID)
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*11.08.2005 16:44 -&gt;Ðåãèñòðèðóåì ôóíêöèè äðàéâåðà
FOR lnFunctionCounter = 1 TO lnFunctionCount
	
	*11.08.2005 16:45 -&gt;×èòàåì èç INI ôàéëà ïàðàìåòðû ôóíêöèè
	lcFuncDescriptor = UPPER(ALLTRIM(oRes.GetParam([FUNCTION]+ALLTRIM(STR(lnFunctionCounter)),[FuncDescriptor],tcInfFile)))
	lcFuncName       = ALLTRIM(oRes.GetParam([FUNCTION]+ALLTRIM(STR(lnFunctionCounter)),[FuncName],tcInfFile))
	lcFuncBmpFileNM  = ALLTRIM(oRes.GetParam([FUNCTION]+ALLTRIM(STR(lnFunctionCounter)),[FuncBmpFileNM],tcInfFile))
	llCustomFuncIsExist = IIF(VAL(oRes.GetParam([FUNCTION]+ALLTRIM(STR(lnFunctionCounter)),[CustomFuncIsExist],tcInfFile))=1,.T.,.F.)
	*------------------------------------------------------------------------------
	
	*11.08.2005 16:50 -&gt;Óñòàíàâëèâàåì ôóíêöèþ
	.SetupDeviceDriverFunction(lcFuncDescriptor, ;
							   lcFuncName, ;
							   lcFuncBmpFileNM, ;
							   llCustomFuncIsExist, ;
							   lnDeviceDriverID, ;
							   lcDriverSourceDir)
	*------------------------------------------------------------------------------

ENDFOR
*------------------------------------------------------------------------------

*07.07.2005 17:11 -&gt; Ñîîáùèì ïîëüçîâàòåëþ îá óñïåõå
MESSAGEBOX([Äðàéâåð óñïåøíî óñòàíîâëåí!],64,[Âûïîëíåíî])
*------------------------------------------------------------------------------

*11.07.2005 10:28 -&gt; Âåðí¸ì ðåçóëüòàò
RETURN lnDeviceDriverID
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE setupdevicedriver
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: CSTDEVICEDRIVERSETUP.SETUPDEVICEDRIVER
* Called by.......: &lt;.Setup()&gt;
* Parameters......: &lt;tcDeviceDriverVersion, ;
*				     tcDeviceDriverAppDescriptor, ;
*				     tcDefaultINI, ;
*				     tnDeviceModelID, ;
*				     tcDriverSourceDir&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcDeviceDriverVersion, ;
		    tcDeviceDriverAppDescriptor, ;
		    tcDefaultINI, ;
		    tnDeviceModelID, ;
		    tcDriverSourceDir
		
*11.08.2005 15:20 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM1, ;
		_PARAM2
*------------------------------------------------------------------------------

*10.08.2005 16:30 -&gt;Îïðåäåëÿåì óñòàíîâëåí ëè äàííûé äðàéâåð
USE IN IIF(USED([lvDeviceDriverByModelAndVersion]),[lvDeviceDriverByModelAndVersion],0)
***
_PARAM1 = tnDeviceModelID
_PARAM2 = UPPER(ALLTRIM(tcDeviceDriverVersion))
USE lvDeviceDriverByModelAndVersion IN 0
*------------------------------------------------------------------------------

*10.08.2005 16:39 -&gt;Åñëè äàííûé äðàéâåð óæå óñòàíîâëåí âîçâðàùàåì èäåíòèôèêàòîð
IF RECCOUNT([lvDeviceDriverByModelAndVersion])= 1
	
	*10.08.2005 16:40 -&gt;Âîçâðàùàåì èäåíòèôèêàòîð
	RETURN lvDeviceDriverByModelAndVersion.DeviceDriverID
	*------------------------------------------------------------------------------
	
ELSE
	
	*10.08.2005 16:46 -&gt;Îòêðûâàåì è çàïîëíÿåì ïðåäñòàâëåíèå äëÿ ðåäàêòèðîâàíèå äðàéâåðîâ óñòðîéñòâ óñòðîéñòâ
	USE IN IIF(USED([lvDeviceDriverEdit]),[lvDeviceDriverEdit],0)
	***
	USE lvDeviceDriverEdit IN 0 NODATA
	SELECT lvDeviceDriverEdit
	CURSORSETPROP([BUFFERING],3)
	***
	APPEND BLANK
	***
	REPLACE ;
		DeviceModelID             WITH tnDeviceModelID, ;
		DeviceDriverVersion       WITH tcDeviceDriverVersion, ;
		DeviceDriverAppDescriptor WITH tcDeviceDriverAppDescriptor
	***
	IF !EMPTY(tcDefaultINI) AND FILE(tcDriverSourceDir+tcDefaultINI)
		APPEND MEMO	DeviceDriverINI FROM (tcDriverSourceDir+tcDefaultINI) OVERWRITE
	ENDIF
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:04 -&gt;Ñîõðàíÿåì
	llResSave = TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:07 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð
	IF llResSave
		RETURN spGetLastIncrementedID([lvDeviceDriverEdit])
	ELSE
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------
	
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE setupdevicedriverfunction
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: CSTDEVICEDRIVERSETUP.SETUPDEVICEDRIVERFUNCTION
* Called by.......: &lt;.Setup()&gt;
* Parameters......: &lt;tcFuncDescriptor,tcFuncName,tcFuncBmpFileNM,tnDeviceDriverID,tcDriverSourceDir&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåãèñòðàöèÿ ôóíêöèè äðàéâåðà óñòðîéñòâà
*------------------------------------------------------------------------------
LPARAMETERS	tcFuncDescriptor, ;
			tcFuncName, ;
			tcFuncBmpFileNM, ;
			tlCustomFuncIsExist, ;
			tnDeviceDriverID, ;
			tcDriverSourceDir

*10.08.2005 16:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		_MSG, ;
		lnBmpID, ;
		lnSelBmpID, ;
		llResSave, ;
		llResult
*------------------------------------------------------------------------------

*10.08.2005 16:30 -&gt;Îïðåäåëÿåì óñòàíîâëåíà ëè äàííàÿ ôóíêöèÿ äðàéâåðà
USE IN IIF(USED([lvDeviceDriverFuncByMSG]),[lvDeviceDriverFuncByMSG],0)
***
_PARAM = tnDeviceDriverID
_MSG = UPPER(ALLTRIM(tcFuncDescriptor))
USE lvDeviceDriverFuncByMSG IN 0
*------------------------------------------------------------------------------

*10.08.2005 16:39 -&gt;Åñëè äàííàÿ ôóíêöèÿ äðàéâåðà óæå óñòàíîâëåíà - âîçâðàùàåì èäåíòèôèêàòîð
IF RECCOUNT([lvDeviceDriverFuncByMSG]) = 1

	*23.01.2006 19:02 -&gt; Ñîõðàíÿåì èäåíòèôèêàòîð êàðòèíêè
	lnBmpID = lvDeviceDriverFuncByMSG.BmpID
	*------------------------------------------------------------------------------

	*23.01.2006 19:01 -&gt; Ñîõðàíÿåì ðåçóëüòàò
	llResult = lvDeviceDriverFuncByMSG.DeviceDriverFuncID
	*------------------------------------------------------------------------------
	
ELSE
	
	*10.08.2005 16:40 -&gt;Óñòàíàâëèâàåì êàðòèíó äëÿ ôóíêöèè äðàéâåðà
	lnBmpID = oApp.SetupBmp(tcDriverSourceDir+tcFuncBmpFileNM)
	*------------------------------------------------------------------------------
	
	*10.08.2005 16:46 -&gt;Îòêðûâàåì è çàïîëíÿåì ïðåäñòàâëåíèå äëÿ ðåäàêòèðîâàíèå òèïîâ óñòðîéñòâ
	USE IN IIF(USED([lvDeviceDriverFuncEdit]),[lvDeviceDriverFuncEdit],0)
	***
	USE lvDeviceDriverFuncEdit IN 0 NODATA
	SELECT lvDeviceDriverFuncEdit
	CURSORSETPROP([BUFFERING],3)
	***
	APPEND BLANK
	***
	REPLACE ;
		DeviceDriverID WITH tnDeviceDriverID, ;
		DeviceDriverFuncNM WITH tcFuncName, ;
		DeviceDriverFuncMsg WITH tcFuncDescriptor, ;
		BmpId WITH lnBmpID
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:04 -&gt;Ñîõðàíÿåì
	llResSave = TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:07 -&gt; Ñîõðàíÿåì ðåçóëüòàò
	IF llResSave
		llResult = spGetLastIncrementedID([lvDeviceDriverFuncEdit])
	ELSE
		llResult = .F.
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*23.01.2006 18:51 -&gt; Óñòàíàâëèâàåì ïîëüçîâàòåëüñêóþ ôóíêöèþ
IF tlCustomFuncIsExist

	*23.01.2006 19:05 -&gt; Îïðåäåëÿåì óñòàíîâëåíà ëè ïîëüçîâàòåëüñêàÿ ôóíêöèÿ
	USE IN IIF(USED([lvCstFuncByMsg]),[lvCstFuncByMsg],0)
	***
	_PARAM = UPPER(ALLTRIM(tcFuncDescriptor))
	USE lvCstFuncByMsg IN 0
	*------------------------------------------------------------------------------

	*23.01.2006 19:06 -&gt; Óñòàíàâëèâàåì ïîëüçîâàòåëüñêóþ ôóíêöèþ
	IF RECCOUNT([lvCstFuncByMsg]) # 1
		
		*23.01.2006 19:13 -&gt; Îòêðûâàåì è çàïîëíÿåì ïðåäñòàâëåíèå äëÿ ðåäàêòèðîâàíèÿ ïîëüçîâàòåëüñêèõ ôóíêöèé
		USE IN IIF(USED([lvCstFuncEdit]),[lvCstFuncEdit],0)
		***
		USE lvCstFuncEdit IN 0 NODATA
		***
		SELECT lvCstFuncEdit
		CURSORSETPROP([BUFFERING],3)
		***
		APPEND BLANK
		***
		REPLACE ;
			CstFuncNM WITH tcFuncName, ;
			CstFuncMsg WITH tcFuncDescriptor, ;
			BmpId WITH lnBmpID
		*------------------------------------------------------------------------------

		*10.08.2005 17:04 -&gt;Ñîõðàíÿåì
		llResSave = TABLEUPDATE(.T.)
		*------------------------------------------------------------------------------
	
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*23.01.2006 19:04 -&gt; Âîçâðàùàåì ðåçóëüòàò
RETURN llResult
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************


ENDPROC
PROCEDURE setupdevicemodel
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: cstDeviceDriverSetup.SetupDeviceModel
* Called by.......: &lt;.Setup()&gt;
* Parameters......: &lt;tcDeviceModelDescriptor, ;
*					tcDeviceModelNM, ;
*					tlDeviceModelGlobalAccess, ;
*					tnDeviceTypeID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óñòàíîâêà òèïà óñòðîéñòâà
*------------------------------------------------------------------------------
LPARAMETERS	tcDeviceModelDescriptor, ;
			tcDeviceModelNM, ;
			tlDeviceModelGlobalAccess, ;
			tnDeviceTypeID
			
*10.08.2005 16:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		llResSave
*------------------------------------------------------------------------------

*10.08.2005 16:30 -&gt;Îïðåäåëÿåì óñòàíîâëåí ëè äàííàÿ ìîäåëü óñòðîéñòâà
USE IN IIF(USED([lvDeviceModelByDescriptor]),[lvDeviceModelByDescriptor],0)
***
_PARAM = tcDeviceModelDescriptor
USE lvDeviceModelByDescriptor IN 0
*------------------------------------------------------------------------------

*10.08.2005 16:39 -&gt;Åñëè ìîäåëü óñòðîéñòâà óæå óñòàíîâëåíà - âîçâðàùàåì èäåíòèôèêàòîð
IF RECCOUNT([lvDeviceModelByDescriptor]) = 1
	
	*10.08.2005 16:40 -&gt;Âîçâðàùàåì èäåíòèôèêàòîð
	RETURN lvDeviceModelByDescriptor.DeviceModelID
	*------------------------------------------------------------------------------
	
ELSE
	
	*10.08.2005 16:46 -&gt;Îòêðûâàåì è çàïîëíÿåì ïðåäñòàâëåíèå äëÿ ðåäàêòèðîâàíèå ìîäåëåé óñòðîéñòâ
	USE IN IIF(USED([lvDeviceModelEdit]),[lvDeviceModelEdit],0)
	***
	USE lvDeviceModelEdit IN 0 NODATA
	SELECT lvDeviceModelEdit
	CURSORSETPROP([BUFFERING],3)
	***
	APPEND BLANK
	***
	REPLACE ;
		DeviceModelDescriptor 	WITH tcDeviceModelDescriptor, ;
		DeviceModelNM         	WITH tcDeviceModelNM, ;
		DeviceModelGlobalAccess	WITH tlDeviceModelGlobalAccess, ;
		DeviceTypeID	      	WITH tnDeviceTypeID
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:04 -&gt;Ñîõðàíÿåì
	llResSave = TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:07 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð
	IF llResSave
		RETURN spGetLastIncrementedID([lvDeviceModelEdit])
	ELSE
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE setupdevicetype
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: cstDeviceDriverSetup.SetupDeviceType
* Called by.......: &lt;.Setup()&gt;
* Parameters......: &lt;tcDeviceTypeDescriptor, ;
*				     tcDeviceTypeNM, ;
*				     tlDeviceTypeIsCnt, ;
*				     tcDeviceTypeBMPFileNM, ;
*				     tcDeviceTypeSelBMPFileNM, ;
*				     tcDriverSourceDir&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óñòàíîâêà òèïà óñòðîéñòâà
*------------------------------------------------------------------------------
LPARAMETERS	tcDeviceTypeDescriptor, ;
			tcDeviceTypeNM, ;
			tlDeviceTypeIsCnt, ;
			tcDeviceTypeBMPFileNM, ;
			tcDeviceTypeSelBMPFileNM, ;
			tcDriverSourceDir

*10.08.2005 16:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lnBmpID, ;
		lnSelBmpID, ;
		llResSave
*------------------------------------------------------------------------------

*10.08.2005 16:30 -&gt;Îïðåäåëÿåì óñòàíîâëåí ëè äàííûé òèï óñòðîéñòâà
USE IN IIF(USED([lvDeviceTypeByDescriptor]),[lvDeviceTypeByDescriptor],0)
***
_PARAM = tcDeviceTypeDescriptor
USE lvDeviceTypeByDescriptor IN 0
*------------------------------------------------------------------------------

*10.08.2005 16:39 -&gt;Åñëè òèï óñòðîéñòâ óæå óñòàíîâëåí - âîçâðàùàåì èäåíòèôèêàòîð
IF RECCOUNT([lvDeviceTypeByDescriptor]) = 1
	
	*10.08.2005 16:40 -&gt;Âîçâðàùàåì èäåíòèôèêàòîð
	RETURN lvDeviceTypeByDescriptor.DeviceTypeID
	*------------------------------------------------------------------------------
	
ELSE
	
	*10.08.2005 16:40 -&gt;Óñòàíàâëèâàåì êàðòèíó äëÿ òèïà óñòðîéñòâ
	lnBmpID    = oApp.SetupBmp(tcDriverSourceDir+tcDeviceTypeBMPFileNM)
	lnSelBmpID = oApp.SetupBmp(tcDriverSourceDir+tcDeviceTypeSelBMPFileNM)
	*------------------------------------------------------------------------------
	
	*10.08.2005 16:46 -&gt;Îòêðûâàåì è çàïîëíÿåì ïðåäñòàâëåíèå äëÿ ðåäàêòèðîâàíèå òèïîâ óñòðîéñòâ
	USE IN IIF(USED([lvDeviceTypeEdit]),[lvDeviceTypeEdit],0)
	***
	USE lvDeviceTypeEdit IN 0 NODATA
	SELECT lvDeviceTypeEdit
	CURSORSETPROP([BUFFERING],3)
	***
	APPEND BLANK
	***
	REPLACE ;
		DeviceTypeDescriptor WITH tcDeviceTypeDescriptor, ;
		DeviceTypeNM         WITH tcDeviceTypeNM, ;
		DeviceTypeIsCnt      WITH tlDeviceTypeIsCnt, ;
		BmpID                WITH lnBmpID, ;
		SelBmpID             WITH lnSelBmpID
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:04 -&gt;Ñîõðàíÿåì
	llResSave = TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*10.08.2005 17:07 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð
	IF llResSave
		RETURN spGetLastIncrementedID([lvDeviceTypeEdit])
	ELSE
		RETURN .F.
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>*setup 
*setupdevicetype &lt;public/nouser/default&gt; Óñòàíîâêà òèïà óñòðîéñòâ
*setupdevicemodel &lt;public/nouser/default&gt; Óñòàíîâêà ìîäåëè óñòðîéñòâ
*setupdevicedriver &lt;public/nouser/default&gt; Óñòàíîâêà äðàéâåðà óñòðîéñòâà
*setupdevicedriverfunction 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Äîáàâëåíèå äðàéâåðà ÷åðåç inf ôàéë</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESFW</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDriverINF</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>FontBold = .T.
Caption = "Äðàéâåð:"
Left = 4
Top = 8
ZOrderSet = 3
Name = "lblDriverINF"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESFZ</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>Height = 0
Left = -1
Top = 34
Width = 340
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESG3</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>Top = 40
Left = 130
ZOrderSet = 13
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESG7</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>Height = 0
Left = -1
Top = 33
Width = 340
ZOrderSet = 11
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESGB</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtDriverINF</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>Enabled = .F.
Left = 108
Top = 5
Width = 200
DisabledForeColor = 0,0,0
_highlightobject = ThisForm.lblDriverINF
Name = "txtDriverINF"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1L612ESGH</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDriverINFGet</objname>
		<parent>frmdevicedriversetup</parent>
		<properties>Top = 5
Left = 312
Height = 23
Width = 23
Picture = ..\graphic\cmdopen.bmp
Caption = ""
Name = "cmdDriverINFGet"
</properties>
		<protected/>
		<methods>PROCEDURE Click
ThisForm.txtDriverINF.Value = GETFILE([inf],[Äðàéâåð:],[Âûáðàòü])
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicedriversetup</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdeviceedit</objname>
		<parent/>
		<properties>Height = 205
Width = 415
DoCreate = .T.
BorderStyle = 2
Caption = "Óñòðîéñòâî"
crequestedoperation = 
Name = "frmdeviceedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*28.06.2005 10:48 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*28.06.2005 10:48 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]

	*28.06.2005 10:48 -&gt; Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*28.06.2005 10:48 -&gt; Óäàëèì çàïèñü
		DELETE IN lvDeviceEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*28.06.2005 10:49 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå îá óñòðîéñòâå
		llDataWasChanged = .cstDataWork.DataChanged([lvDeviceEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	

	*28.06.2005 10:49 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ óñòðîéñòâà
	IF llDataWasChanged
		
		*28.06.2005 10:49 -&gt; Âûñòàâëÿåì ôëàã ìîäèôèêàöèè äàííûõ è ïðîèçâîäèì ñîõðàíåíèå
		llResSave = .cstDataWork.Save([lvDeviceEdit])
		*------------------------------------------------------------------------------
		
		*28.06.2005 10:49 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvDeviceEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------

	ELSE

		*28.06.2005 10:50 -&gt; Îòìåíèì èçìåíåíèÿ
		.cstDataWork.Restore([lvDeviceEdit])
		llResSave = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*04.04.2005 11:57 -&gt; Âîçâðàùàåì ðåçóëüòàò
	IF	llResSave

		IF .cRequestedOperation == [ADD]

			*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
			.uRetVal = IIF(llResSave,spGetLastIncrementedID([lvDeviceEdit]),.F.)
			*------------------------------------------------------------------------------

		ELSE

			*04.07.2005 18:02 -&gt;Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
			.uRetVal = .T.
			*------------------------------------------------------------------------------

		ENDIF

	ELSE

		*13.01.2005 14:38 -&gt; Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
		.uRetVal = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

ELSE

	*28.06.2005 10:50 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvDeviceEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*28.06.2005 10:51 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnDeviceID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnDeviceID

*28.06.2005 10:53 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;2
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*28.06.2005 10:52 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*28.06.2005 10:54 -&gt; Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*06.07.2004 17:10 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*28.06.2005 10:55 -&gt; Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]
			
		*28.06.2005 10:55 -&gt; Äîáàâèì ïóñòóþ çàïèñü â lvDeviceEdit
		APPEND BLANK IN lvDeviceEdit
		*------------------------------------------------------------------------------

		*28.06.2005 10:55 -&gt; Ïîäñòàâèì ïåðåäàííóþ ãðóïïó óñòðîéñòâà
		REPLACE DeviceParID WITH tnDeviceID IN lvDeviceEdit
		*------------------------------------------------------------------------------
		
		*28.06.2005 15:13 -&gt; Óñòàíîâèì ïåðâóþ ïîïàâøóþñÿ ìîäåëü óñòðîéñòâà
		GO TOP IN lvDeviceModelList
		***
		REPLACE DeviceModelID WITH lvDeviceModelList.DeviceModelID IN lvDeviceEdit
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cRequestedOperation,[EDIT],[INFO],[DELE])
		
		*28.06.2005 10:56 -&gt; Çàãðóçèì äàííûå â lvDeviceEdit
		_PARAM = tnDeviceID
		***
		REQUERY([lvDeviceEdit])
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------

_PARAM = lvDeviceEdit.DeviceModelID
REQUERY([lvDeviceDriverList])

*28.06.2005 10:57 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [ADD]
		.Caption = ALLTRIM(.Caption)+[ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])

	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])

	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.

	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ è Alias-îâ äëÿ ðåäàêòèðîâàíèÿ)
*-------------------------------------------------------

*28.06.2005 10:51 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*28.06.2005 10:51 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*28.06.2005 10:51 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvDeviceCntTreeView IN 0
USE lvDeviceBmps IN 0
USE lvDeviceModelList IN 0
USE lvDeviceDriverList IN 0 NODATA
*------------------------------------------------------------------------------

*28.06.2005 10:52 -&gt; Îòêðûâàåì Alias'û äëÿ ðåäàêòèðîâàíèÿ (ïóñòûå)
USE lvDeviceEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridDeviceModel</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 33
Left = 160
TabIndex = 4
_controlsource = lvDeviceEdit.DeviceModelID
_controlsourcetype = 1
_rsaliasname = lvDeviceModelList
_rsfieldnameid = DeviceModelID
_rsfieldnametext = DeviceModelNM
Name = "cntIdCtlGridDeviceModel"
txtText._highlightobject = .Parent.Parent.lblDeviceModel
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
LOCAL	_PARAM
_PARAM = lvDeviceEdit.DeviceModelID
REQUERY([lvDeviceDriverList])
ThisForm.cntIdCtlGridDeviceDriver.SetValue(0)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HV0XIWWZ</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceNM</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 5
Left = 160
TabIndex = 2
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceNM"
txtText.ControlSource = "lvDeviceEdit.DeviceNM"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HV0XIWX2</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceNM</objname>
		<parent>frmdeviceedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 7
Name = "lblDeviceNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceModel</objname>
		<parent>frmdeviceedit</parent>
		<properties>FontBold = .T.
Caption = "Ìîäåëü óñòðîéñòâà:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 7
Name = "lblDeviceModel"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HV0YSF8R</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceParent</objname>
		<parent>frmdeviceedit</parent>
		<properties>FontBold = .T.
Caption = "Ðîäèòåëüñêîå óñòðîéñòâî:"
Left = 5
Top = 92
TabIndex = 7
ZOrderSet = 7
Name = "lblDeviceParent"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HV0YSF8S</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlTreeDeviceParent</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 89
Left = 160
TabIndex = 8
ZOrderSet = 8
_rsaliasname = lvDeviceCntTreeView
_rsfieldnameid = DeviceID
_rsfieldnametext = DeviceNM
_controlsource = lvDeviceEdit.DeviceParID
_controlsourcetype = 1
_selectobject = frmidctltreedevicecnt;device_v1;device.app
Name = "cntIdCtlTreeDeviceParent"
txtText._highlightobject = ThisForm.lblDeviceParent
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K60Z12FY</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceDriver</objname>
		<parent>frmdeviceedit</parent>
		<properties>FontBold = .T.
Caption = "Äðàéâåð óñòðîéñòâà:"
Left = 5
Top = 64
TabIndex = 5
ZOrderSet = 7
Name = "lblDeviceDriver"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 175
Left = 205
TabIndex = 11
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K10LUYTO</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDeviceINI</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 145
Left = 5
Height = 25
Width = 405
FontBold = .T.
Caption = "Äîïîëíèòåëüíûå íàñòðîéêè óñòðîéñòâà"
TabIndex = 10
Name = "cmdDeviceINI"
</properties>
		<protected/>
		<methods>PROCEDURE Click
MODIFY MEMO lvDeviceEdit.DeviceINI NOWAIT
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K60Z12FU</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridDeviceDriver</objname>
		<parent>frmdeviceedit</parent>
		<properties>Top = 61
Left = 160
TabIndex = 6
_controlsource = lvDeviceEdit.DeviceDriverID
_controlsourcetype = 1
_rsaliasname = lvDeviceDriverList
_rsfieldnameid = DeviceDriverID
_rsfieldnametext = DeviceDriverVersion
Name = "cntIdCtlGridDeviceDriver"
txtText._highlightobject = .Parent.Parent.lblDeviceDriver
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*10.08.2005 14:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*10.08.2005 14:33 -&gt;Ïîëó÷èì INI ôàéë
USE IN IIF(USED([lvDeviceDriverByID]),[lvDeviceDriverByID],0)
***
_PARAM = lvDeviceEdit.DeviceDriverID
USE lvDeviceDriverByID IN 0
*------------------------------------------------------------------------------

*10.08.2005 14:34 -&gt;Çàìåíèì INI ôàéë óñòðîéñòâà INI ôàéëîì äðàéâåðà
REPLACE DeviceINI WITH lvDeviceDriverByID.DeviceDriverINI IN lvDeviceEdit
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdeviceedit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicemodeledit</objname>
		<parent/>
		<properties>Height = 119
Width = 400
DoCreate = .T.
BorderStyle = 2
Caption = "Ìîäåëü óñòðîéñòâà"
crequestedoperation = 
Name = "frmdevicemodeledit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceModelEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*30.06.2005 16:50 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*30.06.2005 16:50 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]

	*30.06.2005 16:51 -&gt; Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*30.06.2005 16:51 -&gt; Óäàëèì çàïèñü
		DELETE IN lvDeviceModelEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE

		*30.06.2005 16:51 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå
		llDataWasChanged = .cstDataWork.DataChanged([lvDeviceModelEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	

	*30.06.2005 16:51 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
	IF llDataWasChanged

		*30.06.2005 16:51 -&gt; Âûñòàâëÿåì ôëàã ìîäèôèêàöèè äàííûõ è ïðîèçâîäèì ñîõðàíåíèå
		llResSave = .cstDataWork.Save([lvDeviceModelEdit])
		*------------------------------------------------------------------------------

		*30.06.2005 16:51 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvDeviceModelEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------

	ELSE	

		*30.06.2005 16:52 -&gt; Îòìåíèì èçìåíåíèÿ
		.cstDataWork.Restore([lvDeviceModelEdit])
		llResSave = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*04.04.2005 11:57 -&gt; Âîçâðàùàåì ðåçóëüòàò
	IF	llResSave

		IF .cRequestedOperation == [ADD]

			*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
			.uRetVal = IIF(llResSave,spGetLastIncrementedID([lvDeviceModelEdit]),.F.)
			*------------------------------------------------------------------------------

		ELSE

			*04.07.2005 18:02 -&gt;Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
			.uRetVal = .T.
			*------------------------------------------------------------------------------

		ENDIF

	ELSE

		*13.01.2005 14:38 -&gt; Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
		.uRetVal = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

ELSE

	*30.06.2005 16:52 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvDeviceModelEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:52 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceModelEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnDeviceModelID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnDeviceModelID

*30.06.2005 16:47 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;1
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceModelEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*30.06.2005 16:47 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*30.06.2005 16:47 -&gt; Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*30.06.2005 16:47 -&gt; Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]
			
		*30.06.2005 16:47 -&gt; Äîáàâèì ïóñòóþ çàïèñü â lvDeviceModelEdit
		APPEND BLANK IN lvDeviceModelEdit
		*------------------------------------------------------------------------------

		*30.06.2005 16:48 -&gt; Óñòàíîâèì ïåðâóþ ïîïàâøèéñÿ òèï óñòðîéñòâà
		GO TOP IN lvDeviceTypeList
		***
		REPLACE DeviceTypeID WITH lvDeviceTypeList.DeviceTypeID IN lvDeviceModelEdit
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cRequestedOperation,[EDIT],[INFO],[DELE])
		
		*30.06.2005 16:49 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
		IF PCOUNT()&lt;2
			*{
			ASSERT .F. MESSAGE [Device_v1.frmDeviceModelEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
			RETURN .F.
			*}
		ENDIF
		*------------------------------------------------------------------------------

		*30.06.2005 16:49 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
		PRIVATE _PARAM
		*------------------------------------------------------------------------------

		*30.06.2005 16:49 -&gt; Çàãðóçèì äàííûå â lvDeviceModelEdit
		_PARAM = tnDeviceModelID
		***
		REQUERY([lvDeviceModelEdit])
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------

*30.06.2005 16:49 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [ADD]
		.Caption = ALLTRIM(.Caption)+[ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])

	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])

	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.

	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceModelEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*30.06.2005 16:50 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*30.06.2005 16:50 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*30.06.2005 16:50 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvDeviceTypeList IN 0
*------------------------------------------------------------------------------

*30.06.2005 16:50 -&gt; Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ
USE lvDeviceModelEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>Top = 89
Left = 190
TabIndex = 7
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceModelNM</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>Top = 61
Left = 145
TabIndex = 6
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceModelNM"
txtText.ControlSource = "lvDeviceModelEdit.DeviceModelNM"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceModelNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceModelDesc</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>Top = 33
Left = 145
TabIndex = 4
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceModelDesc"
txtText.ControlSource = "lvDeviceModelEdit.DeviceModelDescriptor"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceModelDesc
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN1</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceType</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>FontBold = .T.
Caption = "Òèï óñòðîéñòâà:"
Height = 17
Left = 5
Top = 8
Width = 94
TabIndex = 1
ZOrderSet = 7
Name = "lblDeviceType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceModelDesc</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>FontBold = .T.
Caption = "Äåñêðèïòîð ìîäåëè:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 7
Name = "lblDeviceModelDesc"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceModelNM</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå ìîäåëè:"
Left = 5
Top = 64
TabIndex = 5
ZOrderSet = 7
Name = "lblDeviceModelNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN3</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridDeviceType</objname>
		<parent>frmdevicemodeledit</parent>
		<properties>Top = 5
Left = 145
TabIndex = 2
_controlsourcetype = 1
_controlsource = lvDeviceModelEdit.DeviceTypeID
_rsaliasname = lvDeviceTypeList
_rsfieldnameid = DeviceTypeID
_rsfieldnametext = DeviceTypeNM
Name = "cntIdCtlGridDeviceType"
txtText._highlightobject = .Parent.Parent.lblDeviceType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicemodeledit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>0</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicemodelview</objname>
		<parent/>
		<properties>Top = -3
Left = 8
Height = 341
Width = 754
DoCreate = .T.
Caption = "Ñïðàâî÷íèê ìîäåëåé óñòðîéñòâ"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
_allowsaveandrestorelayout = .T.
Name = "frmdevicemodelview"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceModelView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------
DODEFAULT()

*30.06.2005 15:57 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*30.06.2005 15:57 -&gt; Îòêðûâàåì LocalView ñ êàðòèíêàìè
USE lvDeviceBmps IN 0
*------------------------------------------------------------------------------

*05.07.2005 18:24 -&gt; Îòêðûâàåì Local View äëÿ Grid-à
USE lvDeviceModelView IN 0
*------------------------------------------------------------------------------

*07.07.2005 17:54 -&gt; Îòêðûâàåì Local View äëÿ Grid-à (ïóñòîé)
USE lvDeviceDriverView IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K7124YOI</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdDeviceDriver</objname>
		<parent>frmdevicemodelview</parent>
		<properties>ColumnCount = 1
Height = 331
Left = 497
Panel = 1
RecordSource = "lvDeviceDriverView"
Top = 5
Width = 252
ZOrderSet = 2
_activerowhighlight = .T.
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Óñòàíîâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
Name = "grdDeviceDriver"
Column1.ControlSource = "lvDeviceDriverView.DeviceDriverVersion"
Column1.CurrentControl = "Txtgrd1"
Column1.Width = 215
Column1.ReadOnly = .T.
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceDriver._Add
* Called by.......: &lt;NA&gt;
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Notes...........: Óñòàíîâêà äðàéâåðà
*-------------------------------------------------------

*08.07.2005 11:47 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResult
*------------------------------------------------------------------------------

*08.07.2005 11:47 -&gt; Âûïîëíÿåì îïåðàöèþ óñòàíîâêè óñòðîéñòâà
luResult = oMgrDevice.Do([DEVICEDRIVER],[SETUP])
*------------------------------------------------------------------------------

*08.07.2005 11:48 -&gt; Îáðàáàòûâàåì ðåçóëüòàò
IF TYPE([luResult])==[N] AND !EMPTY(luResult)

	*11.07.2005 10:22 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias, ;
			lnDeviceDriverID, ;
			lnDeviceModelID
	LOCAL ARRAY laReplaceArray[1]
	***
	lcOldAlias       = ALIAS()
	lnDeviceDriverID = luResult
	laReplaceArray   = .NULL.
	*------------------------------------------------------------------------------
	
	*11.08.2005 18:16 -&gt;Ïîëó÷èì èíôîðìàöèþ îþ óñòàíîâëåííîì äðàéâåðå
	USE IN IIF(USED([lvDeviceDriverByID]),[lvDeviceDriverByID],0)
	***
	_PARAM = lnDeviceDriverID
	USE lvDeviceDriverByID IN  0
	***
	IF RECCOUNT([lvDeviceDriverByID]) # 1
		RETURN
	ENDIF
	***
	lnDeviceModelID = lvDeviceDriverByID.DeviceModelID
	*------------------------------------------------------------------------------
	
	*11.07.2005 10:16 -&gt; Ïåðåõîäèì íà ìîäåëü óñòðîéñòâà, äëÿ êîòîðîé áûë äîáàâëåí äðàéâåð
	SELECT lvDeviceModelView
	LOCATE FOR DeviceModelID = lnDeviceModelID
	*------------------------------------------------------------------------------
	
	*11.07.2005 10:22 -&gt; Åñëè ìîäåëü óñòðîéñòâà íå íàéäåíà, îáíîâëÿþ äàííûå â lvDeviceModelView
	IF !FOUND()
		
		*11.07.2005 10:22 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîé ìîäåëè óñòðîéñòâà
		USE IN IIF(USED([lvDeviceModelViewRepl]),[lvDeviceModelViewRepl],0)
		_PARAM = lnDeviceModelId
		USE lvDeviceModelViewRepl IN 0
		*------------------------------------------------------------------------------

		*11.07.2005 10:23 -&gt; Îáíîâèì äàííûå â lvDeviceModelView
		SELECT lvDeviceModelViewRepl
		SCATTER TO laReplaceArray
		SELECT lvDeviceModelView
		APPEND BLANK
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		*------------------------------------------------------------------------------
		
		*11.07.2005 10:23 -&gt; Çàêðîåì Alias äëÿ îáíîâëåíèÿ
		USE IN lvDeviceModelViewRepl
		*------------------------------------------------------------------------------

		*11.07.2005 10:23 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
		SELECT lvDeviceModelView
		LOCATE FOR lvDeviceModelView.DeviceModelID = lnDeviceModelID
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*11.07.2005 10:24 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ
	ThisForm.grdDeviceModel.DynamicImageReSet()
	ThisForm.grdDeviceModel.Refresh(.T.)
	*------------------------------------------------------------------------------

	*11.07.2005 10:24 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceDriver._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå äðàéâåðà
*-------------------------------------------------------

*08.07.2005 11:19 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceDriverID, ;
		luResDele
***
lnDeviceDriverID = lvDeviceDriverView.DeviceDriverID
*------------------------------------------------------------------------------

*08.07.2005 11:19 -&gt; Âûïîëíèì îïåðàöèþ óäàëåíèÿ äðàéâåðà
luResDele = oMgrDevice.Do([DEVICEDRIVER],[DELE],lnDeviceDriverID)
*------------------------------------------------------------------------------

*08.07.2005 11:19 -&gt; Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele
	
	*08.07.2005 11:19 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*08.07.2005 11:20 -&gt; Óäàëèì îáúåêò èç Grid-à
	SELECT lvDeviceDriverView
	DELETE FOR lvDeviceDriverView.DeviceDriverID = lnDeviceDriverID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*08.07.2005 11:20 -&gt; Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*08.07.2005 11:20 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceDriver._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå äðàéâåðà
*-------------------------------------------------------

*08.07.2005 11:12 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceDriverID, ;
		luResEdit
***
lnDeviceDriverID = lvDeviceDriverView.DeviceDriverID
*------------------------------------------------------------------------------

*08.07.2005 11:12 -&gt; Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ
luResEdit = oMgrDevice.Do([DEVICEDRIVER],[EDIT],lnDeviceDriverID)
*------------------------------------------------------------------------------

*08.07.2005 11:13 -&gt; Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEdit])==[L] AND luResEdit

	*11.07.2005 09:59 -&gt; Îáíîâëÿåì äàííûå
	ThisForm.grdDeviceDriver._RSRequery(lvDeviceModelView.DeviceModelID)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceDriver._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Info()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î äðàéâåðå
*-------------------------------------------------------

*08.07.2005 11:10 -&gt; Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î äðàéâåðå
oMgrDevice.Do([DEVICEDRIVER],[INFO],lvDeviceDriverView.DeviceDriverID)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceDriver._RSRequery
* Called by.......: &lt;External Call's&gt;
* Parameters......: &lt;tnDeviceModelId&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
LPARAMETERS	tnDeviceModelID

*07.07.2005 18:02 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE	_PARAM
*------------------------------------------------------------------------------

WITH This

*07.07.2005 18:02 -&gt; Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*07.07.2005 18:02 -&gt; Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*07.07.2005 18:02 -&gt; Ïåðå÷èòàåì Local View
IF tnDeviceModelID = 0

	*07.07.2005 18:03 -&gt; Îòêðûâàåì LocalView ïóñòûì
	USE IN lvDeviceDriverView
	USE Basis!lvDeviceDriverView IN 0 NODATA
	*------------------------------------------------------------------------------
	
ELSE

	*07.07.2005 18:03 -&gt; Îòêðûâàåì ñ äàííûìè äëÿ òåêóùåãî ïàðàìåòðà îò÷åòà
	_PARAM = tnDeviceModelID
	REQUERY([lvDeviceDriverView])
	*------------------------------------------------------------------------------
	
ENDIF	
*------------------------------------------------------------------------------

*07.07.2005 18:03 -&gt; Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K7124YOY</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicemodelview.grdDeviceDriver.Column1</parent>
		<properties>Alignment = 2
Caption = "Äðàéâåð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K7124YOZ</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicemodelview.grdDeviceDriver.Column1</parent>
		<properties>Left = 32
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdDeviceModel</objname>
		<parent>frmdevicemodelview</parent>
		<properties>ColumnCount = 3
Height = 331
Left = 5
Panel = 1
RecordSource = "lvDeviceModelView"
Top = 5
Width = 487
ZOrderSet = 3
_activerowhighlight = .T.
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
_dynamicimagealias = lvDeviceBmps
_dynamicimagecolumnindex = 1
_dynamicimagefieldnamefilename = BmpFileNM
_dynamicimagefieldnameindex = BmpID
Name = "grdDeviceModel"
Column1.ControlSource = "lvDeviceModelView.BmpID"
Column1.CurrentControl = "Txtgrd1"
Column1.Width = 18
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.ControlSource = "lvDeviceModelView.DeviceModelNM"
Column2.CurrentControl = "Txtgrd1"
Column2.Width = 215
Column2.Name = "Column2"
Column3.ControlSource = "lvDeviceModelView.DeviceModelDescriptor"
Column3.CurrentControl = "Txtgrd1"
Column3.Width = 215
Column3.Name = "Column3"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceModel._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîé ìîäåëè óñòðîéñòâà
*-------------------------------------------------------
WITH This

*30.06.2005 16:05 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResAdding
*------------------------------------------------------------------------------

*30.06.2005 16:06 -&gt; Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé ìîäåëè óñòðîéñòâà
luResAdding = oMgrDevice.Do([DEVICEMODEL], [ADD])
*------------------------------------------------------------------------------

*30.06.2005 16:06 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([luResAdding])==[N]
		
	*30.06.2005 17:05 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias, ;
			lnDeviceModelId
	LOCAL ARRAY laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	lnDeviceModelId = luResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------

	*30.06.2005 17:05 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîé ìîäåëè óñòðîéñòâà
	USE IN IIF(USED([lvDeviceModelViewRepl]),[lvDeviceModelViewRepl],0)
	_PARAM = lnDeviceModelId
	USE lvDeviceModelViewRepl IN 0
	*------------------------------------------------------------------------------

	*30.06.2005 17:06 -&gt; Îáíîâèì äàííûå â lvDeviceModelView
	SELECT lvDeviceModelViewRepl
	SCATTER TO laReplaceArray
	SELECT lvDeviceModelView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*30.06.2005 17:06 -&gt; Çàêðîåì Alias äëÿ îáíîâëåíèÿ
	USE IN lvDeviceModelViewRepl
	*------------------------------------------------------------------------------

	*30.06.2005 17:07 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	SELECT lvDeviceModelView
	LOCATE FOR lvDeviceModelView.DeviceModelID = lnDeviceModelID
	*------------------------------------------------------------------------------

	*30.06.2005 17:08 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 17:08 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	.Refresh(.T.)
	*------------------------------------------------------------------------------

	*30.06.2005 17:08 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceModel._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå ìîäåëè óñòðîéñòâà
*-------------------------------------------------------

*30.06.2005 16:08 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceModelId, ;
		luResDele
***
lnDeviceModelId = lvDeviceModelView.DeviceModelId
*------------------------------------------------------------------------------

*30.06.2005 16:08 -&gt; Âûïîëíèì îïåðàöèþ óäàëåíèÿ ìîäåëè óñòðîéñòâà
luResDele = oMgrDevice.Do([DEVICEMODEL], [DELE], lnDeviceModelId)
*------------------------------------------------------------------------------

*30.06.2005 16:08 -&gt; Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele

	*30.06.2005 17:10 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------

	*30.06.2005 17:11 -&gt; Óäàëèì îáúåêò èç Grid-à
	SELECT lvDeviceModelView
	DELETE FOR lvDeviceModelView.DeviceModelID = lnDeviceModelID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*30.06.2005 17:11 -&gt; Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*30.06.2005 17:11 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceModel._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå ìîäåëè óñòðîéñòâà
*-------------------------------------------------------

*30.06.2005 16:09 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceModelId, ;
		luResEditing
***
lnDeviceModelId = lvDeviceModelView.DeviceModelId
*------------------------------------------------------------------------------

*30.06.2005 16:09 -&gt; Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ ìîäåëè óñòðîéñòâà
luResEditing = oMgrDevice.Do([DEVICEMODEL], [EDIT], lnDeviceModelId)
*------------------------------------------------------------------------------

*30.06.2005 16:10 -&gt; Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing
	
	*30.06.2005 17:13 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------

	*30.06.2005 17:13 -&gt; Ïîëó÷èì îáíîâëåííûå äàííûå î ìîäåëè óñòðîéñòâà
	USE IN IIF(USED([lvDeviceModelViewRepl]),[lvDeviceModelViewRepl],0)
	_PARAM = lnDeviceModelId
	USE lvDeviceModelViewRepl IN 0
	*------------------------------------------------------------------------------

	*30.06.2005 17:14 -&gt; Îáíîâèì äàííûå â lvDeviceModelView
	SELECT lvDeviceModelViewRepl
	SCATTER TO laReplaceArray
	SELECT lvDeviceModelView
	LOCATE FOR lvDeviceModelView.DeviceModelID = lnDeviceModelId
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*30.06.2005 17:14 -&gt; Çàêðîåì Alias
	USE IN lvDeviceModelViewRepl
	*------------------------------------------------------------------------------

	*30.06.2005 17:20 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvDeviceModelView
	LOCATE FOR lvDeviceModelView.DeviceModelID = lnDeviceModelID
	*------------------------------------------------------------------------------

	*30.06.2005 17:20 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 17:20 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*30.06.2005 17:20 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceModel._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð ìîäåëè óñòðîéñòâà
*-------------------------------------------------------

*30.06.2005 16:12 -&gt; Âûïîëíèì îïåðàöèþ ïðîñìîòðà ìîäåëè óñòðîéñòâà
oMgrDevice.Do([DEVICEMODEL], [INFO], lvDeviceModelView.DeviceModelId)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _refreshrelatedobjects
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceModel._RefreshRelatedObjects
* Called by.......: &lt;Object Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå ñâÿçàííûõ îáúåêòîâ
*-------------------------------------------------------

*07.07.2005 17:57 -&gt; Îáíîâëÿåì äàííûå
ThisForm.grdDeviceDriver._RSRequery(lvDeviceModelView.DeviceModelID)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11DWJS</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column1</parent>
		<properties>Alignment = 2
Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11ZRUO</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column1</parent>
		<properties>Left = 32
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QH02X</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column2</parent>
		<properties>Alignment = 2
Caption = "Ìîäåëü óñòðîéñòâà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQEY</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column2</parent>
		<properties>Left = 53
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QKHUP</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column3</parent>
		<properties>Alignment = 2
Caption = "Äåñêðèïòîð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQF0</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicemodelview.grdDeviceModel.Column3</parent>
		<properties>Left = 44
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicemodelview</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicetypeedit</objname>
		<parent/>
		<properties>Height = 175
Width = 470
DoCreate = .T.
BorderStyle = 2
Caption = "Òèï óñòðîéñòâà"
crequestedoperation = 
Name = "frmdevicetypeedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*30.06.2005 13:12 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*30.06.2005 13:12 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]

	*30.06.2005 13:12 -&gt; Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*30.06.2005 13:12 -&gt; Óäàëèì çàïèñü
		DELETE IN lvDeviceTypeEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*30.06.2005 13:12 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå
		llDataWasChanged = .cstDataWork.DataChanged([lvDeviceTypeEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	

	*30.06.2005 13:12 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
	IF llDataWasChanged
		
		*30.06.2005 13:12 -&gt; Âûñòàâëÿåì ôëàã ìîäèôèêàöèè äàííûõ è ïðîèçâîäèì ñîõðàíåíèå
		llResSave = .cstDataWork.Save([lvDeviceTypeEdit])
		*------------------------------------------------------------------------------
		
		*30.06.2005 13:13 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvDeviceTypeEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------

	ELSE

	*30.06.2005 13:13 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvDeviceTypeEdit])
	llResSave = .F.
	*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*04.04.2005 11:57 -&gt; Âîçâðàùàåì ðåçóëüòàò
	IF	llResSave

		IF .cRequestedOperation == [ADD]

			*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
			.uRetVal = IIF(llResSave,spGetLastIncrementedID([lvDeviceTypeEdit]),.F.)
			*------------------------------------------------------------------------------

		ELSE

			*04.07.2005 18:02 -&gt;Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
			.uRetVal = .T.
			*------------------------------------------------------------------------------

		ENDIF

	ELSE

		*13.01.2005 14:38 -&gt; Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
		.uRetVal = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

ELSE

	*30.06.2005 13:13 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvDeviceTypeEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 13:13 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnDeviceTypeID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnDeviceTypeID

*30.06.2005 13:07 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;1
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceTypeEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*30.06.2005 13:08 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*30.06.2005 13:08 -&gt; Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*30.06.2005 13:08 -&gt; Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]
			
		*30.06.2005 13:08 -&gt; Äîáàâèì ïóñòóþ çàïèñü â lvDeviceTypeEdit
		APPEND BLANK IN lvDeviceTypeEdit
		*------------------------------------------------------------------------------

		*30.06.2005 13:08 -&gt; Óñòàíîâèì ïåðâûå ïîïàâøèåñÿ êàðòèíêè
		GO TOP IN lvBmpsList
		***
		REPLACE BmpID WITH lvBmpsList.BmpID, ;
				SelBmpID WITH lvBmpsList.BmpID ;
		IN lvDeviceTypeEdit
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cRequestedOperation,[EDIT],[INFO],[DELE])
		
		*30.06.2005 13:07 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
		IF PCOUNT()&lt;2
			*{
			ASSERT .F. MESSAGE [Device_v1.frmDeviceTypeEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
			RETURN .F.
			*}
		ENDIF
		*------------------------------------------------------------------------------

		*30.06.2005 13:10 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
		PRIVATE _PARAM
		*------------------------------------------------------------------------------

		*30.06.2005 13:10 -&gt; Çàãðóçèì äàííûå â lvDeviceTypeEdit
		_PARAM = tnDeviceTypeID
		***
		REQUERY([lvDeviceTypeEdit])
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------

*30.06.2005 13:10 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [ADD]
		.Caption = ALLTRIM(.Caption)+[ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])

	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])

	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.

	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*30.06.2005 13:06 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*30.06.2005 13:06 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*30.06.2005 13:06 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvBmpsList IN 0 ALIAS lvBmpsList
USE lvBmpsList IN 0 AGAIN ALIAS lvSelBmpsList
*------------------------------------------------------------------------------

*30.06.2005 13:07 -&gt; Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ
USE lvDeviceTypeEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>11</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 145
Left = 260
TabIndex = 10
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceTypeNM</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 33
Left = 215
TabIndex = 4
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceTypeNM"
txtText.ControlSource = "lvDeviceTypeEdit.DeviceTypeNM"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceTypeNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00SCSI5</uniqueid>
		<timestamp>0</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceTypeDesc</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 5
Left = 215
TabIndex = 2
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceTypeDesc"
txtText.ControlSource = "lvDeviceTypeEdit.DeviceTypeDescriptor"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceTypeDesc
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceTypeNM</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå òèïà óñòðîéñòâ:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 7
Name = "lblDeviceTypeNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00SCSIL</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceTypeDesc</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>FontBold = .T.
Caption = "Äåñêðèïòîð òèïà óñòðîéñòâ:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 7
Name = "lblDeviceTypeDesc"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN1</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblBmpID</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>FontBold = .T.
Caption = "Èêîíêà íåàêòèâíàÿ:"
Height = 17
Left = 7
Top = 92
Width = 116
TabIndex = 6
ZOrderSet = 7
Name = "lblBmpID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN2</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblSelBmpID</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>FontBold = .T.
Caption = "Èêîíêà àêòèâíàÿ:"
Height = 17
Left = 7
Top = 120
Width = 102
TabIndex = 8
ZOrderSet = 7
Name = "lblSelBmpID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN3</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridBmp</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 89
Left = 215
TabIndex = 7
_controlsourcetype = 1
_controlsource = lvDeviceTypeEdit.BmpID
_rsaliasname = lvBmpsList
_rsfieldnameid = BmpID
_rsfieldnametext = BmpFileNM
Name = "cntIdCtlGridBmp"
txtText._highlightobject = .Parent.Parent.lblBmpID
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00R3RN4</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridSelBmp</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 117
Left = 215
TabIndex = 9
_controlsourcetype = 1
_controlsource = lvDeviceTypeEdit.SelBmpID
_rsaliasname = lvSelBmpsList
_rsfieldnameid = BmpID
_rsfieldnametext = BmpFileNM
Name = "cntIdCtlGridSelBmp"
txtText._highlightobject = .Parent.Parent.lblSelBmpID
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00SCSIM</uniqueid>
		<timestamp>0</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkDeviceTypeIsCnt</objname>
		<parent>frmdevicetypeedit</parent>
		<properties>Top = 64
Left = 5
Height = 17
Width = 223
FontBold = .T.
Alignment = 1
Caption = "Óñòðîéñòâî ÿâëÿåòñÿ êîíòåéíåðîì:"
Value = .F.
ControlSource = "lvDeviceTypeEdit.DeviceTypeIsCnt"
TabIndex = 5
Name = "chkDeviceTypeIsCnt"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicetypeedit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>0</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdevicetypeview</objname>
		<parent/>
		<properties>Top = -3
Left = 8
Height = 341
Width = 497
DoCreate = .T.
Caption = "Ñïðàâî÷íèê òèïîâ óñòðîéñòâ"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
_allowsaveandrestorelayout = .T.
Name = "frmdevicetypeview"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ)
*-------------------------------------------------------
DODEFAULT()

*30.06.2005 11:55 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*30.06.2005 12:14 -&gt; Îòêðûâàåì LocalView ñ êàðòèíêàìè
USE lvDeviceBmps IN 0
*------------------------------------------------------------------------------

*30.06.2005 11:55 -&gt; Îòêðûâàåì Local View äëÿ Grid-à
USE lvDeviceTypeView IN 0
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñïðàâî÷íèê òèïîâ</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11DWJS</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdDeviceType</objname>
		<parent>frmdevicetypeview</parent>
		<properties>ColumnCount = 3
Height = 331
Left = 5
Panel = 1
RecordSource = "lvDeviceTypeView"
Top = 5
Width = 487
_activerowhighlight = .T.
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
_dynamicimagealias = lvDeviceBmps
_dynamicimagecolumnindex = 1
_dynamicimagefieldnamefilename = BmpFileNM
_dynamicimagefieldnameindex = BmpID
Name = "grdDeviceType"
Column1.ControlSource = "lvDeviceTypeView.BmpID"
Column1.CurrentControl = "Txtgrd1"
Column1.Width = 18
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.ControlSource = "lvDeviceTypeView.DeviceTypeNM"
Column2.CurrentControl = "Txtgrd1"
Column2.Width = 215
Column2.Name = "Column2"
Column3.ControlSource = "lvDeviceTypeView.DeviceTypeDescriptor"
Column3.CurrentControl = "Txtgrd1"
Column3.Width = 215
Column3.Name = "Column3"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî òèïà óñòðîéñòâ
*-------------------------------------------------------
WITH This

*30.06.2005 12:05 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*30.06.2005 12:05 -&gt; Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîãî òèïà óñòðîéñòâ
lnResAdding = oMgrDevice.Do([DEVICETYPE], [ADD])
*------------------------------------------------------------------------------

*30.06.2005 12:06 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]
		
	*30.06.2005 12:06 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnDeviceTypeId
	***
	lcOldAlias = ALIAS()
	lnDeviceTypeId = lnResAdding
	*------------------------------------------------------------------------------
	
	*30.06.2005 12:06 -&gt; Îáíîâèì Local View'û
	REQUERY([lvDeviceBmps])
	REQUERY([lvDeviceTypeView])
	*------------------------------------------------------------------------------

	*30.06.2005 15:45 -&gt; Äîçàãðóçèì êàðòèíêè
	.DynamicImageReset()
	*------------------------------------------------------------------------------

	*30.06.2005 12:06 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	SELECT lvDeviceTypeView
	LOCATE FOR lvDeviceTypeView.DeviceTypeID = lnDeviceTypeId
	*------------------------------------------------------------------------------

	*30.06.2005 12:07 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 12:07 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*30.06.2005 12:07 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 12:02 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceTypeId, ;
		luResDele
***
lnDeviceTypeId = lvDeviceTypeView.DeviceTypeId
*------------------------------------------------------------------------------

*30.06.2005 12:02 -&gt; Âûïîëíèì îïåðàöèþ óäàëåíèÿ òèïà óñòðîéñòâ
luResDele = oMgrDevice.Do([DEVICETYPE], [DELE], lnDeviceTypeId)
*------------------------------------------------------------------------------

*30.06.2005 12:03 -&gt; Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele
	
	*30.06.2005 12:03 -&gt; Îáíîâèì Local View'û
	REQUERY([lvDeviceBmps])
	REQUERY([lvDeviceTypeView])
	*------------------------------------------------------------------------------

	*30.06.2005 12:03 -&gt; Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 12:00 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceTypeId, ;
		luResEditing
***
lnDeviceTypeId = lvDeviceTypeView.DeviceTypeId
*------------------------------------------------------------------------------

*30.06.2005 12:00 -&gt; Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ òèïà óñòðîéñòâ
luResEditing = oMgrDevice.Do([DEVICETYPE], [EDIT], lnDeviceTypeId)
*------------------------------------------------------------------------------

*30.06.2005 12:01 -&gt; Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing
	
	*30.06.2005 12:01 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------

	*30.06.2005 12:01 -&gt; Îáíîâèì Local View'û
	REQUERY([lvDeviceBmps])
	REQUERY([lvDeviceTypeView])
	*------------------------------------------------------------------------------

	*30.06.2005 15:45 -&gt; Äîçàãðóçèì êàðòèíêè
	.DynamicImageReset()
	*------------------------------------------------------------------------------

	*30.06.2005 12:01 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvDeviceTypeView
	LOCATE FOR lvDeviceTypeView.DeviceTypeID = lnDeviceTypeID
	*------------------------------------------------------------------------------
	
	*30.06.2005 12:02 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 12:02 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*30.06.2005 12:02 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 11:58 -&gt; Âûïîëíèì îïåðàöèþ ïðîñìîòðà òèïà óñòðîéñòâ
oMgrDevice.Do([DEVICETYPE], [INFO], lvDeviceTypeView.DeviceTypeId)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11ZRUO</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column1</parent>
		<properties>Alignment = 2
Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QH02X</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column1</parent>
		<properties>Left = 32
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQEY</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column2</parent>
		<properties>Alignment = 2
Caption = "Òèï óñòðîéñòâà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QKHUP</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column2</parent>
		<properties>Left = 53
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQF0</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column3</parent>
		<properties>Alignment = 2
Caption = "Äåñêðèïòîð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QKHUQ</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdevicetypeview.grdDeviceType.Column3</parent>
		<properties>Left = 44
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdevicetypeview</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>0</timestamp>
		<class>frmidctltree</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmidctltreedevicecnt</objname>
		<parent/>
		<properties>DoCreate = .T.
Name = "frmidctltreedevicecnt"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
CSTDATAWORK.Name = "CSTDATAWORK"
oleimagelist.Top = 185
oleimagelist.Left = 37
oleimagelist.Height = 100
oleimagelist.Width = 100
oleimagelist.Name = "oleimagelist"
oletreeview.Height = 175
oletreeview.Width = 320
oletreeview._rsaliasname = lvDeviceCntTreeView
oletreeview._rsfieldnameid = DeviceID
oletreeview._rsfieldnameparentid = DeviceParID
oletreeview._rsfieldnametext = DeviceNM
oletreeview._imagelistobject = .parent.Oleimagelist.object
oletreeview._rsfieldnameparentflag = DeviceIsCnt
oletreeview._imgalias = lvDeviceBmps
oletreeview._imgfieldnamefilename = BmpFileNM
oletreeview._imgfieldnameindex = BmpId
oletreeview._rsfieldnameimageindex = BmpId
oletreeview._rsfieldnameimageselectedindex = SelBmpId
oletreeview.Name = "oletreeview"
cntcancelsavehandled.cmdCancel.Name = "cmdCancel"
cntcancelsavehandled.cmdOK.Name = "cmdOK"
cntcancelsavehandled.Name = "cntcancelsavehandled"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8>..\include\comctl_v1_oletreeview.h</reserved8>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmidctltreedevicecnt</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1DZ118AIP</uniqueid>
		<timestamp>0</timestamp>
		<class>tlbfrm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>toolbar</baseclass>
		<objname>tlbdevicedriverfunc</objname>
		<parent/>
		<properties>Height = 28
Left = 0
Top = 0
Width = 33
Name = "tlbdevicedriverfunc"
</properties>
		<protected/>
		<methods>PROCEDURE refreshenabledmsg
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: TLBDEVICEDRIVERFUNC.REFRESHENABLEDMSG
* Called by.......: &lt;_screen.ActiveForm.cstMsgHadler.RefershToolBar()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
WITH This

*15.08.2005 17:16 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	loActiveForm, ;
		lnMsgCounter, ;
		lnMsgCount, ;
		lcMsg, ;
		laControlName[1], ;
		lnControlCounter, ;
		llLibLoad
***
loActiveForm = oApp.WindowActiveGet()
*------------------------------------------------------------------------------

*16.08.2005 17:40 -&gt; Óáèðàåì âñå ñóùåñòâóþùèå êíîïêè
DO WHILE .ControlCount &gt; 1
	.RemoveObject(.Controls[2].Name)
ENDDO
*------------------------------------------------------------------------------

*11.01.2004 18:36 -&gt; Ïîëó÷àåì ñïèñîê ñîîáùåíèé
IF 	TYPE([loActiveForm])==[O] AND !ISNULL(loActiveForm) AND ;
	TYPE([loActiveForm.cstMsgHandler])==[O] AND !ISNULL(loActiveForm.cstMsgHandler)

	*30.09.2005 14:29 -&gt; Ïîëó÷èì êîëè÷åñòâî ñîîáùåíèé
	lnMsgCount = loActiveForm.cstMsgHandler.GetHandledMsgCount()
	*------------------------------------------------------------------------------

	*30.09.2005 14:28 -&gt; Äîáàâëÿåì êíîïêè íà ToolBar
	FOR lnMsgCounter = 1 TO lnMsgCount
		
		*15.08.2005 18:13 -&gt;Ïîëó÷èì ñîîáùåíèå
		lcMsg = loActiveForm.cstMsgHandler.GetHandledMsg(lnMsgCounter)
		*------------------------------------------------------------------------------
		
		*15.08.2005 18:11 -&gt; Ïîëó÷àåì èíôîðìàöèþ î ñîîáùåíèè
		USE IN IIF(USED([lvDeviceDriverFuncByIDExpanded]),[lvDeviceDriverFuncByIDExpanded],0)
		***
		_PARAM = VAL(lcMsg)
		USE Basis!lvDeviceDriverFuncByIDExpanded IN 0
		***
		IF RECCOUNT([lvDeviceDriverFuncByIDExpanded]) = 0
			ASSERT .F. MESSAGE [tlbDeviceDriverFunc.RefreshEnabledMsg: ôóíêöèÿ íå íàéäåíà]
			LOOP
		ENDIF
		*------------------------------------------------------------------------------
		
		*15.08.2005 18:25 -&gt;Äîáàâèì êíîïêó
		.AddObject([cmdTlbFrm]+lcMsg,[cmdTlbFrm],ALLTRIM(lcMsg),ALLTRIM(lvDeviceDriverFuncByIDExpanded.BmpFileNM),ALLTRIM(lvDeviceDriverFuncByIDExpanded.DeviceDriverFuncNM))
		*------------------------------------------------------------------------------
		
	ENDFOR
	*------------------------------------------------------------------------------

	*15.08.2005 18:24 -&gt;Àêòèâèçèðóåì äîáàâëåííûå êíîïêè
	This.SetAll([VISIBLE],.T.,[cmdTlbFrm])
	This.SetEnabled(.lEnabled)
	*------------------------------------------------------------------------------

ENDIF	
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1LD0XSS9Z</uniqueid>
		<timestamp>0</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img1</objname>
		<parent>tlbdevicedriverfunc</parent>
		<properties>Picture = ..\graphic\dummy22x1.bmp
Height = 22
Left = 5
Top = 3
Width = 1
ZOrderSet = 0
Name = "Img1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1LD0ZNC4U</uniqueid>
		<timestamp>0</timestamp>
		<class>spr</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>separator</baseclass>
		<objname>Spr1</objname>
		<parent>tlbdevicedriverfunc</parent>
		<properties>Top = 3
Left = 5
Height = 0
Width = 0
Name = "Spr1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>tlbdevicedriverfunc</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>948327707</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdeviceview</objname>
		<parent/>
		<properties>Top = 26
Left = 28
Height = 439
Width = 700
DoCreate = .T.
Caption = "Ñïðàâî÷íèê óñòðîéñòâ"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
_allowmultiple = .T.
Name = "frmdeviceview"
cstmsghandler.Top = 0
cstmsghandler.Left = 72
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ)
*-------------------------------------------------------
DODEFAULT()

*24.06.2005 17:20 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*24.06.2005 17:20 -&gt; Îòêðûâàåì LocalView ñ êàðòèíêàìè
USE lvDeviceBmps IN 0
*------------------------------------------------------------------------------

*24.06.2005 17:20 -&gt; Îòêðûâàåì LocalView äëÿ äåðåâà
USE lvDeviceCntTreeView IN 0
*------------------------------------------------------------------------------

*24.06.2005 17:21 -&gt; Îòêðûâàåì Local View äëÿ Grid-à
USE lvDeviceInCntView IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñïðàâî÷íèê</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40MQQHG</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdDevice</objname>
		<parent>frmdeviceview</parent>
		<properties>ColumnCount = 2
DeleteMark = .F.
Height = 427
Left = 350
RecordSource = "lvDeviceInCntView"
TabIndex = 3
Top = 5
Width = 345
_activerowhighlight = .T.
_dynamicimagealias = lvDeviceBmps
_dynamicimagecolumnindex = 1
_dynamicimagefieldnamefilename = BmpFileNM
_dynamicimagefieldnameindex = BmpId
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
Name = "grdDevice"
Column1.ControlSource = "lvDeviceInCntView.BmpID"
Column1.Width = 18
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.ControlSource = "lvDeviceInCntView.DeviceNM"
Column2.Width = 293
Column2.ReadOnly = .T.
Column2.Visible = .T.
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDevice._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî óñòðîéñòâà.
*-------------------------------------------------------

*28.06.2005 10:42 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResAdding
*------------------------------------------------------------------------------

*28.06.2005 10:42 -&gt; Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewDeviceCnt.Visible = .F.
*------------------------------------------------------------------------------

*28.06.2005 10:42 -&gt; Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ óñòðîéñòâà
luResAdding = oMgrDevice.Do([DEVICE],[ADD],ThisForm.OleTreeViewDeviceCnt.nValue)
*------------------------------------------------------------------------------

*28.06.2005 10:43 -&gt; Âåðíåì äåðåâî
ThisForm.OleTreeViewDeviceCnt.Visible = .T.
*------------------------------------------------------------------------------

*28.06.2005 10:43 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([luResAdding])==[N] &amp;&amp;çàïèñü äîáàâëåíà

	*28.06.2005 10:43 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias, ;
			lnDeviceId
	LOCAL ARRAY laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	lnDeviceId = luResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------

	*28.06.2005 10:43 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîì óñòðîéñòâå
	USE IN IIF(USED([lvDeviceInCntViewRepl]),[lvDeviceInCntViewRepl],0)
	_PARAM = lnDeviceId
	USE lvDeviceInCntViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*07.07.2005 17:18 -&gt; Îáíîâëÿåì äàííûå â äåðåâå, åñëè äîáàâëåííîå óñòðîéñòâî ÿâëÿåòñÿ êîíòåéíåðîì
	IF lvDeviceInCntViewRepl.DeviceTypeIsCnt

		*28.06.2005 10:44 -&gt; Îòêðîåì Alias äëÿ îáíîâëåíèÿ lvDeviceCntTreeView
		USE IN IIF(USED([lvDeviceCntTreeViewRepl]),[lvDeviceCntTreeViewRepl],0)
		_PARAM = lnDeviceId
		USE lvDeviceCntTreeViewRepl IN 0
		*------------------------------------------------------------------------------

		*28.06.2005 10:44 -&gt; Îáíîâèì äàííûå â lvDeviceCntTreeView
		SELECT lvDeviceCntTreeViewRepl
		SCATTER TO laReplaceArray
		SELECT lvDeviceCntTreeView
		APPEND BLANK
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewDeviceCnt.OperateAdd(lnDeviceId)
		*------------------------------------------------------------------------------

		*28.06.2005 10:45 -&gt; Çàêðîåì Alias äëÿ îáíîâëåíèÿ
		USE IN lvDeviceCntTreeViewRepl
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*28.06.2005 10:45 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------

	*28.06.2005 10:45 -&gt; Âûïîëíèì äåéñòâèÿ äëÿ îáíîâëåíèÿ lvDeviceInCntView
	IF ThisForm.OleTreeViewDeviceCnt.nValue = lvDeviceInCntViewRepl.DeviceParID

		*28.06.2005 10:46 -&gt; Îáíîâëÿåì äàííûå
		This._RSRequery(ThisForm.OleTreeViewDeviceCnt.nValue)
		*------------------------------------------------------------------------------

	ELSE

		*28.06.2005 10:46 -&gt; Âûáèðàåì â äåðåâå ðîäèòåëüñêóþ ãðóïïó
		ThisForm.OleTreeViewDeviceCnt.OperateSelect(lvDeviceInCntViewRepl.DeviceParID)
		*------------------------------------------------------------------------------

	ENDIF		
	*------------------------------------------------------------------------------

	*28.06.2005 10:46 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	SELECT lvDeviceInCntView
	LOCATE FOR lvDeviceInCntView.DeviceID = lnDeviceID
	*------------------------------------------------------------------------------

	*28.06.2005 10:46 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------

	*28.06.2005 10:46 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*28.06.2005 10:46 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*28.06.2005 10:46 -&gt; Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvDeviceInCntViewRepl
	*------------------------------------------------------------------------------

	*28.06.2005 10:47 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDevice._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå óñòðîéñòâà
*-------------------------------------------------------

*28.06.2005 10:34 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceId, ;
		llDeviceIsCnt, ;
		luResDele
***
lnDeviceId = lvDeviceInCntView.DeviceId
llDeviceIsCnt = lvDeviceInCntView.DeviceTypeIsCnt
*------------------------------------------------------------------------------

*28.06.2005 10:34 -&gt; Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewDeviceCnt.Visible = .F.
*------------------------------------------------------------------------------

*28.06.2005 10:34 -&gt; Âûïîëíèì îïåðàöèþ óäàëåíèÿ óñòðîéñòâà
luResDele = oMgrDevice.Do([DEVICE],[DELE],lnDeviceId)
*------------------------------------------------------------------------------

*28.06.2005 10:35 -&gt; Âåðíåì äåðåâî
ThisForm.OleTreeViewDeviceCnt.Visible = .T.
*------------------------------------------------------------------------------

*28.06.2005 10:35 -&gt; Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele
	
	*28.06.2005 10:35 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*07.07.2005 17:08 -&gt; Åñëè îáúåêò ÿâëÿåòñÿ êîíòåéíåðîì -&gt; óäàëèì èç äåðåâà
	IF llDeviceIsCnt
		SELECT lvDeviceCntTreeView
		DELETE FOR lvDeviceCntTreeView.DeviceId = lnDeviceId
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewDeviceCnt.OperateRemove(lnDeviceId)
	ENDIF
	*------------------------------------------------------------------------------

	*28.06.2005 10:36 -&gt; Óäàëèì îáúåêò èç Grid-à
	SELECT lvDeviceInCntView
	DELETE FOR lvDeviceInCntView.DeviceID = lnDeviceID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*28.06.2005 10:36 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*28.06.2005 10:36 -&gt; Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDevice._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå óñòðîéñòâà.
*-------------------------------------------------------

*28.06.2005 10:37 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceId, ;
		luResEdit
***
lnDeviceId = lvDeviceInCntView.DeviceId
*------------------------------------------------------------------------------

*28.06.2005 10:37 -&gt; Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewDeviceCnt.Visible = .F.
*------------------------------------------------------------------------------

*28.06.2005 10:37 -&gt; Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ
luResEdit = oMgrDevice.Do([DEVICE],[EDIT],lnDeviceId)
*------------------------------------------------------------------------------

*28.06.2005 10:37 -&gt; Âåðíåì äåðåâî
ThisForm.OleTreeViewDeviceCnt.Visible = .T.
*------------------------------------------------------------------------------

*28.06.2005 10:38 -&gt; Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEdit])==[L] AND luResEdit

	*28.06.2005 10:38 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	_PARAM, ;
			lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------

	*28.06.2005 10:38 -&gt; Ïîëó÷èì îáíîâëåííûå äàííûå îá óñòðîéñòâå
	USE IN IIF(USED([lvDeviceInCntViewRepl]),[lvDeviceInCntViewRepl],0)
	_PARAM = lnDeviceId
	USE lvDeviceInCntViewRepl IN 0
	*------------------------------------------------------------------------------

	*07.07.2005 17:25 -&gt; Îáíîâèì äàííûå â äåðåâå, åñëè óñòðîéñòâî ÿâëÿåòñÿ êîíòåéíåðîì
	IF lvDeviceInCntViewRepl.DeviceTypeIsCnt

		*28.06.2005 10:38 -&gt; Îòêðîåì Alias äëÿ îáíîâëåíèÿ lvDeviceCntTreeView
		USE IN IIF(USED([lvDeviceCntTreeViewRepl]),[lvDeviceCntTreeViewRepl],0)
		_PARAM = lnDeviceId
		USE lvDeviceCntTreeViewRepl IN 0
		*------------------------------------------------------------------------------	

		*28.06.2005 10:38 -&gt; Îáíîâèì äàííûå â lvDeviceTreeView
		SELECT lvDeviceCntTreeViewRepl
		SCATTER TO laReplaceArray
		SELECT lvDeviceCntTreeView
		LOCATE FOR lvDeviceCntTreeView.DeviceID = lnDeviceId
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		***
		ThisForm.OleTreeViewDeviceCnt.OperateReloadNode(lnDeviceId)
		*------------------------------------------------------------------------------

		*28.06.2005 10:39 -&gt; Çàêðîåì Alias
		USE IN lvDeviceCntTreeViewRepl
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*28.06.2005 10:39 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .T.
	*------------------------------------------------------------------------------

	*28.06.2005 10:39 -&gt; Âûïîëíèì äåéñòâèÿ äëÿ îáíîâëåíèÿ lvDeviceInCntView
	IF ThisForm.OleTreeViewDeviceCnt.nValue = lvDeviceInCntViewRepl.DeviceParID

		*28.06.2005 10:39 -&gt; Îòêëþ÷àåì èñòî÷íèê äàííûõ îò Grid-à
		.SourceKeep()
		.SourceReset()
		*------------------------------------------------------------------------------

		*28.06.2005 10:39 -&gt; Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvDeviceInCntViewRepl
		SCATTER TO laReplaceArray
		SELECT lvDeviceInCntView
		LOCATE FOR lvDeviceInCntView.DeviceID = lnDeviceID
		GATHER FROM laReplaceArray
		TABLEUPDATE(.T.)
		*------------------------------------------------------------------------------

		*28.06.2005 10:40 -&gt; Ïîäêëþ÷àåì èñòî÷íèê äàííûõ ê Grid-ó
		.SourceRecall()
		*------------------------------------------------------------------------------

	ELSE
		
		*28.06.2005 10:40 -&gt; Âûáèðàåì â äåðåâå ðîäèòåëüñêóþ ãðóïïó
		ThisForm.OleTreeViewDeviceCnt.OperateSelect(lvDeviceInCntViewRepl.DeviceParID)
		*------------------------------------------------------------------------------
		
		*28.06.2005 10:40 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvDeviceInCntView
		LOCATE FOR lvDeviceInCntView.DeviceID = lnDeviceID
		*------------------------------------------------------------------------------
		
	ENDIF		
	*------------------------------------------------------------------------------

	*28.06.2005 10:40 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
	This.lNoExtendedRefresh = .F.
	*------------------------------------------------------------------------------

	*28.06.2005 10:40 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*28.06.2005 10:41 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

	*28.06.2005 10:41 -&gt; Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvDeviceInCntViewRepl
	*------------------------------------------------------------------------------

	*28.06.2005 10:41 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDevice._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Info()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè îá óñòðîéñòâå
*-------------------------------------------------------

*28.06.2005 10:32 -&gt; Ñêðîåì äåðåâî, èíà÷å îíî áóäåò ôóíêöèîíèðîâàòü íåêîððåêòíî
ThisForm.OleTreeViewDeviceCnt.Visible = .F.
*------------------------------------------------------------------------------

*28.06.2005 10:32 -&gt; Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè îá óñòðîéñòâå
oMgrDevice.Do([DEVICE],[INFO],lvDeviceInCntView.DeviceId)
*------------------------------------------------------------------------------

*28.06.2005 10:32 -&gt; Âåðíåì äåðåâî
ThisForm.OleTreeViewDeviceCnt.Visible = .T.
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDevice._RSRequery
* Called by.......: &lt;ThisForm.OleTreeViewDevice._HandleAnyChange()&gt;
* Parameters......: &lt;tnParentId&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à.
*-------------------------------------------------------
LPARAMETERS	tnParentId

WITH This

*24.06.2005 17:28 -&gt; Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*24.06.2005 17:28 -&gt; Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*24.06.2005 17:28 -&gt; Ïåðå÷èòàåì Local View
_PARAM = tnParentID
REQUERY([lvDeviceInCntView])
*------------------------------------------------------------------------------

*24.06.2005 17:28 -&gt; Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40SH4II</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdeviceview.grdDevice.Column1</parent>
		<properties>Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IG10NWRZ</uniqueid>
		<timestamp>948327707</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdeviceview.grdDevice.Column1</parent>
		<properties>Left = 11
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40SH4IK</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmdeviceview.grdDevice.Column2</parent>
		<properties>Alignment = 2
Caption = "Óñòðîéñòâî"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IG10NWS0</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmdeviceview.grdDevice.Column2</parent>
		<properties>Left = 40
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40MQQHH</uniqueid>
		<timestamp>948327707</timestamp>
		<class>oleimagelist</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Oleimagelist</objname>
		<parent>frmdeviceview</parent>
		<properties>Top = 15
Left = 221
Height = 100
Width = 100
Name = "Oleimagelist"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODmuGSgl8gBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PjdpYap0bEK/AQhAQKo2nIUM0EggAAADtAwAA7QMAAIB+4eYCAAUAIAAAAAAAAADAwMAA//8AAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIADmjgAAAAAAAGyOAAAAAAAA6I8AAAAAAABojwAAAAAAAOqQAAAAAAAAcJAAAAAAAAABAACAAAAAAHqSAAAAAAAADJQAAAAAAACElAAAAAAAAAKVAAAAAAAAjJUAAAAAAAAElwAAAAAAAASWAAAAAAAAGDkfAAYAAAD/////BQAAgAAAAAAAAAAAAAAAAAAAAAAImgAAAAAAAIiZAAAAAAAAjJoAAAAAAACyNQAAAAAAAJacAAAAAAAATIMAAAAAAAAEmwAAAAAAABCdAAAAAAAAkFgAAAAAAACYPQAAAAAAAI6dAAAAAAAAGp4AAAAAAABYiwAAAAAAAPCLAAAAAAAAHDcAAAAAAACkNgAAAAAAAOYdAAAAAAAA3jgAAAAAAABqOQAAAAAAAAo6AAAAAAAAtjoAAAAAAACAjQAAAAAAAF47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40MQQHI</uniqueid>
		<timestamp>948327707</timestamp>
		<class>oletreeview</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleTreeViewDeviceCnt</objname>
		<parent>frmdeviceview</parent>
		<properties>Top = 5
Left = 5
Height = 427
Width = 345
TabIndex = 1
_imgfieldnameindex = BmpId
_imgfieldnamefilename = BmpFileNM
_imgalias = lvDeviceBmps
_imagelistobject = .parent.Oleimagelist.object
_rsaliasname = lvDeviceCntTreeView
_rsfieldnameid = DeviceID
_rsfieldnameimageindex = BmpId
_rsfieldnameimageselectedindex = SelBmpId
_rsfieldnameparentflag = DeviceIsCnt
_rsfieldnameparentid = DeviceParID
_rsfieldnametext = DeviceNM
Name = "OleTreeViewDeviceCnt"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
ThisForm.grdDevice._RSRequery(This.nValue)
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODmuGSgl8gBAwAAAEACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZgAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+i6BMHCoUbEK/AQhAQKo2nIUM0EggAAACoIwAAIiwAAI5+4eYCAAUAIgAAAH0gaWaNAQAAAQAAAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAAAAYAAAAAAAAABQAAgOzpEgABAAAAXAAf3uy9AQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAHAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdeviceview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14N16HZEQ</uniqueid>
		<timestamp>949504174</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdeviceoperate</objname>
		<parent/>
		<properties>Top = 0
Left = 27
Height = 470
Width = 603
DoCreate = .T.
Caption = "Ñïðàâî÷íèê óñòðîéñòâ"
_allowmultiple = .T.
_customtoolbar = tlbdevicedriverfunc;device_v1;device.app
_customtoolbarinstancenm = tlbdevicedriverfunc
Name = "frmdeviceoperate"
cstmsghandler.Top = 0
cstmsghandler.Left = 72
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
IMG1.Name = "IMG1"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ)
*-------------------------------------------------------
DODEFAULT()

*24.06.2005 17:20 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*24.06.2005 17:20 -&gt; Îòêðûâàåì LocalView ñ êàðòèíêàìè
USE lvDeviceBmps IN 0
*------------------------------------------------------------------------------

*24.06.2005 17:20 -&gt; Îòêðûâàåì LocalView äëÿ äåðåâà
USE lvDeviceTreeView IN 0
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>îïåðàöèè ñ óñòðîéñòâàìè</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40MQQHH</uniqueid>
		<timestamp>949504174</timestamp>
		<class>oleimagelist</class>
		<classloc>comctl_v2.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Oleimagelist</objname>
		<parent>frmdeviceoperate</parent>
		<properties>Top = 15
Left = 221
Height = 100
Width = 100
Name = "Oleimagelist"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKDe3gu4pcgBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+PjdpYap0bEK/AQhAQKo2nIUM0EggAAADtAwAA7QMAAIB+4eYCAAUAIAAAAAAAAADAwMAA//8AAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIADmjgAAAAAAAGyOAAAAAAAA6I8AAAAAAABojwAAAAAAAOqQAAAAAAAAcJAAAAAAAAABAACAAAAAAHqSAAAAAAAADJQAAAAAAACElAAAAAAAAAKVAAAAAAAAjJUAAAAAAAAElwAAAAAAAASWAAAAAAAAMFkZAAYAAAD/////BQAAgAAAAAAAAAAAAAAAAAAAAAAImgAAAAAAAIiZAAAAAAAAjJoAAAAAAACyNQAAAAAAAJacAAAAAAAATIMAAAAAAAAEmwAAAAAAABCdAAAAAAAAkFgAAAAAAACYPQAAAAAAAI6dAAAAAAAAGp4AAAAAAABYiwAAAAAAAPCLAAAAAAAAHDcAAAAAAACkNgAAAAAAAOYdAAAAAAAA3jgAAAAAAABqOQAAAAAAAAo6AAAAAAAAtjoAAAAAAACAjQAAAAAAAF47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1F40MQQHI</uniqueid>
		<timestamp>949504174</timestamp>
		<class>oletreeview</class>
		<classloc>comctl_v2.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>OleTreeViewDeviceCnt</objname>
		<parent>frmdeviceoperate</parent>
		<properties>Top = 5
Left = 5
Height = 463
Width = 595
TabIndex = 1
_imgfieldnameindex = BmpId
_imgfieldnamefilename = BmpFileNM
_imgalias = lvDeviceBmps
_imagelistobject = .parent.Oleimagelist.object
_rsaliasname = lvDeviceTreeView
_rsfieldnameid = DeviceID
_rsfieldnameimageindex = BmpId
_rsfieldnameimageselectedindex = SelBmpId
_rsfieldnameparentflag = DeviceIsCnt
_rsfieldnameparentid = DeviceParID
_rsfieldnametext = DeviceNM
_parentonly = .F.
_refreshhandledcustommsglistonnodechange = .T.
Name = "OleTreeViewDeviceCnt"
</properties>
		<protected/>
		<methods>PROCEDURE _gethandledcustommsglist
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: oleTreeViewDeviceCnt._GetHandledCustomMsgList
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ôîðìèðîâàíèå ñïèñêà êîìàíä, îáðàáûòûâàåìûõ òåêóùèì äðàéâåðîì
*					âûáðàííîãî óñòðîéñòâà
*------------------------------------------------------------------------------

*12.08.2005 16:45 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*12.08.2005 16:18 -&gt;Ïîëó÷àåì ñïèñîê êîìàíä
USE IN IIF(USED([lvDeviceDriverFuncByDeviceID]),[lvDeviceDriverFuncByDeviceID],0)
***
_PARAM = This.nValue
USE lvDeviceDriverFuncByDeviceID IN 0
*------------------------------------------------------------------------------

*12.08.2005 17:13 -&gt;Ñôîðìèðóåì íîâûé ñïèñîê ñîîáùåíèé
This._HandledCustomMsgList = []
This._HandledCustomMsgPromptList = []
***
SELECT lvDeviceDriverFuncByDeviceID
SCAN ALL
	
	*12.08.2005 16:52 -&gt;Ôîðìèðóåì ñïèñîê ñîîáùåíèé
	This._HandledCustomMsgList = This._HandledCustomMsgList + IIF(!EMPTY(This._HandledCustomMsgList),[;],[]) + ALLTRIM(STR(lvDeviceDriverFuncByDeviceID.DeviceDriverFuncID,10,0))
	*------------------------------------------------------------------------------
		
	*12.08.2005 16:53 -&gt;Ôîðìèðóåì ñïèñîê íàçâàíèé ôàíêöèé
	This._HandledCustomMsgPromptList = This._HandledCustomMsgPromptList + IIF(!EMPTY(This._HandledCustomMsgPromptList),[;],[]) + ALLTRIM(lvDeviceDriverFuncByDeviceID.DeviceDriverFuncNM)
	*------------------------------------------------------------------------------
	
ENDSCAN
*------------------------------------------------------------------------------

*15.08.2005 13:47 -&gt;Âåðíåì ñôîðìèðîâàíííûé ñïèñîê
RETURN This._HandledCustomMsgList
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE _handlecustommsg
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: oleTreeViewDeviceCnt._HandleCustomMsg
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âûïîëíåíèå ôóíêöèè äðàéâåðà
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

*12.08.2005 17:40 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		lcOldPath, ;
		lcOldOnError, ;
		lcDriverPath, ;
		loDriver
PRIVATE llError
***
lcOldPath    = SET([PATH])
lcOldOnError = ON([ERROR])
*------------------------------------------------------------------------------

*12.08.2005 17:32 -&gt;Ïîëó÷àåì èíôîðìàöèþ îá óñòðîéñòâå
USE IN IIF(USED([lvDeviceInfoByID]),[lvDeviceInfoByID],0)
***
_PARAM = This.nValue
USE lvDeviceInfoByID IN 0
***
IF RECCOUNT([lvDeviceInfoByID]) # 1
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*12.08.2005 17:52 -&gt;Ïîëó÷àåì èíôîðìàöèþ î ôóíêöèè
USE IN IIF(USED([lvDeviceDriverFuncByID]),[lvDeviceDriverFuncByID],0)
***
_PARAM = VAL(tcMessage)
USE lvDeviceDriverFuncByID IN 0
***
IF RECCOUNT([lvDeviceDriverFuncByID]) # 1
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------
*12.08.2005 17:41 -&gt;Îïðåäåëÿåì ïàïêó â êîòîðîé ëåæèò äðàéâåð óñòðîéñòâà
lcDriverPath = FULLPATH(CURDIR(SET([DEFAULT]))) + ;
			   [Drivers\] + ;
			   ALLTRIM(lvDeviceInfoByID.DeviceTypeDescriptor) + [\] + ;
			   ALLTRIM(lvDeviceInfoByID.DeviceModelDescriptor) + [\] + ;
			   ALLTRIM(lvDeviceInfoByID.DeviceDriverVersion) + [\]
*------------------------------------------------------------------------------

*15.08.2005 12:20 -&gt;Ïðîâåðÿåì íàëè÷èå äèðåêòîðèè
IF !DIRECTORY(lcDriverPath)
	MESSAGEBOX([Äðàéâåð äëÿ äàííîãî óñòðîéñòâà íå óñòàíîâëåí íà äàííîì êîìïüþòåðå]+  CHR(13)+ lcDriverPath ,16,[Íå âûïîëíåíî])
	_CLIPTEXT = lcDriverPath
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

*12.08.2005 17:48 -&gt;Äîáàâëÿåì ê ïóòÿì
SET PATH TO (lcOldPath+[;]+lcDriverPath)
*------------------------------------------------------------------------------

*15.08.2005 12:17 -&gt;Âûãðóæàåì ini ôàéë äëÿ äðàéâåðà
IF !EMPTY(lvDeviceInfoByID.DeviceINI)
	COPY MEMO lvDeviceInfoByID.DeviceINI TO (lcDriverPath+[driver.ini])
ENDIF
*------------------------------------------------------------------------------

*12.08.2005 17:50 -&gt;Ñîçäàåì îáúåêò äðàéâåðà
ON ERROR llError=.T.
***
loDriver = oApp.CreateObject(ALLTRIM(lvDeviceInfoByID.DeviceDriverAppDescriptor))
***
IF TYPE([loDriver])#[O] OR ISNULL(loDriver)
	MESSAGEBOX([Äðàéâåð äëÿ äàííîãî óñòðîéñòâà íå óñòàíîâëåí íà äàííîì êîìïüþòåðå ëèáî óñòàíîâëåí íåêîððåêòíî],16,[Íå âûïîëíåíî])
	RETURN .F.
ENDIF
***
ON ERROR &amp;lcOldOnError
*------------------------------------------------------------------------------

*12.08.2005 17:52 -&gt;Âûïîëíèì ôóíêöèþ äðàéâåðà
loDriver.Do(ALLTRIM(lvDeviceDriverFuncByID.DeviceDriverFuncMsg),lcDriverPath)
*------------------------------------------------------------------------------

*12.08.2005 17:59 -&gt;Âîññòàíîâèì ïóòè
SET PATH TO (lcOldPath)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKBP4Qu4pcgBAwAAAEACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZgAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABPAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+i6BMHCoUbEK/AQhAQKo2nIUM0EggAAAB/PQAA2i8AAI5+4eYCAAUAIgAAAH0gaWaNAQAAAQAAAAHvzasAAAUATwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABcAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgcWhqIFp0dVFoYTtqZGZuW2lhZXRyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAAAAYAAAAAAAAABQAAgJzpEgABAAAAXAAf3uy9AQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAHAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\comctl32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdeviceoperate</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_0VL0XXSOC</uniqueid>
		<timestamp>979858265</timestamp>
		<class>custom</class>
		<classloc/>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE do
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: Interface.Do
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé èíòåðôåéñ áèáëèîòåêè.
*-------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequestedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10

*24.06.2005 17:08 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;2
	*{
	ASSERT .F. MESSAGE [Device_v1.Interface.Do: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF	
*------------------------------------------------------------------------------

*24.06.2005 17:12 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequestedOperation, ;
		llOperateResult
***
lcEntityName = UPPER(ALLTRIM(tcEntityName))
lcRequestedOperation = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*24.06.2005 17:12 -&gt; Âûïîëíÿåì îïåðàöèþ
DO CASE

	*********************************************************************************
	*[ACTRULE] &amp;&amp; [VIEW] - ïðîñìîòð ïðàâèë ïðè ïðîäàæå							*
	*********************************************************************************
	CASE lcEntityName == [ACTRULE] AND lcRequestedOperation == [VIEW]
	
		*30.06.2005 11:48 -&gt; Çàïóñòèì ôîðìó äëÿ ïðîñìîòðà òèïîâ óñòðîéñòâ
		oApp.ExecuteScrFormByObjDesc([frmactruleview;device_v1.vcx;device.app])
		*------------------------------------------------------------------------------

		*30.06.2005 11:49 -&gt; Âåðíåì ôëàã óñïåøíîñòè
		RETURN .T.
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[ACTRULE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])														*
	*äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ïðàâèë ïðè ïðîäàæå												*
	*************************************************************************************************************
	CASE lcEntityName == [ACTRULE] AND (lcRequestedOperation == [ADD] OR lcRequestedOperation == [EDIT] OR ;
		lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*30.06.2005 12:32 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð òèïà óñòðîéñòâ äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*30.06.2005 12:33 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmactruleedit;device_v1.vcx;device.app],lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************
	*[DEVICETYPE] &amp;&amp; [VIEW] - ïðîñìîòð òèïîâ óñòðîéñòâ								*
	*********************************************************************************
	CASE lcEntityName == [DEVICETYPE] AND lcRequestedOperation == [VIEW]
	
		*30.06.2005 11:48 -&gt; Çàïóñòèì ôîðìó äëÿ ïðîñìîòðà òèïîâ óñòðîéñòâ
		oApp.ExecuteScrFormByObjDesc([frmdevicetypeview;device_v1.vcx;device.app])
		*------------------------------------------------------------------------------

		*30.06.2005 11:49 -&gt; Âåðíåì ôëàã óñïåøíîñòè
		RETURN .T.
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[DEVICETYPE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])														*
	*äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå òèïîâ óñòðîéñòâ												*
	*************************************************************************************************************
	CASE lcEntityName == [DEVICETYPE] AND (lcRequestedOperation == [ADD] OR lcRequestedOperation == [EDIT] OR ;
		lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*30.06.2005 12:32 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð òèïà óñòðîéñòâ äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*30.06.2005 12:33 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdevicetypeedit;device_v1.vcx;device.app],lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************
	*[DEVICEMODEL] &amp;&amp; [VIEW] - ïðîñìîòð ìîäåëåé óñòðîéñòâ							*
	*********************************************************************************
	CASE lcEntityName == [DEVICEMODEL] AND lcRequestedOperation == [VIEW]
	
		*30.06.2005 11:49 -&gt; Çàïóñòèì ôîðìó äëÿ ïðîñìîòðà ìîäåëåé óñòðîéñòâ
		oApp.ExecuteScrFormByObjDesc([frmdevicemodelview;device_v1.vcx;device.app])
		*------------------------------------------------------------------------------

		*30.06.2005 11:50 -&gt; Âåðíåì ôëàã óñïåøíîñòè
		RETURN .T.
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[DEVICEMODEL] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])														*
	*äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìîäåëåé óñòðîéñòâ												*
	*************************************************************************************************************
	CASE lcEntityName == [DEVICEMODEL] AND (lcRequestedOperation == [ADD] OR lcRequestedOperation == [EDIT] OR ;
		lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*30.06.2005 16:03 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð ìîäåëè óñòðîéñòâà äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*30.06.2005 16:04 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdevicemodeledit;device_v1.vcx;device.app],lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************
	*[DEVICEDRIVER] &amp;&amp; [SETUP] - óñòàíîâêà äðàéâåðà									*
	*********************************************************************************
	CASE lcEntityName == [DEVICEDRIVER] AND lcRequestedOperation == [SETUP]

		*07.07.2005 12:16 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdevicedriversetup;device_v1;device.app])
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[DEVICEDRIVER] &amp;&amp; ([EDIT] || [INFO] || [DELE]) - ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå äðàéâåðà					*
	*************************************************************************************************************
	CASE lcEntityName == [DEVICEDRIVER] AND (lcRequestedOperation == [EDIT] OR ;
		lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*08.07.2005 11:03 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð äðàéâåðà äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*08.07.2005 11:03 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdevicedriveredit;device_v1.vcx;device.app],lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*********************************************************************************
	*[DEVICE] &amp;&amp; [VIEW] - ïðîñìîòð óñòðîéñòâ										*
	*********************************************************************************
	CASE lcEntityName == [DEVICE] AND lcRequestedOperation == [VIEW]
	
		*24.06.2005 17:12 -&gt; Çàïóñòèì ôîðìó äëÿ ïðîñìîòðà óñòðîéñòâ
		oApp.ExecuteScrFormByObjDesc([frmdeviceview;device_v1.vcx;device.app])
		*------------------------------------------------------------------------------

		*24.06.2005 17:12 -&gt; Âåðíåì ôëàã óñïåøíîñòè
		RETURN .T.
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[DEVICE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])															*
	*äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå óñòðîéñòâ														*
	*************************************************************************************************************
	CASE lcEntityName == [DEVICE] AND (lcRequestedOperation == [ADD] OR lcRequestedOperation == [EDIT] OR ;
		lcRequestedOperation == [INFO] OR lcRequestedOperation == [DELE])

		*24.06.2005 17:14 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð óñòðîéñòâà äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*						èäåíòèôèêàòîð êîíòåéíåðà äëÿ äîáàâëÿåìîãî óñòðîéñòâà
		*------------------------------------------------------------------------------

		*24.06.2005 17:14 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmdeviceedit;device_v1.vcx;device.app],lcRequestedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	OTHERWISE
	
		*24.06.2005 17:14 -&gt; Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Ê ñîæàëåíèþ çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*do Îñíîâíîé èíòåðôåéñ áèáëèîòåêè.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7> </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>979858542</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmactruleview</objname>
		<parent/>
		<properties>Top = -3
Left = 8
Height = 541
Width = 904
DoCreate = .T.
Caption = "Ñïðàâî÷íèê ïðàâèë îáðàáîòêè ïðîäàæè òîâàðîâ"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
_allowsaveandrestorelayout = .T.
Name = "frmactruleview"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû (îòêðûòèå ñïðàâî÷íèêîâ)
*-------------------------------------------------------
DODEFAULT()

*30.06.2005 11:55 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------


*30.06.2005 11:55 -&gt; Îòêðûâàåì Local View äëÿ Grid-à
USE lvActionRuleView IN 0
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>16</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñïðàâî÷íèê ïðàâèë îáðàáîòêè ïðîäàæè òîâàðà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11DWJS</uniqueid>
		<timestamp>979858542</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdActRule</objname>
		<parent>frmactruleview</parent>
		<properties>ColumnCount = 7
Height = 535
Left = 1
Panel = 1
RecordSource = "lvActionRuleView"
Top = 1
Width = 903
_activerowhighlight = .T.
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;EDIT;INFO;DELE
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;Óäàëèòü
Name = "grdActRule"
Column1.ControlSource = "lvActionRuleView.ActionRuleId"
Column1.CurrentControl = "Txtgrd1"
Column1.Width = 29
Column1.ReadOnly = .T.
Column1.Name = "Column1"
Column2.ControlSource = "lvActionRuleView.ActionRuleNm"
Column2.CurrentControl = "Txtgrd1"
Column2.Width = 247
Column2.Name = "Column2"
Column3.ControlSource = "lvActionRuleView.CashNm"
Column3.CurrentControl = "Txtgrd1"
Column3.Width = 109
Column3.Name = "Column3"
Column4.ControlSource = "lvActionRuleView.DeviceNm"
Column4.Width = 112
Column4.Name = "Column4"
Column5.ControlSource = "lvActionRuleView.EmiNm"
Column5.Width = 108
Column5.Name = "Column5"
Column6.ControlSource = "lvActionRuleView.IspNm"
Column6.Width = 136
Column6.Name = "Column6"
Column7.ControlSource = "lvActionRuleView.StockNm"
Column7.Width = 130
Column7.Name = "Column7"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî òèïà óñòðîéñòâ
*-------------------------------------------------------
WITH This

*30.06.2005 12:05 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*30.06.2005 12:05 -&gt; Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîãî òèïà óñòðîéñòâ
lnResAdding = oMgrDevice.Do([ACTRULE], [ADD])
*------------------------------------------------------------------------------

*30.06.2005 12:06 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]
		
	*30.06.2005 12:06 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	***
	lcOldAlias = ALIAS()
	
	*30.06.2005 12:06 -&gt; Îáíîâèì Local View'û
	REQUERY([lvActionRuleView])
	*------------------------------------------------------------------------------

	*30.06.2005 15:45 -&gt; Äîçàãðóçèì êàðòèíêè
	.DynamicImageReset()
	*------------------------------------------------------------------------------

	*30.06.2005 12:06 -&gt; Ïåðåõîäèì íà äîáàâëåííûé ýëåìåíò
	SELECT lvActionRuleView
	LOCATE FOR lvActionRuleView.ActionRuleID = lnResAdding
	*------------------------------------------------------------------------------

	*30.06.2005 12:07 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 12:07 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*30.06.2005 12:07 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 12:02 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnDeviceTypeId, ;
		luResDele
***

*30.06.2005 12:02 -&gt; Âûïîëíèì îïåðàöèþ óäàëåíèÿ òèïà óñòðîéñòâ
luResDele = oMgrDevice.Do([ACTRULE], [DELE], lvActionRuleView.ActionRuleID)
*------------------------------------------------------------------------------

*30.06.2005 12:03 -&gt; Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luResDele])==[L] AND luResDele
	
	*30.06.2005 12:03 -&gt; Îáíîâèì Local View'û
	REQUERY([lvActionRuleView])
	*------------------------------------------------------------------------------

	*30.06.2005 12:03 -&gt; Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 12:00 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL			luResEditing
*------------------------------------------------------------------------------

*30.06.2005 12:00 -&gt; Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ òèïà óñòðîéñòâ
luResEditing = oMgrDevice.Do([ACTRULE], [EDIT], lvActionRuleView.ActionRuleID)
*------------------------------------------------------------------------------

*30.06.2005 12:01 -&gt; Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing
	
	*30.06.2005 12:01 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------

	*30.06.2005 12:01 -&gt; Îáíîâèì Local View'û
	REQUERY([lvActionRuleView])
	*------------------------------------------------------------------------------


	*30.06.2005 12:01 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
*!*		SELECT lvActionRuleView
*!*		LOCATE FOR lvActionRuleView.ActionRuleID = lvActionRuleView.ActionRuleID
*!*		*------------------------------------------------------------------------------
*!*		
	*30.06.2005 12:02 -&gt; Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*30.06.2005 12:02 -&gt; âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*30.06.2005 12:02 -&gt; Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: grdDeviceType._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð òèïà óñòðîéñòâ
*-------------------------------------------------------

*30.06.2005 11:58 -&gt; Âûïîëíèì îïåðàöèþ ïðîñìîòðà òèïà óñòðîéñòâ
oMgrDevice.Do([ACTRULE], [INFO], lvActionRuleView.ActionRuleID )
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB11ZRUO</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column1</parent>
		<properties>Alignment = 2
Caption = " Id"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QH02X</uniqueid>
		<timestamp>979856932</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmactruleview.grdActRule.Column1</parent>
		<properties>ControlSource = "lvActionRuleView.ActionRuleId"
Left = 32
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQEY</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column2</parent>
		<properties>Alignment = 2
Caption = "Íàçâàíèå ïðàâèëà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QKHUP</uniqueid>
		<timestamp>979856932</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmactruleview.grdActRule.Column2</parent>
		<properties>ControlSource = "lvActionRuleView.ActionRuleNm"
Left = 53
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FC0PYQF0</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column3</parent>
		<properties>Alignment = 2
Caption = "Òî÷êà ïðîäàæè"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FD0QKHUQ</uniqueid>
		<timestamp>979856932</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>frmactruleview.grdActRule.Column3</parent>
		<properties>ControlSource = "lvActionRuleView.CashNm"
Left = 44
Top = 30
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OB</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column4</parent>
		<properties>Caption = "Óñòðîéñòâî ïå÷àòè"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OC</uniqueid>
		<timestamp>979856932</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmactruleview.grdActRule.Column4</parent>
		<properties>BorderStyle = 0
ControlSource = "lvActionRuleView.DeviceNm"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OD</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column5</parent>
		<properties>Caption = "Ìåñòî ñïèñàíèÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OF</uniqueid>
		<timestamp>979856932</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmactruleview.grdActRule.Column5</parent>
		<properties>BorderStyle = 0
ControlSource = "lvActionRuleView.EmiNm"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OG</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column6</parent>
		<properties>Caption = "Ìåñòî èçãîòîâëåíèÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OH</uniqueid>
		<timestamp>979856932</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmactruleview.grdActRule.Column6</parent>
		<properties>BorderStyle = 0
ControlSource = "lvActionRuleView.IspNm"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OI</uniqueid>
		<timestamp>979856932</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmactruleview.grdActRule.Column7</parent>
		<properties>Caption = "Ìåñòî õðàíåíèÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0T74OJ</uniqueid>
		<timestamp>979856932</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmactruleview.grdActRule.Column7</parent>
		<properties>BorderStyle = 0
ControlSource = "lvActionRuleView.StockNm"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmactruleview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>979858912</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmactruleedit</objname>
		<parent/>
		<properties>Height = 234
Width = 676
DoCreate = .T.
BorderStyle = 2
Caption = "Ïðàâèëî ïðè ïðîäàæå òîâàðà"
crequestedoperation = 
Name = "frmactruleedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
CSTRESIZABLE.Name = "CSTRESIZABLE"
Img1.Name = "Img1"
CSTDATAWORK.Name = "CSTDATAWORK"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS	tcMessage

WITH This

*30.06.2005 13:12 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llDataWasChanged, ;
		llResSave
*------------------------------------------------------------------------------

*30.06.2005 13:12 -&gt; Ñîõðàíèì èëè îòìåíèì èçìåíåíèÿ
IF tcMessage == [OK]

	*30.06.2005 13:12 -&gt; Îïåðàöèÿ óäàëåíèå / ðåäàêòèðîâàíèå
	IF .cRequestedOperation == [DELE]

		*30.06.2005 13:12 -&gt; Óäàëèì çàïèñü
		DELETE IN lvActionRuleEdit
		llDataWasChanged = .T.
		*------------------------------------------------------------------------------
	ELSE
		
		*30.06.2005 13:12 -&gt; Ïðîâåðèì áûëè ëè èçìåíåíû äàííûå
		llDataWasChanged = .cstDataWork.DataChanged([lvActionRuleEdit],.T.)
		*------------------------------------------------------------------------------
	ENDIF
	*------------------------------------------------------------------------------	

	*30.06.2005 13:12 -&gt; Ïðîèçâîäèì ñîõðàíåíèå Alias-à äëÿ ðåäàêòèðîâàíèÿ
	IF llDataWasChanged
		
		*30.06.2005 13:12 -&gt; Âûñòàâëÿåì ôëàã ìîäèôèêàöèè äàííûõ è ïðîèçâîäèì ñîõðàíåíèå
		llResSave = .cstDataWork.Save([lvActionRuleEdit])
		*------------------------------------------------------------------------------
		
		*30.06.2005 13:13 -&gt; Îáðàáîòàåì ðåçóëüòàòû ñîõðàíåíèÿ
		IF !llResSave
			IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà
				RETURN .T. &amp;&amp;âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			ELSE	
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				.cstDataWork.Restore([lvActionRuleEdit])
			ENDIF	
		ENDIF
		*------------------------------------------------------------------------------

	ELSE

	*30.06.2005 13:13 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvActionRuleEdit])
	llResSave = .F.
	*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

	*04.04.2005 11:57 -&gt; Âîçâðàùàåì ðåçóëüòàò
	IF	llResSave

		IF .cRequestedOperation == [ADD]

			*08.07.2004 15:23 -&gt;Ïîëó÷àåì èäåíòèôèêàòîð äîáàâëåíííîãî ýëåìåíòà
			.uRetVal = IIF(llResSave,spGetLastIncrementedID([lvActionRuleEdit]),.F.)
			*------------------------------------------------------------------------------

		ELSE

			*04.07.2005 18:02 -&gt;Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
			.uRetVal = .T.
			*------------------------------------------------------------------------------

		ENDIF

	ELSE

		*13.01.2005 14:38 -&gt; Ñîõðàíÿåì ðåçóëüòàò ñîõðàíåíèÿ
		.uRetVal = .F.
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------

ELSE

	*30.06.2005 13:13 -&gt; Îòìåíèì èçìåíåíèÿ
	.cstDataWork.Restore([lvActionRuleEdit])
	.uRetVal = .F.
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*30.06.2005 13:13 -&gt; Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation,tnDeviceTypeID&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Èíèöèàëèçàöèÿ ôîðìû
*-------------------------------------------------------
LPARAMETERS	tcRequestedOperation,tnActionRuleID

*30.06.2005 13:07 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
IF PCOUNT()&lt;1
	*{
	ASSERT .F. MESSAGE [Device_v1.frmDeviceTypeEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
	RETURN .F.
	*}
ENDIF
*------------------------------------------------------------------------------

*30.06.2005 13:08 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*30.06.2005 13:08 -&gt; Ñîõðàíèì îïåðàöèþ
.cRequestedOperation = tcRequestedOperation
*------------------------------------------------------------------------------

*30.06.2005 13:08 -&gt; Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]
			
		*30.06.2005 13:08 -&gt; Äîáàâèì ïóñòóþ çàïèñü â lvDeviceTypeEdit
		APPEND BLANK IN lvActionRuleEdit
		*------------------------------------------------------------------------------

		
	CASE INLIST(.cRequestedOperation,[EDIT],[INFO],[DELE])
		
		*30.06.2005 13:07 -&gt; Ïðîâåðÿåì íàëè÷èå îáÿçàòåëüíûõ ïàðàìåòðîâ
		IF PCOUNT()&lt;2
			*{
			ASSERT .F. MESSAGE [Device_v1.frmDeviceTypeEdit.Init: íåïåðåäàí îáÿçàòåëüíûé ïàðàìåòð.]
			RETURN .F.
			*}
		ENDIF
		*------------------------------------------------------------------------------

		*30.06.2005 13:10 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
		PRIVATE _PARAM
		*------------------------------------------------------------------------------

		*30.06.2005 13:10 -&gt; Çàãðóçèì äàííûå â lvDeviceTypeEdit
		_PARAM = tnActionRuleID
		***
		REQUERY([lvActionRuleEdit])
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------

*30.06.2005 13:10 -&gt; Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation == [ADD]
		.Caption = ALLTRIM(.Caption)+[ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])

	CASE .cRequestedOperation == [EDIT]
		.Caption = ALLTRIM(.Caption)+[ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])

	CASE .cRequestedOperation == [INFO]
		.Caption = ALLTRIM(.Caption)+[ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.

	CASE .cRequestedOperation == [DELE]
		.Caption = ALLTRIM(.Caption)+[ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]

ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Device_v1.vcx
* Class.Module....: frmDeviceTypeEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ôîðìû
*-------------------------------------------------------

*30.06.2005 13:06 -&gt; Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*30.06.2005 13:06 -&gt; Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*30.06.2005 13:06 -&gt; Îòêðûâàåì ñïðàâî÷íèêè
USE lvcashlist IN 0
USE lvdevicetreeview IN 0
USE lvouoperatelistint IN 0 ALIAS lvEmiList
USE lvouoperatelistint IN 0 AGAIN ALIAS lvIspList
USE lvouoperatelistint IN 0 ALIAS lvStockList
*------------------------------------------------------------------------------

*30.06.2005 13:07 -&gt; Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ
USE lvActionRuleEdit IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>16</reserved2>
		<reserved3>crequestedoperation &lt;public/runtime&gt; Îïåðàöèÿ, êîòîðóþ äîëæåí âûïîëíèòü äàííûé îáúåêò.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ðåäàêòîð ïðàâèë îáðàáîòêè ïðîäàæè òîâàðà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>979858912</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceTypeNM</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 33
Left = 215
Width = 457
Height = 23
TabIndex = 4
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceTypeNM"
txtText.ControlSource = "lvActionRuleEdit.ActionRuleNM"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 421
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceTypeNM
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 435
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00SCSI5</uniqueid>
		<timestamp>979858912</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntTxtCalcLenDeviceTypeDesc</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 5
Left = 215
Enabled = .F.
TabIndex = 2
ZOrderSet = 6
Name = "cntTxtCalcLenDeviceTypeDesc"
txtText.ControlSource = "lvActionRuleEdit.ActionRuleID"
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblDeviceTypeDesc
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceTypeNM</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå ïðàâèëà:"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 7
Name = "lblDeviceTypeNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF953</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl3</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Ìåñòî õðàíåíèÿ:"
Height = 17
Left = 7
Top = 177
Width = 100
TabIndex = 13
ZOrderSet = 7
Name = "Lbl3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF94X</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Ìåñòî ïðîèçâîäñòâà:"
Height = 17
Left = 7
Top = 148
Width = 126
TabIndex = 11
ZOrderSet = 7
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF94W</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Ìåñòî ñïèñàíèÿ:"
Height = 17
Left = 7
Top = 120
Width = 100
TabIndex = 9
ZOrderSet = 7
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_17C0QQD9L</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblSelBmpID</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Òî÷êà äåéñòâèÿ:"
Height = 17
Left = 6
Top = 92
Width = 97
TabIndex = 7
ZOrderSet = 7
Name = "lblSelBmpID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1551428TS</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblBmpID</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "Òî÷êà ïðîäàæè:"
Height = 17
Left = 6
Top = 64
Width = 94
TabIndex = 5
ZOrderSet = 7
Name = "lblBmpID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K00SCSIL</uniqueid>
		<timestamp>979858912</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeviceTypeDesc</objname>
		<parent>frmactruleedit</parent>
		<properties>FontBold = .T.
Caption = "ID ïðàâèëà:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 7
Name = "lblDeviceTypeDesc"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10B7SL</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridBmp</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 61
Left = 214
Width = 458
Height = 24
TabIndex = 6
_controlsourcetype = 1
_controlsource = lvActionRuleEdit.ActionRulePointEmi
_rsaliasname = lvcashlist
_rsfieldnameid = CashID
_rsfieldnametext = CashNM
Name = "cntIdCtlGridBmp"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 410
txtText._highlightobject = .Parent.Parent.lblBmpID
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 413
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 436
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1K80OR73A</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridSelBmp</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 89
Left = 214
Width = 458
TabIndex = 8
_controlsourcetype = 1
_controlsource = lvActionRuleEdit.ActionRulePointIsp
_rsaliasname = lvdevicetreeview
_rsfieldnameid = DeviceID
_rsfieldnametext = DeviceNM
Name = "cntIdCtlGridSelBmp"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 410
txtText._highlightobject = .Parent.Parent.lblSelBmpID
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 413
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 436
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF94Y</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntidctlgrid1</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 117
Left = 215
Width = 458
TabIndex = 10
_controlsourcetype = 1
_controlsource = lvActionRuleEdit.PointEmiOUID
_rsaliasname = lvEmiList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "Cntidctlgrid1"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 409
txtText._highlightobject = .Parent.Parent.lblBmpID
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 413
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 436
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF94Z</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntidctlgrid2</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 145
Left = 215
Width = 458
TabIndex = 12
_controlsourcetype = 1
_controlsource = lvActionRuleEdit.PointIspOUID
_rsaliasname = lvIspList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "Cntidctlgrid2"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 409
txtText._highlightobject = .Parent.Parent.lblSelBmpID
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 413
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 436
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HF0Z6S64</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 204
Left = 468
TabIndex = 15
ZOrderSet = 17
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0UF954</uniqueid>
		<timestamp>979858912</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntidctlgrid3</objname>
		<parent>frmactruleedit</parent>
		<properties>Top = 174
Left = 215
Width = 458
TabIndex = 14
_controlsourcetype = 1
_controlsource = lvActionRuleEdit.ActionRuleStockID
_rsaliasname = lvStockList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "Cntidctlgrid3"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 409
txtText._highlightobject = .Parent.Parent.lblBmpID
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 413
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 436
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmactruleedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
