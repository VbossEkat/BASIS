<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>882011901</timestamp>
		<class>grdmenuview</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdmenuview</objname>
		<parent/>
		<properties>Height = 580
RowHeight = (ROUND(580/8,0))
ScrollBars = 2
Name = "grdmenuview"
Column1.Header1.Name = "Header1"
Column1.Edt1._highlightself = .F.
Column1.Edt1.Name = "Edt1"
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êíîïêè ìåíþ áûñòðîãî äîñòóïà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdmenuview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 11, 7, 18, 14, 39, 4, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>882072490</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>imgtable</objname>
		<parent/>
		<properties>Picture = ..\graphic\t1.bmp
Stretch = 2
Height = 73
Width = 98
Name = "imgtable"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>èçîáðàæåíèå ñòîëà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>imgtable</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>887319937</timestamp>
		<class>login</class>
		<classloc>pos.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>login</objname>
		<parent/>
		<properties>Height = 203
Width = 379
ShowWindow = 1
DoCreate = .T.
BorderStyle = 3
Name = "login"
Shp1.Top = 120
Shp1.Left = 41
Shp1.Name = "Shp1"
cstmsghandler.Top = 115
cstmsghandler.Left = 36
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 115
cstresizable.Left = 58
cstresizable.Name = "cstresizable"
cntcancelsavehandled.cmdCancel.Name = "cmdCancel"
cntcancelsavehandled.cmdOk.Name = "cmdOk"
cntcancelsavehandled.Top = 165
cntcancelsavehandled.Left = 146
cntcancelsavehandled.Name = "cntcancelsavehandled"
cstdatawork.Top = 115
cstdatawork.Left = 80
cstdatawork.Name = "cstdatawork"
txtPassword.Left = 146
txtPassword.Top = 125
txtPassword.Name = "txtPassword"
lblPassword.Left = 46
lblPassword.Top = 128
lblPassword.Name = "lblPassword"
Olecommprox1.Top = 152
Olecommprox1.Left = 43
Olecommprox1.Height = 38
Olecommprox1.Width = 37
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>887319937</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img1</objname>
		<parent>login</parent>
		<properties>Picture = ..\graphic\login.bmp
Height = 80
Left = 8
Top = 12
Width = 350
Name = "Img1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>login</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>887321259</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblwaiter</objname>
		<parent/>
		<properties>AutoSize = .T.
FontBold = .T.
FontItalic = .T.
FontName = "Times New Roman"
FontSize = 14
BackStyle = 0
Caption = "ÔÈÎ îôèöèàíòà"
ForeColor = 128,128,255
Name = "lblwaiter"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>lblwaiter</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>887327567</timestamp>
		<class>txtcalctype</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtcalctype</objname>
		<parent/>
		<properties>InputMask = "999999.99"
MaxLength = 8
Name = "txtcalctype"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
NODEFAULT

txt::gotfocus()

ENDPROC
PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl
LOCAL lselstart, lcAlias, lnRecNo, lnTmpValue

lcAlias = ALIAS()
lnRecNo = RECNO()

NODEFAULT

lselstart = this.SelStart
lnTmpValue = this.value

IF BETWEEN(tnKeyCode,48,57) AND tnShiftAltCtrl=0 &amp;&amp; Digits
	IF lselstart &lt;=LEN(ALLTRIM(STR(INT(lnTmpValue))))
		*--åñëè ðàáîòàåì ñ öåëîé ÷àñòüþ
		IF LEN(ALLTRIM(STR(INT(lnTmpValue))))&lt;6
			*--åñëè öåëàÿ ÷àñòü &lt; max ÷èñëà ñèìâîëîâ â öåëîé ÷àñòè
		 	lnTmpValue=INT(lnTmpValue)*10+VAL(CHR(tnKeyCode))+lnTmpValue-INT(lnTmpValue)

		 	*--âûäåëèì êóðñîðîì åäèíè÷íûé ðàçðÿä
			this.SelStart=0
			this.SelLength=1
		ENDIF
	ELSE
		*--ðàáîòàåì ñ äðîáíîé ÷àñòüþ
		IF LEN(ALLTRIM(STR(lnTmpValue-INT(lnTmpValue))))&lt;2
			*--åñëè äðîáíàÿ ÷àñòü &lt; max ÷èñëà ñèìâîëîâ â äðîáíîé ÷àñòè
			IF INT((lnTmpValue-INT(lnTmpValue))*10)&gt;0
				*--ââîäèì ñîòûå äîëè
				lnTmpValue=INT(lnTmpValue*10)/10+VAL(CHR(tnKeyCode))/100
			ELSE
				*--ââîäèì äåñÿòûå äîëè
				lnTmpValue=INT(lnTmpValue)+VAL(CHR(tnKeyCode))/10
			ENDIF
			this.SelStart=LEN(ALLTRIM(STR(INT(lnTmpValue))))+2
			this.SelLength=1
		ELSE
			*--çàìåíÿåì íîâûì ââîäîì ïîñëåäíèé ñèìâîë
			lnTmpValue = INT(lnTmpValue*10)/10+VAL(CHR(tnKeyCode))/100
			this.SelStart=LEN(ALLTRIM(STR(INT(lnTmpValue))))+2
			this.SelLength=1
		ENDIF
	ENDIF
ELSE
	IF tnKeyCode=7 &amp;&amp;--DELETE
		lnTmpValue = 0
		this.SelStart=0
		this.SelLength=0
	ENDIF
	
	IF tnKeyCode=46 AND tnShiftAltCtrl=0 &amp;&amp; Point
		this.SelStart=LEN(ALLTRIM(STR(INT(lnTmpValue))))+1
		this.SelLength=0
	ENDIF
ENDIF

this.value = lnTmpValue

This._HandleAnyChange()

SELECT (lcAlias)
GOTO (lnRecNo)
*-------------------------------------------------------------------
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ïîëå ââîäà ñ êàëüêóëÿòîðà â òàáëèöó</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>txtcalctype</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>893740843</timestamp>
		<class>txtcalctype</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtcalcnum</objname>
		<parent/>
		<properties>Name = "txtcalcnum"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl


IF tnKeyCode=7 OR (!EMPTY(this.MaxLength) AND LEN(ALLTRIM(STR(this.value,99,2)))&gt;this.MaxLength)
	*--DELETE èëè ïðåâûøåíèå äëèíû
	this.value = 0
	this.SelStart=0
	this.SelLength=0
ELSE
	*--äðóãèå êëàâèøè
	DODEFAULT(tnKeyCode, tnShiftAltCtrl)
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>äðîáíîå ïîëå äëÿ ââîäà ñ êàëüêóëÿòîðà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>txtcalcnum</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA02X99M</uniqueid>
		<timestamp>894264944</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtcalcint</objname>
		<parent/>
		<properties>nlength = 3
Name = "txtcalcint"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl

IF BETWEEN(tnKeyCode,48,57) AND tnShiftAltCtrl=0 &amp;&amp; Digits
	IF LEN(ALLTRIM(STR(this.Value)))&lt;this.nlength
	 	this.Value=this.Value*10+VAL(CHR(tnKeyCode))
	ELSE
	 	this.Value=this.Value-MOD(this.Value,10)+VAL(CHR(tnKeyCode))
	ENDIF
	this.SelStart=LEN(this.InputMask)-1
	this.SelLength=1
ELSE
	IF tnKeyCode = 7 &amp;&amp;--DELETE
		this.Value = 0
	ENDIF
ENDIF
*-------------------------------------------------------------------
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nlength
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>öåëî÷èñëåííîå ïîëå ââîäà ñ êàëüêóëÿòîðà </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>txtcalcint</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SC0S5FAV</uniqueid>
		<timestamp>921474020</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtmenu</objname>
		<parent/>
		<properties>BorderStyle = 0
ScrollBars = 0
_highlightself = .F.
Name = "edtmenu"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform._clickmenu(this.value)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>edtmenu</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>921662996</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmbackpayment</objname>
		<parent/>
		<properties>DataSession = 1
Height = 313
Width = 359
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = "Âîçâðàò"
KeyPreview = .F.
BackColor = 241,239,241
nordersum = 0
ncoupon = .F.
nnal = .F.
Name = "frmbackpayment"
cstmsghandler.Top = 12
cstmsghandler.Left = 56
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 12
cstresizable.Left = 24
cstresizable.Name = "cstresizable"
cstdatawork.Top = 12
cstdatawork.Left = 84
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMBACKPAYMENT._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This
	IF tcMessage = [OK]
		*--ñôîðìèðóåì âîçâðàùàåìîå çíà÷åíèå
		.uRetVal = .CntPayTypeID.Value
	ELSE
		*--tcMessage = [ESC]
		.uRetVal = .F.
	ENDIF
		
	*--Ñêðûâåì ôîðìó
	.hide()
	*------------------------------------------------------------------------------
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMBACKPAYMENT.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnOrderSum - ñóììà çàêàçà
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tnOrderSum
LOCAL _PARAM

DODEFAULT()

*--òèïû îïëàòû
USE IN SELECT([lvPayTypeView])
_PARAM = ALLT(oRes.GetParam([RST],[BACKTYPE]))
USE lvPayTypeView IN 0

thisform.cntPayTypeID.SetValue(1)

thisform.nOrderSum = tnOrderSum
thisform.lblCash.caption = ALLTRIM(STR(tnOrderSum,99,2))


ENDPROC
PROCEDURE Load
DODEFAULT()

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>nordersum
ncoupon
nnal
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>âûáîð òèïà îïëàòû ïðè âîçâðàòå</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X00PAG8M</uniqueid>
		<timestamp>921662996</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmbackpayment</parent>
		<properties>Top = 0
Left = 0
Height = 313
Width = 359
BackStyle = 0
BorderWidth = 6
BorderColor = 0,0,255
ZOrderSet = 1
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>921662996</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmbackpayment</parent>
		<properties>Top = 264
Left = 12
Width = 324
Height = 41
TabIndex = 5
TabStop = .F.
ZOrderSet = 5
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 36
cmdCancel.Width = 156
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 14
cmdCancel.ForeColor = 0,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 164
cmdOk.Height = 36
cmdOk.Width = 172
cmdOk.FontBold = .T.
cmdOk.FontSize = 14
cmdOk.Caption = "Îïëàòèòü "
cmdOk.ForeColor = 0,0,255
cmdOk.BackColor = 241,239,241
cmdOk.DisabledBackColor = 241,239,241
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>921662996</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblCash</objname>
		<parent>frmbackpayment</parent>
		<properties>FontBold = .T.
FontSize = 38
BackStyle = 0
Caption = "1234567.89"
Left = 46
Top = 91
TabIndex = 7
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 6
Name = "LblCash"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>921662996</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPayTypeID</objname>
		<parent>frmbackpayment</parent>
		<properties>Top = 175
Left = 12
Width = 336
Height = 43
BackStyle = 0
TabIndex = 2
ForeColor = 228,151,22
BackColor = 241,239,241
ZOrderSet = 7
_allowresizecontent = .T.
_rsaliasname = lvPayTypeView
_rsfieldnametext = NM
_rsfieldnameid = ID_
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntPayTypeID"
txtText.FontBold = .T.
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.BorderStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 276
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 279
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.DisabledForeColor = 0,0,255
cmdShow.DisabledBackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 319
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods>PROCEDURE txtText.Click
THIS.PARENT.ShowSelectObject()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>921662996</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSum</objname>
		<parent>frmbackpayment</parent>
		<properties>FontBold = .T.
FontSize = 30
BackStyle = 0
Caption = "Ñóììà âîçâðàòà"
Left = 16
Top = 30
TabIndex = 6
ForeColor = 0,0,255
ZOrderSet = 8
Name = "LblSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmbackpayment</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 14, 9, 23, 18, 50, 4, 1
Arial, 1, 16, 10, 25, 19, 55, 5, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>921663123</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcancelreason</objname>
		<parent/>
		<properties>Height = 116
Width = 318
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = "Ïðè÷èíû îòêàçà îò áëþäà"
BackColor = 241,239,241
Name = "frmcancelreason"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMCANCELREASON._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This
	IF tcMessage = [OK]
		*--Ïðîâåðèì, âûáðàíà ëè ïðè÷èíà îòêàçà îò áëþäà
		IF EMPTY(.cntRsn.value)
			MESSAGEBOX([Íåîáõîäèìî âûáðàòü ïðè÷èíó îòêàçà îò áëþäà!],48,[Îêíî ñîîáùåíèé])
			.cntRsn.txtText.SetFocus()
			RETURN .F.
		ENDIF
		
		*--Ñîõðàíÿåì ðåçóëüòàòû âûáîðâ â ñâîéñòâå .uRetVal
		.uRetVal = .cntRsn.value
	ELSE
		*--tcMessage = [ESC]
		.uRetVal = .F.
	ENDIF
		
	*--Ñêðûâåì ôîðìó
	.Hide()
	*------------------------------------------------------------------------------
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMCANCELREASON.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------

*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì Alias äëÿ âûïàäàþùåãî ñïèñêà
USE lvCancelReasonList IN 0
CURSORSETPROP([BUFFERING],3,[lvCancelReasonList])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñïèñîê ïðè÷èí îòêàçà îò áëþäà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY12O86G</uniqueid>
		<timestamp>921663123</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmcancelreason</parent>
		<properties>Top = 72
Left = 2
Width = 312
Height = 38
TabIndex = 2
TabStop = .F.
ZOrderSet = 12
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 36
cmdCancel.Width = 132
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 12
cmdCancel.ForeColor = 0,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.DisabledForeColor = 0,0,255
cmdCancel.DisabledBackColor = 241,239,241
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 181
cmdOk.Height = 36
cmdOk.Width = 132
cmdOk.FontBold = .T.
cmdOk.FontSize = 12
cmdOk.ForeColor = 0,0,255
cmdOk.BackColor = 241,239,241
cmdOk.DisabledForeColor = 0,0,255
cmdOk.DisabledBackColor = 241,239,241
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SZ0NUEEZ</uniqueid>
		<timestamp>921663123</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntRsn</objname>
		<parent>frmcancelreason</parent>
		<properties>Top = 14
Left = 9
Width = 297
Height = 43
BackStyle = 0
TabIndex = 1
ForeColor = 128,0,255
BackColor = 241,239,241
ZOrderSet = 11
_rsaliasname = lvCancelReasonList
_rsfieldnameid = ID
_rsfieldnametext = NM
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntRsn"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 254
txtText.ForeColor = 128,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 253
cmdShow.Height = 42
cmdShow.Width = 44
cmdShow.BackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 297
cmdClear.Height = 42
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcancelreason</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 16, 9, 25, 19, 56, 5, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>921663278</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmdiscount</objname>
		<parent/>
		<properties>DataSession = 1
Height = 205
Width = 359
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = "Ñêèäêà ïî äèñêîíòíîé êàðòå"
KeyPreview = .F.
BackColor = 241,239,241
Name = "frmdiscount"
cstmsghandler.Top = 12
cstmsghandler.Left = 56
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 12
cstresizable.Left = 24
cstresizable.Name = "cstresizable"
cstdatawork.Top = 12
cstdatawork.Left = 84
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
LPARAMETERS tcMessage

WITH This
	IF tcMessage = [OK]
		*--ñôîðìèðóåì âîçâðàùàåìîå çíà÷åíèå
		.uRetVal = .txtCardNo.value
	ELSE
		*--tcMessage = [ESC]
		.uRetVal = .F.
	ENDIF
		
	*--Ñêðûâåì ôîðìó
	.hide()
	*------------------------------------------------------------------------------
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE getcardinfo
LPARAMETERS tccardcode

*--âåðíåì íîìåð êàðòû
thisform.txtCardNo.value  = tccardcode

ENDPROC
PROCEDURE Init
DODEFAULT()

thisform.txtCardNo.SetFocus()
ENDPROC
PROCEDURE Load
DODEFAULT()

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>*getcardinfo 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñêèäêè ïî êàðòî÷êàì</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X00PAG8M</uniqueid>
		<timestamp>921663278</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmdiscount</parent>
		<properties>Top = 0
Left = 0
Height = 206
Width = 359
BackStyle = 0
BorderWidth = 6
BackColor = 0,0,0
BorderColor = 0,0,255
ZOrderSet = 1
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>921663278</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmdiscount</parent>
		<properties>Top = 156
Left = 12
Width = 336
Height = 36
TabIndex = 5
TabStop = .F.
BackColor = 241,239,241
ZOrderSet = 5
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 36
cmdCancel.Width = 156
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 12
cmdCancel.Caption = "Îòìåíà (ESC)"
cmdCancel.ForeColor = 128,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.DisabledForeColor = 0,0,255
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 180
cmdOk.Height = 36
cmdOk.Width = 156
cmdOk.FontBold = .T.
cmdOk.FontSize = 12
cmdOk.Caption = "Âûáðàòü"
cmdOk.ForeColor = 128,0,255
cmdOk.BackColor = 241,239,241
cmdOk.DisabledForeColor = 0,0,255
cmdOk.DisabledBackColor = 252,242,218
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8KL</uniqueid>
		<timestamp>921663278</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCardNo</objname>
		<parent>frmdiscount</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 3
Value = 
Enabled = .T.
Height = 29
Left = 36
Top = 83
Width = 288
PasswordChar = "*"
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 241,239,241
DisabledForeColor = 0,0,255
ZOrderSet = 6
Name = "txtCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8L0</uniqueid>
		<timestamp>921663278</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmdiscount</parent>
		<properties>Top = 12
Left = 312
Height = 48
Width = 58
ZOrderSet = 7
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	*------------------------------------------------------------------------------

	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	This.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJDJ6yq+xscBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8L1</uniqueid>
		<timestamp>921663278</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmdiscount</parent>
		<properties>AutoSize = .F.
FontBold = .F.
FontSize = 14
Alignment = 2
BackStyle = 1
Caption = "Ââåäèòå íîìåð äèñêîíòíîé êàðòû"
Height = 25
Left = 1
Top = 54
Width = 360
TabIndex = 26
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 8
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmdiscount</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>921663508</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmodlist</objname>
		<parent/>
		<properties>DataSession = 1
Height = 241
Width = 319
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = "Ìîäèôèêàòîðû"
BackColor = 241,239,241
Name = "frmmodlist"
cstmsghandler.Top = 185
cstmsghandler.Left = 40
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 185
cstresizable.Left = 12
cstresizable.Name = "cstresizable"
cstdatawork.Top = 186
cstdatawork.Left = 68
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMMODLIST._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This
	IF tcMessage = [OK]
		*--Ñîõðàíÿåì ðåçóëüòàòû âûáîðà â ñâîéñòâå .uRetVal
		.uRetVal = []
		
		SELECT lvModList
		SCAN FOR lvModList.Mark
			.uRetVal = .uRetVal+ALLTRIM(STR(lvModList.ID))+[,]
			SELECT lvModList
		ENDSCAN

		*--Ïðîâåðèì, âûáðàí ëè ìîäèôèêàòîð (õîòÿ áû îäèí)
		IF EMPTY(.uRetVal)
			MESSAGEBOX([Äëÿ âûáîðà ìîäèôèêàòîðîâ íåîáõîäèìî èõ ïîìåòèòü!],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ELSE
		*--tcMessage = [ESC]
		.uRetVal = .F.
	ENDIF
		
	*--Ñêðûâåì ôîðìó
	.Hide()
	*------------------------------------------------------------------------------
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMMODLIST.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnTvrID - êîä áëþäà
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tnTvrID
LOCAL _PARAM

*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

_PARAM = tnTvrID
REQUERY([lvModList])

ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMMODLIST.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------

*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì ñïèñîê ìîäèôèêàòîðîâ (ïóñòîé)
USE lvModList IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModList])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ñïèñîê ïðè÷èí îòêàçà îò áëþäà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY12O86G</uniqueid>
		<timestamp>921663508</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmmodlist</parent>
		<properties>Top = 208
Left = 10
Width = 303
Height = 32
TabIndex = 2
TabStop = .F.
BackColor = 241,239,241
ZOrderSet = 12
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 32
cmdCancel.Width = 140
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 12
cmdCancel.ForeColor = 0,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 164
cmdOk.Height = 32
cmdOk.Width = 140
cmdOk.FontBold = .T.
cmdOk.FontSize = 12
cmdOk.ForeColor = 0,0,255
cmdOk.BackColor = 241,239,241
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T00T6BME</uniqueid>
		<timestamp>921663508</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdMod</objname>
		<parent>frmmodlist</parent>
		<properties>ColumnCount = 2
FontSize = 20
HeaderHeight = 0
Height = 201
Left = 1
Panel = 1
ReadOnly = .F.
RecordSource = "lvModList"
RowHeight = 36
ScrollBars = 2
Top = 0
Width = 318
AllowAutoColumnFit = 2
_activerowhighlight = .F.
Name = "GrdMod"
Column1.FontSize = 20
Column1.ColumnOrder = 1
Column1.ControlSource = "lvModList.mark"
Column1.Width = 30
Column1.ReadOnly = .F.
Column1.Sparse = .F.
Column1.ForeColor = 0,0,0
Column1.Name = "Column1"
Column2.FontSize = 10
Column2.ColumnOrder = 2
Column2.ControlSource = "lvModList.NM"
Column2.Width = 256
Column2.ReadOnly = .T.
Column2.ForeColor = 0,0,0
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T00T6BMF</uniqueid>
		<timestamp>884108438</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmmodlist.GrdMod.Column1</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T00T6BMG</uniqueid>
		<timestamp>921663508</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>CHK1</objname>
		<parent>frmmodlist.GrdMod.Column1</parent>
		<properties>Top = 23
Left = 13
FontSize = 20
Alignment = 0
Caption = " "
ForeColor = 0,0,0
ReadOnly = .F.
Name = "CHK1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T00T6BMU</uniqueid>
		<timestamp>884108438</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmmodlist.GrdMod.Column2</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T00T6BMV</uniqueid>
		<timestamp>884108438</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmmodlist.GrdMod.Column2</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmodlist</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 20, 12, 33, 26, 72, 6, 1
Arial, 0, 10, 6, 16, 13, 35, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S207614U</uniqueid>
		<timestamp>922058131</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntorder</objname>
		<parent/>
		<properties>Width = 92
Height = 85
BackStyle = 0
BorderWidth = 0
BackColor = 255,255,255
Style = 0
nfrmid = .F.
Name = "cntorder"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: cntOrder.Click()
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå çàêàçà
*-------------------------------------------------------
*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResEditing

*--çàïîìíèì íîìåð êîíòåéíåðà, íà êîòîðîì ñòîèò ôîêóñ
thisform.nFocusCount = ALLTRIM(SUBSTR(this.name,9,LEN(this.name)-8))

IF thisform.name==[frmmgrview]
	*--ìåíåäæåð ìîæåò òîëüêî ïðîñìàòðèâàòü çàêàçû
	luResEditing = oMgrOrder.Operate([FORM],[EDIT],this.nFrmID,.T.)
ELSE
	*--îôèöèàíò ìîæåò ðåäàêòèðîâàòü çàêàçû
	luResEditing = oMgrOrder.Operate([FORM],[EDIT],this.nFrmID)
ENDIF

*--Îáðàáàòûâàåì ðåçóëüòàò ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing
	*--Îáíîâèì äàííûå íà ôîðìå îôèöèàíòà (ñïèñîê çàêàçîâ ïî äàííîìó ñòîëó)
	IF thisform.Name==[frmorderview]
		thisform._update(.T.)
	ENDIF
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************


ENDPROC
PROCEDURE GotFocus
*--ïîìåíÿåì öâåò ðàìêè
this.shp1.BorderColor = RGB(128,128,255)

DODEFAULT()
ENDPROC
PROCEDURE LostFocus
*--ïîìåíÿåì öâåò ðàìêè
this.shp1.BorderColor = RGB(228,151,22)

DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>nfrmid
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Êîíòåéíåð äëÿ çàêàçà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S70OM49B</uniqueid>
		<timestamp>922057736</timestamp>
		<class>imgtable</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Img1</objname>
		<parent>cntorder</parent>
		<properties>Picture = ..\graphic\ord_.gif
BackStyle = 0
Height = 56
Left = 7
Top = 5
Width = 78
Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
this.Parent.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S70OO7LZ</uniqueid>
		<timestamp>922058131</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>cntorder</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontSize = 12
Alignment = 2
BackStyle = 0
Caption = "11.11"
Height = 19
Left = 5
Top = 62
Width = 80
ForeColor = 0,0,255
Name = "Lbl1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
this.Parent.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntorder</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0S1K7H</uniqueid>
		<timestamp>922977963</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cnttable</objname>
		<parent/>
		<properties>Width = 116
Height = 111
BackStyle = 0
BorderWidth = 0
TabStop = .T.
ntablenum = 0
Name = "cnttable"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: CNTTABLE._ADD
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî çàêàçà
*-------------------------------------------------------

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResAdding, i, _PARAM, lnTableID
lnTableID = VAL(SUBSTR(this.Name,9))

*--Âûïîëíÿåì îïåðàöèþ äîáàâëåíèÿ äîêóìåíòà
luResAdding = oMgrOrder.Operate([FORM],[ADD],lnTableID)
*------------------------------------------------------------------------------

LOCAL lcexp

*12.05.2004 03:26 -&gt;Îáðàáàòûâàåì ðåçóëüòàò äîáàâëåíèÿ
IF TYPE([luResAdding])==[N] AND !EMPTY(luResAdding)
	*--Åñëè äîáàâèëàñü øàïêà çàêàçà, òî îòêðîåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ çàêàçà
	oMgrOrder.Operate([FORM],[EDIT],luResAdding)
	
	*--ïîëó÷èì ID ñòîëà èç íîâîãî çàêàçà
	USE IN SELECT([lvFrmEditDop])
	_PARAM = luResAdding
	USE lvFrmEdit ALIAS lvFrmEditDop IN 0
	IF RECCOUNT([lvFrmEditDop])&gt;0
		lnTableID = lvFrmEditDop.PointEmiOUID
	ENDIF
	
	*--îáíîâèì äàííûå
	SELECT lvWaiterTableView
	LOCATE FOR lvWaiterTableView.PointEmiOUID = lnTableID
	IF !FOUND()
		*--åñëè ñòîë åùå íå áûë îòêðûò, äîáàâèì åãî
		APPEND BLANK
		
		*--ïîëó÷èì íàçâàíèå ñòîëà
		USE IN SELECT([lvOrgUnitEdit])
		_PARAM = lnTableID
		USE lvOrgUnitEdit IN 0
		
		*--äîáàâèì ñòîë
		REPLACE lvWaiterTableView.PointEmiOUID WITH lnTableID, ;
				lvWaiterTableView.TableNM WITH lvOrgUnitEdit.OUNM
				
		*--îáíîâèì ôîðìó
		thisform.refreshtable()
	ENDIF
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _view
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: CNTTABLE._VIEW
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð çàêàçîâ ïî äàííîìó ñòîëó (òåêóùåãî îôèöèàíòà)
*-------------------------------------------------------
LOCAL llupdate

*--îòêðîåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ çàêàçà
oApp.DoFormObj([frmOrderView;rst_v1.vcx],this.ntablenum)

*--ïðîâåðèì, íå èçìåíèëñÿ ëè ñïèñîê ñòîëîâ äàííîãî îôèöèàíòà
_PARAM1 = VAL(oRes.GetParam([RST],[TYPEORD]))
_PARAM2 = spUserClt()
USE lvWaiterTableView IN 0 ALIAS lvWTView

llupdate = .F.

*--ïðîâåðèì ñîâïàäåíèå ñïèñêîâ ñòîëîâ
SELECT lvWaiterTableView
GO TOP
SCAN ALL
	SELECT lvWTView
	LOCATE FOR lvWTView.PointEmiOUID = lvWaiterTableView.PointEmiOUID
	IF !FOUND()
		llupdate = .T.
		EXIT
	ENDIF
	SELECT lvWaiterTableView
ENDSCAN

*--åñëè âñå õîðîøî, ïðîâåðÿåì äàëüøå
IF !llupdate
	SELECT lvWTView
	GO TOP
	SCAN ALL
		SELECT lvWaiterTableView
		LOCATE FOR lvWaiterTableView.PointEmiOUID = lvWTView.PointEmiOUID
		IF !FOUND()
			llupdate = .T.
			EXIT
		ENDIF
		SELECT lvWTView
	ENDSCAN
ENDIF

USE IN SELECT([lvWTView])

*--îáíîâèì äàííûå íà ôîðìå
IF llupdate
	REQUERY([lvWaiterTableView])
	*--thisform.DefaultTable()
	thisform.RefreshTable()
ENDIF
ENDPROC
PROCEDURE Click
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: CNTTABLE.CLICK
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðàáîòà ñ çàêàçàìè ïî äàííîìó ñòîëó
*-------------------------------------------------------
IF EMPTY(this.ntablenum)
	*--Åñëè ñòîë åùå íå îòêðûò, òî ñðàçó ïîêàçûâàåì ôîðìó äëÿ çàâåäåíèÿ íîâîãî çàêàçà
	this._add()
ELSE
	*--åñëè ñòîë óæå îòêðûò, ïîêàæåì ñïèñîê çàêàçîâ ïî ýòîìó ñòîëó
	this._view()
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>ntablenum
*_add íîâûé çàêàç
*_edit ðåäàêòèðîâàíèå çàêàçà
*_view ïðîñìîòð ñïèñêà çàêàçîâ ïî òåêóùåìó ñòîëó
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Êîíòåéíåð äëÿ ñòîëà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ1031NC</uniqueid>
		<timestamp>922977963</timestamp>
		<class>imgtable</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgtable1</objname>
		<parent>cnttable</parent>
		<properties>Picture = ..\graphic\t8s.gif
BackStyle = 0
Height = 73
Left = 9
Top = 8
Width = 98
Name = "Imgtable1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
this.Parent.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0S5QZH</uniqueid>
		<timestamp>922058198</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>cnttable</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontItalic = .F.
FontSize = 11
Alignment = 2
BackStyle = 0
Caption = "Ñòîë ¹ 1"
Height = 20
Left = 9
Top = 84
Width = 98
ForeColor = 0,0,255
BackColor = 255,255,255
ZOrderSet = 2
Name = "Lbl1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
this.Parent.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttable</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_25O15I67X</uniqueid>
		<timestamp>923774075</timestamp>
		<class>frmorderedit</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmorderedit_new</objname>
		<parent/>
		<properties>DoCreate = .T.
Name = "frmorderedit_new"
cstmsghandler.Top = 146
cstmsghandler.Left = 45
cstmsghandler.Name = "cstmsghandler"
LblEdit.Alignment = 0
LblEdit.ZOrderSet = 2
LblEdit.Name = "LblEdit"
cstresizable.Top = 146
cstresizable.Left = 67
cstresizable.Name = "cstresizable"
cstdatawork.Top = 146
cstdatawork.Left = 89
cstdatawork.Name = "cstdatawork"
LblAttr.Caption = "Ãîñòåé"
LblAttr.Left = 257
LblAttr.Top = 31
LblAttr.ZOrderSet = 0
LblAttr.Name = "LblAttr"
chkFrmAutoNum.Alignment = 0
chkFrmAutoNum.ZOrderSet = 5
chkFrmAutoNum.Name = "chkFrmAutoNum"
lblOUTableID.Left = 1
lblOUTableID.Top = 31
lblOUTableID.ForeColor = 0,0,255
lblOUTableID.ZOrderSet = 6
lblOUTableID.Name = "lblOUTableID"
Lbl1.Caption = "Êëèåíò"
Lbl1.Enabled = .F.
Lbl1.Height = 25
Lbl1.Left = 324
Lbl1.Top = 120
Lbl1.Visible = .F.
Lbl1.Width = 62
Lbl1.ZOrderSet = 42
Lbl1.Name = "Lbl1"
cntCltID.txtText.Height = 22
cntCltID.txtText.Left = 0
cntCltID.txtText.Top = 0
cntCltID.txtText.Width = 280
cntCltID.txtText.Name = "txtText"
cntCltID.cmdShow.Top = 0
cntCltID.cmdShow.Left = 268
cntCltID.cmdShow.Name = "cmdShow"
cntCltID.cmdClear.Top = 0
cntCltID.cmdClear.Left = 304
cntCltID.cmdClear.Name = "cmdClear"
cntCltID.Top = 32
cntCltID.Left = 516
cntCltID.Width = 282
cntCltID.Height = 25
cntCltID.ZOrderSet = 7
cntCltID._showtextempty = Êëèåíò
cntCltID.Name = "cntCltID"
CntDiscID.txtText.Name = "txtText"
CntDiscID.cmdShow.Name = "cmdShow"
CntDiscID.cmdClear.Name = "cmdClear"
CntDiscID.Top = 61
CntDiscID.Left = 290
CntDiscID.Enabled = .F.
CntDiscID.Visible = .F.
CntDiscID.ZOrderSet = 8
CntDiscID.Name = "CntDiscID"
cntOUTableID.txtText.ForeColor = 0,0,255
cntOUTableID.txtText.Name = "txtText"
cntOUTableID.cmdShow.Name = "cmdShow"
cntOUTableID.cmdClear.Name = "cmdClear"
cntOUTableID.Top = 28
cntOUTableID.Left = 77
cntOUTableID.Width = 169
cntOUTableID.Height = 22
cntOUTableID.ForeColor = 0,0,255
cntOUTableID.BackColor = 240,240,240
cntOUTableID.ZOrderSet = 9
cntOUTableID.Name = "cntOUTableID"
LblPar.ZOrderSet = 10
LblPar.Name = "LblPar"
LblSumAccount.ZOrderSet = 11
LblSumAccount.Name = "LblSumAccount"
LblSum.ZOrderSet = 12
LblSum.Name = "LblSum"
CmdPredChk.Top = 262
CmdPredChk.Left = 600
CmdPredChk.ZOrderSet = 13
CmdPredChk.Name = "CmdPredChk"
GrdOrder.ColumnCount = 7
GrdOrder.COLUMN1.Header1.Caption = " "
GrdOrder.COLUMN1.Header1.Name = "Header1"
GrdOrder.COLUMN1.CHK1.FontSize = 20
GrdOrder.COLUMN1.CHK1.Picture = ..\graphic\point_.bmp
GrdOrder.COLUMN1.CHK1.DownPicture = ..\graphic\marktlbfilter.bmp
GrdOrder.COLUMN1.CHK1.Alignment = 6
GrdOrder.COLUMN1.CHK1.Centered = .T.
GrdOrder.COLUMN1.CHK1.Style = 1
GrdOrder.COLUMN1.CHK1.ColorSource = 0
GrdOrder.COLUMN1.CHK1.BackColor = 192,192,192
GrdOrder.COLUMN1.CHK1.Name = "CHK1"
GrdOrder.COLUMN1.Width = 27
GrdOrder.COLUMN1.Name = "COLUMN1"
GrdOrder.COLUMN2.Header1.FontSize = 11
GrdOrder.COLUMN2.Header1.Alignment = 2
GrdOrder.COLUMN2.Header1.Caption = "Íàèìåíîâàíèå"
GrdOrder.COLUMN2.Header1.Name = "Header1"
GrdOrder.COLUMN2.Text1.ControlSource = "lvOrderTvrView.TvrNM"
GrdOrder.COLUMN2.Text1.Name = "Text1"
GrdOrder.COLUMN2.ColumnOrder = 4
GrdOrder.COLUMN2.Width = 197
GrdOrder.COLUMN2.Name = "COLUMN2"
GrdOrder.Column3.Header1.FontSize = 11
GrdOrder.Column3.Header1.Alignment = 2
GrdOrder.Column3.Header1.Caption = "Êîë"
GrdOrder.Column3.Header1.Name = "Header1"
GrdOrder.Column3.Txt1.Alignment = 1
GrdOrder.Column3.Txt1.Name = "Txt1"
GrdOrder.Column3.Alignment = 5
GrdOrder.Column3.ColumnOrder = 5
GrdOrder.Column3.Width = 68
GrdOrder.Column3.Name = "Column3"
GrdOrder.Column4.Header1.FontSize = 11
GrdOrder.Column4.Header1.Alignment = 2
GrdOrder.Column4.Header1.Caption = "Öåíà"
GrdOrder.Column4.Header1.Name = "Header1"
GrdOrder.Column4.Text1.Name = "Text1"
GrdOrder.Column4.ColumnOrder = 6
GrdOrder.Column4.Name = "Column4"
GrdOrder.COLUMN5.Header1.FontSize = 11
GrdOrder.COLUMN5.Header1.Alignment = 2
GrdOrder.COLUMN5.Header1.Caption = "Ñóììà"
GrdOrder.COLUMN5.Header1.Name = "Header1"
GrdOrder.COLUMN5.Text1.Name = "Text1"
GrdOrder.COLUMN5.ColumnOrder = 7
GrdOrder.COLUMN5.Width = 86
GrdOrder.COLUMN5.Name = "COLUMN5"
GrdOrder.Column6.ColumnOrder = 2
GrdOrder.Column6.Width = 26
GrdOrder.Column6.Name = "Column6"
GrdOrder.Column7.ColumnOrder = 3
GrdOrder.Column7.ControlSource = "lvOrderTvrView.TvrId"
GrdOrder.Column7.Width = 65
GrdOrder.Column7.Name = "Column7"
GrdOrder.HeaderHeight = 15
GrdOrder.Highlight = .T.
GrdOrder.Panel = 1
GrdOrder.RowHeight = 30
GrdOrder.ScrollBars = 0
GrdOrder.Width = 548
GrdOrder.HighlightStyle = 2
GrdOrder.ZOrderSet = 14
GrdOrder.Name = "GrdOrder"
CmdDel.Top = 262
CmdDel.Left = 550
CmdDel.ZOrderSet = 15
CmdDel.Name = "CmdDel"
CmdPay.Top = 262
CmdPay.Left = 650
CmdPay.ZOrderSet = 16
CmdPay.Name = "CmdPay"
CmdPlus.Top = 161
CmdPlus.Left = 550
CmdPlus.ZOrderSet = 17
CmdPlus.Name = "CmdPlus"
CmdMinus.Top = 211
CmdMinus.Left = 550
CmdMinus.ZOrderSet = 18
CmdMinus.Name = "CmdMinus"
CmdPrint.Top = 264
CmdPrint.Left = 504
CmdPrint.Enabled = .F.
CmdPrint.Visible = .F.
CmdPrint.ZOrderSet = 19
CmdPrint.Name = "CmdPrint"
shtrih.Name = "shtrih"
Cntnumericpad1.ImgButton0.Name = "ImgButton0"
Cntnumericpad1.ImgButtonPoint.Height = 50
Cntnumericpad1.ImgButtonPoint.Width = 50
Cntnumericpad1.ImgButtonPoint.Name = "ImgButtonPoint"
Cntnumericpad1.ImgButton1.Height = 50
Cntnumericpad1.ImgButton1.Width = 50
Cntnumericpad1.ImgButton1.Name = "ImgButton1"
Cntnumericpad1.ImgButton2.Height = 50
Cntnumericpad1.ImgButton2.Width = 50
Cntnumericpad1.ImgButton2.Name = "ImgButton2"
Cntnumericpad1.ImgButton3.Height = 50
Cntnumericpad1.ImgButton3.Width = 50
Cntnumericpad1.ImgButton3.Name = "ImgButton3"
Cntnumericpad1.ImgButton4.Height = 50
Cntnumericpad1.ImgButton4.Width = 50
Cntnumericpad1.ImgButton4.Name = "ImgButton4"
Cntnumericpad1.ImgButton5.Height = 50
Cntnumericpad1.ImgButton5.Width = 50
Cntnumericpad1.ImgButton5.Name = "ImgButton5"
Cntnumericpad1.ImgButton6.Height = 50
Cntnumericpad1.ImgButton6.Width = 50
Cntnumericpad1.ImgButton6.Name = "ImgButton6"
Cntnumericpad1.ImgButton7.Height = 50
Cntnumericpad1.ImgButton7.Width = 50
Cntnumericpad1.ImgButton7.Name = "ImgButton7"
Cntnumericpad1.ImgButton8.Height = 50
Cntnumericpad1.ImgButton8.Width = 50
Cntnumericpad1.ImgButton8.Name = "ImgButton8"
Cntnumericpad1.ImgButton9.Height = 50
Cntnumericpad1.ImgButton9.Width = 50
Cntnumericpad1.ImgButton9.Name = "ImgButton9"
Cntnumericpad1.ImgbuttonDelete.Height = 50
Cntnumericpad1.ImgbuttonDelete.Width = 50
Cntnumericpad1.ImgbuttonDelete.Name = "ImgbuttonDelete"
Cntnumericpad1.Top = 61
Cntnumericpad1.ZOrderSet = 21
Cntnumericpad1.Name = "Cntnumericpad1"
CmdClose.Top = 120
CmdClose.Left = 504
CmdClose.Visible = .F.
CmdClose.ZOrderSet = 22
CmdClose.Name = "CmdClose"
CmdDelM.Top = 168
CmdDelM.Left = 504
CmdDelM.Visible = .F.
CmdDelM.ZOrderSet = 23
CmdDelM.Name = "CmdDelM"
CmdPrintCancel.Top = 216
CmdPrintCancel.Left = 504
CmdPrintCancel.Visible = .F.
CmdPrintCancel.ZOrderSet = 24
CmdPrintCancel.Name = "CmdPrintCancel"
CmdPredChkCancel.Top = 161
CmdPredChkCancel.Left = 750
CmdPredChkCancel.ZOrderSet = 25
CmdPredChkCancel.Name = "CmdPredChkCancel"
TxtAttr.Left = 326
TxtAttr.Top = 30
TxtAttr.ZOrderSet = 26
TxtAttr.Name = "TxtAttr"
CmdOrderDel.Top = 111
CmdOrderDel.Left = 750
CmdOrderDel.ZOrderSet = 27
CmdOrderDel.Name = "CmdOrderDel"
CmdManager.Left = 750
CmdManager.ZOrderSet = 28
CmdManager.Name = "CmdManager"
CmdXReport.Top = 72
CmdXReport.Left = 504
CmdXReport.Visible = .F.
CmdXReport.ZOrderSet = 29
CmdXReport.Name = "CmdXReport"
GrdMenu.COLUMN1.Header1.Name = "Header1"
GrdMenu.COLUMN1.Edtmenu1.Name = "Edtmenu1"
GrdMenu.COLUMN1.Name = "COLUMN1"
GrdMenu.COLUMN2.Header1.Name = "Header1"
GrdMenu.COLUMN2.Edtmenu1.Name = "Edtmenu1"
GrdMenu.COLUMN2.Name = "COLUMN2"
GrdMenu.Column3.Header1.Name = "Header1"
GrdMenu.Column3.Edtmenu1.Name = "Edtmenu1"
GrdMenu.Column3.Name = "Column3"
GrdMenu.Column4.Header1.Name = "Header1"
GrdMenu.Column4.Edtmenu1.Name = "Edtmenu1"
GrdMenu.Column4.Name = "Column4"
GrdMenu.COLUMN5.Header1.Name = "Header1"
GrdMenu.COLUMN5.Edtmenu1.Name = "Edtmenu1"
GrdMenu.COLUMN5.Name = "COLUMN5"
GrdMenu.COLUMN6.Header1.Name = "Header1"
GrdMenu.COLUMN6.Edtmenu1.Name = "Edtmenu1"
GrdMenu.COLUMN6.Name = "COLUMN6"
GrdMenu.COLUMN7.Header1.Name = "Header1"
GrdMenu.COLUMN7.Edtmenu1.Name = "Edtmenu1"
GrdMenu.COLUMN7.Name = "COLUMN7"
GrdMenu.ZOrderSet = 30
GrdMenu.Name = "GrdMenu"
CmdUp.ZOrderSet = 31
CmdUp.Name = "CmdUp"
CmdGrdDown.Top = 111
CmdGrdDown.Left = 550
CmdGrdDown.ZOrderSet = 32
CmdGrdDown.Name = "CmdGrdDown"
CmdGrdUp.Top = 61
CmdGrdUp.Left = 550
CmdGrdUp.ZOrderSet = 33
CmdGrdUp.Name = "CmdGrdUp"
CmdDevOrder.Top = 262
CmdDevOrder.Left = 750
CmdDevOrder.ZOrderSet = 34
CmdDevOrder.Name = "CmdDevOrder"
txtCardNo.Left = 418
txtCardNo.Top = 31
txtCardNo.ZOrderSet = 35
txtCardNo.Name = "txtCardNo"
Olecommprox1.Top = 72
Olecommprox1.Left = 72
Olecommprox1.Height = 48
Olecommprox1.Width = 58
Olecommprox1.ZOrderSet = 36
Olecommprox1.Name = "Olecommprox1"
CmdCHKBACK.Top = 211
CmdCHKBACK.Left = 750
CmdCHKBACK.ZOrderSet = 37
CmdCHKBACK.Name = "CmdCHKBACK"
Txtbarcod.ZOrderSet = 38
Txtbarcod.Name = "Txtbarcod"
CmdNoDisc.Top = 61
CmdNoDisc.Left = 429
CmdNoDisc.Enabled = .F.
CmdNoDisc.Visible = .F.
CmdNoDisc.ZOrderSet = 39
CmdNoDisc.Name = "CmdNoDisc"
CmdDisc.Top = 61
CmdDisc.Left = 468
CmdDisc.Enabled = .F.
CmdDisc.Visible = .F.
CmdDisc.ZOrderSet = 40
CmdDisc.Name = "CmdDisc"
CmdEnter.ZOrderSet = 41
CmdEnter.Name = "CmdEnter"
</properties>
		<protected/>
		<methods>PROCEDURE CmdManager.Click
*--ïðîèçâåäåì àâòîðèçàöèþ ìåíåäæåðà
LOCAL  lnUserKod, ;
		_PARAM, ;
		lnDiscTvrID, ;
		llblock, ;
		lretacc, ;
		_PARAM1, ;
		_PARAM2

IF !thisform.lmanagerwork
	*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíèòîâ
	thisform.olecommprox1._close()
	
	*--Çàïóñêàåì ôîðìó àâòîðèçàöèè è ïàðîëÿ è àíàëèçèðóåì ðåçóëüòàò
	lnUserKod = oApp.DoModalFormRetValObj([login;rst_v1.vcx])

	*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
	thisform.olecommprox1._open()
	
	IF TYPE([lnUserKod])==[N] AND !EMPTY(lnUserKod)
		*--ïðîâåðêà íà ñòàòóñ ìåíåäæåðà
		USE IN SELECT([lvCltEditMgr])
		_PARAM = spUserClt(0,lnUserKod)
		USE lvCltEdit ALIAS lvCltEditMgr IN 0

		IF RECCOUNT([lvCltEditMgr])&gt;0
			DO CASE
				*--ðàçáëîêèðóåì êíîïêè ìåíåäæåðà, åñëè ïîëüçîâàòåëü ÿâëÿåòñÿ ìåíåäæåðîì
				CASE BITTEST(lvCltEditMgr.CltRole,5)
					WAIT WINDOW 'Âûâîäèì ïàíåëü ìåíåäæåðà ....'				
				OTHERWISE
					MESSAGEBOX([Äàííûé ïîëüçîâàòåëü íå ÿâëÿåòñÿ ìåíåäæåðîì],48,[Îêíî ñîîáùåíèé])
					RETURN .F.
			ENDCASE
		ELSE
			MESSAGEBOX([Íåò ïðèâÿçêè ïîëüçîâàòåëÿ ê êëèåíòó],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ENDIF
ELSE
	*--çàáëîêèðóåì êíîïêè ìåíåäæåðà
	thisform.cmdPredChkCancel.Enabled = .F.
	thisform.cmdPrintCancel.Enabled = .F.
	thisform.cmdDelM.Enabled = .F.
	thisform.cmdClose.Enabled = .F.
	thisform.cmdOrderDel.Enabled = .F.
	thisform.CmdCHKBACK.Enabled = .F.
	thisform.cmdXReport.Enabled = .F.
	thisform.lmanagerwork = .F.
	this.BackColor = RGB(239,228,250)
	this.ForeColor = RGB(255,128,64)
ENDIF
ENDPROC
PROCEDURE cntCltID.Click
thisform.cntCltID.cmdShow.Click()
ENDPROC
PROCEDURE cntOUTableID._handleanychange
RETURN

ENDPROC
PROCEDURE GrdOrder._refreshrelatedobjects
	thisform.lblEdit.Caption = [ Âñåãî: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))

ENDPROC
PROCEDURE Init
LPARAMETERS tnFrmID, tlReadOnly
DODEFAULT(tnFrmID, tlReadOnly)
thisform.lblEdit.Caption = [ Âñåãî: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
thisform.CmdManager.Enabled = .t.

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_25O19NXC8</uniqueid>
		<timestamp>923773852</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit_new.GrdOrder.Column6</parent>
		<properties>FontSize = 11
Alignment = 2
Caption = "¹"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_25O19NXC9</uniqueid>
		<timestamp>923773514</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmorderedit_new.GrdOrder.Column6</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_25O19NXCA</uniqueid>
		<timestamp>923773852</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit_new.GrdOrder.Column7</parent>
		<properties>FontSize = 11
Alignment = 2
Caption = "Êîä"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_25O19NXCB</uniqueid>
		<timestamp>923773682</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmorderedit_new.GrdOrder.Column7</parent>
		<properties>BorderStyle = 0
ControlSource = "lvOrderTvrView.TvrId"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmorderedit_new</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 20, 12, 33, 26, 72, 6, 1
Arial, 0, 10, 6, 16, 13, 35, 3, 0
Arial, 0, 11, 7, 17, 14, 40, 3, 0
Arial, 1, 20, 13, 33, 25, 71, 7, 1
Arial, 0, 28, 16, 43, 34, 99, 8, 1
Times New Roman, 1, 18, 10, 27, 21, 61, 5, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S207614U</uniqueid>
		<timestamp>925601190</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntordernew</objname>
		<parent/>
		<properties>Width = 92
Height = 85
BackColor = 239,228,250
Name = "cntordernew"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--äîáàâèì íîâûé çàêàç
LOCAL	luResAdding

*--ñáðîñèì íîìåð êîíòåéíåðà, íà êîòîðîì ñòîèò ôîêóñ
thisform.nFocusCount = []

*--Âûïîëíÿåì îïåðàöèþ äîáàâëåíèÿ äîêóìåíòà
luResAdding = oMgrOrder.Operate([FORM],[ADD],thisform.ntablenum)

IF TYPE([luResAdding])==[N] AND !EMPTY(luResAdding)
	*--Åñëè äîáàâèëàñü øàïêà çàêàçà, òî îòêðîåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ çàêàçà
	oMgrOrder.Operate([FORM],[EDIT],luResAdding)

	*--Îáíîâèì äàííûå íà ôîðìå
	thisform._update(.T.)
ENDIF
ENDPROC
PROCEDURE GotFocus
this.shp1.BorderColor = RGB(128,128,255)
DODEFAULT()
ENDPROC
PROCEDURE LostFocus
this.shp1.BorderColor = RGB(228,151,22)
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Êîíòåéíåð äëÿ íîâîãî çàêàçà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S20QARPV</uniqueid>
		<timestamp>882074301</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>cntordernew</parent>
		<properties>Top = 3
Left = 3
Height = 81
Width = 86
BackStyle = 0
BorderWidth = 3
Visible = .T.
BorderColor = 228,151,22
ZOrderSet = 0
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S2078FZK</uniqueid>
		<timestamp>925601190</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cntordernew</parent>
		<properties>Top = 6
Left = 6
Height = 75
Width = 80
Picture = ..\graphic\ord_.gif
Caption = ""
BackColor = 255,255,255
Name = "Cmd1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
this.Parent.Click()
ENDPROC
PROCEDURE GotFocus
this.Parent.GotFocus()
ENDPROC
PROCEDURE LostFocus
this.Parent.LostFocus()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntordernew</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>927104225</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmorderadd</objname>
		<parent/>
		<properties>Height = 290
Width = 559
ShowWindow = 1
DoCreate = .T.
BorderStyle = 2
Caption = ""
ControlBox = .F.
Movable = .F.
ClipControls = .F.
BackColor = 241,239,241
Name = "frmorderadd"
cstmsghandler.Top = 12
cstmsghandler.Left = 295
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 12
cstresizable.Left = 317
cstresizable.Name = "cstresizable"
cstdatawork.Top = 12
cstdatawork.Left = 339
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERADD._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This
	*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	llResSave, ;
			lnLastIncrementedID
	*------------------------------------------------------------------------------

	*--ñîõðàíèì/îòìåíèì èçìåíåíèÿ
	IF tcMessage = [OK]
		*--Ïðîâåðèì, âûáðàí ëè ñòîë
		IF EMPTY(.cntOUTableID.value)
			MESSAGEBOX([Íåîáõîäèìî âûáðàòü ñòîë!],48,[Îêíî ñîîáùåíèé])
			.cntOUTableID.txtText.SetFocus()
			RETURN .F.
		ENDIF
		
		*--Îòêðîåì òðàíçàêöèþ
		BEGIN TRANSACTION
		*--Åñëè âêëþ÷åíà àâòîíóìåðàöèÿ ïðîèçâîäèì àâòîìàòè÷åñêóþ âñòàâêó íîìåðà
		IF .chkFrmAutoNum.Value
			REPLACE FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,lvFrmEdit.FrmDate,lvFrmEdit.PointEmiOUID) IN lvFrmEdit
		ENDIF
		*------------------------------------------------------------------------------

		*--Ïðîèçâîäèì ñîõðàíåíèå ðîäèòåëüñêîé òàáëèöû
		llResSave = .cstDataWork.Save([lvFrmEdit])
		*------------------------------------------------------------------------------
		
		*--Îáðàáîòàåì ðåçóëüòàòû ÂÑÅÕ îïåðàöèé ñîõðàíåíèÿ
		IF llResSave
			*-Ïîäòâåðæäàåì òðàíçàêöèþ
			END TRANSACTION
			
			*--Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
			.uRetVal = spGetLastIncrementedID([lvFrmEdit])
		ELSE
			*--Îòêàòûâàåì òðàíçàêöèþ
			ROLLBACK
			
			*--Îáðàáàòûâàåì îøèáêó
			IF .cstDataWork.HandleSaveFail() &amp;&amp;--åñëè îøèáêà îáðàáîòàíà
				*--Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
				RETURN .T.
			ELSE
				*--Ñîîáùàåì îá îøèáêå
				MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
				
				*--Îòìåíÿåì èçìåíåíèÿ â ðîäèòåëüñêîì Aliase
				.cstDataWork.Restore([lvFrmEdit])
			ENDIF
			
			*--Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
			.uRetVal = 0
		ENDIF
		
	ELSE &amp;&amp;--tcMessage = [ESC]

		*--Îòìåíÿåì èçìåíåíèÿ â ðîäèòåëüñêîì Aliase
		.cstDataWork.Restore([lvFrmEdit])
	ENDIF
	*------------------------------------------------------------------------------

	*--Ñêðûâåì ôîðìó
	.Hide()
	*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderAdd.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î äèñêîíòíîé êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.txtClientNM.Value = lvCardViewByCardCode.CltNM
		.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspOUID WITH lvCardViewByCardCode.CardID
		*------------------------------------------------------------------------------
	ENDIF
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnFrmTypeID - òèï äîêóìåíòà
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*------------------------------------------------------------------------------
LPARAMETERS tnTableNum

LOCAL	lnFrmTypeID, ;
		lnDefClt, ;
		lnTblType, ;
		lnTblPar, ;
		lnWaiterID, ;
		_PARAM1, ;
	_PARAM2, ;
	_PARAM

*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))

*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

*--ïîëó÷èì òèï ïîäðàçäåëåíèÿ "ñòîë"
lnTblType = VAL(oRes.GetParam([RST],[TBLTYPE]))

*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))

*--ïîëó÷èì êîä òåêóùåãî îôèöèàíòà
lnWaiterID = spUserClt()
*------------------------------------------------------------------------------

*Îáíîâèì ñïðàâî÷íèê ñòîëîâ
_PARAM1 = lnTblType
_PARAM2 = lnTblPar
REQUERY([lvOUTableList])
*-------------------------------------------------------------------------------

WITH This
	*--îòêðîåì ñ÷åò  è óñòàíîâèì çíà÷åíèÿ ïî óìîë÷àíèþ
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	*------------------------------------------------------------------------------
	SELECT lvFrmEdit
	APPEND BLANK
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnWaiterID, ;  &amp;&amp; ýòî îñòàâèì âðåììåíî - ïîòîì óáåðåì
		 lvFrmEdit.DevCltId WITH lnWaiterID, ;
		 lvFrmEdit.FrmTypeID WITH lnFrmTypeID, ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
		
	*--åñëè äîáàâëÿåì çàêàç íà óæå îòêðûòûé ñòîë, ïîêàæåì åãî íîìåð
	IF !EMPTY(tnTableNum)
		REPL lvFrmEdit.PointEmiOUID WITH tnTableNum
	ENDIF
	
	*--ïîêàæåì âðåìÿ îòêðûòèÿ çàêàçà
	.lblDate.caption = .lblDate.caption + ' ' + ALLTRIM(TTOC(lvFrmEdit.FrmDate))
	
	*--ïîêàæåì èìÿ êëèåíòà
	USE IN SELECT([lvCltNmView])
	_PARAM = lnDefClt
	USE lvCltNmView IN 0
	
	IF RECCOUNT([lvCltNmView])&gt;0
		.txtClientNM.value = ALLTRIM(lvCltNmView.CltNM)
	ELSE
		.txtClientNM.value = []
	ENDIF
ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRORDEREDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------

*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ äîêóìåíòîâ (ïóñòîé)
USE lvFrmEdit IN 0 NODATA
*------------------------------------------------------------------------------

*--Îòêðîåì ñïðàâî÷íèê ñòîëîâ
USE lvOUTableList IN 0 NODATA

*--Îòêðîåì êëèåíòîâ ðåñòîðàíà
USE lvCltRSTList IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>14</reserved2>
		<reserved3>*getcardinfo 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ôîðìà äëÿ äîáàâëåíèÿ çàêàçà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S10QQ3SG</uniqueid>
		<timestamp>927104225</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 0
Left = 0
Height = 291
Width = 559
BackStyle = 0
BorderWidth = 6
BorderColor = 0,0,255
ZOrderSet = 0
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RS0SJ3V2</uniqueid>
		<timestamp>927104225</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDate</objname>
		<parent>frmorderadd</parent>
		<properties>FontSize = 14
BackStyle = 0
Caption = "Îòêðûò â"
Left = 34
Top = 10
TabIndex = 7
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 5
Name = "lblDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5VB</uniqueid>
		<timestamp>927104225</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblAttribute</objname>
		<parent>frmorderadd</parent>
		<properties>FontBold = .F.
FontSize = 16
BackStyle = 0
Caption = "Ãîñòåé"
Left = 34
Top = 119
TabIndex = 6
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 6
Name = "LblAttribute"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RW0R59U0</uniqueid>
		<timestamp>927104225</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkFrmAutoNum</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 261
Left = 12
FontBold = .T.
Alignment = 0
Caption = "Àâòîíóìåðàöèÿ"
Value = .T.
TabIndex = 5
Visible = .F.
ZOrderSet = 7
ReadOnly = .T.
Name = "chkFrmAutoNum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5UG</uniqueid>
		<timestamp>927104225</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOUTableID</objname>
		<parent>frmorderadd</parent>
		<properties>FontBold = .F.
FontSize = 16
BackStyle = 0
Caption = "Ñòîë"
Height = 27
Left = 34
Top = 65
Width = 50
TabIndex = 8
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 8
Name = "lblOUTableID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5UU</uniqueid>
		<timestamp>927104225</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntOUTableID</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 49
Left = 132
Width = 227
Height = 43
TabIndex = 1
TabStop = .F.
ForeColor = 228,151,22
BackColor = 241,239,241
ZOrderSet = 9
_allowresizecontent = .T.
_rsaliasname = lvOUTableList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 1
_controlsource = lvFrmEdit.PointEmiOUID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntOUTableID"
txtText.FontSize = 16
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 184
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 186
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 226
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5UV</uniqueid>
		<timestamp>927104225</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltID</objname>
		<parent>frmorderadd</parent>
		<properties>FontBold = .F.
FontSize = 16
BackStyle = 0
Caption = "Êëèåíò"
Height = 27
Left = 34
Top = 172
Width = 69
TabIndex = 9
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 10
Name = "lblCltID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UI0T2INC</uniqueid>
		<timestamp>921663650</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtClientNM</objname>
		<parent>frmorderadd</parent>
		<properties>FontSize = 16
BackStyle = 0
Enabled = .F.
Height = 30
Left = 132
Top = 169
Width = 227
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 252,242,218
DisabledForeColor = 0,0,255
_highlightself = .F.
Name = "txtClientNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5VA</uniqueid>
		<timestamp>927104225</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 240
Left = 216
Width = 330
Height = 39
TabIndex = 4
TabStop = .F.
ZOrderSet = 12
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 36
cmdCancel.Width = 144
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 12
cmdCancel.ForeColor = 0,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 186
cmdOk.Height = 36
cmdOk.Width = 144
cmdOk.FontBold = .T.
cmdOk.FontSize = 12
cmdOk.ForeColor = 0,0,255
cmdOk.BackColor = 241,239,241
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S910CCZU</uniqueid>
		<timestamp>927104225</timestamp>
		<class>cntnumericpad</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntnumericpad1</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 35
Left = 391
TabStop = .F.
ZOrderSet = 13
Name = "Cntnumericpad1"
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Height = 50
ImgButtonPoint.Width = 50
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Height = 50
ImgButton1.Width = 50
ImgButton1.Name = "ImgButton1"
ImgButton2.Height = 50
ImgButton2.Width = 50
ImgButton2.Name = "ImgButton2"
ImgButton3.Height = 50
ImgButton3.Width = 50
ImgButton3.Name = "ImgButton3"
ImgButton4.Height = 50
ImgButton4.Width = 50
ImgButton4.Name = "ImgButton4"
ImgButton5.Height = 50
ImgButton5.Width = 50
ImgButton5.Name = "ImgButton5"
ImgButton6.Height = 50
ImgButton6.Width = 50
ImgButton6.Name = "ImgButton6"
ImgButton7.Height = 50
ImgButton7.Width = 50
ImgButton7.Name = "ImgButton7"
ImgButton8.Height = 50
ImgButton8.Width = 50
ImgButton8.Name = "ImgButton8"
ImgButton9.Height = 50
ImgButton9.Width = 50
ImgButton9.Name = "ImgButton9"
ImgbuttonDelete.Height = 50
ImgbuttonDelete.Width = 50
ImgbuttonDelete.Name = "ImgbuttonDelete"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0339JN</uniqueid>
		<timestamp>921663650</timestamp>
		<class>txtcalcint</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtcalcint1</objname>
		<parent>frmorderadd</parent>
		<properties>FontSize = 16
Alignment = 3
BackStyle = 0
ControlSource = "lvFrmEdit.ID_"
Format = "R"
Height = 33
InputMask = "999"
Left = 132
MaxLength = 3
Top = 113
Width = 58
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 252,242,218
SelectedBackColor = 252,242,218
ZOrderSet = 14
_highlightself = .F.
Name = "Txtcalcint1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UI0T2IND</uniqueid>
		<timestamp>921663650</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCardNo</objname>
		<parent>frmorderadd</parent>
		<properties>FontSize = 16
Alignment = 3
BackStyle = 0
Value = 
Enabled = .F.
Height = 30
Left = 132
Top = 205
Width = 227
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 252,242,218
DisabledForeColor = 0,0,255
Name = "txtCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UI0T2INR</uniqueid>
		<timestamp>927104225</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmorderadd</parent>
		<properties>Top = 200
Left = 37
Height = 48
Width = 58
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	*------------------------------------------------------------------------------

	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	This.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAd0w/YBMgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmorderadd</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 16, 9, 25, 19, 56, 5, 1
Arial, 1, 12, 8, 20, 15, 42, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RX0UFZLH</uniqueid>
		<timestamp>927171635</timestamp>
		<class>interface</class>
		<classloc>primarydoc_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE form_add
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: MGRORDER.FORM_ADD
* Called by.......: &lt;.Operate()&gt;
* Parameters......: tuParam1 - äîïîëíèòåëüíûé ïàðàìåòð (íàïðèìåð, íîìåð ñòîëà)
* Returns.........: &lt;luResultAdding&gt;
* Notes...........: Äîáàâëåíèå íîâîãî äîêóìåíòà.
*-------------------------------------------------------
LPARAMETERS	tuParam1

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM, ;
		luResultAdding

	*29.11.2004 17:36 -&gt;Âûïîëíèì îïåðàöèþ ñîçäàíèÿ íîâîé ôîðìû
	luResultAdding = oApp.DoModalFormRetValObj([FrmOrderAdd;rst_v1.vcx],tuParam1)
	*------------------------------------------------------------------------------
		
*--Âåðíåì ðåçóëüòàò îïåðàöèè
RETURN luResultAdding
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE form_edit
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: MGRORDER.FORM_EDIT
* Called by.......: &lt;.Operate()&gt;
* Parameters......: &lt;tcRequestedOperation,tnFrmID&gt;
* Returns.........: &lt;llResultEditing&gt;
* Notes...........: Ðåäàêòèðîâàíèå/ïðîñìîòð äîêóìåíòà.
*-------------------------------------------------------
LPARAMETERS	tnFrmID, tlReadOnly

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL llResultEditing

*--Çàïóñêàåì ôîðìó äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà äîêóìåíòà
**llResultEditing = oApp.DoModalFormRetValObj([FrmOrderEdit_new;rst_v1.vcx],tnFrmID,tlReadOnly)

llResultEditing = oApp.DoModalFormRetValObj([FrmOrderEdit;rst_v1.vcx],tnFrmID,tlReadOnly)
		
*--Âåðíåì ðåçóëüòàò îïåðàöèè
RETURN llResultEditing
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE operate
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: PRIMARYDOC_V1.VCX
* Class.Module....: MGRPRIMARYDOC.OPERATE
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé ìåòîä ìåíåäæåðà áèáëèîòåêè ïåðâè÷íûõ äîêóìåíòîâ.
*-------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequestedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10

*19.05.2004 19:23 -&gt;Ïðîâåðÿåì ïåðâûå äâà îáÿçàòåëüíûõ ïàðàìåòðà
IF 	TYPE([tcEntityName])#[C] OR EMPTY([tcEntityName]) OR ;
	TYPE([tcRequestedOperation])#[C] OR EMPTY([tcRequestedOperation])
	*{
	ASSERT .F. MESSAGE [MGRPRIMARYDOC.DOCOMMAND: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà.]
	*}
ENDIF	
*------------------------------------------------------------------------------

*19.05.2004 19:24 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequstedOperation, ;
		llOperateResult
***
lcEntityName = UPPER(ALLTRIM(tcEntityName))
lcRequstedOperation = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*05.04.2004 19:59 -&gt;Âûïîëíÿåì îïðåàöèþ íàä ñóùíîñòüþ
*CASE lcEntityName == [] AND lcRequstedOperation == []
DO CASE

	*******************************************************************************
	*[FORM] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ïðîñìîòðà äîêóìåíòîâ					  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND lcRequstedOperation == [VIEW]
	
		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ôîðìû äëÿ ïðîñìîòðà ïåðâè÷íûõ äîêóìåíòîâ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:27 -&gt;Âûïîëíÿåì îïåðàöèþ
		This.Form_View(tuParam1)
		*------------------------------------------------------------------------------		

	*******************************************************************************
	*[FORM] &amp;&amp; [ADD] - äîáàâëåíèå äîêóìåíòà										  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND lcRequstedOperation == [ADD]
		
		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		llOperateResult = This.Form_Add(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[FORM] &amp;&amp; ([EDIT] || [INFO] || [DELE]) - ðåäàêòèðîâàíèå/ïðîñìîòð äîêóìåíòà	  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND (lcRequstedOperation == [EDIT] OR lcRequstedOperation == [INFO] OR lcRequstedOperation == [DELE])

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.Form_Edit(tuParam1, tuParam2)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
	
	*******************************************************************************
	*[FORM] &amp;&amp; ([COPY] OR [INHERIT]) - êîïèðîâàíèå/íàñëåäîâàíèå äîêóìåíòà		  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND ( ;
			lcRequstedOperation == [COPY] OR ;
			lcRequstedOperation == [INHERIT])

		*05.04.2004 20:01 -&gt; Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà äëÿ êîïèðîâàíèÿ/íàñëåäîâàíèÿ
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmPDCopyAs;PrimaryDoc_v1;PrimaryDoc.app],lcRequstedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[FORM] &amp;&amp; [PRNDOC] - ïå÷àòü äîêóìåíòà							  			  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND lcRequstedOperation == [PRNDOC]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà äëÿ ïå÷àòè
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.Form_PrnDoc(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[FORM] &amp;&amp; [NAKLOUT] - Ôîðìèðîâàíèå ðàñõîäíîé íàêëàäíîé ïî ðåçóëüòàòàì ïðîäàæ  *
	*******************************************************************************
	CASE lcEntityName == [FORM] AND lcRequstedOperation == [NAKLOUT]

		*16.03.2006 16:07 -&gt; Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.ExecuteScrFormByObjDescRetVal([frmNaklOut;PrimaryDoc_v1.vcx;PrimaryDoc.app])
		***
		IF TYPE([llOperateResult])=[N]
			RETURN llOperateResult
		ENDIF
		***
		RETURN .T.
		*------------------------------------------------------------------------------

	*****************************************************************************
	*[FORM] &amp;&amp; [PAYDOCMAKE]														*
	*****************************************************************************
	CASE lcEntityName == [FORM] AND lcRequstedOperation == [PAYDOCMAKE]

		*16.03.2006 16:09 -&gt; Âûïîëíèì îïåðàöèþ		
		llOperateResult = This._PayDocMake()
		***
		IF TYPE([llOperateResult])=[N]
			RETURN llOperateResult
		ENDIF
		***
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[PARTTVR] &amp;&amp; [ADD] - äîáàâëåíèå òîâàðíîé ïîçèöèè ëîêóìåíòà					  *
	*******************************************************************************
	CASE lcEntityName == [PARTTVR] AND lcRequstedOperation == [ADD]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà äëÿ äîáàâëåíèÿ òîâàðíîé ïîçèöèè äîêóìåíòà
		*------------------------------------------------------------------------------
	
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.PartTvr_Add(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
		
	*********************************************************************************************************
	*[PARTTVR] &amp;&amp; ([EDIT] || [INFO] ||[DELE]) - ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå òîâàðíîé ïîçèöèè äîêóìåíòà	*
	*********************************************************************************************************
	CASE lcEntityName == [PARTTVR] AND (lcRequstedOperation == [EDIT] OR lcRequstedOperation == [INFO] OR lcRequstedOperation == [DELE])

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð òîâàðíîé ïîçèöèè äîêóìåíòà
		*------------------------------------------------------------------------------
		
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.PartTvr_Edit(lcRequstedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[PARTFRM] &amp;&amp; [ADD] - äîáàâëåíèå ñóììîâîé ïîçèöèè ëîêóìåíòà					  *
	*******************************************************************************
	CASE lcEntityName == [PARTFRM] AND lcRequstedOperation == [ADD]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà äëÿ äîáàâëåíèÿ ñóììîâîé ïîçèöèè
		*------------------------------------------------------------------------------
	
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.PartFrm_Add(tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[PARTFRM] &amp;&amp; ([EDIT] || [INFO] || [DELE]) - ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ñóììîâîé ïîçèöèè äîêóìåíòà	*
	*************************************************************************************************************
	CASE lcEntityName == [PARTFRM] AND (lcRequstedOperation == [EDIT] OR lcRequstedOperation == [INFO] OR lcRequstedOperation == [DELE])

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð ñóììîâîé ïîçèöèè äîêóìåíòà
		*------------------------------------------------------------------------------
	
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.PartFrm_Edit(lcRequstedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*************************************************************************************************************
	*[PAYDOC] &amp;&amp; [EXPORT] - ýêñïîðò ïëàòåæíîãî ïîðó÷åíèÿ ê êëèåíò-áàíê                                          *
	*************************************************************************************************************
	CASE lcEntityName == [PAYDOC] AND lcRequstedOperation == [EXPORT]

		*05.04.2004 20:01 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð äîêóìåíòà
		*------------------------------------------------------------------------------
	
		*19.05.2004 19:44 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = This.Paydoc_Exchange(lcRequstedOperation,tuParam1)
		RETURN llOperateResult
		*------------------------------------------------------------------------------
	
	*******************************************************************************
	*[AUTONUM] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû c àâòîíóìåðàòîðàìè			  *
	*******************************************************************************
	CASE lcEntityName == [AUTONUM] AND lcRequstedOperation == [VIEW]

		*16.03.2006 16:22 -&gt; Âûïîëíèì îïåðàöèþ
		oApp.ExecuteScrFormByObjDesc([frmAutoNumView;PrimaryDoc_v1.vcx;PrimaryDoc.app])
		***
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[AUTONUM] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])							  *
	*Äîáàâëåíèå/ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå èíôîðìàöèè îá àâòîíóìåðàòîðå	  *
	*******************************************************************************
	CASE lcEntityName == [AUTONUM] AND ;
		 (lcRequstedOperation == [ADD] OR ;
		  lcRequstedOperation == [EDIT] OR ;
		  lcRequstedOperation == [DELE])

		* tuParam1 - èäåíòèôèêàòîð àâòîíóìåðàòîðà äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------

		*06.02.2006 12:39 -&gt;Âûïîëíèì îïåðàöèþ
		luOperateResult = oApp.DoModalFormRetValObj([frmAutoNumEdit;PrimaryDoc_v1;PrimaryDoc.app],lcRequstedOperation,tuParam1)
		*06.02.2006 12:39 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN luOperateResult
		*------------------------------------------------------------------------------

	OTHERWISE
	
		*19.05.2004 21:59 -&gt;Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Ê ñîæàëåíèþ çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ìåíåäæåð áèáëèîòåêè çàêàçîâ</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>931628621</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmgrview</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 416
Width = 696
ShowWindow = 2
ScrollBars = 3
DoCreate = .T.
Picture = ..\graphic\ìåíåäæåð_ôîí2.bmp
BorderStyle = 2
Caption = ""
ControlBox = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
WindowState = 2
BackColor = 241,239,241
ncountcnt = .F.
_nscrollbars = .F.
nfocuscount = .F.
Name = "frmmgrview"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE _paintform
LOCAL lcexp, ;
	lncount, ;
	lcTableNM, ;
	_PARAM, ;
	nQntCol, ;
	nQntStr, ;
	nCurStr, ;
	nCurCol

*--çàãðóçèì áèáëèîòåêó, åñëè ýòî íóæíî
IF !([RST_V1.VCX]$SET([CLASSLIB]))
	SET CLASSLIB TO rst_v1 ADDITIVE
ENDIF

lncount  = 0

*--îïðåäåëèì êîëè÷åñòâî êîëîíîê è ñòðîê  íà ýêðàíå äëÿ ïðîðèñîâêè îáúåêòîâ
nQntCol = INT((thisform.Width-300)/120)
nQntStr = INT((thisform.Height-40)/120)

*--îïðåäåëèì êîëè÷åñòâî ñòðîê äëÿ ïðîðèñîâêè îáúåêòîâ
SELECT DISTINCT lvMgrView.PointEmiCltID, ;
				lvMgrView.ClientNM ;
	FROM lvMgrView ;
	INTO CURSOR curWaiter NOFILTER
	
*--çàäàäèì òåêóùóþ ñòðîêó è êîëîíêó
nCurStr = 0
nCurCol = 0

SELECT curWaiter
GO TOP
SCAN ALL
	*--äîáàâèì îáúåêò ñ ÔÈÎ îôèöèàíòà
	lcexp = [thisform.AddObject('lblWaiter]+ALLTRIM(STR(nCurStr+1))+[','lblWaiter')]
	&amp;lcexp
	
	*--ïîðàáîòàåì ñ ýòèì îáúåêòîì
	lcexp = [thisform.lblWaiter]+ALLTRIM(STR(nCurStr+1))
	WITH &amp;lcexp
		.visible = .T.
		.top = 80 + nCurStr*120
		.left = 20
		.caption = LEFT(PADR(ALLTRIM(curWaiter.ClientNM),30,' '),30)
	ENDWITH
	
	*--ïîêàæåì âñå çàêàçû äàííîãî îôèöèàíòà
	SELECT lvMgrView
	SCAN FOR lvMgrView.PointEmiCltID = curWaiter.PointEmiCltID
		lncount = lncount+1
		
		*--äîáàâèì îáúåêò
		lcexp = [thisform.AddObject('cntorder]+ALLTRIM(STR(lncount))+[','cntorder')]
		&amp;lcexp
		
		*--ïîðàáîòàåì ñ ýòèì îáúåêòîì
		lcexp = [thisform.cntorder]+ALLTRIM(STR(lncount))
		WITH &amp;lcexp
			*--çàïîìíèì ID ýòîãî çàêàçà
			.nFrmID = lvMgrView.FrmID
			
			*--íàïèøåì çàãîëîâîê îáúåêòà (íîìåð ñòîëà.íîìåð çàêàçà)
			USE IN SELECT([lvOrgUnitEdit])
			_PARAM = lvMgrView.PointEmiOUID
			USE lvOrgUnitEdit IN 0

			IF RECCOUNT([lvOrgUnitEdit])&gt;0
				lcTableNM = lvOrgUnitEdit.OUNM
			ELSE
				lcTableNM = []
			ENDIF			
			.lbl1.caption = ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvMgrView.FrmNum)
			
			*--ðàçìåñòèì îáúåêò íà ôîðìå
			.visible = .T.
			.top = 40 + nCurStr*120
			.left = 300 + nCurCol*120
			
			*--îïðåäåëèì ñëåäóþùóþ êîëîíêó
			nCurCol = nCurCol+1
		ENDWITH
		SELECT lvMgrView
	ENDSCAN

	*--ïåðåéäåì ê ñëåäóþùåìó îôèöèàíòó
	nCurStr = nCurStr+1
	nCurCol = 0
	SELECT curWaiter
ENDSCAN

thisform.ncountcnt = lncount


ENDPROC
PROCEDURE cstresizable.doresize
NODEFAULT

thisform.lblForm.Width = thisform.Width
thisform.lblForm.Top = 0
thisform.lblForm.Left = 0


ENDPROC
PROCEDURE Init
LPARAMETERS	tnScrFrmID
LOCAL loStrih, lnNameOU, lcNameOU

DODEFAULT(tnScrFrmID)

*--ïðîâåðèì, âêëþ÷åí ëè ôèñêàëüíûé ðåãèñòðàòîð
						*!*	SET CLASSLIB TO kkms.vcx ADDITIVE
						*!*	loStrih = CREATEOBJECT([Shtrih])
						*!*	RELEASE CLASSLIB kkms
						*!*	loStrih.Beep()
						*!*	IF loStrih.ErrorCode # 0

						*!*		*16.04.2006 10:22 -&gt;Çàïèøåì  èíôîðìàöèþ â Log
						*!*		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
						*!*				  [Îøèáêà ] + PADL(ALLTRIM(STR(loStrih.ErrorCode)),3) + ;
						*!*				  [ ïðè çàïóñêå POS ïðîãðàììû] + CHR(13), [KKM.LOG], 1)
						*!*		*------------------------------------------------------------------------------
						*!*		
						*!*		oApp.lUserChange = .T.
						*!*		CLEAR EVENTS
						*!*		RETURN .F.
						*!*	ENDIF

*--ïðîðèñóåì âñå çàêàçû âñåõ îôèöèàíòîâ
thisform._PaintForm()

thisform.lblForm.Width = thisform.Width
thisform.lblForm.Top = 0
thisform.lblForm.Left = 0

*--íàçâàíèå ïðåäïðèÿòèÿ
lnNameOU = VAL(oRes.GetParam([RST],[NAMEOU]))

lcNameOU = ALLT(oRes.GetParam([RST],[NAMEOU]))

DO CASE
	CASE lnNameOU = 0
		thisform.lblForm.Caption = lcNameOU
		
	CASE lnNameOU = 1
		thisform.lblForm.Caption = [Áèñòðî "Êëàññèê"]
		
	CASE lnNameOU = 2
			thisform.lblForm.Caption = [Áàð VIP çàë "Ïîä øïèëåì"]

	CASE lnNameOU = 3
			thisform.lblForm.Caption = [ÌÈÊÀÄÎ]

	CASE lnNameOU = 4
			thisform.lblForm.Caption = [ÀÉÑÁÅÐÃ]
			

ENDCASE

thisform.Refresh()


ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMTABLEVIEW.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îòêðûòèå ôîðìû (çàãðóçêà äàííûõ)
*-------------------------------------------------------
LOCAL _PARAM, ;
	  _PARAM_DOP

frm::LOAD()

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	

*--îòêðîåì ñïèñîê âñåõ îòêðûòûõ çàêàçîâ äëÿ ìåíåäæåðà
_PARAM = VAL(oRes.GetParam([RST],[TYPEORD]))
_PARAM_DOP = VAL(oRes.GetParam([RST],[TBLPAR]))
USE IN SELECT([lvMgrView])
USE lvMgrView IN 0
*------------------------------------------------------------------------------
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>ncountcnt
_nscrollbars
nfocuscount
*_paintform äîáàâëåíèå è ðàññòàíîâêà îáúåêòîâ íà ôîðìå
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ôîðìà ìåíåäæåðà (âñå çàêàçû âñåõ îôèöèàíòîâ)</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S010XTQL</uniqueid>
		<timestamp>931628621</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblForm</objname>
		<parent>frmmgrview</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
BackStyle = 1
Caption = 'Áèñòðî "Êëàññèê"'
Height = 30
Left = -5
Top = -1
Width = 787
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 0
Name = "LblForm"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--âûéäåì ïîëíîñòüþ èç ïðîãðàììû
oApp.lUserChange = .T.
CLEAR EVENTS
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmgrview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0W60XM</uniqueid>
		<timestamp>949058200</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchpadmainpict</objname>
		<parent/>
		<properties>Width = 532
Height = 575
Name = "cnttuchpadmain"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>21</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ïàíåëü äëÿ tuchscreen Îñíîâíàÿ </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgButton11</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 0
Top = 0
Width = 133
Name = "ImgButton11"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton12</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 133
Top = 0
Width = 133
Name = "Imgbutton12"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton13</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 266
Top = 0
Width = 133
Name = "Imgbutton13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton14</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 399
Top = 0
Width = 133
Name = "Imgbutton14"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton21</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 0
Top = 115
Width = 133
Name = "Imgbutton21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton22</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 133
Top = 115
Width = 133
Name = "Imgbutton22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton23</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 266
Top = 115
Width = 133
Name = "Imgbutton23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton24</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 399
Top = 115
Width = 133
Name = "Imgbutton24"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5Z7</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton31</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 0
Top = 230
Width = 133
Name = "Imgbutton31"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5Z8</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton32</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 133
Top = 230
Width = 133
Name = "Imgbutton32"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5Z9</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton33</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 266
Top = 230
Width = 133
Name = "Imgbutton33"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5ZA</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton34</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 399
Top = 230
Width = 133
Name = "Imgbutton34"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton41</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 0
Top = 345
Width = 133
Name = "Imgbutton41"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton42</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 133
Top = 345
Width = 133
Name = "Imgbutton42"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton43</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 266
Top = 345
Width = 133
Name = "Imgbutton43"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton44</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 399
Top = 345
Width = 133
Name = "Imgbutton44"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5ZF</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton51</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 0
Top = 460
Width = 133
Name = "Imgbutton51"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5ZG</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton52</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 133
Top = 460
Width = 133
Name = "Imgbutton52"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5ZH</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton53</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 266
Top = 460
Width = 133
Name = "Imgbutton53"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WS5ZI</uniqueid>
		<timestamp>949058101</timestamp>
		<class>imgbutton</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>Imgbutton54</objname>
		<parent>cnttuchpadmainpict</parent>
		<properties>Height = 115
Left = 399
Top = 460
Width = 133
Name = "Imgbutton54"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchpadmainpict</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0WWO6U</uniqueid>
		<timestamp>949110327</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchpadmainbut</objname>
		<parent/>
		<properties>Width = 500
Height = 560
Name = "cnttuchpadmainbut"
</properties>
		<protected/>
		<methods>PROCEDURE _paintmnu
*--íàðèñóåì ìåíþ ñ êíîïêàìè
LPARAMETERS tnVar, tnIDSET
LOCAL i, lcexp, _PARAM

*--ñíà÷àëà âûáåðåì äàííûå âî âðåìåííûé êóðñîð, ïî êîòîðîìó áóäåò ñòðîèòüñÿ ìåíþ
DO CASE
	CASE tnVar = 1
		SELECT ;
			lvPOSFuncInSetView.NM AS NM, ;
			lvPOSFuncInSetView.ID AS ID ;
		FROM lvPOSFuncInSetView ;
		INTO CURSOR curBuild NOFILTER

	CASE tnVar = 2
		USE IN SELECT([lvTvrInSetView])
		_PARAM = tnIDSET
		USE lvTvrInSetView IN 0	
			
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð ïðàéñà
		USE IN SELECT([lvTvrSetInfo])
		_PARAM = tnIDSET
		USE lvTvrSetInfo IN 0
		ThisForm.nPrcTypeID = lvTvrSetInfo.PrcTypeID
		*------------------------------------------------------------------------------
			
		SELECT ;
			lvTvrInSetView.TvrNM AS NM, ;
			lvTvrInSetView.TvrID AS ID ;
		FROM lvTvrInSetView ;
		INTO CURSOR curBuild NOFILTER
	
ENDCASE

*--ïîñòðîèì ïî ýòîìó êóðñîðó  òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(80),t2 C(80),t3 C(80),t4 C(80),t5 C(80),t6 C(80),t7 C(80))

*--çàïîëíèì òàáëèöó äëÿ ìåíþ
i = 1
SELECT tmpmenu
APPEND BLANK

SELECT curBuild
GO TOP
DO WHILE !EOF([curBuild])
	IF i&lt;=thisform.GrdMenu.ColumnCount
		lcexp = [REPL tmpmenu.t]+ALLTRIM(STR(i))+[ WITH NVL(curBuild.NM,'ïóñòî')]
		&amp;lcexp
		i = i+1
		SKIP 1
	ELSE
		*--ïåðåéäåì íà çàïîëíåíèå íîâîé ñòðîêè
		i = 1
		SELECT tmpmenu
		APPEND BLANK
	ENDIF
	SELECT curBuild
ENDDO

SELECT tmpmenu
GO TOP
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>21</reserved2>
		<reserved3>*_paintmnu Çàïîëíÿåì êíîïêè çíà÷åíèÿìè
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch îñíîâíàÿ Ald</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd11</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 0
Left = 0
Height = 112
Width = 125
Caption = ""
Name = "Cmd11"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd12</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 0
Left = 125
Height = 112
Width = 125
Caption = ""
Name = "Cmd12"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd13</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 0
Left = 250
Height = 112
Width = 125
Caption = ""
Name = "Cmd13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd14</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 0
Left = 375
Height = 112
Width = 125
Caption = ""
Name = "Cmd14"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 112
Left = 0
Height = 112
Width = 125
Caption = ""
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 112
Left = 125
Height = 112
Width = 125
Caption = ""
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd23</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 112
Left = 250
Height = 112
Width = 125
Caption = ""
Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd24</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 112
Left = 375
Height = 112
Width = 125
Caption = ""
Name = "Cmd24"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDCV</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd31</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 224
Left = 0
Height = 112
Width = 125
Caption = ""
Name = "Cmd31"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDCW</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd32</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 224
Left = 125
Height = 112
Width = 125
Caption = ""
Name = "Cmd32"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDCX</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd33</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 224
Left = 250
Height = 112
Width = 125
Caption = ""
Name = "Cmd33"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDCY</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd34</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 224
Left = 375
Height = 112
Width = 125
Caption = ""
Name = "Cmd34"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd41</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 336
Left = 0
Height = 112
Width = 125
Caption = ""
Name = "Cmd41"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd42</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 336
Left = 125
Height = 112
Width = 125
Caption = ""
Name = "Cmd42"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd43</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 336
Left = 250
Height = 112
Width = 125
Caption = ""
Name = "Cmd43"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd44</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 336
Left = 375
Height = 112
Width = 125
Caption = ""
Name = "Cmd44"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDD3</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd51</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 448
Left = 0
Height = 112
Width = 125
Caption = ""
Name = "Cmd51"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDD4</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd52</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 448
Left = 125
Height = 112
Width = 125
Caption = ""
Name = "Cmd52"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDD5</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd53</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 448
Left = 250
Height = 112
Width = 125
Caption = ""
Name = "Cmd53"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK0XFDD6</uniqueid>
		<timestamp>949110327</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd54</objname>
		<parent>cnttuchpadmainbut</parent>
		<properties>Top = 448
Left = 375
Height = 112
Width = 125
Caption = ""
Name = "Cmd54"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchpadmainbut</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>949111027</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttablepad</objname>
		<parent/>
		<properties>Width = 630
Height = 576
Name = "cnttablepad"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>73</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà ñòîëîâ Ald</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 0
Height = 72
Width = 70
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 70
Height = 72
Width = 70
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd3</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 140
Height = 72
Width = 70
Name = "Cmd3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd4</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 210
Height = 72
Width = 70
Name = "Cmd4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd5</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 280
Height = 72
Width = 70
Name = "Cmd5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd6</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 350
Height = 72
Width = 70
Name = "Cmd6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd7</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 420
Height = 72
Width = 70
Name = "Cmd7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd8</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 490
Height = 72
Width = 70
Name = "Cmd8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd9</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 0
Left = 560
Height = 72
Width = 70
Name = "Cmd9"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 0
Height = 72
Width = 70
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 70
Height = 72
Width = 70
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd23</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 140
Height = 72
Width = 70
Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd24</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 210
Height = 72
Width = 70
Name = "Cmd24"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA02X99M</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd25</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 280
Height = 72
Width = 70
Name = "Cmd25"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd26</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 350
Height = 72
Width = 70
Name = "Cmd26"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S60XPNMV</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd27</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 420
Height = 72
Width = 70
Name = "Cmd27"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd28</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 490
Height = 72
Width = 70
Name = "Cmd28"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SC0S5FAV</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd29</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 72
Left = 560
Height = 72
Width = 70
Name = "Cmd29"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd31</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 0
Height = 72
Width = 70
Name = "Cmd31"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd32</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 70
Height = 72
Width = 70
Name = "Cmd32"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X00PAG8M</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd33</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 140
Height = 72
Width = 70
Name = "Cmd33"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd34</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 210
Height = 72
Width = 70
Name = "Cmd34"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd35</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 280
Height = 72
Width = 70
Name = "Cmd35"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd36</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 350
Height = 72
Width = 70
Name = "Cmd36"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd37</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 420
Height = 72
Width = 70
Name = "Cmd37"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd38</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 490
Height = 72
Width = 70
Name = "Cmd38"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd39</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 144
Left = 560
Height = 72
Width = 70
Name = "Cmd39"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY12O86G</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd41</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 0
Height = 72
Width = 70
Name = "Cmd41"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SZ0NUEEZ</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd42</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 70
Height = 72
Width = 70
Name = "Cmd42"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd43</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 140
Height = 72
Width = 70
Name = "Cmd43"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd44</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 210
Height = 72
Width = 70
Name = "Cmd44"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X00PAG8M</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd45</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 280
Height = 72
Width = 70
Name = "Cmd45"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd46</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 350
Height = 72
Width = 70
Name = "Cmd46"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8KL</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd47</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 420
Height = 72
Width = 70
Name = "Cmd47"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8L0</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd48</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 490
Height = 72
Width = 70
Name = "Cmd48"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XH10E8L1</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd49</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 216
Left = 560
Height = 72
Width = 70
Name = "Cmd49"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197070</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd51</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 0
Height = 72
Width = 70
Name = "Cmd51"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197071</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd52</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 70
Height = 72
Width = 70
Name = "Cmd52"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197072</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd53</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 140
Height = 72
Width = 70
Name = "Cmd53"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197073</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd54</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 210
Height = 72
Width = 70
Name = "Cmd54"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197074</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd55</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 280
Height = 72
Width = 70
Name = "Cmd55"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197075</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd56</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 350
Height = 72
Width = 70
Name = "Cmd56"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197076</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd57</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 420
Height = 72
Width = 70
Name = "Cmd57"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197077</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd58</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 490
Height = 72
Width = 70
Name = "Cmd58"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197078</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd59</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 288
Left = 560
Height = 72
Width = 70
Name = "Cmd59"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197079</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd61</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 0
Height = 72
Width = 70
Name = "Cmd61"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707A</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd62</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 70
Height = 72
Width = 70
Name = "Cmd62"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707B</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd63</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 140
Height = 72
Width = 70
Name = "Cmd63"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707C</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd64</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 210
Height = 72
Width = 70
Name = "Cmd64"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707D</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd65</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 280
Height = 72
Width = 70
Name = "Cmd65"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707E</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd66</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 350
Height = 72
Width = 70
Name = "Cmd66"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707F</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd67</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 420
Height = 72
Width = 70
Name = "Cmd67"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707G</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd68</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 490
Height = 72
Width = 70
Name = "Cmd68"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707H</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd69</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 360
Left = 560
Height = 72
Width = 70
Name = "Cmd69"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707I</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd71</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 0
Height = 72
Width = 70
Name = "Cmd71"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707J</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd72</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 70
Height = 72
Width = 70
Name = "Cmd72"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707K</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd73</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 140
Height = 72
Width = 70
Name = "Cmd73"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707L</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd74</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 210
Height = 72
Width = 70
Name = "Cmd74"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707M</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd75</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 280
Height = 72
Width = 70
Name = "Cmd75"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707N</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd76</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 350
Height = 72
Width = 70
Name = "Cmd76"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707O</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd77</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 420
Height = 72
Width = 70
Name = "Cmd77"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707P</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd78</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 490
Height = 72
Width = 70
Name = "Cmd78"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707Q</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd79</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 432
Left = 560
Height = 72
Width = 70
Name = "Cmd79"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707R</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd81</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 0
Height = 72
Width = 70
Name = "Cmd81"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707S</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd82</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 70
Height = 72
Width = 70
Name = "Cmd82"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707T</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd83</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 140
Height = 72
Width = 70
Name = "Cmd83"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707U</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd84</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 210
Height = 72
Width = 70
Name = "Cmd84"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707V</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd85</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 280
Height = 72
Width = 70
Name = "Cmd85"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707W</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd86</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 350
Height = 72
Width = 70
Name = "Cmd86"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707X</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd87</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 420
Height = 72
Width = 70
Name = "Cmd87"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707Y</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd88</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 490
Height = 72
Width = 70
Name = "Cmd88"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707Z</uniqueid>
		<timestamp>949111027</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd89</objname>
		<parent>cnttablepad</parent>
		<properties>Top = 504
Left = 560
Height = 72
Width = 70
Name = "Cmd89"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttablepad</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S90QTAKE</uniqueid>
		<timestamp>950759746</timestamp>
		<class>cntnumericpad</class>
		<classloc>comctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntnumericpad</objname>
		<parent/>
		<properties>Name = "cntnumericpad"
ImgButton0.Picture = ..\graphic\0_.gif
ImgButton0.Stretch = 2
ImgButton0.Height = 50
ImgButton0.Left = 0
ImgButton0.Top = 150
ImgButton0.Width = 50
ImgButton0.downpicture = 0_pr.gif
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Picture = ..\graphic\point_.gif
ImgButtonPoint.Height = 50
ImgButtonPoint.Width = 50
ImgButtonPoint.downpicture = point_pr.gif
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Picture = ..\graphic\1_.gif
ImgButton1.BackStyle = 1
ImgButton1.Height = 50
ImgButton1.Width = 50
ImgButton1.ColorSource = 0
ImgButton1.downpicture = 1_pr.gif
ImgButton1.Name = "ImgButton1"
ImgButton2.Picture = ..\graphic\2_.gif
ImgButton2.Height = 50
ImgButton2.Width = 50
ImgButton2.downpicture = 2_pr.gif
ImgButton2.Name = "ImgButton2"
ImgButton3.Picture = ..\graphic\3_1.gif
ImgButton3.Height = 50
ImgButton3.Width = 50
ImgButton3.downpicture = 3_pr.gif
ImgButton3.Name = "ImgButton3"
ImgButton4.Picture = ..\graphic\4_.gif
ImgButton4.Height = 50
ImgButton4.Width = 50
ImgButton4.downpicture = 4_pr.gif
ImgButton4.Name = "ImgButton4"
ImgButton5.Picture = ..\graphic\5_.gif
ImgButton5.Height = 50
ImgButton5.Width = 50
ImgButton5.downpicture = 5_pr.gif
ImgButton5.Name = "ImgButton5"
ImgButton6.Picture = ..\graphic\6_.gif
ImgButton6.Height = 50
ImgButton6.Width = 50
ImgButton6.downpicture = 6_pr.gif
ImgButton6.Name = "ImgButton6"
ImgButton7.Picture = ..\graphic\7_.gif
ImgButton7.Height = 50
ImgButton7.Width = 50
ImgButton7.downpicture = 7_pr.gif
ImgButton7.Name = "ImgButton7"
ImgButton8.Picture = ..\graphic\8_.gif
ImgButton8.Height = 50
ImgButton8.Width = 50
ImgButton8.downpicture = 8_pr.gif
ImgButton8.Name = "ImgButton8"
ImgButton9.Picture = ..\graphic\9_.gif
ImgButton9.Height = 50
ImgButton9.Width = 50
ImgButton9.downpicture = 9_pr.gif
ImgButton9.Name = "ImgButton9"
IMGBUTTONDELETE.Picture = ..\graphic\del_.gif
IMGBUTTONDELETE.Height = 50
IMGBUTTONDELETE.Width = 50
IMGBUTTONDELETE.downpicture = del_pr.gif
IMGBUTTONDELETE.Name = "IMGBUTTONDELETE"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Êîíòåéíåð äëÿ êàëüêóëÿòîðà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntnumericpad</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2D80T78OB</uniqueid>
		<timestamp>950764709</timestamp>
		<class>cntnumericpad</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntnumericpadextend</objname>
		<parent/>
		<properties>Width = 146
Height = 279
uretval = 0.00
Name = "cntnumericpadextend"
ImgButton0.Left = -2
ImgButton0.Top = 175
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Height = 50
ImgButtonPoint.Left = 98
ImgButtonPoint.Top = 175
ImgButtonPoint.Width = 50
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Height = 50
ImgButton1.Left = -2
ImgButton1.Top = 125
ImgButton1.Width = 50
ImgButton1.Name = "ImgButton1"
ImgButton2.Height = 50
ImgButton2.Left = 48
ImgButton2.Top = 125
ImgButton2.Width = 50
ImgButton2.Name = "ImgButton2"
ImgButton3.Height = 50
ImgButton3.Left = 98
ImgButton3.Top = 125
ImgButton3.Width = 50
ImgButton3.Name = "ImgButton3"
ImgButton4.Height = 50
ImgButton4.Left = -2
ImgButton4.Top = 75
ImgButton4.Width = 50
ImgButton4.Name = "ImgButton4"
ImgButton5.Height = 50
ImgButton5.Left = 48
ImgButton5.Top = 75
ImgButton5.Width = 50
ImgButton5.Name = "ImgButton5"
ImgButton6.Height = 50
ImgButton6.Left = 98
ImgButton6.Top = 75
ImgButton6.Width = 50
ImgButton6.Name = "ImgButton6"
ImgButton7.Height = 50
ImgButton7.Left = -2
ImgButton7.Top = 25
ImgButton7.Width = 50
ImgButton7.Name = "ImgButton7"
ImgButton8.Height = 50
ImgButton8.Left = 48
ImgButton8.Top = 25
ImgButton8.Width = 50
ImgButton8.Name = "ImgButton8"
ImgButton9.Height = 50
ImgButton9.Left = 98
ImgButton9.Top = 25
ImgButton9.Width = 50
ImgButton9.Name = "ImgButton9"
ImgbuttonDelete.Height = 50
ImgbuttonDelete.Left = 48
ImgbuttonDelete.Top = 175
ImgbuttonDelete.Width = 50
ImgbuttonDelete.Name = "ImgbuttonDelete"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>uretval
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Êîíòåéíåð äëÿ êàëüêóëÿòîðà Ðàñøèðåííûé Ald</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2D80ZFJDR</uniqueid>
		<timestamp>950764538</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>cntnumericpadextend</parent>
		<properties>Top = 224
Left = 0
Width = 146
Height = 55
TabIndex = 3
ZOrderSet = 4
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 0
cmdCancel.Left = 0
cmdCancel.Height = 25
cmdCancel.Width = 147
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 31
cmdOk.Left = 0
cmdOk.Height = 25
cmdOk.Width = 147
cmdOk.Caption = "Îê (Enter)"
cmdOk.Enabled = .F.
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods>PROCEDURE cmdOk.Click
*14.04.2006 16:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
this.parent.parent.uRetVal = this.parent.parent.txtCalc.Value
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2D80ZAIHI</uniqueid>
		<timestamp>950764647</timestamp>
		<class>txtcalcnum</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtcalc</objname>
		<parent>cntnumericpadextend</parent>
		<properties>FontBold = .T.
FontSize = 12
Height = 29
Left = -1
MaxLength = 12
Top = 0
Width = 147
ForeColor = 0,0,255
BackColor = 218,214,218
SelectedForeColor = 255,128,64
SelectedBackColor = 239,228,250
_highlightself = .F.
Name = "Txtcalc"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF this.Value&gt;=ABS(thisform.nOrderSum)
	**thisform.lblChange.Caption = ALLTRIM(STR((this.Value-thisform.nOrderSum*2+thisform.ncltbalans+thisform.ncltlimit),99,2))
	thisform.lblChange.Caption = ALLTRIM(STR((this.Value-ABS(thisform.nOrderSum)),99,2))
	thisform.cntcancelsavehandled1.cmdOk.Enabled=.t.
ELSE
	thisform.lblChange.Caption = [0.00]
	thisform.cntcancelsavehandled1.cmdOk.Enabled=.f.
ENDIF
thisform.txtFree.Value = ALLTRIM(STR((this.Value+thisform.ncltbalans+thisform.ncltlimit),99,2))

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntnumericpadextend</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S11EF03W</uniqueid>
		<timestamp>950766577</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmorderview</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 500
Width = 778
ShowWindow = 1
ScrollBars = 2
DoCreate = .T.
BorderStyle = 2
Caption = ""
ControlBox = .F.
Closable = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
ClipControls = .F.
TitleBar = 0
WindowType = 1
WindowState = 2
BackColor = 239,228,250
ntablenum = .F.
ncountcnt = 0
nfocuscount = .F.
Name = "frmorderview"
cstmsghandler.Top = 3
cstmsghandler.Left = 48
cstmsghandler.Height = 17
cstmsghandler.Width = 34
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 2
cstresizable.Left = 22
cstresizable.Height = 19
cstresizable.Width = 32
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE _clearord
LOCAL lcexp, lncountcnt

*--î÷èñòèì ôîðìó
FOR lncountcnt = 1 TO thisform.ncountcnt
	lcexp = [thisform.removeobject('cntorder]+ALLTRIM(STR(lncountcnt))+[')]
	&amp;lcexp
ENDFOR

IF TYPE([thisform.cntordernew1])==[O]
	thisform.removeobject('cntordernew1')
ENDIF

thisform.ncountcnt = 0
ENDPROC
PROCEDURE _paintord
LOCAL lcexp, ;
	lncount, ;
	lcTableNM, ;
	_PARAM, ;
	nQntCol, ;
	nQntStr, ;
	nCurStr, ;
	nCurCol, ;
	lcSum

USE IN SELECT([lvOrgUnitEdit])
_PARAM = thisform.ntablenum
USE lvOrgUnitEdit IN 0

IF RECCOUNT([lvOrgUnitEdit])&gt;0
	lcTableNM = lvOrgUnitEdit.OUNM
ELSE
	lcTableNM = []
ENDIF

*--çàãðóçèì áèáëèîòåêó, åñëè ýòî íóæíî
IF !([RST_V1.VCX]$SET([CLASSLIB]))
	SET CLASSLIB TO rst_v1 ADDITIVE
ENDIF

lncount  = 0

*--îïðåäåëèì êîëè÷åñòâî êîëîíîê äëÿ ïðîðèñîâêè îáúåêòîâ
nQntCol = INT((thisform.Width-30)/120)

*--îïðåäåëèì êîëè÷åñòâî ñòðîê äëÿ ïðîðèñîâêè îáúåêòîâ
nQntStr = INT((thisform.Height-100)/120)

*--çàäàäèì òåêóùóþ ñòðîêó è êîëîíêó
nCurStr = 0
nCurCol = 0

SELECT lvOrderView
GO TOP
SCAN ALL
	lncount = RECNO([lvOrderView])
	lcnum = lvOrderView.FrmNum
	lcSum = IIF(lvOrderView.FrmSum=0,'',[;]+ALLTRIM(STR(lvOrderView.FrmSum,16,2)))
	
	*--äîáàâèì îáúåêò
	lcexp = [thisform.AddObject('cntorder]+ALLTRIM(STR(lncount))+[','cntorder')]
	&amp;lcexp
	
	*--ïîðàáîòàåì ñ ýòèì îáúåêòîì
	lcexp = [thisform.cntorder]+ALLTRIM(STR(lncount))
	WITH &amp;lcexp
		*--çàïîìíèì ID ýòîãî çàêàçà
		.nFrmID = lvOrderView.FrmID
		
		*--íàïèøåì çàãîëîâîê îáúåêòà (íîìåð ñòîëà.íîìåð çàêàçà)
		.lbl1.caption = ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lcnum)+lcSum
		
		*--ðàçìåñòèì îáúåêò íà ôîðìå
		.visible = .T.
		.top = 40 + nCurStr*120
		.left = 20 + nCurCol*120
		
		*--îïðåäåëèì ñëåäóþùóþ ñòðîêó è êîëîíêó
		nCurCol = nCurCol+1
		IF nCurCol&gt;(nQntCol-1)
			nCurStr = nCurStr+1
			nCurCol = 0
		ENDIF
	ENDWITH
	
	SELECT lvOrderView
ENDSCAN

thisform.ncountcnt = lncount

*--äîáàâèì êíîïêó äëÿ íîâîãî çàêàçà
lcexp = [thisform.AddObject('cntordernew1','cntordernew')]
&amp;lcexp

WITH thisform.cntordernew1
	.visible = .T.
	.top = 40 + nCurStr*120
	.left = 20 + nCurCol*120
ENDWITH

*--åñëè íóæíî, äîáàâèì âåðòèêàëüíóþ ïîëîñó ïðîêðóòêè
IF nCurStr&gt;nQntStr
	thisform.ScrollBars = 2
ENDIF

ENDPROC
PROCEDURE _update
LPARAMETERS tnvarfocus
LOCAL lnFocusCount

lnFocusCount = thisform.nFocusCount

*--Îáíîâèì äàííûå íà ôîðìå
_PARAM1 = spUserClt()
_PARAM2 = thisform.ntablenum
_PARAM3 = VAL(oRes.GetParam([RST],[TYPEORD]))
REQUERY([lvOrderView])

*--Ïåðåðèñóåì ôîðìó
thisform._clearord()
thisform._paintord()

*--óñòàíîâèì ôîêóñ íà òîò îáúåêò, íà êîòîðûé òðåáóåòñÿ
DO CASE
	CASE tnvarfocus AND !EMPTY(lnFocusCount)
		*--ïðè ðåäàêòèðîâàíèè - âñòàíåì íà òîò êîíòåéíåð, êîòîðûé ðåäàêòèðîâàëè
		lcexp = [TYPE('thisform.cntorder]+lnFocusCount+[')=='O']
		IF &amp;lcexp
			lcexp = [thisform.cntorder]+lnFocusCount+[.SetFocus()]
		ELSE
			*--åñëè íå íàøëè åãî, òî âñòàíåì íà ïîñëåäíèé çàïîëíåííûé, åñëè îí åñòü
			IF thisform.ncountcnt&gt;0
				lcexp = [thisform.cntorder]+ALLTRIM(STR(thisform.ncountcnt))+[.SetFocus()]
			ELSE
				*--åñëè íåò çàêàçîâ, òî âñòàíåì íà êîíòåéíåð íîâîãî çàêàçà
				lcexp = [thisform.cntordernew1.cmd1.SetFocus()]
			ENDIF
		ENDIF
		
	CASE tnvarfocus AND EMPTY(lnFocusCount)
		*--âñòàíåì íà ïîñëåäíèé äîáàâëåííûé, åñëè îí åñòü
		IF thisform.ncountcnt&gt;0
			lcexp = [thisform.cntorder]+ALLTRIM(STR(thisform.ncountcnt))+[.SetFocus()]
		ELSE
			*--åñëè íåò çàêàçîâ, òî âñòàíåì íà êîíòåéíåð íîâîãî çàêàçà
			lcexp = [thisform.cntordernew1.cmd1.SetFocus()]
		ENDIF
		
	OTHERWISE
		*--èíà÷å âñòàíåì íà êîíòåéíåð ñ íîâûì çàêàçîì
		lcexp = [thisform.cntordernew1.cmd1.SetFocus()]
ENDCASE

&amp;lcexp
ENDPROC
PROCEDURE cstresizable.doresize
NODEFAULT
ENDPROC
PROCEDURE Init
LPARAMETERS	tnTableNum

DODEFAULT()

thisform.ntablenum = tnTableNum

*--íàïèøåì íàçâàíèå ñòîëà
USE IN SELECT([lvOrgUnitEdit])
_PARAM = thisform.ntablenum
USE lvOrgUnitEdit IN 0

thisform.lblTable.Caption = ALLTRIM(lvOrgUnitEdit.OUNM)+[. Ñïèñîê çàêàçîâ]
thisform.lblTable.Width = thisform.Width
thisform.lblTable.Top = 0
thisform.lblTable.Left = 0

*--Îáíîâèì äàííûå äëÿ äàííîãî ñòîëà òåêóùåãî îôèöèàíòà
thisform._update()


ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERVIEW.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îòêðûòèå ôîðìû (çàãðóçêà äàííûõ)
*-------------------------------------------------------

frm::LOAD()

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	

*******************************************************************************
* Çàãðóçèì ïóñòîé Alias                             *
*******************************************************************************

USE lvOrderView IN 0 NODATA

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Resize
NODEFAULT
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>ntablenum íîìåð ñòîëà
ncountcnt
nfocuscount
*_paintord Ðèñóåì êíîïêè ñ çàêàçàìè
*_clearord Î÷èùàåì ôîðìó
*_update 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ïðîñìîòð çàêàçîâ ïî äàííîìó ñòîëó òåêóùåãî îôèöèàíòà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S11EM32A</uniqueid>
		<timestamp>950766577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblTable</objname>
		<parent>frmorderview</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
BackStyle = 1
Caption = "Ñòîë ¹ "
Height = 30
Left = -3
Top = -1
Width = 817
ForeColor = 252,242,218
BackColor = 0,0,255
ZOrderSet = 0
Name = "LblTable"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.release()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmorderview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>950766701</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmtableview</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 456
Width = 779
ShowWindow = 2
DoCreate = .T.
Picture = ..\graphic\ôîí5.bmp
Caption = ""
ControlBox = .F.
MaxButton = .F.
MinButton = .F.
Movable = .F.
TitleBar = 0
WindowState = 2
BackColor = 252,242,218
Name = "frmtableview"
cstmsghandler.Top = 27
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 32
cstresizable.Left = 22
cstresizable.Name = "cstresizable"
Img1.ZOrderSet = 0
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE cstresizable.doresize
DODEFAULT()

thisform.lblWaiter.Width = thisform.Width
thisform.lblWaiter.Top = 0
thisform.lblWaiter.Left = 0



ENDPROC
PROCEDURE defaulttable
LOCAL lcexp, i

FOR i = 1 TO 8
	*--ñíà÷àëà îáíóëèì íîìåðà âñåõ ñòîëîâ
	lcexp = [thisform.cnttable]+ALLTRIM(STR(i))+[.ntablenum = 0]
	&amp;lcexp
	
	*--óáåðåì íàäïèñü ñ íàçâàíèåì ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(i))+[.Lbl1.Visible = .F.]
	&amp;lcexp
	
	*--óáåðåì êàðòèíêó ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(i))+[.Imgtable1.Visible = .F.]
	&amp;lcexp

	*--ñíèìåì ïîäñâåòêó ðàìêè
	lcexp = [thisform.cnttable]+ALLTRIM(STR(i))+[.Shp1.BorderColor = RGB(252,242,218)]
	&amp;lcexp
ENDFOR

	
	
		

ENDPROC
PROCEDURE Init
LPARAMETERS	tnScrFrmID
LOCAL loStrih

DODEFAULT(tnScrFrmID)
					*!*	*--ïðîâåðèì, âêëþ÷åí ëè ôèñêàëüíûé ðåãèñòðàòîð
					*!*	SET CLASSLIB TO kkms.vcx ADDITIVE
					*!*	loStrih = CREATEOBJECT([Shtrih])
					*!*	RELEASE CLASSLIB kkms
					*!*	loStrih.Beep()
					*!*	IF loStrih.ErrorCode # 0

					*!*		*16.04.2006 10:22 -&gt;Çàïèøåì  èíôîðìàöèþ â Log
					*!*		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
					*!*				  [Îøèáêà ] + PADL(ALLTRIM(STR(loStrih.ErrorCode)),3) + ;
					*!*				  [ ïðè çàïóñêå POS ïðîãðàììû] + CHR(13), [KKM.LOG], 1)
					*!*		*------------------------------------------------------------------------------
					*!*		
					*!*		oApp.lUserChange = .T.
					*!*		CLEAR EVENTS
					*!*		RETURN .F.
					*!*	ENDIF

*--ïîêàæåì ÔÈÎ òåêóùåãî îôèöèàíòà
thisform.lblWaiter.caption = ALLTRIM(spUserClt(1))

*--ïîêàæåì îòêðûòûå ñòîëû òåêóùåãî îôèöèàíòà
thisform.refreshtable()

thisform.lblWaiter.Width = thisform.Width
thisform.lblWaiter.Top = 0
thisform.lblWaiter.Left = 0



ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMTABLEVIEW.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îòêðûòèå ôîðìû (çàãðóçêà äàííûõ)
*-------------------------------------------------------
frm::LOAD()
LOCAL lnTblPar
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	

*--îòêðîåì ñïèñîê ñòîëîâ äàííîãî îôèöèàíòà
USE IN SELECT([lvWaiterTableView])
_PARAM1 = VAL(oRes.GetParam([RST],[TYPEORD]))
_PARAM2 = spUserClt()
USE lvWaiterTableView IN 0
*-- ïîäãîòîâèì äàííûå äëÿ êàðòû ñòîëîâ
lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))
DO spTableMap WITH lnTblPar

*------------------------------------------------------------------------------
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE refreshtable
LOCAL lncount1, lncount2, lcexp, i

*--çàãðóçèì áèáëèîòåêó, åñëè ýòî íóæíî
IF !([RST_V1.VCX]$SET([CLASSLIB]))
	SET CLASSLIB TO rst_v1 ADDITIVE
ENDIF
*!*	_screen.Top = -20
*!*	_screen.Height  = _screen.Height+20
SELECT tmpTableMap
LOCATE ALL FOR tmpTableMap.IsPar=1
IF FILE('tmpTableMap')
thisform.Picture = ALLTRIM(tmpTableMap.PictureNM)
ENDIF
SCAN ALL FOR !tmpTableMap.IsPar=1
		IF !TYPE('thisform.cntTable'+ALLTRIM(STR(tmpTableMap.OuId)))='O'
		   *--äîáàâèì îáúåêò
		   lcexp = [thisform.AddObject('cntTable]+ALLTRIM(STR(tmpTableMap.OuId))+[','cntTable')]
	       &amp;lcexp
	    	lcexp = [thisform.cntTable]++ALLTRIM(STR(tmpTableMap.OuId))
	    	WITH &amp;lcexp
			*--íàïèøåì çàãîëîâîê îáúåêòà (íîìåð ñòîëà)
			.lbl1.caption = ALLTRIM(tmpTableMap.OUNM)
			
			*--ðàçìåñòèì îáúåêò íà ôîðìå
			.top = tmpTableMap.CoordY
			.left = tmpTableMap.CoordX
			*.nTableNum = tmpTableMap.OuId
			ENDWITH
		ENDIF
		*--ïîðàáîòàåì ñ ýòèì îáúåêòîì
	    lcexp = [thisform.cntTable]++ALLTRIM(STR(tmpTableMap.OuId))
	WITH &amp;lcexp
	SELECT lvWaiterTableView
			LOCATE ALL FOR lvWaiterTableView.PointEmiOUID = tmpTableMap.OuId
			IF FOUND()
.nTableNum = lvWaiterTableView.PointEmiOUID	
			    .ImgTable1.Picture = ALLTRIM('t6.gif')
ELSE		
			    .ImgTable1.Picture = ALLTRIM(tmpTableMap.PictureNM)
			ENDIF
			.visible = .T.
		ENDWITH
		SELECT tmpTableMap
ENDSCAN
SELECT lvWaiterTableView

retu
GO TOP
DO WHILE lncount1&lt;=lncount2
	*--çàïîìíèì íîìåð ñòîëà
	IF ISNULL(lvWaiterTableView.PointEmiOUID)
		SELECT lvWaiterTableView
		SKIP 1
		lncount1 = lncount1+1
		LOOP
	ENDIF
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.nTableNum = ]+ALLTRIM(STR(lvWaiterTableView.PointEmiOUID))
	&amp;lcexp
	
	*--íàïèøåì íîìåð ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Lbl1.Caption = ']+ALLTRIM(lvWaiterTableView.TableNM)+[']
	&amp;lcexp
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Lbl1.Visible = .T.]
	&amp;lcexp
	
	*--ïîêàæåì êàðòèíêó ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Imgtable1.Visible = .T.]
	&amp;lcexp
		
	*--ïîäñâåòèì åãî ðàìêó
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Shp1.BorderColor = RGB(228,151,22)]
	** &amp;lcexp
	
	SELECT lvWaiterTableView
	SKIP 1
	lncount1 = lncount1+1
ENDDO

ENDPROC
PROCEDURE refreshtable_old
LOCAL lncount1, lncount2, lcexp, i

*--ñíà÷àëà îáíóëèì íîìåðà âñåõ ñòîëîâ
FOR i = 1 TO 8
	lcexp = [thisform.cnttable]+ALLTRIM(STR(i))+[.ntablenum = 0]
	&amp;lcexp
ENDFOR

*--ïîêàæåì îòêðûòûå ñòîëû òåêóùåãî îôèöèàíòà
lncount1 = 1
lncount2 = MIN(8,RECCOUNT([lvWaiterTableView]))

SELECT lvWaiterTableView

GO TOP
DO WHILE lncount1&lt;=lncount2
	*--çàïîìíèì íîìåð ñòîëà
	IF ISNULL(lvWaiterTableView.PointEmiOUID)
		SELECT lvWaiterTableView
		SKIP 1
		lncount1 = lncount1+1
		LOOP
	ENDIF
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.nTableNum = ]+ALLTRIM(STR(lvWaiterTableView.PointEmiOUID))
	&amp;lcexp
	
	*--íàïèøåì íîìåð ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Lbl1.Caption = ']+ALLTRIM(lvWaiterTableView.TableNM)+[']
	&amp;lcexp
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Lbl1.Visible = .T.]
	&amp;lcexp
	
	*--ïîêàæåì êàðòèíêó ñòîëà
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Imgtable1.Visible = .T.]
	&amp;lcexp
		
	*--ïîäñâåòèì åãî ðàìêó
	lcexp = [thisform.cnttable]+ALLTRIM(STR(lncount1))+[.Shp1.BorderColor = RGB(228,151,22)]
	** &amp;lcexp
	
	SELECT lvWaiterTableView
	SKIP 1
	lncount1 = lncount1+1
ENDDO

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>*refreshtable îáíîâëåíèå èíôîðìàöèè ïî ñòîëàì
*defaulttable 
*refreshtable_old 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ôîðìà îôèöèàíòà (ñòîëû äàííîãî îôèöèàíòà)</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S010XTQL</uniqueid>
		<timestamp>950766701</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblWaiter</objname>
		<parent>frmtableview</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
BackStyle = 1
Caption = "Ôàìèëèÿ Èìÿ Îò÷åñòâî"
Height = 30
Left = -5
Top = 0
Width = 788
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 1
Name = "LblWaiter"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--âûéäåì ïîëíîñòüþ èç ïðîãðàììû
oApp.lUserChange = .T.
CLEAR EVENTS
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmtableview</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S60XPNMV</uniqueid>
		<timestamp>951033368</timestamp>
		<class>frmidctlgridintop</class>
		<classloc>pos_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmidctlgridintop</objname>
		<parent/>
		<properties>Height = 224
Width = 358
DoCreate = .T.
Name = "frmidctlgridintop"
grd.Column1.Header1.FontSize = 14
grd.Column1.Header1.Name = "Header1"
grd.Column1.Text1.FontSize = 14
grd.Column1.Text1.Name = "Text1"
grd.Column1.FontSize = 14
grd.Column1.Name = "Column1"
grd.FontSize = 14
grd.HeaderHeight = 0
grd.Height = 224
grd.Left = 0
grd.RowHeight = 26
grd.Top = 0
grd.Width = 360
grd.lnoextendedrefresh = .T.
grd.Name = "grd"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE grd.Column1.Text1.Click
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: BASE_V1.VCX
* Class.Module....: TXTGR.DBLCLICK
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðåäà÷à ñîîáùåíèÿ Edit ðîäèòåëüñêîìó îáúåêòó.
*-------------------------------------------------------
This.Parent.Parent.HandleKey(13,0) &amp;&amp; Íàæàòèå Enter
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>âûïàäàþùèé ñïèñîê</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmidctlgridintop</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 14, 8, 23, 18, 51, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951870544</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchmenumain</objname>
		<parent/>
		<properties>Width = 168
Height = 468
Name = "cnttuchmenumain"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>19</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch îñíîâãî ìåíþ ðàáîòû ñ çàêàçîì Ald 2*9 êíîïîê </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 0
Left = 0
Height = 52
Width = 84
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 0
Left = 84
Height = 52
Width = 84
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 52
Left = 0
Height = 52
Width = 84
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 52
Left = 84
Height = 52
Width = 84
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd31</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 104
Left = 0
Height = 52
Width = 84
Name = "Cmd31"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd32</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 104
Left = 84
Height = 52
Width = 84
Name = "Cmd32"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY12O86G</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd41</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 156
Left = 0
Height = 52
Width = 84
Name = "Cmd41"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SZ0NUEEZ</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd42</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 156
Left = 84
Height = 52
Width = 84
Name = "Cmd42"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197070</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd51</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 208
Left = 0
Height = 52
Width = 84
Name = "Cmd51"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197071</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd52</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 208
Left = 84
Height = 52
Width = 84
Name = "Cmd52"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197079</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd61</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 260
Left = 0
Height = 52
Width = 84
Name = "Cmd61"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707A</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd62</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 260
Left = 84
Height = 52
Width = 84
Name = "Cmd62"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707I</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd71</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 312
Left = 0
Height = 52
Width = 84
Name = "Cmd71"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707J</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd72</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 312
Left = 84
Height = 52
Width = 84
Name = "Cmd72"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd81</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 364
Left = 0
Height = 52
Width = 84
Name = "Cmd81"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd82</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 364
Left = 84
Height = 52
Width = 84
Name = "Cmd82"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0P7YB4</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd91</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 416
Left = 0
Height = 52
Width = 84
Name = "Cmd91"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0P7YB5</uniqueid>
		<timestamp>951870544</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd92</objname>
		<parent>cnttuchmenumain</parent>
		<properties>Top = 416
Left = 84
Height = 52
Width = 84
Name = "Cmd92"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchmenumain</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951870609</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchmenu</objname>
		<parent/>
		<properties>Width = 440
Height = 416
Name = "cnttuchmenu"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>33</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch ìåíþ ðàáîòû ñ çàêàçîì Ald 4*8 êíîïîê </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 0
Left = 0
Height = 52
Width = 110
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 0
Left = 110
Height = 52
Width = 110
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd3</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 0
Left = 220
Height = 52
Width = 110
Name = "Cmd3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd4</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 0
Left = 330
Height = 52
Width = 110
Name = "Cmd4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 52
Left = 0
Height = 52
Width = 110
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 52
Left = 110
Height = 52
Width = 110
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd23</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 52
Left = 220
Height = 52
Width = 110
Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd24</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 52
Left = 330
Height = 52
Width = 110
Name = "Cmd24"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd31</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 104
Left = 0
Height = 52
Width = 110
Name = "Cmd31"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd32</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 104
Left = 110
Height = 52
Width = 110
Name = "Cmd32"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X00PAG8M</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd33</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 104
Left = 220
Height = 52
Width = 110
Name = "Cmd33"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd34</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 104
Left = 330
Height = 52
Width = 110
Name = "Cmd34"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY12O86G</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd41</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 156
Left = 0
Height = 52
Width = 110
Name = "Cmd41"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SZ0NUEEZ</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd42</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 156
Left = 110
Height = 52
Width = 110
Name = "Cmd42"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd43</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 156
Left = 220
Height = 52
Width = 110
Name = "Cmd43"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd44</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 156
Left = 330
Height = 52
Width = 110
Name = "Cmd44"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197070</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd51</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 208
Left = 0
Height = 52
Width = 110
Name = "Cmd51"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197071</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd52</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 208
Left = 110
Height = 52
Width = 110
Name = "Cmd52"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197072</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd53</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 208
Left = 220
Height = 52
Width = 110
Name = "Cmd53"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197073</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd54</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 208
Left = 330
Height = 52
Width = 110
Name = "Cmd54"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK197079</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd61</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 260
Left = 0
Height = 52
Width = 110
Name = "Cmd61"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707A</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd62</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 260
Left = 110
Height = 52
Width = 110
Name = "Cmd62"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707B</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd63</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 260
Left = 220
Height = 52
Width = 110
Name = "Cmd63"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707C</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd64</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 260
Left = 330
Height = 52
Width = 110
Name = "Cmd64"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707I</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd71</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 312
Left = 0
Height = 52
Width = 110
Name = "Cmd71"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707J</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd72</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 312
Left = 110
Height = 52
Width = 110
Name = "Cmd72"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707K</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd73</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 312
Left = 220
Height = 52
Width = 110
Name = "Cmd73"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707L</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd74</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 312
Left = 330
Height = 52
Width = 110
Name = "Cmd74"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707R</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd81</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 364
Left = 0
Height = 52
Width = 110
Name = "Cmd81"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707S</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd82</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 364
Left = 110
Height = 52
Width = 110
Name = "Cmd82"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707T</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd83</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 364
Left = 220
Height = 52
Width = 110
Name = "Cmd83"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK19707U</uniqueid>
		<timestamp>951870609</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd84</objname>
		<parent>cnttuchmenu</parent>
		<properties>Top = 364
Left = 330
Height = 52
Width = 110
Name = "Cmd84"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchmenu</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>951872421</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmorderedit_ald</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 580
Width = 800
ShowWindow = 1
DoCreate = .T.
AutoCenter = .F.
BorderStyle = 1
Caption = ""
MaxButton = .T.
MinButton = .T.
Movable = .F.
MaxHeight = 580
MaxWidth = 800
MinHeight = 580
MinWidth = 800
BackColor = 241,239,241
nfrmid = 0
lorderpay = .F.
_qntintable = .T.
ncashno = 0
nsalesid = 0
ncheckid = 0
nordersum = 0
lmanagerwork = .F.
_menusel = .F.
lreadonly = .F.
nprctypeid = 0
lorderdelm = .F.
lblock = .F.
npayvarnum = 0
lorderreturn = .F.
Name = "frmorderedit_ald"
cstmsghandler.Top = 32
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 32
cstresizable.Left = 22
cstresizable.Name = "cstresizable"
Img1.Left = -36
Img1.Top = 36
Img1.ZOrderSet = 0
Img1.Name = "Img1"
cstdatawork.Top = 32
cstdatawork.Left = 44
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE ___kkmerrorhandler
RETURN
LPARAMETERS tcErrorMsg, ;
			tlNoReset
******    ÏÅÐÅÍÎÑÈÌ  Â ÄÐÀÉÂÅÐ Ôèñêàëüíèêà   **********************
****** Âûçîâ âñòðå÷àåòñÿ 5 ðàç
*11.10.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnECRAdvancedMode, ;
		lnCheckID, ;
		loStatus
***
lnCheckID = This.nCheckID
*------------------------------------------------------------------------------

WITH This

*11.10.2006 16:53 -&gt;Ñîõðàíèì ñîîáùåíèå â ëîãå
IF VARTYPE(tcErrorMsg) == [C]
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + tcErrorMsg,[KKM.LOG],1)
ENDIF
*------------------------------------------------------------------------------

*16.10.2006 15:38 -&gt;
loStatus = oApp.CreateObject([frmKKMStatus;pos_v1.vcx],.Shtrih)

loStatus.Show(1)

IF loStatus.uRetVal
	IF NOT tlNoReset
		.CheckReset()
	ELSE
		.Shtrih.CancelCheck()
	ENDIF
ELSE
	.Shutdown(.T.)
ENDIF
*------------------------------------------------------------------------------

*!*	*12.10.2006 10:15 -&gt;Ïûòàåìñÿ îáðàáîòàòü îøèáêó
*!*	DO WHILE .T.

*!*	*11.10.2006 17:04 -&gt;Ïîëó÷èì ïîäðåæèì ÊÊÌ
*!*	lnECRAdvancedMode = .Shtrih.GetECRAdvancedMode(.T.)
*!*	*------------------------------------------------------------------------------

*!*	*11.10.2006 17:10 -&gt;Àíàëèçèðóåì ïîäðåæèì
*!*	DO CASE
*!*		CASE BETWEEN(.Shtrih.ErrorCode,-6,-1)
*!*			.Shtrih.Beep()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,1,2)
*!*			MESSAGEBOX([Âñòàâüòå ðóëîí áóìàãè â ÊÊÌ],64,[Ïðåäóïðåæäåíèå])
*!*			LOOP
*!*		CASE lnECRAdvancedMode = 3
*!*			.Shtrih.ContinuePrint()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,4,5)
*!*			LOOP
*!*		OTHERWISE
*!*			***
*!*			IF NOT tlNoReset
*!*				.CheckReset()
*!*			ELSE
*!*				.Shtrih.CancelCheck()
*!*			ENDIF
*!*			***
*!*			EXIT
*!*	ENDCASE
*!*	*------------------------------------------------------------------------------

*!*	ENDDO
*------------------------------------------------------------------------------
*********** ÏÅÐÅÍÎÑÈÌ
*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
spSaleFiscError(lnCheckID)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE __iscasher
RETURN
*-- ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, ÿâëÿåòñÿ ëè äàííûé îôèöèàíò êàññèðîì
LOCAL _PARAM

USE IN SELECT([lvcashierByCltView])
_PARAM = spUserClt()
USE lvcashierByCltView IN 0

IF RECCOUNT([lvcashierByCltView])&lt;=0
	MESSAGEBOX([Äàííûé îôèöèàíò íå ÿâëÿåòñÿ êàññèðîì],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ELSE
	RETURN .T.
ENDIF
ENDPROC
PROCEDURE __storechktrans
RETURN
*----- ÏÅÐÅÍÎÑÈÌ -------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: tfsctype - òèï îïëàòû, tfscexp - ïàðàìåòðû ôèñêàëüíîãî ÷åêà
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå òðàíçàêöèè ÷åêà
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype, tfscexp

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lnDiscount, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

lfsctype = tfsctype
ls1 = VAL(SUBSTR(tfscexp,AT([(],tfscexp)+1,AT([,],tfscexp,1)-AT([(],tfscexp)-1))
ls2 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,1)+1,AT([,],tfscexp,2)-AT([,],tfscexp,1)-1))
ls3 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,2)+1,AT([,],tfscexp,3)-AT([,],tfscexp,2)-1))
ls4 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,3)+1,AT([)],tfscexp)-AT([,],tfscexp,3)-1))


*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*------------------------------------------------------------------------------

WITH This

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,1,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

*--Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID

	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleTran(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------

	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.CheckDiscount(lnDiscount)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	
	*--Ïðèâÿçûâàåì äèñêîíòíóþ êàðòó ê ÷åêó
	spBindDisc(.nCheckID,VAL(lvFrmEdit.FrmNote))

	*--Äîáàâëÿåì ïîçèöèþ ñêèäêè  â ÷åê
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
	
	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECCOUNT([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 7, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lnDiscTvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH 1, ;
		lvCheckTransEdit.CheckTransPrc		WITH lnDiscount ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------
ENDIF


*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	

*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF

*------------------------------------------------------------------------------

WAIT CLEAR
RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE __storechktrans_pred
RETURN
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This

*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
						IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
						+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
						[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

.Shtrih.PrintString(REPLICATE([-],60))

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

IF lcnt&lt;30
	.Shtrih.FeedDocument(30-lcnt)
ENDIF

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._FooterPrint()

.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
ThisForm.grdOrder._RSRequery()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktrans_slim
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPredChk.Click()&gt;
* Parameters......: tCardID
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ÑËÈÏ (ïðè îïëàòå êàðòîé)
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETERS tCardID

MESSAGEBOX('Ìåòîä â äðóãîé áèáëèîòåêå' , 0+16 , 'Ñîîáùèòå îá ýòîì ðàçàðáîò÷èêó')
RETURN

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lcnt, ;
		lCardID, ;
		lCardNo, ;
		lFIO, ;
		_PARAM

*--ïîëó÷èì èíôîðìàöèþ ïî êàðòå
lCardID = tCardID
lCardNo = []

USE IN SELECT([lvCardViewByCardID])
_PARAM = lCardID
USE lvCardViewByCardID IN 0

IF RECCOUNT([lvCardViewByCardID])&gt;0
	lFIO = lvCardViewByCardID.CltNM
	lCardNo = lvCardViewByCardID.CardNo
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This
*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÑËÈÏ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*12.04.2006 17:22 -&gt;Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,30)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,3)),10)+[*]+ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),40,[ ]))

IF lcnt&lt;15
	.Shtrih.FeedDocument(12-lcnt)
ELSE
	.Shtrih.FeedDocument(3)
ENDIF

IF !EMPTY(lCardID)
	*--Ðàñïå÷àòàåì èíôîðìàöèþ ïî  VIP êàðòå
	.Shtrih.PrintString([¹ êàðòû ]+ALLTRIM(lCardNo))

	IF !EMPTY(lFIO)
		.Shtrih.PrintString(ALLTRIM(lFIO))
	ENDIF
ENDIF

.Shtrih.FeedDocument(1)
.Shtrih.PrintString([Ïîäïèñü]+PADL([_____________________________],35,[ ]))
.Shtrih.FeedDocument(1)
.Shtrih.PrintString(REPLICATE([=],60))
.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*--Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktransback
RETURN
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTransBACK
* Called by.......: &lt;cmdCHKBACK.Click()&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ôèñêàëüíûé ÷åê íà âîçâðàò
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype

LOCAL   lcUniqueFileNM, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

WITH This

*--ñôîðìèðóåì âûðàæåíèå äëÿ ñóìì â çàâèñèìîñòè îò òèïà îïëàòû
lfsctype = tfsctype
ls1 = IIF(lfsctype=1,.nordersum,0) &amp;&amp;--îïëàòà íàëè÷íûìè
ls2 = IIF(lfsctype=2,.nordersum,0) &amp;&amp;--îïëàòà áàíêîâñêîé êàðòîé
ls3 = IIF(lfsctype=3,.nordersum,0) &amp;&amp;--îïëàòà êóïîíîì
ls4 = IIF(lfsctype=4,.nordersum,0) &amp;&amp;--îïëàòà VIP êàðòîé

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,2,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()

*--Îòêðûâàåì ÄÌ äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN ALL
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleReturn(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
	

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF
*------------------------------------------------------------------------------

RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE _block_in
*--áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
LPARAMETERS tblock

LOCAL ldiscount, ;
	  lpredchk, ;
	  lkol,;
	  lnMODEDISC

*--îïðåäåëèì, áûëà ëè ñäåëàíà ñêèäêà ïî çàêàçó
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
IF FOUND()
	ldiscount = .T.
ENDIF

*--îïðåäåëèì, áûë ëè íàïå÷àòàí ïðåä÷åê ïî çàêàçó
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lkol

IF lkol &gt; 0
	lpredchk = .T.
ENDIF

*--îïðåäåëèì ðåæèì ñêèäêè
lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))
		
WITH thisform
	IF tblock
		*--çàáëîêèðóåì ââîä
		.lblock = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		*--â çàâèñèìîñòè îò ðåæèìà ñêèäêè
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ELSE
			.cmdDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
			.cmdNoDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPredchk.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		.CmdDelM.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
		.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width)
		.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
		IF ldiscount
			*--ðàçáëîêèðóåì òîëüêî äâå êíîïêè (åñëè ñíÿëè ïðåä÷åê, íî åñòü ñêèäêà)
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.CmdPredchk.Enabled = .T.
		ELSE
			*--ðàçáëîêèðóåì ââîä
			.lblock = .F.
			.GrdOrder.ReadOnly = .F.
			.GrdMenu.ReadOnly = .F.
			.TxtAttr.ReadOnly = .F.
			.cntOUTableID.Enabled = .T.
			
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.Cntnumericpad1.ImgButton1.Enabled = .T.
			.Cntnumericpad1.ImgButton2.Enabled = .T.
			.Cntnumericpad1.ImgButton3.Enabled = .T.
			.Cntnumericpad1.ImgButton4.Enabled = .T.
			.Cntnumericpad1.ImgButton5.Enabled = .T.
			.Cntnumericpad1.ImgButton6.Enabled = .T.
			.Cntnumericpad1.ImgButton7.Enabled = .T.
			.Cntnumericpad1.ImgButton8.Enabled = .T.
			.Cntnumericpad1.ImgButton9.Enabled = .T.
			.Cntnumericpad1.ImgButton0.Enabled = .T.
			.Cntnumericpad1.ImgButtonDelete.Enabled = .T.
			.Cntnumericpad1.ImgButtonPoint.Enabled = .T.
			.CmdUp.Enabled = .T.
			.CmdPlus.Enabled = .T.
			.CmdMinus.Enabled = .T.
			.CmdDel.Enabled = .T.
			.CmdDevOrder.Enabled = .T.
			.txtbarcod.Enabled = .T.
			.cmdEnter.Enabled = .T.
			.CmdPredchk.Enabled = .T.
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE _clickmenu
*--ïðè íàæàòèè êíîïêè ìåíþ ðàñêðîåì äåðåâî äëÿ äàëüíåéøåãî âûáîðà èëè ñäåëàåì âûáîð
LPARAMETERS tcNM
LOCAL _PARAM, lcModList, lnModID

IF !thisform.lReadOnly AND !thisform.lblock
	IF !thisform._menusel
		IF !EMPTY(tcNM) AND tcNM&lt;&gt;[ïóñòî]
			*--ðàñêðûâàåì äàëüøå
			thisform.grdmenu._rsrequery(2,tcNM)
			thisform._menusel = .T.
			thisform.lblPar.Visible = .T.
			thisform.lblPar.caption = ALLTRIM(tcNM)
		ENDIF
	ELSE
		*--äåëàåì âûáîð
		SELECT curBuild
		LOCATE FOR ALLTRIM(curBuild.NM)==ALLTRIM(tcNM)
				
		IF FOUND()
			*--äîáàâèì áëþäî â çàêàç
			thisform.grdOrder._add(curBuild.ID)	
			
			*--ïîëó÷èì ñïèñîê ìîäèôèêàòîðîâ äëÿ äàííîãî áëþäà
			_PARAM = curBuild.ID
			REQUERY([lvModList])
			
			*--åñëè ñïèñîê ìîäèôèêàòîðîâ íåïóñò, ïîêàæåì åãî
			IF RECCOUNT([lvModList])&gt;0
				lcModList = oApp.DoModalFormRetValObj([FrmModList;rst_v1.vcx],_PARAM)
			ENDIF
			
			*--åñëè ÷òî-òî âûáðàëè, òî äîáàâèì â çàêàç
			IF TYPE([lcModList])==[C] AND !EMPTY(lcModList)
				DO WHILE !EMPTY(lcModList)
					*--âûäåëèì ID ìîäèôèêàòîðà èç ñïèñêà
					lnModID = VAL(LEFT(lcModList,AT([,],lcModList)-1))
					
					*--äîáàâèì â çàêàç
					thisform.grdOrder._add(lnModID)	
					
					*--îáðåæåì ñïèñîê
					lcModList = RIGHT(lcModList,LEN(lcModList)-AT([,],lcModList))
				ENDDO
			ENDIF
		ELSE
			IF !EMPTY(tcNM)
				MESSAGEBOX([Íå íàéäåí òîâàð ]+ALLTRIM(tcNM),48,[Îêíî ñîîáùåíèé])
			ENDIF
		ENDIF		
	ENDIF
ENDIF
ENDPROC
PROCEDURE _closeday
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmorderedit.CloseDay
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàêðûòèå ñìåíû
*------------------------------------------------------------------------------

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSalesID, ;
		_PARAM, ;
	    _PARAM_DOP

WITH This
*--Ïðîâåðèì íåîáõîäèìîñòü çàêðûòèÿ ñìåíû
IF .nSalesID = 0
	lnSalesID = spGetOpenDay(.nCashNo,.T.)
	DO CASE
		CASE lnSalesID &gt; 0
			.nSalesID = lnSalesID
		CASE lnSalesID = 0
			MESSAGEBOX([Ñìåíà íå îòêðûòà.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
		OTHERWISE
			MESSAGEBOX([Ëîêàëüíàÿ ñìåíà óæå çàêðûòà]+CHR(13)+;
					[Äëÿ çàêðûòèÿ îáùåé ñìåíû îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
	ENDCASE
ENDIF

*--äëÿ Ëèäåðà ïðîâåðèì íàëè÷èå íåîïëà÷åííûõ çàêàçîâ
IF VAL(oRes.GetParam([RST],[CLOSEDAY]))=1 &amp;&amp;--ìîæíî îòêëþ÷èòü ýòó ïðîâåðêó
	*--îòêðîåì ñïèñîê âñåõ íåîïëà÷åííûõ çàêàçîâ
	_PARAM = VAL(oRes.GetParam([RST],[TYPEORD]))
	_PARAM_DOP = VAL(oRes.GetParam([RST],[TBLPAR]))
	USE IN SELECT([lvMgrView])
	USE lvMgrView IN 0
	IF RECCOUNT([lvMgrView])&gt;0
		MESSAGEBOX([Íåëüçÿ çàêðûòü ñìåíó ïðè íàëè÷èè íåîïëà÷åííûõ çàêàçîâ.]+CHR(13)+;
					[Äëÿ ïðîñìîòðà âñåõ íåîïëà÷åííûõ çàêàçîâ âîñïîëüçóéòåñü êàðòî÷êîé ìåíåäæåðà.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
ENDIF

*------------------------------------------------------------------------------

*12.04.2006 14:01 -&gt;Çàêðûâàåì ëîêàëüíûé äåíü
spSaleCloseDay(.nSalesID,.nCashNo)
*------------------------------------------------------------------------------

*--Ïå÷àòàåì Z-îò÷åò
	*13.04.2006 16:22 -&gt;Ïå÷àòàåì Z-îò÷åò
	LOCAL lcIniFileName ,lcKkmLib
	lcIniFileName = FULLPATH([KKM.INI])
	lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
	this.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

	this.Shtrih.CloseShift()
	This.Shtrih.Release()
	*------------------------------------------------------------------------------
*------------------------------------------------------------------------------

*--Ñáðîñèì íîìåð ñìåíû(ïðîäàæ)
.nSalesID = 0
*------------------------------------------------------------------------------

*--ñáðîñèì àâòîíóìåðàòîð
spResetAutoNum(VAL(oRes.GetParam([RST],[TYPEORD])))

MESSAGEBOX([Ëîêàëüíàÿ ñìåíà çàêðûòà.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó äëÿ çàêðûòèÿ îáùåé ñìåíû.],64,[Îêíî ñîîáùåíèé])
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************



ENDPROC
PROCEDURE _footerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì ïîäâàë ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcFooterFile, lnHandleFile, lcLine

lcFooterFile = ALLT(oRes.GetParam([RST],[CHKFTRFL]))
lcFooterFile = IIF(AT([.],lcFooterFile)=0,lcFooterFile+[.TXT],lcFooterFile)

IF !EMPTY(lcFooterFile) AND FILE(lcFooterFile)
	lnHandleFile = FOPEN(lcFooterFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _headerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcHeaderFile, lnHandleFile, lcLine

lcHeaderFile = ALLT(oRes.GetParam([RST],[CHKHDRFL]))
lcHeaderFile = IIF(AT([.],lcHeaderFile)=0,lcHeaderFile+[.TXT],lcHeaderFile)

IF !EMPTY(lcHeaderFile) AND FILE(lcHeaderFile)
	lnHandleFile = FOPEN(lcHeaderFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _ok
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDEREDIT._OK()
* Called by.......: frmOrderEdit.lblEdit.Click()
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------

LOCAL	llResSaveOrd, ;
		llDataChanged

WITH This			
	
	*--Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*--Ïîäãîòîâèìñÿ ê ñîõðàíåíèþ äàííûõ
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åíà àâòîíóìåðàöèÿ, ïðîèçâîäèì àâòîìàòè÷åñêóþ âñòàâêó íîìåðà çàêàçà
	IF .chkFrmAutoNum.Value
		REPLACE FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,lvFrmEdit.FrmDate,lvFrmEdit.PointEmiOUID) IN lvFrmEdit
	ENDIF
	*-- Îòìå÷àåì äàòó ïîñëåäíåãî èçìåíåíèÿ
	REPLACE FrmDateAcc WITH DATETIME() IN lvFrmEdit
	
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã óäàëåíèÿ çàêàçà ìåíåäæåðîì, ïîìåíÿåì åãî àòðèáóòû
	IF .lorderDelM
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,30) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã âîçâðàòà, óêàæåì ýòî â àòðèáóòàõ çàêàçà
	IF .lOrderReturn
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,0) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------
	
	*-- ÎÑÒÀÅÒÑß Ïðîèçâîäèì ñîõðàíåíèå øàïêè çàêàçà
	llDataChanged = .cstDataWork.DataChanged([lvFrmEdit],.T.)
	IF llDataChanged
		llResSaveOrd = .cstDataWork.Save([lvFrmEdit])
	ELSE
		llResSaveOrd = .T.
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Îáðàáîòàåì ðåçóëüòàòû ÂÑÅÕ îïåðàöèé ñîõðàíåíèÿ
	IF llResSaveOrd
		*--Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		.uRetVal = .T.
	ELSE
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		.uRetVal = .F.
	ENDIF
ENDWITH
*------------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _paintmenu
*--íàðèñóåì ìåíþ ñ êíîïêàìè
LPARAMETERS tnVar, tnIDSET
LOCAL i, lcexp, _PARAM

*--ñíà÷àëà âûáåðåì äàííûå âî âðåìåííûé êóðñîð, ïî êîòîðîìó áóäåò ñòðîèòüñÿ ìåíþ
DO CASE
	CASE tnVar = 1
		SELECT ;
			lvPOSFuncInSetView.NM AS NM, ;
			lvPOSFuncInSetView.ID AS ID ;
		FROM lvPOSFuncInSetView ;
		INTO CURSOR curBuild NOFILTER

	CASE tnVar = 2
		USE IN SELECT([lvTvrInSetView])
		_PARAM = tnIDSET
		USE lvTvrInSetView IN 0	
			
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð ïðàéñà
		USE IN SELECT([lvTvrSetInfo])
		_PARAM = tnIDSET
		USE lvTvrSetInfo IN 0
		ThisForm.nPrcTypeID = lvTvrSetInfo.PrcTypeID
		*------------------------------------------------------------------------------
			
		SELECT ;
			lvTvrInSetView.TvrNM AS NM, ;
			lvTvrInSetView.TvrID AS ID ;
		FROM lvTvrInSetView ;
		INTO CURSOR curBuild NOFILTER
	
ENDCASE

*--ïîñòðîèì ïî ýòîìó êóðñîðó  òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(80),t2 C(80),t3 C(80),t4 C(80),t5 C(80),t6 C(80),t7 C(80))

*--çàïîëíèì òàáëèöó äëÿ ìåíþ
i = 1
SELECT tmpmenu
APPEND BLANK

SELECT curBuild
GO TOP
DO WHILE !EOF([curBuild])
	IF i&lt;=thisform.GrdMenu.ColumnCount
		lcexp = [REPL tmpmenu.t]+ALLTRIM(STR(i))+[ WITH NVL(curBuild.NM,'ïóñòî')]
		&amp;lcexp
		i = i+1
		SKIP 1
	ELSE
		*--ïåðåéäåì íà çàïîëíåíèå íîâîé ñòðîêè
		i = 1
		SELECT tmpmenu
		APPEND BLANK
	ENDIF
	SELECT curBuild
ENDDO

SELECT tmpmenu
GO TOP
ENDPROC
PROCEDURE _storechecktrans_pred
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmPayment._StoreCheckTrans_pred
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = UPPER(ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName))) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì

WITH This

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

IF !lcKkmLib  = [SPARK]

				.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

				*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
				LOCAL   _PARAM

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._HeaderPrint()

				*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
				.Shtrih.FeedDocument(2)
				.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
				.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
				*-* 20080410 äîáàëåíî âðåìÿ îòêðûòèÿ çàêàçà
				.Shtrih.PrintString([Íîìåð çàêàçà:]+PADR(ALLTRIM(lvFrmEdit.FrmNum),10,[ ])+[Îòêðûò:]+ TTOC(lvFrmEdit.FrmDate))
				.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
				.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
				.Shtrih.FeedDocument(3)
				.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
				.Shtrih.FeedDocument(3)

				*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
				lcnt = 0
				SELECT lvOrderTvrView
				GO TOP
				SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
					lcnt = lcnt+1
					*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
					.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
										IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
										+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
										[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
				 	*------------------------------------------------------------------------------

					*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
					IF .Shtrih.ErrorCode # 0
						STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
								  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
								  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
								  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
								  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
								
						*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
						spSaleFiscError(.nCheckID)
						*------------------------------------------------------------------------------
				    RETURN .F.
					ENDIF
					*------------------------------------------------------------------------------
					SELECT lvOrderTvrView
				ENDSCAN

				.Shtrih.PrintString(REPLICATE([-],50))

				*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
				SELECT lvOrderTvrView
				LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
				IF FOUND()
					lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
					.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
				ENDIF

				*--Ïå÷àòàåì èòîã ÷åêà
				.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

				IF lcnt&lt;10
					.Shtrih.FeedDocument(10-lcnt)
					else
					.Shtrih.FeedDocument(3)
				ENDIF

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._FooterPrint()

				.Shtrih.FeedDocument(3)
				.Shtrih.CutCheck()
				*------------------------------------------------------------------------------

				*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
				IF .Shtrih.ErrorCode # 0
					STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
							  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
							  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
							  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
							
					*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
					spSaleFiscError(.nCheckID)
				    RETURN .F.
					*------------------------------------------------------------------------------
							
				ENDIF
				*------------------------------------------------------------------------------
				This.Shtrih.Release()

	ELSE
	this.printpredtoprint()
ENDIF

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	SELECT lvOrderTvrEdit
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
RETURN .T.
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE addvip
LOCAL _PARAM

WITH thisform
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		*--Ïðîâåðèì, ÿâëÿåòñÿ ëè ýòà êàðòà ïëàòèíîâîé èëè çîëîòîé
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0

		IF RECCOUNT([lvCardViewByCardID])&gt;0 AND ;
			(lvCardViewByCardID.CardTypeID = 1 OR lvCardViewByCardID.CardTypeID = 2) AND;
			!([5]$.nPayVarNum)
			
			.nPayVarNum = .nPayVarNum + [,5]
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE checkreset
*------- ÏÅÐÅÍÎÑÈÌ -----------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.CHECKRESET
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñáðîñ ÷åêà
*-------- ÏÅÐÅÍÎÑÈÌ ----------------------------------------------------------------------

WITH This

*16.04.2006 10:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnCheckID
***
lnCheckID = .nCheckID
*------------------------------------------------------------------------------

IF RECCOUNT([lvOrderTvrView])#0

	*12.04.2006 18:34 -&gt;Ñáðîñèì ÷åê íà ÔÐ
	.Shtrih.CancelCheck()
	*------------------------------------------------------------------------------

	*16.04.2006 10:26 -&gt;
	IF .Shtrih.ErrorCode # 0
	
		*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ñáðîñå ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(lnCheckID)), .T.)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

	*16.04.2006 10:27 -&gt;Îòìåòèì, ÷òî ÷åê ñáðîøåí îïåðàòîðîì
	spCheckSaleSucces(lnCheckID)
	*------------------------------------------------------------------------------

	*12.04.2006 15:32 -&gt;Ñáðîñèì ÷åê
	spCheckReset(.nCheckID)	
	*------------------------------------------------------------------------------

	
	.nCheckID = 0
ENDIF

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

*--ïðîâåðèì, íå çàáëîêèðîâàí ëè ââîä
IF thisform.lReadOnly
	MESSAGEBOX([Èçìåíåíèå äàííûõ ìåíåäæåðîì íå ïðåäóñìîòðåíî.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.cntCltID.SetValue(lvCardViewByCardCode.CltID)
		.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð VIP êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspCltSAccID WITH lvCardViewByCardCode.CardID
				
		*--Äîáàâèì âîçìîæíîñòü âûáðàòü òèï îïëàòû VIP êàðòîé
		thisform.addVIP()
	ENDIF
	thisform.cmdpay.Click()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE GotFocus
DODEFAULT()
		thisform.olecommprox1._open()

ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnFrmTypeID - òèï äîêóìåíòà
* Returns.........: &lt;none&gt;
* LastEditDate....: 26 October 2006
* Notes...........: &lt;~&gt;
*------------------------------------------------------------------------------
LPARAMETERS tnFrmID, tlReadOnly

LOCAL	lnDefClt, ;
		lnTblType, ;
		lnTblPar, ;
		lnWaiterID, ;
		_PARAM1, ;
	_PARAM2, ;
	_PARAM, ;
	lcTableNM, ;
	lnPredchk, ;
	lnDiscTvrID, ;
	llblock, ;
	lnSalesID, ;
	lnMODEDISC


*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------
WITH thisform
	*--ID çàêàçà
	.nFrmID = tnFrmID
	
	.lblFrmId.Caption = ALLTRIM(STR(tnFrmID,10))

	*--Íîìåð ìàøèíû (êàññû)
	.nCashNo = VAL(oRes.GetParam([RST],[CASH]))

	*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
	lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

	*--ïîëó÷èì òèï ïîäðàçäåëåíèÿ "ñòîë"
	lnTblType = VAL(oRes.GetParam([RST],[TBLTYPE]))

	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))

	*--ïîëó÷èì êîä òåêóùåãî îôèöèàíòà
	lnWaiterID = spUserClt()
	
	*--ïîëó÷èì ðåæèì ñêèäêè
	lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))	
	*------------------------------------------------------------------------------

	*--  ÏÅÐÅÍÎÑÈÌ  Â ÔÓÍÊÖÈÈ ÌÅÍÅÄÆÅÐÀ îïðåäåëèì äîñòóïíîñòü êíîïîê X-îò÷åò è Z-îò÷åò äëÿ äàííîãî ïîëüçîâàòåëÿ
	.cmdClose.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[ZACC])
	.cmdXReport.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[XACC])

	*--------------------------------------------------------------------------------
	*--Ïîëó÷àåì èäåíòèôèêàòîð íåçàêðûòîé ñìåíû
	lnSalesID = spGetOpenDay(This.nCashNo)

	*--Ïðîâåðèì êîððåêòíîñòü äàííûõ î ïðîäàæàõ
	DO CASE
		CASE lnSalesID = -1
			MESSAGEBOX([Äåíü óæå çàêðûò.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE INLIST(lnSalesID,-2,-3)
			MESSAGEBOX([Îñòàëèñü íå çàêðûòûìè áîëåå îäíîãî äíÿ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE lnSalesID = -4

			*--Åñëè ñìåíà îòêðûòà áîëåå ñóòîê, òðåáóåì çàêðûòü åå
			IF MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
						  [áîëåå 24 ÷àñîâ.Çàêðûòü ñìåíó?],4+32,[Ñìåíà]) = 6
				***
			    This._CloseDay()
				***
			ENDIF
			
			RETURN .F.
			
		CASE lnSalesID = -5
			MESSAGEBOX([Íåèçâåcòíàÿ îøèáêà],16,[Îøèáêà])
			RETURN .F.
			
		OTHERWISE
			thisform.nsalesid = lnSalesID
	ENDCASE
	*------------------------------------------------------------------------------

	*--Îáíîâèì ñïðàâî÷íèê ñòîëîâ
	_PARAM1 = lnTblType
	_PARAM2 = lnTblPar
	REQUERY([lvOUTableList])
	*-------------------------------------------------------------------------------
IF tnFrmID = 0 &amp;&amp; Áûñòðîå äîáàâëåíèå çàêàçà
	*--îòêðîåì ñ÷åò  è óñòàíîâèì çíà÷åíèÿ ïî óìîë÷àíèþ
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	SELECT lvFrmEdit
	APPEND BLANK
	*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
	lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))
	*------------------------------------------------------------------------------
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnWaiterID, ;  &amp;&amp; ýòî îñòàâèì âðåììåíî - ïîòîì óáåðåì
		 lvFrmEdit.DevCltId WITH lnWaiterID, ;
		 lvFrmEdit.FrmTypeID WITH lnFrmTypeID, ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
	IF TABLEUPDATE(1,.T.,[lvFrmEdit])
.nFrmID = spGetLastIncrementedID([lvFrmEdit])
ELSE
MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ äàííûõ ïðîèçîøëà îøèáêà',0+16,'Ïåðäóïðåæäåíèå')
RETURN .f.
	ENDIF
ENDIF

	*09.04.2006 14:54 -&gt;îáíîâèì Alias-û äëÿ ðåäàêòèðîâàíèÿ çàêàçà (øàïêà è ïîçèöèè)
	_PARAM = .nFrmID
	REQUERY([lvFrmEdit])
	REQUERY([lvOrderTvrView])
	USE lvFrmSumView IN 0

	*--îïðåäåëèì íîìåð ñòîëà (èç íàçâàíèÿ ñòîëà)
	USE IN SELECT([lvOrgUnitEdit])
	_PARAM = lvFrmEdit.PointEmiOUID
	USE lvOrgUnitEdit IN 0

	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

	*--íàïèøåì â çàãîëîâêå ôîðìû íîìåð çàêàçà
	.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)
	.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)

	**.lblEdit.Caption = [Âñåãî: ...]

	*--ïîêàæåì èìÿ êëèåíòà
	.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
	.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width+1)
	.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
	*--åñëè åñòü íîìåð êàðòî÷êè, ïîêàæåì åãî
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0
		
		IF RECCOUNT([lvCardViewByCardID])&gt;0
			.txtCardNo.value = ALLTRIM(lvCardViewByCardID.CardNo)
		ENDIF
	ENDIF
	
	*--îïðåäåëèì âîçìîæíûå âàðèàíòû îïëàòû (â çàâèñèìîñòè îò íàñòðîéêè è êàðòî÷êè)
	.nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
	
	*--äîáàâèì âàðèàíò îïëàòû ïî VIP êàðòå, åñëè ýòî âîçìîæíî
	.addVIP()
	
	*--íàðèñóåì êíîïî÷íîå ìåíþ
	.grdmenu._rsrequery(1)

	*--åñëè ðàáîòàåò ìåíåäæåð, òî çàïðåòèì ðåäàêòèðîâàíèå äàííûõ, äîñòóïíî òîëüêî çàêðûòèå ñìåíû
	IF tlReadOnly
		.lReadOnly = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = .F.
		ELSE
			.cmdDisc.Enabled = .F.
			.cmdNoDisc.Enabled = .F.
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPrint.Enabled = .F.
		.CmdOrderDel.Enabled = .F.
		.CmdCHKBACK.Enabled = .F.
		.CmdPredchk.Enabled = .F.
		.CmdPay.Enabled = .F.
		.CmdManager.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		*--åñëè â çàêàçå óæå åñòü ñêèäêà, òî çàïðåòèì ðåäàêòèðîâàíèå çàêàçà
		lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
		IF FOUND()
			llblock = .T.
		ENDIF
		
		*--åñëè áûë íàïå÷àòàí ïðåä÷åê, òî çàïðåòèì ââîä äàííûõ
		SELECT lvOrderTvrView
		COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

		IF lnPredchk &gt; 0
			llblock = .T.
		ENDIF	
		
		IF llblock
			thisform._block_in(.T.)
		ENDIF
	ENDIF


	*--âîçìîæíû ðàçëè÷íûå âàðèàíòû ïðåäîñòàâëåíèÿ ñêèäêè
	DO CASE
		CASE lnMODEDISC=1
			*--äëÿ Ëèäåðà
			.cntDiscID.Width = .cntDiscID.txtText.Width-1
			.cmdDisc.Left = .cntDiscID.Left+.cntDiscID.Width+1
			.cmdNoDisc.Left = .cmdDisc.Left+.cmdDisc.Width+1
			
		OTHERWISE
			*--äëÿ Êîëüöîâî
			.cmdDisc.Enabled = .F.
			.cmdDisc.Visible = .F.
			.cmdNoDisc.Enabled = .F.
			.cmdNoDisc.Visible = .F.
	ENDCASE
.grdOrder.SetFocus()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRORDEREDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------
*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì lv äëÿ ðåäàêòèðîâàíèÿ äîêóìåíòîâ (ïóñòîé)
USE lvFrmEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
*------------------------------------------------------------------------------

*--Îòêðîåì ñïðàâî÷íèê ñòîëîâ
USE lvOUTableList IN 0 NODATA

*--Îòêðîåì ñïðàâî÷íèê êëèåíòîâ ðåñòîðàíà
USE lvCltRSTList IN 0

*--Îòêðîåì ñïðàâî÷íèê ñêèäîê
USE lvDiscList IN 0

*--îòêðîåì ñïðàâî÷íèê áûñòðîãî âûáîðà áëþä
_PARAM =  VAL(oRes.GetParam([RST],[SETNUM]))
USE lvPOSFuncInSetView IN 0

*--Îòêðîåì ñîäåðæèìîå çàêàçà
USE lvOrderTvrView IN 0 NODATA

*--îòêðîåì lv äëÿ ïðèâÿçîê ïðè÷èí îòêàçà ê áëþäàì (ïðè óäàëåíèè ìåíåäæåðîì) - ïóñòîé
USE lvTvrCncRsnEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvTvrCncRsnEdit])

*--îòêðîåì ñïèñîê ìîäèôèêàòîðîâ (ïóñòîé)
USE lvModList IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModList])

*--ñîçäàäèì ïóñòóþ òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(40),t2 C(40),t3 C(40),t4 C(40),t5 C(40),t6 C(40),t7 C(40))

*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
DODEFAULT()
		thisform.olecommprox1._close()

ENDPROC
PROCEDURE tbloff
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âûêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOff(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
PROCEDURE tblon
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOn(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>nfrmid
lorderpay
_qntintable
ncashno Íîìåð êàññû (óíèêàëüíûé)
nsalesid
ncheckid
nordersum èòîã ïî çàêàçó
lmanagerwork
_menusel îêîí÷àòåëüíûé âûáîð áëþäà èç ìåíþ
lreadonly
nprctypeid èäåíòèôèêàòîð ïðàéñà
lorderdelm ïðèçíàê óäàëåíèÿ âñåãî çàêàçà ìåíåäæåðîì
lblock ôëàã áëîêèðîâêè ââîäà
npayvarnum ÷èñëî âàðèàíòîâ îïëàòû
lorderreturn ôëàã âîçâðàòà
*_ok âûõîä èç ôîðìû ñ ñîõðàíåíèåì
*__storechktrans 
*__storechktrans_pred ïå÷àòü ïðåä÷åêà
*_paintmenu 
*_clickmenu 
*_closeday çàêðûòèå äíÿ (ñìåíû)
*_headerprint 
*__storechktrans_slim ïå÷àòü ÑËÈÌ (ïðè îïëàòå êàðòîé)
*_block_in áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
*getcardinfo 
*addvip 
*__storechktransback ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
*__iscasher 
*_footerprint Ïå÷àòü ïîäâàëà ïðåä÷åêà
*___kkmerrorhandler 
*checkreset 
*_storechecktrans_pred ïå÷àòü ïðåä÷åêà
*tblon Âêëþ÷åíèå áèëüÿðäíîãî ñòîëà
*tbloff Îòêëþ÷åíèå áèëüÿðäíîãî ñòîëà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ôîðìà äëÿ ðåäàêòèðîâàíèÿ çàêàçà ïî Ald</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0RG7Z8</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cnttuchmenumain</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cnttuchmenumain1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 0
Left = 0
Name = "Cnttuchmenumain1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd21.Name = "Cmd21"
Cmd22.Name = "Cmd22"
Cmd31.Name = "Cmd31"
Cmd32.Name = "Cmd32"
Cmd41.Name = "Cmd41"
Cmd42.Name = "Cmd42"
Cmd51.Name = "Cmd51"
Cmd52.Name = "Cmd52"
Cmd61.Name = "Cmd61"
Cmd62.Name = "Cmd62"
Cmd71.Name = "Cmd71"
Cmd72.Name = "Cmd72"
Cmd81.Name = "Cmd81"
Cmd82.Name = "Cmd82"
Cmd91.Name = "Cmd91"
Cmd92.Name = "Cmd92"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0RG7ZC</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cnttuchordinfo</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cnttuchordinfo1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 0
Left = 168
Name = "Cnttuchordinfo1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd3.Name = "Cmd3"
Cmd4.Name = "Cmd4"
Cmd5.Name = "Cmd5"
Cmd6.Name = "Cmd6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0RG7ZG</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cnttuchmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cnttuchmenu1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 52
Left = 168
Name = "Cnttuchmenu1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd3.Name = "Cmd3"
Cmd4.Name = "Cmd4"
Cmd21.Name = "Cmd21"
Cmd22.Name = "Cmd22"
Cmd23.Name = "Cmd23"
Cmd24.Name = "Cmd24"
Cmd31.Name = "Cmd31"
Cmd32.Name = "Cmd32"
Cmd33.Name = "Cmd33"
Cmd34.Name = "Cmd34"
Cmd41.Name = "Cmd41"
Cmd42.Name = "Cmd42"
Cmd43.Name = "Cmd43"
Cmd44.Name = "Cmd44"
Cmd51.Name = "Cmd51"
Cmd52.Name = "Cmd52"
Cmd53.Name = "Cmd53"
Cmd54.Name = "Cmd54"
Cmd61.Name = "Cmd61"
Cmd62.Name = "Cmd62"
Cmd63.Name = "Cmd63"
Cmd64.Name = "Cmd64"
Cmd71.Name = "Cmd71"
Cmd72.Name = "Cmd72"
Cmd73.Name = "Cmd73"
Cmd74.Name = "Cmd74"
Cmd81.Name = "Cmd81"
Cmd82.Name = "Cmd82"
Cmd83.Name = "Cmd83"
Cmd84.Name = "Cmd84"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0RG7ZN</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cnttuchordmanag</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cnttuchordmanag1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 468
Left = 0
Name = "Cnttuchordmanag1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd3.Name = "Cmd3"
Cmd4.Name = "Cmd4"
Cmd5.Name = "Cmd5"
Cmd6.Name = "Cmd6"
Cmd7.Name = "Cmd7"
Cmd8.Name = "Cmd8"
Cmd22.Name = "Cmd22"
Cmd23.Name = "Cmd23"
Cmd24.Name = "Cmd24"
Cmd25.Name = "Cmd25"
Cmd26.Name = "Cmd26"
Cmd27.Name = "Cmd27"
Cmd28.Name = "Cmd28"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0SUJFS</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cntorddetail</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntorddetail1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 0
Left = 608
Name = "Cntorddetail1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd3.Name = "Cmd3"
Cmd21.Name = "Cmd21"
Cmd22.Name = "Cmd22"
Cmd23.Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0SWIKV</uniqueid>
		<timestamp>951872421</timestamp>
		<class>cnttuchordpay</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cnttuchordpay1</objname>
		<parent>frmorderedit_ald</parent>
		<properties>Top = 468
Left = 609
Name = "Cnttuchordpay1"
Cmd1.Name = "Cmd1"
Cmd2.Name = "Cmd2"
Cmd21.Name = "Cmd21"
Cmd22.Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmorderedit_ald</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951873011</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttxtinfo</objname>
		<parent/>
		<properties>Width = 96
Height = 36
BorderWidth = 2
Name = "cnttxtinfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>èíôîðìàöèÿ î çàêàçå â êðàñèâîì âèäå</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0TEMO5</uniqueid>
		<timestamp>951872871</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>cnttxtinfo</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontSize = 10
Caption = "Èòîãî"
Height = 16
Left = 4
Top = 2
Width = 38
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0TEMO6</uniqueid>
		<timestamp>951873011</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>cnttxtinfo</parent>
		<properties>AutoSize = .F.
FontBold = .T.
FontSize = 10
Alignment = 1
Caption = "9999999.99"
Height = 15
Left = 24
Top = 18
Width = 69
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttxtinfo</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_QYW0ZV9O9</uniqueid>
		<timestamp>951877268</timestamp>
		<class>commandbutton</class>
		<classloc/>
		<baseclass>commandbutton</baseclass>
		<objname>cmd</objname>
		<parent/>
		<properties>Height = 25
Width = 100
WordWrap = .T.
Caption = ""
starting = 
Name = "cmd"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðè íàæàòèè êíîïêè ìåíþ ðàñêðîåì äåðåâî äëÿ äàëüíåéøåãî âûáîðà èëè ñäåëàåì âûáîð
LPARAMETERS tcNM
LOCAL _PARAM, lcModList, lnModID

IF !thisform.lReadOnly AND !thisform.lblock
	IF !thisform._menusel
		IF !EMPTY(tcNM) AND tcNM&lt;&gt;[ïóñòî]
			*--ðàñêðûâàåì äàëüøå
			thisform.grdmenu._rsrequery(2,tcNM)
			thisform._menusel = .T.
			thisform.lblPar.Visible = .T.
			thisform.lblPar.caption = ALLTRIM(tcNM)
		ENDIF
	ELSE
		*--äåëàåì âûáîð
		SELECT curBuild
		LOCATE FOR ALLTRIM(curBuild.NM)==ALLTRIM(tcNM)
				
		IF FOUND()
			*--äîáàâèì áëþäî â çàêàç
			thisform.grdOrder._add(curBuild.ID)	
			
			*--ïîëó÷èì ñïèñîê ìîäèôèêàòîðîâ äëÿ äàííîãî áëþäà
			_PARAM = curBuild.ID
			REQUERY([lvModList])
			
			*--åñëè ñïèñîê ìîäèôèêàòîðîâ íåïóñò, ïîêàæåì åãî
			IF RECCOUNT([lvModList])&gt;0
				lcModList = oApp.DoModalFormRetValObj([FrmModList;rst_v1.vcx],_PARAM)
			ENDIF
			
			*--åñëè ÷òî-òî âûáðàëè, òî äîáàâèì â çàêàç
			IF TYPE([lcModList])==[C] AND !EMPTY(lcModList)
				DO WHILE !EMPTY(lcModList)
					*--âûäåëèì ID ìîäèôèêàòîðà èç ñïèñêà
					lnModID = VAL(LEFT(lcModList,AT([,],lcModList)-1))
					
					*--äîáàâèì â çàêàç
					thisform.grdOrder._add(lnModID)	
					
					*--îáðåæåì ñïèñîê
					lcModList = RIGHT(lcModList,LEN(lcModList)-AT([,],lcModList))
				ENDDO
			ENDIF
		ELSE
			IF !EMPTY(tcNM)
				MESSAGEBOX([Íå íàéäåí òîâàð ]+ALLTRIM(tcNM),48,[Îêíî ñîîáùåíèé])
			ENDIF
		ENDIF		
	ENDIF
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>starting Íàçâàíèå îïåðàöèè, êîòîðóþ çàïóñêàåò äàííàÿ êíîïî÷êà
</reserved3>
		<reserved4>..\bitmaps\pushb.bmp</reserved4>
		<reserved5>..\bitmaps\pushb.bmp</reserved5>
		<reserved6>Pixels</reserved6>
		<reserved7>Áàçîâûé êëàññ CommandButton äëÿ TuchPad</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cmd</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951877294</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchordpay</objname>
		<parent/>
		<properties>Width = 192
Height = 92
Name = "cnttuchordpay"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch îïëàòû çàêàçà Ald 1*2+1*2 êíîïîê </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951877217</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttuchordpay</parent>
		<properties>Top = 0
Left = 0
Height = 46
Width = 96
FontBold = .T.
Picture = ..\graphic\bank_.gif
DownPicture = ..\graphic\bank_pr.gif
Caption = "íàëè÷íûìè"
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951877294</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttuchordpay</parent>
		<properties>Top = 0
Left = 96
Height = 46
Width = 96
FontBold = .T.
Caption = "äðóãèå ñïîñîáû îïëàòû"
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>951877217</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cnttuchordpay</parent>
		<properties>Top = 46
Left = 0
Height = 46
Width = 96
FontBold = .T.
Picture = ..\graphic\servis_printer2007.gif
Caption = "ìàðêà"
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951877217</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttuchordpay</parent>
		<properties>Top = 46
Left = 96
Height = 46
Width = 96
FontBold = .T.
Caption = "ÎÊ"
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchordpay</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951881212</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchordmanag</objname>
		<parent/>
		<properties>Width = 608
Height = 92
Name = "cnttuchordmanag"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>16</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch óïðàâëåíèÿ çàêàçîì Ald 7*2+1 êíîïîê </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 0
Height = 92
Width = 84
FontBold = .T.
Caption = "îòìåíèòü"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 84
Height = 46
Width = 84
FontBold = .T.
Caption = "Ìîäèô- ôèêàòîðû"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd3</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 169
Height = 46
Width = 73
FontBold = .T.
Caption = "îòìåíèòü ïîçèöèþ"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd4</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 242
Height = 46
Width = 73
FontBold = .T.
Caption = "ïîâòîðèòü ïîçèöèþ"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd5</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 315
Height = 46
Width = 73
FontBold = .T.
Caption = "îòëîæèòü ïîäà÷ó"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd6</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 388
Height = 46
Width = 73
FontBold = .T.
Caption = "ðàçäåëèòü çàêàç"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd7</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 461
Height = 46
Width = 73
FontBold = .T.
Caption = "ñëîæèòü çàêàçû"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd8</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 0
Left = 534
Height = 46
Width = 73
FontBold = .T.
Caption = "ïðî÷èå äåéñòâèÿ"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 84
Height = 46
Width = 84
FontBold = .T.
Caption = "ïîëîâèíà áîëþäà"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd23</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 169
Height = 46
Width = 73
FontBold = .T.
Caption = "îïèñàíèå áëþäà"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd24</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 242
Height = 46
Width = 73
FontBold = .T.
Caption = "êîëè- ÷åñòâî"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd24"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA02X99M</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd25</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 315
Height = 46
Width = 73
FontBold = .T.
Caption = "Ñêèäêà"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd25"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd26</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 388
Height = 46
Width = 73
FontBold = .T.
Caption = "íàäáàâêè"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd26"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S60XPNMV</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd27</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 461
Height = 46
Width = 73
FontBold = .T.
Caption = "â äîëã"
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd27"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881212</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd28</objname>
		<parent>cnttuchordmanag</parent>
		<properties>Top = 46
Left = 534
Height = 46
Width = 73
FontBold = .T.
ForeColor = 255,255,255
BackColor = 192,192,192
Name = "Cmd28"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchordmanag</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>951881330</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cnttuchordinfo</objname>
		<parent/>
		<properties>Width = 440
Height = 52
Name = "cnttuchordinfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>êëàâèàòóðà tuch èçìåíåíèÿ äàííûõ î çàêàçå Ald 6 êíîïîê </reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 1
Height = 52
Width = 73
FontBold = .T.
Caption = "Íîâûé çàêàç"
Name = "Cmd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd2</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 74
Height = 52
Width = 73
FontBold = .T.
Caption = " Êàðòà  ãîñòÿ"
Name = "Cmd2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd3</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 147
Height = 52
Width = 73
FontBold = .T.
Caption = "Ñîîáùåíèå"
Name = "Cmd3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd4</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 220
Height = 52
Width = 73
FontBold = .T.
Caption = "Êîëè- ÷åñòâî ãîñòåé"
Name = "Cmd4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd5</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 293
Height = 52
Width = 73
FontBold = .T.
Caption = "Âûáðàòü ñòîëèê"
Name = "Cmd5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>951881330</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd6</objname>
		<parent>cnttuchordinfo</parent>
		<properties>Top = 0
Left = 366
Height = 52
Width = 73
FontBold = .T.
Caption = "Äðóãèå çàêàçû"
Name = "Cmd6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cnttuchordinfo</objname>
		<parent/>
		<properties>Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>951881481</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmordereditexclusiv</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 600
Width = 800
ShowWindow = 1
DoCreate = .T.
AutoCenter = .F.
BorderStyle = 2
Caption = ""
ControlBox = .F.
Closable = .F.
Movable = .F.
ClipControls = .F.
BackColor = 241,239,241
nfrmid = 0
lorderpay = .F.
_qntintable = .T.
ncashno = 0
nsalesid = 0
ncheckid = 0
nordersum = 0
lmanagerwork = .F.
_menusel = .F.
lreadonly = .F.
nprctypeid = 0
lorderdelm = .F.
lblock = .F.
npayvarnum = 0
lorderreturn = .F.
Name = "frmordereditexclusiv"
cstmsghandler.Top = 32
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 32
cstresizable.Left = 22
cstresizable.Name = "cstresizable"
Img1.Left = -122
Img1.Top = 73
Img1.Name = "Img1"
cstdatawork.Top = 32
cstdatawork.Left = 44
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE ___kkmerrorhandler
RETURN
LPARAMETERS tcErrorMsg, ;
			tlNoReset
******    ÏÅÐÅÍÎÑÈÌ  Â ÄÐÀÉÂÅÐ Ôèñêàëüíèêà   **********************
****** Âûçîâ âñòðå÷àåòñÿ 5 ðàç
*11.10.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnECRAdvancedMode, ;
		lnCheckID, ;
		loStatus
***
lnCheckID = This.nCheckID
*------------------------------------------------------------------------------

WITH This

*11.10.2006 16:53 -&gt;Ñîõðàíèì ñîîáùåíèå â ëîãå
IF VARTYPE(tcErrorMsg) == [C]
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + tcErrorMsg,[KKM.LOG],1)
ENDIF
*------------------------------------------------------------------------------

*16.10.2006 15:38 -&gt;
loStatus = oApp.CreateObject([frmKKMStatus;pos_v1.vcx],.Shtrih)

loStatus.Show(1)

IF loStatus.uRetVal
	IF NOT tlNoReset
		.CheckReset()
	ELSE
		.Shtrih.CancelCheck()
	ENDIF
ELSE
	.Shutdown(.T.)
ENDIF
*------------------------------------------------------------------------------

*!*	*12.10.2006 10:15 -&gt;Ïûòàåìñÿ îáðàáîòàòü îøèáêó
*!*	DO WHILE .T.

*!*	*11.10.2006 17:04 -&gt;Ïîëó÷èì ïîäðåæèì ÊÊÌ
*!*	lnECRAdvancedMode = .Shtrih.GetECRAdvancedMode(.T.)
*!*	*------------------------------------------------------------------------------

*!*	*11.10.2006 17:10 -&gt;Àíàëèçèðóåì ïîäðåæèì
*!*	DO CASE
*!*		CASE BETWEEN(.Shtrih.ErrorCode,-6,-1)
*!*			.Shtrih.Beep()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,1,2)
*!*			MESSAGEBOX([Âñòàâüòå ðóëîí áóìàãè â ÊÊÌ],64,[Ïðåäóïðåæäåíèå])
*!*			LOOP
*!*		CASE lnECRAdvancedMode = 3
*!*			.Shtrih.ContinuePrint()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,4,5)
*!*			LOOP
*!*		OTHERWISE
*!*			***
*!*			IF NOT tlNoReset
*!*				.CheckReset()
*!*			ELSE
*!*				.Shtrih.CancelCheck()
*!*			ENDIF
*!*			***
*!*			EXIT
*!*	ENDCASE
*!*	*------------------------------------------------------------------------------

*!*	ENDDO
*------------------------------------------------------------------------------
*********** ÏÅÐÅÍÎÑÈÌ
*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
spSaleFiscError(lnCheckID)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE __iscasher
RETURN
*-- ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, ÿâëÿåòñÿ ëè äàííûé îôèöèàíò êàññèðîì
LOCAL _PARAM

USE IN SELECT([lvcashierByCltView])
_PARAM = spUserClt()
USE lvcashierByCltView IN 0

IF RECCOUNT([lvcashierByCltView])&lt;=0
	MESSAGEBOX([Äàííûé îôèöèàíò íå ÿâëÿåòñÿ êàññèðîì],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ELSE
	RETURN .T.
ENDIF
ENDPROC
PROCEDURE __storechktrans
RETURN
*----- ÏÅÐÅÍÎÑÈÌ -------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: tfsctype - òèï îïëàòû, tfscexp - ïàðàìåòðû ôèñêàëüíîãî ÷åêà
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå òðàíçàêöèè ÷åêà
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype, tfscexp

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lnDiscount, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

lfsctype = tfsctype
ls1 = VAL(SUBSTR(tfscexp,AT([(],tfscexp)+1,AT([,],tfscexp,1)-AT([(],tfscexp)-1))
ls2 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,1)+1,AT([,],tfscexp,2)-AT([,],tfscexp,1)-1))
ls3 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,2)+1,AT([,],tfscexp,3)-AT([,],tfscexp,2)-1))
ls4 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,3)+1,AT([)],tfscexp)-AT([,],tfscexp,3)-1))


*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*------------------------------------------------------------------------------

WITH This

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,1,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

*--Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID

	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleTran(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------

	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.CheckDiscount(lnDiscount)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	
	*--Ïðèâÿçûâàåì äèñêîíòíóþ êàðòó ê ÷åêó
	spBindDisc(.nCheckID,VAL(lvFrmEdit.FrmNote))

	*--Äîáàâëÿåì ïîçèöèþ ñêèäêè  â ÷åê
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
	
	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECCOUNT([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 7, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lnDiscTvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH 1, ;
		lvCheckTransEdit.CheckTransPrc		WITH lnDiscount ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------
ENDIF


*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	

*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF

*------------------------------------------------------------------------------

WAIT CLEAR
RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE __storechktrans_pred
RETURN
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This

*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
						IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
						+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
						[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

.Shtrih.PrintString(REPLICATE([-],60))

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

IF lcnt&lt;30
	.Shtrih.FeedDocument(30-lcnt)
ENDIF

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._FooterPrint()

.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
ThisForm.grdOrder._RSRequery()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktrans_slim
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPredChk.Click()&gt;
* Parameters......: tCardID
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ÑËÈÏ (ïðè îïëàòå êàðòîé)
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETERS tCardID

MESSAGEBOX('Ìåòîä â äðóãîé áèáëèîòåêå' , 0+16 , 'Ñîîáùèòå îá ýòîì ðàçàðáîò÷èêó')
RETURN

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lcnt, ;
		lCardID, ;
		lCardNo, ;
		lFIO, ;
		_PARAM

*--ïîëó÷èì èíôîðìàöèþ ïî êàðòå
lCardID = tCardID
lCardNo = []

USE IN SELECT([lvCardViewByCardID])
_PARAM = lCardID
USE lvCardViewByCardID IN 0

IF RECCOUNT([lvCardViewByCardID])&gt;0
	lFIO = lvCardViewByCardID.CltNM
	lCardNo = lvCardViewByCardID.CardNo
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This
*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÑËÈÏ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*12.04.2006 17:22 -&gt;Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,30)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,3)),10)+[*]+ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),40,[ ]))

IF lcnt&lt;15
	.Shtrih.FeedDocument(12-lcnt)
ELSE
	.Shtrih.FeedDocument(3)
ENDIF

IF !EMPTY(lCardID)
	*--Ðàñïå÷àòàåì èíôîðìàöèþ ïî  VIP êàðòå
	.Shtrih.PrintString([¹ êàðòû ]+ALLTRIM(lCardNo))

	IF !EMPTY(lFIO)
		.Shtrih.PrintString(ALLTRIM(lFIO))
	ENDIF
ENDIF

.Shtrih.FeedDocument(1)
.Shtrih.PrintString([Ïîäïèñü]+PADL([_____________________________],35,[ ]))
.Shtrih.FeedDocument(1)
.Shtrih.PrintString(REPLICATE([=],60))
.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*--Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktransback
RETURN
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTransBACK
* Called by.......: &lt;cmdCHKBACK.Click()&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ôèñêàëüíûé ÷åê íà âîçâðàò
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype

LOCAL   lcUniqueFileNM, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

WITH This

*--ñôîðìèðóåì âûðàæåíèå äëÿ ñóìì â çàâèñèìîñòè îò òèïà îïëàòû
lfsctype = tfsctype
ls1 = IIF(lfsctype=1,.nordersum,0) &amp;&amp;--îïëàòà íàëè÷íûìè
ls2 = IIF(lfsctype=2,.nordersum,0) &amp;&amp;--îïëàòà áàíêîâñêîé êàðòîé
ls3 = IIF(lfsctype=3,.nordersum,0) &amp;&amp;--îïëàòà êóïîíîì
ls4 = IIF(lfsctype=4,.nordersum,0) &amp;&amp;--îïëàòà VIP êàðòîé

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,2,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()

*--Îòêðûâàåì ÄÌ äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN ALL
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleReturn(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
	

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF
*------------------------------------------------------------------------------

RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE _block_in
*--áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
LPARAMETERS tblock

LOCAL ldiscount, ;
	  lpredchk, ;
	  lkol,;
	  lnMODEDISC

*--îïðåäåëèì, áûëà ëè ñäåëàíà ñêèäêà ïî çàêàçó
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
IF FOUND()
	ldiscount = .T.
ENDIF

*--îïðåäåëèì, áûë ëè íàïå÷àòàí ïðåä÷åê ïî çàêàçó
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lkol

IF lkol &gt; 0
	lpredchk = .T.
ENDIF

*--îïðåäåëèì ðåæèì ñêèäêè
lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))
		
WITH thisform
	IF tblock
		*--çàáëîêèðóåì ââîä
		.lblock = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		*--â çàâèñèìîñòè îò ðåæèìà ñêèäêè
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ELSE
			.cmdDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
			.cmdNoDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPredchk.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		.CmdDelM.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
		.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width)
		.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
		IF ldiscount
			*--ðàçáëîêèðóåì òîëüêî äâå êíîïêè (åñëè ñíÿëè ïðåä÷åê, íî åñòü ñêèäêà)
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.CmdPredchk.Enabled = .T.
		ELSE
			*--ðàçáëîêèðóåì ââîä
			.lblock = .F.
			.GrdOrder.ReadOnly = .F.
			.GrdMenu.ReadOnly = .F.
			.TxtAttr.ReadOnly = .F.
			.cntOUTableID.Enabled = .T.
			
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.Cntnumericpad1.ImgButton1.Enabled = .T.
			.Cntnumericpad1.ImgButton2.Enabled = .T.
			.Cntnumericpad1.ImgButton3.Enabled = .T.
			.Cntnumericpad1.ImgButton4.Enabled = .T.
			.Cntnumericpad1.ImgButton5.Enabled = .T.
			.Cntnumericpad1.ImgButton6.Enabled = .T.
			.Cntnumericpad1.ImgButton7.Enabled = .T.
			.Cntnumericpad1.ImgButton8.Enabled = .T.
			.Cntnumericpad1.ImgButton9.Enabled = .T.
			.Cntnumericpad1.ImgButton0.Enabled = .T.
			.Cntnumericpad1.ImgButtonDelete.Enabled = .T.
			.Cntnumericpad1.ImgButtonPoint.Enabled = .T.
			.CmdUp.Enabled = .T.
			.CmdPlus.Enabled = .T.
			.CmdMinus.Enabled = .T.
			.CmdDel.Enabled = .T.
			.CmdDevOrder.Enabled = .T.
			.txtbarcod.Enabled = .T.
			.cmdEnter.Enabled = .T.
			.CmdPredchk.Enabled = .T.
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE _clickmenu
*--ïðè íàæàòèè êíîïêè ìåíþ ðàñêðîåì äåðåâî äëÿ äàëüíåéøåãî âûáîðà èëè ñäåëàåì âûáîð
LPARAMETERS tcNM
LOCAL _PARAM, lcModList, lnModID

IF !thisform.lReadOnly AND !thisform.lblock
	IF !thisform._menusel
		IF !EMPTY(tcNM) AND tcNM&lt;&gt;[ïóñòî]
			*--ðàñêðûâàåì äàëüøå
			thisform.grdmenu._rsrequery(2,tcNM)
			thisform._menusel = .T.
			thisform.lblPar.Visible = .T.
			thisform.lblPar.caption = ALLTRIM(tcNM)
		ENDIF
	ELSE
		*--äåëàåì âûáîð
		SELECT curBuild
		LOCATE FOR ALLTRIM(curBuild.NM)==ALLTRIM(tcNM)
				
		IF FOUND()
			*--äîáàâèì áëþäî â çàêàç
			thisform.grdOrder._add(curBuild.ID)	
			
			*--ïîëó÷èì ñïèñîê ìîäèôèêàòîðîâ äëÿ äàííîãî áëþäà
			_PARAM = curBuild.ID
			REQUERY([lvModList])
			
			*--åñëè ñïèñîê ìîäèôèêàòîðîâ íåïóñò, ïîêàæåì åãî
			IF RECCOUNT([lvModList])&gt;0
				lcModList = oApp.DoModalFormRetValObj([FrmModList;rst_v1.vcx],_PARAM)
			ENDIF
			
			*--åñëè ÷òî-òî âûáðàëè, òî äîáàâèì â çàêàç
			IF TYPE([lcModList])==[C] AND !EMPTY(lcModList)
				DO WHILE !EMPTY(lcModList)
					*--âûäåëèì ID ìîäèôèêàòîðà èç ñïèñêà
					lnModID = VAL(LEFT(lcModList,AT([,],lcModList)-1))
					
					*--äîáàâèì â çàêàç
					thisform.grdOrder._add(lnModID)	
					
					*--îáðåæåì ñïèñîê
					lcModList = RIGHT(lcModList,LEN(lcModList)-AT([,],lcModList))
				ENDDO
			ENDIF
		ELSE
			IF !EMPTY(tcNM)
				MESSAGEBOX([Íå íàéäåí òîâàð ]+ALLTRIM(tcNM),48,[Îêíî ñîîáùåíèé])
			ENDIF
		ENDIF		
	ENDIF
ENDIF
ENDPROC
PROCEDURE _closeday
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmorderedit.CloseDay
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàêðûòèå ñìåíû
*------------------------------------------------------------------------------

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSalesID, ;
		_PARAM, ;
	    _PARAM_DOP

WITH This
*--Ïðîâåðèì íåîáõîäèìîñòü çàêðûòèÿ ñìåíû
IF .nSalesID = 0
	lnSalesID = spGetOpenDay(.nCashNo,.T.)
	DO CASE
		CASE lnSalesID &gt; 0
			.nSalesID = lnSalesID
		CASE lnSalesID = 0
			MESSAGEBOX([Ñìåíà íå îòêðûòà.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
		OTHERWISE
			MESSAGEBOX([Ëîêàëüíàÿ ñìåíà óæå çàêðûòà]+CHR(13)+;
					[Äëÿ çàêðûòèÿ îáùåé ñìåíû îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
	ENDCASE
ENDIF

*--äëÿ Ëèäåðà ïðîâåðèì íàëè÷èå íåîïëà÷åííûõ çàêàçîâ
IF VAL(oRes.GetParam([RST],[CLOSEDAY]))=1 &amp;&amp;--ìîæíî îòêëþ÷èòü ýòó ïðîâåðêó
	*--îòêðîåì ñïèñîê âñåõ íåîïëà÷åííûõ çàêàçîâ
	_PARAM = VAL(oRes.GetParam([RST],[TYPEORD]))
	_PARAM_DOP = VAL(oRes.GetParam([RST],[TBLPAR]))
	USE IN SELECT([lvMgrView])
	USE lvMgrView IN 0
	IF RECCOUNT([lvMgrView])&gt;0
		MESSAGEBOX([Íåëüçÿ çàêðûòü ñìåíó ïðè íàëè÷èè íåîïëà÷åííûõ çàêàçîâ.]+CHR(13)+;
					[Äëÿ ïðîñìîòðà âñåõ íåîïëà÷åííûõ çàêàçîâ âîñïîëüçóéòåñü êàðòî÷êîé ìåíåäæåðà.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
ENDIF

*------------------------------------------------------------------------------

*12.04.2006 14:01 -&gt;Çàêðûâàåì ëîêàëüíûé äåíü
spSaleCloseDay(.nSalesID,.nCashNo)
*------------------------------------------------------------------------------

*--Ïå÷àòàåì Z-îò÷åò
	*13.04.2006 16:22 -&gt;Ïå÷àòàåì Z-îò÷åò
	LOCAL lcIniFileName ,lcKkmLib
	lcIniFileName = FULLPATH([KKM.INI])
	lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
	this.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

	this.Shtrih.CloseShift()
	This.Shtrih.Release()
	*------------------------------------------------------------------------------
*------------------------------------------------------------------------------

*--Ñáðîñèì íîìåð ñìåíû(ïðîäàæ)
.nSalesID = 0
*------------------------------------------------------------------------------

*--ñáðîñèì àâòîíóìåðàòîð
spResetAutoNum(VAL(oRes.GetParam([RST],[TYPEORD])))

MESSAGEBOX([Ëîêàëüíàÿ ñìåíà çàêðûòà.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó äëÿ çàêðûòèÿ îáùåé ñìåíû.],64,[Îêíî ñîîáùåíèé])
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************



ENDPROC
PROCEDURE _footerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì ïîäâàë ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcFooterFile, lnHandleFile, lcLine

lcFooterFile = ALLT(oRes.GetParam([RST],[CHKFTRFL]))
lcFooterFile = IIF(AT([.],lcFooterFile)=0,lcFooterFile+[.TXT],lcFooterFile)

IF !EMPTY(lcFooterFile) AND FILE(lcFooterFile)
	lnHandleFile = FOPEN(lcFooterFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _headerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcHeaderFile, lnHandleFile, lcLine

lcHeaderFile = ALLT(oRes.GetParam([RST],[CHKHDRFL]))
lcHeaderFile = IIF(AT([.],lcHeaderFile)=0,lcHeaderFile+[.TXT],lcHeaderFile)

IF !EMPTY(lcHeaderFile) AND FILE(lcHeaderFile)
	lnHandleFile = FOPEN(lcHeaderFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _ok
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDEREDIT._OK()
* Called by.......: frmOrderEdit.lblEdit.Click()
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------

LOCAL	llResSaveOrd, ;
		llDataChanged

WITH This			
	
	*--Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*--Ïîäãîòîâèìñÿ ê ñîõðàíåíèþ äàííûõ
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åíà àâòîíóìåðàöèÿ, ïðîèçâîäèì àâòîìàòè÷åñêóþ âñòàâêó íîìåðà çàêàçà
	IF .chkFrmAutoNum.Value
		REPLACE FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,lvFrmEdit.FrmDate,lvFrmEdit.PointEmiOUID) IN lvFrmEdit
	ENDIF
	*-- Îòìå÷àåì äàòó ïîñëåäíåãî èçìåíåíèÿ
	REPLACE FrmDateAcc WITH DATETIME() IN lvFrmEdit
	
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã óäàëåíèÿ çàêàçà ìåíåäæåðîì, ïîìåíÿåì åãî àòðèáóòû
	IF .lorderDelM
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,30) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã âîçâðàòà, óêàæåì ýòî â àòðèáóòàõ çàêàçà
	IF .lOrderReturn
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,0) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------
	
	*-- ÎÑÒÀÅÒÑß Ïðîèçâîäèì ñîõðàíåíèå øàïêè çàêàçà
	llDataChanged = .cstDataWork.DataChanged([lvFrmEdit],.T.)
	IF llDataChanged
		llResSaveOrd = .cstDataWork.Save([lvFrmEdit])
	ELSE
		llResSaveOrd = .T.
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Îáðàáîòàåì ðåçóëüòàòû ÂÑÅÕ îïåðàöèé ñîõðàíåíèÿ
	IF llResSaveOrd
		*--Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		.uRetVal = .T.
	ELSE
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		.uRetVal = .F.
	ENDIF
ENDWITH
*------------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _paintmenu
*--íàðèñóåì ìåíþ ñ êíîïêàìè
LPARAMETERS tnVar, tnIDSET
LOCAL i, lcexp, _PARAM

*--ñíà÷àëà âûáåðåì äàííûå âî âðåìåííûé êóðñîð, ïî êîòîðîìó áóäåò ñòðîèòüñÿ ìåíþ
DO CASE
	CASE tnVar = 1
		SELECT ;
			lvPOSFuncInSetView.NM AS NM, ;
			lvPOSFuncInSetView.ID AS ID ;
		FROM lvPOSFuncInSetView ;
		INTO CURSOR curBuild NOFILTER

	CASE tnVar = 2
		USE IN SELECT([lvTvrInSetView])
		_PARAM = tnIDSET
		USE lvTvrInSetView IN 0	
			
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð ïðàéñà
		USE IN SELECT([lvTvrSetInfo])
		_PARAM = tnIDSET
		USE lvTvrSetInfo IN 0
		ThisForm.nPrcTypeID = lvTvrSetInfo.PrcTypeID
		*------------------------------------------------------------------------------
			
		SELECT ;
			lvTvrInSetView.TvrNM AS NM, ;
			lvTvrInSetView.TvrID AS ID ;
		FROM lvTvrInSetView ;
		INTO CURSOR curBuild NOFILTER
	
ENDCASE

*--ïîñòðîèì ïî ýòîìó êóðñîðó  òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(80),t2 C(80),t3 C(80),t4 C(80),t5 C(80),t6 C(80),t7 C(80))

*--çàïîëíèì òàáëèöó äëÿ ìåíþ
i = 1
SELECT tmpmenu
APPEND BLANK

SELECT curBuild
GO TOP
DO WHILE !EOF([curBuild])
	IF i&lt;=thisform.GrdMenu.ColumnCount
		lcexp = [REPL tmpmenu.t]+ALLTRIM(STR(i))+[ WITH NVL(curBuild.NM,'ïóñòî')]
		&amp;lcexp
		i = i+1
		SKIP 1
	ELSE
		*--ïåðåéäåì íà çàïîëíåíèå íîâîé ñòðîêè
		i = 1
		SELECT tmpmenu
		APPEND BLANK
	ENDIF
	SELECT curBuild
ENDDO

SELECT tmpmenu
GO TOP
ENDPROC
PROCEDURE _storechecktrans_pred
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmPayment._StoreCheckTrans_pred
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = UPPER(ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName))) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì

WITH This

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

IF !lcKkmLib  = [SPARK]

				.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

				*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
				LOCAL   _PARAM

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._HeaderPrint()

				*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
				.Shtrih.FeedDocument(2)
				.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
				.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
				*-* 20080410 äîáàëåíî âðåìÿ îòêðûòèÿ çàêàçà
				.Shtrih.PrintString([Íîìåð çàêàçà:]+PADR(ALLTRIM(lvFrmEdit.FrmNum),10,[ ])+[Îòêðûò:]+ TTOC(lvFrmEdit.FrmDate))
				.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
				.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
				.Shtrih.FeedDocument(3)
				.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
				.Shtrih.FeedDocument(3)

				*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
				lcnt = 0
				SELECT lvOrderTvrView
				GO TOP
				SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
					lcnt = lcnt+1
					*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
					.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
										IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
										+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
										[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
				 	*------------------------------------------------------------------------------

					*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
					IF .Shtrih.ErrorCode # 0
						STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
								  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
								  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
								  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
								  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
								
						*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
						spSaleFiscError(.nCheckID)
						*------------------------------------------------------------------------------
				    RETURN .F.
					ENDIF
					*------------------------------------------------------------------------------
					SELECT lvOrderTvrView
				ENDSCAN

				.Shtrih.PrintString(REPLICATE([-],50))

				*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
				SELECT lvOrderTvrView
				LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
				IF FOUND()
					lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
					.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
				ENDIF

				*--Ïå÷àòàåì èòîã ÷åêà
				.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

				IF lcnt&lt;10
					.Shtrih.FeedDocument(10-lcnt)
					else
					.Shtrih.FeedDocument(3)
				ENDIF

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._FooterPrint()

				.Shtrih.FeedDocument(3)
				.Shtrih.CutCheck()
				*------------------------------------------------------------------------------

				*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
				IF .Shtrih.ErrorCode # 0
					STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
							  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
							  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
							  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
							
					*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
					spSaleFiscError(.nCheckID)
				    RETURN .F.
					*------------------------------------------------------------------------------
							
				ENDIF
				*------------------------------------------------------------------------------
				This.Shtrih.Release()

	ELSE
	this.printpredtoprint()
ENDIF

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	SELECT lvOrderTvrEdit
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
RETURN .T.
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE addvip
LOCAL _PARAM

WITH thisform
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		*--Ïðîâåðèì, ÿâëÿåòñÿ ëè ýòà êàðòà ïëàòèíîâîé èëè çîëîòîé
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0

		IF RECCOUNT([lvCardViewByCardID])&gt;0 AND ;
			(lvCardViewByCardID.CardTypeID = 1 OR lvCardViewByCardID.CardTypeID = 2) AND;
			!([5]$.nPayVarNum)
			
			.nPayVarNum = .nPayVarNum + [,5]
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE checkreset
*------- ÏÅÐÅÍÎÑÈÌ -----------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.CHECKRESET
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñáðîñ ÷åêà
*-------- ÏÅÐÅÍÎÑÈÌ ----------------------------------------------------------------------

WITH This

*16.04.2006 10:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnCheckID
***
lnCheckID = .nCheckID
*------------------------------------------------------------------------------

IF RECCOUNT([lvOrderTvrView])#0

	*12.04.2006 18:34 -&gt;Ñáðîñèì ÷åê íà ÔÐ
	.Shtrih.CancelCheck()
	*------------------------------------------------------------------------------

	*16.04.2006 10:26 -&gt;
	IF .Shtrih.ErrorCode # 0
	
		*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ñáðîñå ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(lnCheckID)), .T.)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

	*16.04.2006 10:27 -&gt;Îòìåòèì, ÷òî ÷åê ñáðîøåí îïåðàòîðîì
	spCheckSaleSucces(lnCheckID)
	*------------------------------------------------------------------------------

	*12.04.2006 15:32 -&gt;Ñáðîñèì ÷åê
	spCheckReset(.nCheckID)	
	*------------------------------------------------------------------------------

	
	.nCheckID = 0
ENDIF

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

*--ïðîâåðèì, íå çàáëîêèðîâàí ëè ââîä
IF thisform.lReadOnly
	MESSAGEBOX([Èçìåíåíèå äàííûõ ìåíåäæåðîì íå ïðåäóñìîòðåíî.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.cntCltID.SetValue(lvCardViewByCardCode.CltID)
		.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð VIP êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspCltSAccID WITH lvCardViewByCardCode.CardID
				
		*--Äîáàâèì âîçìîæíîñòü âûáðàòü òèï îïëàòû VIP êàðòîé
		thisform.addVIP()
	ENDIF
	thisform.cmdpay.Click()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE GotFocus
DODEFAULT()
		thisform.olecommprox1._open()

ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnFrmTypeID - òèï äîêóìåíòà
* Returns.........: &lt;none&gt;
* LastEditDate....: 26 October 2006
* Notes...........: &lt;~&gt;
*------------------------------------------------------------------------------
LPARAMETERS tnFrmID, tlReadOnly

LOCAL	lnDefClt, ;
		lnTblType, ;
		lnTblPar, ;
		lnWaiterID, ;
		_PARAM1, ;
	_PARAM2, ;
	_PARAM, ;
	lcTableNM, ;
	lnPredchk, ;
	lnDiscTvrID, ;
	llblock, ;
	lnSalesID, ;
	lnMODEDISC


*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------
WITH thisform
	*--ID çàêàçà
	.nFrmID = tnFrmID
	
	.lblFrmId.Caption = ALLTRIM(STR(tnFrmID,10))

	*--Íîìåð ìàøèíû (êàññû)
	.nCashNo = VAL(oRes.GetParam([RST],[CASH]))

	*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
	lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

	*--ïîëó÷èì òèï ïîäðàçäåëåíèÿ "ñòîë"
	lnTblType = VAL(oRes.GetParam([RST],[TBLTYPE]))

	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))

	*--ïîëó÷èì êîä òåêóùåãî îôèöèàíòà
	lnWaiterID = spUserClt()
	
	*--ïîëó÷èì ðåæèì ñêèäêè
	lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))	
	*------------------------------------------------------------------------------

	*--  ÏÅÐÅÍÎÑÈÌ  Â ÔÓÍÊÖÈÈ ÌÅÍÅÄÆÅÐÀ îïðåäåëèì äîñòóïíîñòü êíîïîê X-îò÷åò è Z-îò÷åò äëÿ äàííîãî ïîëüçîâàòåëÿ
	.cmdClose.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[ZACC])
	.cmdXReport.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[XACC])

	*--------------------------------------------------------------------------------
	*--Ïîëó÷àåì èäåíòèôèêàòîð íåçàêðûòîé ñìåíû
	lnSalesID = spGetOpenDay(This.nCashNo)

	*--Ïðîâåðèì êîððåêòíîñòü äàííûõ î ïðîäàæàõ
	DO CASE
		CASE lnSalesID = -1
			MESSAGEBOX([Äåíü óæå çàêðûò.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE INLIST(lnSalesID,-2,-3)
			MESSAGEBOX([Îñòàëèñü íå çàêðûòûìè áîëåå îäíîãî äíÿ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE lnSalesID = -4

			*--Åñëè ñìåíà îòêðûòà áîëåå ñóòîê, òðåáóåì çàêðûòü åå
			IF MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
						  [áîëåå 24 ÷àñîâ.Çàêðûòü ñìåíó?],4+32,[Ñìåíà]) = 6
				***
			    This._CloseDay()
				***
			ENDIF
			
			RETURN .F.
			
		CASE lnSalesID = -5
			MESSAGEBOX([Íåèçâåcòíàÿ îøèáêà],16,[Îøèáêà])
			RETURN .F.
			
		OTHERWISE
			thisform.nsalesid = lnSalesID
	ENDCASE
	*------------------------------------------------------------------------------

	*--Îáíîâèì ñïðàâî÷íèê ñòîëîâ
	_PARAM1 = lnTblType
	_PARAM2 = lnTblPar
	REQUERY([lvOUTableList])
	*-------------------------------------------------------------------------------
IF tnFrmID = 0 &amp;&amp; Áûñòðîå äîáàâëåíèå çàêàçà
	*--îòêðîåì ñ÷åò  è óñòàíîâèì çíà÷åíèÿ ïî óìîë÷àíèþ
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	SELECT lvFrmEdit
	APPEND BLANK
	*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
	lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))
	*------------------------------------------------------------------------------
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnWaiterID, ;  &amp;&amp; ýòî îñòàâèì âðåììåíî - ïîòîì óáåðåì
		 lvFrmEdit.DevCltId WITH lnWaiterID, ;
		 lvFrmEdit.FrmTypeID WITH lnFrmTypeID, ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
	IF TABLEUPDATE(1,.T.,[lvFrmEdit])
.nFrmID = spGetLastIncrementedID([lvFrmEdit])
ELSE
MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ äàííûõ ïðîèçîøëà îøèáêà',0+16,'Ïåðäóïðåæäåíèå')
RETURN .f.
	ENDIF
ENDIF

	*09.04.2006 14:54 -&gt;îáíîâèì Alias-û äëÿ ðåäàêòèðîâàíèÿ çàêàçà (øàïêà è ïîçèöèè)
	_PARAM = .nFrmID
	REQUERY([lvFrmEdit])
	REQUERY([lvOrderTvrView])
	USE lvFrmSumView IN 0

	*--îïðåäåëèì íîìåð ñòîëà (èç íàçâàíèÿ ñòîëà)
	USE IN SELECT([lvOrgUnitEdit])
	_PARAM = lvFrmEdit.PointEmiOUID
	USE lvOrgUnitEdit IN 0

	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

	*--íàïèøåì â çàãîëîâêå ôîðìû íîìåð çàêàçà
	.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)

	**.lblEdit.Caption = [Âñåãî: ...]

	*--ïîêàæåì èìÿ êëèåíòà
	.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
	.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width+1)
	.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
	*--åñëè åñòü íîìåð êàðòî÷êè, ïîêàæåì åãî
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0
		
		IF RECCOUNT([lvCardViewByCardID])&gt;0
			.txtCardNo.value = ALLTRIM(lvCardViewByCardID.CardNo)
		ENDIF
	ENDIF
	
	*--îïðåäåëèì âîçìîæíûå âàðèàíòû îïëàòû (â çàâèñèìîñòè îò íàñòðîéêè è êàðòî÷êè)
	.nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
	
	*--äîáàâèì âàðèàíò îïëàòû ïî VIP êàðòå, åñëè ýòî âîçìîæíî
	.addVIP()
	
	*--íàðèñóåì êíîïî÷íîå ìåíþ
	.grdmenu._rsrequery(1)

	*--åñëè ðàáîòàåò ìåíåäæåð, òî çàïðåòèì ðåäàêòèðîâàíèå äàííûõ, äîñòóïíî òîëüêî çàêðûòèå ñìåíû
	IF tlReadOnly
		.lReadOnly = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = .F.
		ELSE
			.cmdDisc.Enabled = .F.
			.cmdNoDisc.Enabled = .F.
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPrint.Enabled = .F.
		.CmdOrderDel.Enabled = .F.
		.CmdCHKBACK.Enabled = .F.
		.CmdPredchk.Enabled = .F.
		.CmdPay.Enabled = .F.
		.CmdManager.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		*--åñëè â çàêàçå óæå åñòü ñêèäêà, òî çàïðåòèì ðåäàêòèðîâàíèå çàêàçà
		lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
		IF FOUND()
			llblock = .T.
		ENDIF
		
		*--åñëè áûë íàïå÷àòàí ïðåä÷åê, òî çàïðåòèì ââîä äàííûõ
		SELECT lvOrderTvrView
		COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

		IF lnPredchk &gt; 0
			llblock = .T.
		ENDIF	
		
		IF llblock
			thisform._block_in(.T.)
		ENDIF
	ENDIF


	*--âîçìîæíû ðàçëè÷íûå âàðèàíòû ïðåäîñòàâëåíèÿ ñêèäêè
	DO CASE
		CASE lnMODEDISC=1
			*--äëÿ Ëèäåðà
			.cntDiscID.Width = .cntDiscID.txtText.Width-1
			.cmdDisc.Left = .cntDiscID.Left+.cntDiscID.Width+1
			.cmdNoDisc.Left = .cmdDisc.Left+.cmdDisc.Width+1
			
		OTHERWISE
			*--äëÿ Êîëüöîâî
			.cmdDisc.Enabled = .F.
			.cmdDisc.Visible = .F.
			.cmdNoDisc.Enabled = .F.
			.cmdNoDisc.Visible = .F.
	ENDCASE
.grdOrder.SetFocus()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRORDEREDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------
*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì lv äëÿ ðåäàêòèðîâàíèÿ äîêóìåíòîâ (ïóñòîé)
USE lvFrmEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
*------------------------------------------------------------------------------

*--Îòêðîåì ñïðàâî÷íèê ñòîëîâ
USE lvOUTableList IN 0 NODATA

*--Îòêðîåì ñïðàâî÷íèê êëèåíòîâ ðåñòîðàíà
USE lvCltRSTList IN 0

*--Îòêðîåì ñïðàâî÷íèê ñêèäîê
USE lvDiscList IN 0

*--îòêðîåì ñïðàâî÷íèê áûñòðîãî âûáîðà áëþä
_PARAM =  VAL(oRes.GetParam([RST],[SETNUM]))
USE lvPOSFuncInSetView IN 0

*--Îòêðîåì ñîäåðæèìîå çàêàçà
USE lvOrderTvrView IN 0 NODATA

*--îòêðîåì lv äëÿ ïðèâÿçîê ïðè÷èí îòêàçà ê áëþäàì (ïðè óäàëåíèè ìåíåäæåðîì) - ïóñòîé
USE lvTvrCncRsnEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvTvrCncRsnEdit])

*--îòêðîåì ñïèñîê ìîäèôèêàòîðîâ (ïóñòîé)
USE lvModList IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModList])

*--ñîçäàäèì ïóñòóþ òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(40),t2 C(40),t3 C(40),t4 C(40),t5 C(40),t6 C(40),t7 C(40))

*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
DODEFAULT()
		thisform.olecommprox1._close()

ENDPROC
PROCEDURE tbloff
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âûêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOff(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
PROCEDURE tblon
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOn(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>65</reserved2>
		<reserved3>nfrmid
lorderpay
_qntintable
ncashno Íîìåð êàññû (óíèêàëüíûé)
nsalesid
ncheckid
nordersum èòîã ïî çàêàçó
lmanagerwork
_menusel îêîí÷àòåëüíûé âûáîð áëþäà èç ìåíþ
lreadonly
nprctypeid èäåíòèôèêàòîð ïðàéñà
lorderdelm ïðèçíàê óäàëåíèÿ âñåãî çàêàçà ìåíåäæåðîì
lblock ôëàã áëîêèðîâêè ââîäà
npayvarnum ÷èñëî âàðèàíòîâ îïëàòû
lorderreturn ôëàã âîçâðàòà
*_ok âûõîä èç ôîðìû ñ ñîõðàíåíèåì
*__storechktrans 
*__storechktrans_pred ïå÷àòü ïðåä÷åêà
*_paintmenu 
*_clickmenu 
*_closeday çàêðûòèå äíÿ (ñìåíû)
*_headerprint 
*__storechktrans_slim ïå÷àòü ÑËÈÌ (ïðè îïëàòå êàðòîé)
*_block_in áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
*getcardinfo 
*addvip 
*__storechktransback ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
*__iscasher 
*_footerprint Ïå÷àòü ïîäâàëà ïðåä÷åêà
*___kkmerrorhandler 
*checkreset 
*_storechecktrans_pred ïå÷àòü ïðåä÷åêà
*tblon Âêëþ÷åíèå áèëüÿðäíîãî ñòîëà
*tbloff Îòêëþ÷åíèå áèëüÿðäíîãî ñòîëà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ôîðìà äëÿ ðåäàêòèðîâàíèÿ çàêàçà íîâûé âàðèàíò</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblEdit</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
BackStyle = 1
Caption = "Çàêàç ¹"
Height = 30
Left = -2
Top = 0
Width = 803
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 1
Name = "LblEdit"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðêà íà íóëåâîå êîëè÷åñòâî
SELECT lvOrderTvrView
GO TOP
SCAN ALL
	IF lvOrderTvrView.TvrQnt = 0
		MESSAGEBOX([Çàêàç ñîäåðæèò íóëåâîå êîëè÷åñòâî!],48,[Îêíî ñîîáùåíèé])
		thisform.grdOrder.SetFocus()
		RETURN .F.
	ENDIF
	SELECT lvOrderTvrView
ENDSCAN

thisform.cmdPrint.Click(.T.)
thisform._OK()
*--Ñêðûâåì ôîðìó
thisform.Hide()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5VB</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblAttr</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ãîñòè"
Height = 25
Left = 1
Top = 31
Width = 51
TabIndex = 6
ForeColor = 0,0,255
ZOrderSet = 5
Name = "LblAttr"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RX0W2RGH</uniqueid>
		<timestamp>951881481</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkFrmAutoNum</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 333
Left = 156
FontBold = .T.
Alignment = 0
Caption = "Àâòîíóìåðàöèÿ"
Value = .F.
TabIndex = 5
Visible = .F.
ZOrderSet = 6
ReadOnly = .T.
Name = "chkFrmAutoNum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOUTableID</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñòîë"
Height = 25
Left = 1
Top = 3
Width = 45
TabIndex = 26
ForeColor = 255,255,255
ZOrderSet = 7
Name = "lblOUTableID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2700OUVTJ</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblFrmId</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .F.
FontSize = 8
BackStyle = 0
Caption = "Ñêèäêà"
Height = 16
Left = 744
Top = 348
Width = 37
TabIndex = 26
ForeColor = 0,0,255
ZOrderSet = 8
Name = "LblFrmId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881481</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCltID</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 31
Left = 107
Width = 216
Height = 25
BackStyle = 0
TabIndex = 27
ForeColor = 252,174,12
ZOrderSet = 9
_allowresizecontent = .T.
_rsaliasname = lvCltRstList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 1
_controlsource = lvFrmEdit.PointIspCltID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntCltID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.BorderStyle = 0
txtText.Height = 22
txtText.Left = 0
txtText.Top = 0
txtText.Width = 214
txtText.ForeColor = 0,0,255
txtText.BackColor = 239,228,250
txtText.DisabledBackColor = 239,228,250
txtText._highlightselfcolor = RGB(239,228,250)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 183
cmdShow.Height = 26
cmdShow.Width = 33
cmdShow.Visible = .F.
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 219
cmdClear.Height = 26
cmdClear.Width = 26
cmdClear.Enabled = .T.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE txtText.Click
this.Parent.cmdShow.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0OHYRT</uniqueid>
		<timestamp>951881481</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntDiscID</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 31
Left = 590
Width = 135
Height = 30
BackStyle = 0
TabIndex = 27
ForeColor = 252,174,12
ZOrderSet = 10
_allowresizecontent = .T.
_rsaliasname = lvDiscList
_rsfieldnametext = NM
_rsfieldnameid = ID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "CntDiscID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.Height = 29
txtText.Left = -1
txtText.Top = 0
txtText.Width = 131
txtText.ForeColor = 0,0,255
txtText._highlightselfcolor = RGB(239,228,250)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 132
cmdShow.Height = 29
cmdShow.Width = 33
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 167
cmdClear.Height = 29
cmdClear.Width = 33
cmdClear.Enabled = .T.
cmdClear.BackColor = 239,228,250
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
LOCAL lnDiscTvrID, ;
		lnDiscPrice, ;
		_PARAM, ;
		lAltSum, ;
		lAltPr, ;
		lFrmSum, ;
		lOstSum

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--îïðåäåëèì ãðàíè÷íóþ ñóììó äëÿ àëüòåðíàòèâíîé ñêèäêè
lAltSum = VAL(oRes.GetParam([RST],[ALTSUM]))

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--óäàëèì ñêèäêó, åñëè îíà óæå åñòü â çàêàçå
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
IF FOUND()
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	DELETE FROM lvOrderTvrEdit
	IF TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		Thisform.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[DELETE])
	ENDIF
ENDIF

*--ñôîðìèðóåì ñêèäêó ïî çàêàçó â çàâèñèìîñòè îò âûáðàííîãî òèïà ñêèäêè
IF EMPTY(this.value)
	*--ðàçáëîêèðóåì äàëüíåéøåå èçìåíåíèå èíôîðìàöèè
	thisform._block_in(.F.)
	
	RETURN .F.
ENDIF

USE IN SELECT([lvDiscType])
_PARAM = this.value
USE lvDiscType IN 0

*--ðàññ÷èòàåì ñêèäêó
DO CASE
	CASE lvDiscType.disctypeid = 1
		*--ïðîöåíòíàÿ ñêèäêà
		lnDiscPrice = ROUND(ThisForm.nOrderSum/100*lvDiscType.discrate,2)*(-1)
	
	CASE lvDiscType.disctypeid = 2
		*--ñóììîâàÿ ñêèäêà
		lnDiscPrice = lvDiscType.discrate*(-1)

	CASE lvDiscType.disctypeid = 3
		*--àëüòåðíàòèâíàÿ ñêèäêà (äëÿ Àéñáåðãà)
		lAltPr = lvDiscType.discrate
		
		*--ïîñ÷èòàåì ñóììó çàêàçîâ ïî äàííîé êàðòî÷êå çà òåêóùóþ ñìåíó
		USE IN SELECT([lvShiftSumView])
		_PARAM = VAL(lvFrmEdit.FrmNote)
		USE lvShiftSumView IN 0
		
		IF RECCOUNT([lvShiftSumView])&gt;0
			lFrmSum = lvShiftSumView.FrmSum
		ELSE
			lFrmSum = 0
		ENDIF
		
		*--ïðîâåðèì, âûáðàíà ëè ëèìèò ñêèäêè çà òåêóùóþ ñìåíó
		IF lFrmSum&gt;=lAltSum
			*--ñêèäêè â òåêóùóþ ñìåíó áîëüøå íåò
			lnDiscPrice=0
		ELSE
			*--ïîñ÷èòàåì, ñêîëüêî ìîæíî åùå äàòü ñêèäêè (ñóììà îñòàòêà îò ëèìèòà)
			lOstSum = (lAltSum-lFrmSum)/(100-lAltPr)*100
			
			IF lOstSum&gt;=thisform.nordersum
				*--äàåì ñêèäêó ñ ñóììû çàêàçà
				lnDiscPrice = ROUND(ThisForm.nOrderSum/100*lAltPr,2)*(-1)
			ELSE
				*--äàåì ôèêñèðîâàííóþ ñêèäêó ñ ñóììû îñòàòêà îò ëèìèòà
				lnDiscPrice = ROUND(lOstSum/100*lAltPr,2)*(-1)
			ENDIF
		ENDIF
		
	OTHERWISE
		lnDiscPrice = 0
ENDCASE

IF lnDiscPrice&lt;&gt;0
	*--äîáàâèì òîâàð "ñêèäêà" â çàêàç
	thisform.grdOrder._add(lnDiscTvrID,lnDiscPrice)

	*--çàáëîêèðóåì äàëüíåéøåå èçìåíåíèå èíôîðìàöèè
	thisform._block_in(.T.)
ENDIF
ENDPROC
PROCEDURE cmdClear.Click
DODEFAULT()

this.Parent._handleanychange()
ENDPROC
PROCEDURE cmdShow.Click
LOCAL ldiscflag, ;
	  lnMODEDISC

ldiscflag = VAL(oRes.GetParam([RST],[DISCFLAG]))
lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))	

*--ïðîâåðèì äîñòóïíîñòü ñêèäîê
IF !EMPTY(ldiscflag)
	MESSAGEBOX([Ñêèäêè íå ïðåäóñìîòðåíû íàñòðîéêîé.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--ñêèäêè äîëæíû äàâàòüñÿ òîëüêî ìåíåäæåðîì (ïðè âûáîðå ñêèäêè èç ñïèñêà)
IF !thisform.lmanagerwork AND EMPTY(lnMODEDISC)
	MESSAGEBOX([Äëÿ âûáîðà ñêèäêè àêòèâèçèðóéòå áëîê êíîïîê ìåíåäæåðà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--åñëè âñå â ïîðÿäêå, âûáèðàåì ñêèäêó
DODEFAULT()

this.Parent._handleanychange()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1V60T2FBI</uniqueid>
		<timestamp>951881481</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntOUTableID</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 0
Left = 51
Width = 169
Height = 31
BackStyle = 0
TabIndex = 27
ColorSource = 0
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 11
_allowresizecontent = .T.
_rsaliasname = lvOUTableList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 1
_controlsource = lvFrmEdit.PointEmiOUID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntOUTableID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.BorderStyle = 0
txtText.Height = 21
txtText.Left = 0
txtText.SpecialEffect = 0
txtText.Top = 4
txtText.Width = 168
txtText.ColorSource = 0
txtText.ForeColor = 255,255,255
txtText.BackColor = 0,0,255
txtText.DisabledBackColor = 0,0,255
txtText.DisabledForeColor = 255,255,255
txtText.SelectedBackColor = 0,0,255
txtText._highlightselfcolor = RGB(0,0,255)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 175
cmdShow.Height = 13
cmdShow.Width = 5
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 219
cmdClear.Height = 26
cmdClear.Width = 26
cmdClear.Enabled = .T.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*--ïðè ñìåíå ñòîëà äîëæåí âêëþ÷èòüñÿ àâòîíóìåðàòîð
WITH ThisForm
	.lblEdit.Caption = [             Çàêàç ¹ ]
	.chkFrmAutoNum.Value = .T.
ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************




ENDPROC
PROCEDURE txtText.Click
this.Parent.cmdShow.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1Y90TVA66</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSumAccount</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
Caption = "Ñóììà íàêîïëåíèÿ "
Height = 22
Left = 324
Top = 333
Visible = .F.
Width = 157
TabIndex = 30
ForeColor = 255,128,0
ZOrderSet = 12
Name = "LblSumAccount"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSum</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñóììà "
Enabled = .F.
Height = 25
Left = 728
Top = 2
Visible = .F.
Width = 66
TabIndex = 30
ForeColor = 0,0,255
ZOrderSet = 13
Name = "LblSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>932994103</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPredChk</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\prdcheck_new_.gif
DownPicture = ..\graphic\prdcheck_new_pr.gif
DisabledPicture = ..\graphic\prdcheck_new_dis_.gif
Caption = ""
MousePointer = 0
Style = 0
ToolTipText = "Ïå÷àòü ïðåä÷åêà"
Visible = .T.
SpecialEffect = 0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 14
Name = "CmdPredChk"
</properties>
		<protected/>
		<methods>PROCEDURE Click
**RETURN
*--ïå÷àòü ïðåä÷åêà
LOCAL lnPredchk, ;
lmaxid, ;
lnDiscTvrID

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü ïðåä÷åêà íåäîñòóïíà.],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

IF MESSAGEBOX([Íàïå÷àòàòü ïðåä÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
RETURN .F.
ENDIF

*--ïðîâåðêà íà íåïóñòîé çàêàç
IF RECCOUNT([lvOrderTvrView])&lt;=0
MESSAGEBOX([Çàêàç íå ñîäåðæèò íè îäíîãî áëþäà!],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

*--ïðîâåðêà íà íóëåâîå êîëè÷åñòâî
SELECT lvOrderTvrView
GO TOP
SCAN ALL
IF lvOrderTvrView.TvrQnt = 0
IF TYPE('thisform.grdOrder')=[O]
MESSAGEBOX([Çàêàç ñîäåðæèò íóëåâîå êîëè÷åñòâî!],48,[Îêíî ñîîáùåíèé])
thisform.grdOrder.SetFocus()
RETURN .F.
ENDIF
ENDIF
SELECT lvOrderTvrView
ENDSCAN

*--åñëè ïðåä÷åê óæå áûë íàïå÷àòàí, òî äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà íóæíà îòìåíèòü ïåðâûé ïðåä÷åê
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

IF lnPredchk = 0
*--ïðîèçâåäåì ïðîâåðêó ñêèäêè (ñêèäêà äîëæíà ñòîÿòü ïîñëåäíåé ïîçèöèåé â çàêàçå)
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

CALCULATE MAX(lvOrderTvrView.FrmPartTvrID) TO lmaxid

SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID

IF (FOUND() AND lvOrderTvrView.FrmPartTvrID&lt;&gt;lmaxid)
MESSAGEBOX([Íåîáõîäèìî ïåðåñ÷èòàòü ñêèäêó.],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

*--âûïîëíèì ïå÷àòü ïðåä÷åêà è óñòàíîâèì ïðèçíàê ïðîèçâåäåííîé ïå÷àòè ïðåä÷åêà
thisform._storechecktrans_pred()

	*-- Ïðîâåðÿåì âûêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
	thisForm.tblOff()

*--ïîñëå ïå÷àòè ïðåä÷åêà ââîä äàííûõ áóäåò çàáëîêèðîâàí
thisform._block_in(.T.)
ELSE
MESSAGEBOX([Ïðåä÷åê óæå áûë íàïå÷àòàí.]+CHR(13)+;
[Äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà îáðàòèòåñü ê ìåíåäæåðó.],64,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdOrder</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>ColumnCount = 5
FontSize = 20
Anchor = 0
HeaderHeight = 0
Height = 267
Left = 0
Panel = 1
ReadOnly = .F.
RecordSource = "lvOrderTvrView"
RowHeight = 36
Top = 59
Width = 499
ForeColor = 0,0,160
GridLineColor = 0,0,160
ZOrderSet = 15
AllowAutoColumnFit = 2
_activerowhighlight = .T.
_activerowhighlightcoloractive = RGB(239,228,250)
_activerowhighlightcolorunactive = RGB(255,255,255)
Name = "GrdOrder"
Column1.FontSize = 20
Column1.ColumnOrder = 1
Column1.ControlSource = "lvOrderTvrView.mark"
Column1.Width = 30
Column1.ReadOnly = .F.
Column1.Sparse = .F.
Column1.ForeColor = 255,255,255
Column1.Name = "Column1"
Column2.FontSize = 10
Column2.ColumnOrder = 2
Column2.ControlSource = "lvOrderTvrView.TvrNM"
Column2.Width = 180
Column2.ReadOnly = .T.
Column2.ForeColor = 0,0,160
Column2.Name = "Column2"
Column3.FontBold = .T.
Column3.FontSize = 20
Column3.ColumnOrder = 4
Column3.ControlSource = "lvOrderTvrView.TvrQnt"
Column3.Width = 60
Column3.ReadOnly = .F.
Column3.Sparse = .F.
Column3.ForeColor = 0,0,160
Column3.Name = "Column3"
Column4.FontSize = 10
Column4.ColumnOrder = 3
Column4.ControlSource = "lvOrderTvrView.TvrPrcSale"
Column4.Width = 60
Column4.ReadOnly = .T.
Column4.Format = "R"
Column4.InputMask = "999999.99"
Column4.ForeColor = 0,0,160
Column4.Name = "Column4"
Column5.FontSize = 10
Column5.ControlSource = "lvOrderTvrView.TvrSum"
Column5.Width = 64
Column5.ReadOnly = .T.
Column5.Format = "R"
Column5.InputMask = "999999.99"
Column5.ForeColor = 0,0,160
Column5.Name = "Column5"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._Add
* Called by.......: &lt;&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå áëþäà â çàêàç
*-------------------------------------------------------
LPARAMETERS tnTvrID, tnPrice
*09.08.2005 16:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes, ;
		laAddRec[1], ;
		_PARAM, ;
		lnMsuID, ;
		lnPrice, ;
		lnRes, ;
		lCountScroll
*------------------------------------------------------------------------------

*09.08.2005 16:47 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([tnTvrID])==[N] AND !EMPTY(tnTvrID)
	
	WITH This
			*09.08.2005 16:47 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .T.
		*------------------------------------------------------------------------------
		
		*--íàéäåì öåíó áëþäà
		IF INLIST(TYPE([tnPrice]),[N],[Y])
			lnPrice = tnPrice
		ELSE

			*11.04.2006 12:02 -&gt;Ïîëó÷èì èíôîðìàöèþ î öåíå íà òîâàð
			USE IN SELECT([lvPriceTvr])
			***

			*05.05.2006 09:41 -&gt;Ïîëó÷èì öåíó ïî ïðàéñó
			_PARAM1 = tnTvrID
			_PARAM2 = ThisForm.nPrcTypeID
			USE lvPriceTvr IN 0
			***

			*05.05.2006 09:41 -&gt;Åñëè öåíà íóëåâàÿ - ïîëó÷èì öåíó èç ïðàéñà ïî óìîë÷àíèþ
			IF lvPriceTvr.Price = 0
				USE IN SELECT([lvPriceTvrDef])
				***
				
				_PARAM = tnTvrID
				USE lvPriceTvrDef IN 0
				lnPrice = lvPriceTvrDef.Price	
				
			ELSE
				lnPrice = lvPriceTvr.Price
			ENDIF
			*------------------------------------------------------------------------------

		ENDIF
		
		*--Ïîëó÷èì èíôîðìàöèþ î åäåíèöàõ èçìåðåíèÿ
		USE IN SELECT([lvMsuIDByTvr])
		***
		_PARAM = tnTvrID
		USE lvMsuIDByTvr IN 0
		***
		IF RECCOUNT([lvMsuIDByTvr])&gt;0 AND !EMPTY(lvMsuIDByTvr.MsuID) AND !ISNULL(lvMsuIDByTvr.MsuID)
			lnMsuID = lvMsuIDByTvr.MsuID
		ELSE
			lnMsuID = 1
		ENDIF
		
		***
		USE IN SELECT([lvMsuIDByTvr])
		*-------------------------------------------------------------------------------

		*--Äîáàâèì ïîçèöèþ
		USE IN SELECT([lvOrderTvrEdit])
		USE lvOrderTvrEdit IN 0 NODATA
		APPEND BLANK IN lvOrderTvrEdit
		REPLACE ;
			FrmID WITH ThisForm.nFrmID, ;
			TvrId WITH tnTvrID, ;
			MsuId WITH lnMsuID, ;
			TvrQnt WITH 1, ;
			TvrPrcSale WITH lnPrice ;
		IN lvOrderTvrEdit
		llResult = TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		*------------------------------------------------------------------------------
		
		IF llResult
			This._RSRequeryOne(spGetLastIncrementedID([lvOrderTvrEdit]),[ADD])
		ENDIF
		*-------------------------------------------------------------------------------


		*09.08.2005 16:48 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .F.
		*------------------------------------------------------------------------------
			
		*09.08.2005 16:48 -&gt; Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
		.Refresh(.T.)
		*------------------------------------------------------------------------------
		
		*--ïîêàæåì çàêàç â ñåòêå êðàñèâî è óäîáíî
		lCountScroll = MIN(6,RECCOUNT([lvOrderTvrView]))-1
		
		FOR i= 1 TO lCountScroll
			.DoScroll(0)
		ENDFOR
		
		.SetFocus()
		
	ENDWITH
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _refreshrelatedobjects
*--ïîêàæåì îáíîâëåííóþ ñóììó çàêàçà íà ôîðìå
LOCAL lcTableNM
USE IN SELECT([lvFrmSumView])
_PARAM = thisform.nFrmID
USE lvFrmSumView IN 0

*--ñîõðàíèì èòîã ïî çàêàçó
ThisForm.nOrderSum = lvFrmSumView.FrmSum
*-------------------------------------------------------------------------------
	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

*thisform.lblSum.caption = [Ñóììà ]+ALLTRIM(STR(lvFrmSumView.FrmSum,99,2))
	thisform.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)+ [     íà ñóììó: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
USE IN SELECT([lvFrmSumView])
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._RSRequery
* Called by.......: &lt;&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
_PARAM = thisform.nFrmID
REQUERY([lvOrderTvrView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequeryone
LPARAMETERS tnFrmPartTvrID, tcMode

*17.01.2005 15:30 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL 	lcOldAlias, ;
		lnId, ;
		laReplaceArray[1]
***
PRIVATE	_PARAM
***
lcOldAlias = ALIAS()
lnId = tnFrmPartTvrID
laReplaceArray = .NULL.
*------------------------------------------------------------------------------

*12.05.2004 03:35 -&gt;Îòêëþ÷àåì èñòî÷íèê äàííûõ
This.SourceKeep()
This.SourceReset()
*------------------------------------------------------------------------------

* Â çàâèñèìîñòè îò ðåæèìà âûïîëíèì äåéñòâèÿ
DO CASE
	CASE UPPER(tcMode) == [DELETE]

		*22.12.2004 15:11 -&gt;Óäàëÿåì çàïèñü
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnId
		IF FOUND()
			DELETE IN lvOrderTvrView
			IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
				TABLEUPDATE(.T.)
			ENDIF
		ENDIF
		*------------------------------------------------------------------------------

		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

	CASE UPPER(tcMode) == [ADD] OR UPPER(tcMode) == [EDIT]
	
		*--Ïîëó÷èì äàííûå î äîáàâëåííîé çàïèñè
		IF USED([lvOrderTvrViewRepl])
			USE IN lvOrderTvrViewRepl
		ENDIF
		_PARAM = lnId
		USE lvOrderTvrViewRepl IN 0
		*------------------------------------------------------------------------------

		*17.01.2005 15:34 -&gt; Îáíîâèì äàííûå â lvOrderTvrView
		SELECT lvOrderTvrViewRepl
		SCATTER TO laReplaceArray
		SELECT lvOrderTvrView
		IF UPPER(tcMode) == [ADD]
			APPEND BLANK
		ENDIF
		GATHER FROM laReplaceArray
		IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
			TABLEUPDATE(.T.)
		ENDIF
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:35 -&gt; Çàêðîåì Alis
		USE IN lvOrderTvrViewRepl
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

ENDCASE
*-------------------------------------------------------------------------------

*12.05.2004 03:37 -&gt;Âîññòàíàâëèâàåì èñòî÷íèê äàííûõ
This.SourceRecall()
*------------------------------------------------------------------------------

*22.12.2004 15:35 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
	SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
DODEFAULT()

this.column1.DynamicBackColor = [IIF(BITTEST(lvOrderTvrView.TvrAttr,0),RGB(252,174,12),IIF(BITTEST(lvOrderTvrView.TvrAttr,1),RGB(252,242,218),]+this.column1.DynamicBackColor+[))]
								

ENDPROC
PROCEDURE Valid
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
PROCEDURE When
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column1</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951881481</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>CHK1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column1</parent>
		<properties>Top = 23
Left = 13
FontSize = 20
Alignment = 0
Caption = " "
ColorSource = 0
ForeColor = 255,255,255
ReadOnly = .F.
Name = "CHK1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column2</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S207614U</uniqueid>
		<timestamp>932992837</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column2</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S20QARPV</uniqueid>
		<timestamp>882074301</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column3</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S2078FZK</uniqueid>
		<timestamp>932992837</timestamp>
		<class>txtcalctype</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column3</parent>
		<properties>FontBold = .T.
FontSize = 9
Format = "R"
InputMask = "999999.99"
Left = 22
ReadOnly = .F.
Top = 10
ForeColor = 0,0,160
_highlightself = .F.
Name = "Txt1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
USE IN SELECT([lvOrderTvrEdit])
_PARAM = lvOrderTvrView.FrmPartTvrID
USE lvOrderTvrEdit IN 0

REPLACE lvOrderTvrEdit.TvrQnt WITH this.value IN lvOrderTvrEdit
TABLEUPDATE(1,.T.,[lvOrderTvrEdit])

REPLACE lvOrderTvrView.TvrSum WITH ROUND(lvOrderTvrView.TvrPrcSale*this.value,2)
ThisForm.grdOrder._RefreshRelatedObjects()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column4</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>932992837</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column4</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column5</parent>
		<properties>Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>887319332</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmordereditexclusiv.GrdOrder.Column5</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDel</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 161
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\stdtlbdele_.gif
DownPicture = ..\graphic\stdtlbdele_pr.gif
DisabledPicture = ..\graphic\stdtlbdele_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Óäàëåíèå ïîçèöèé"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 16
Name = "CmdDel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LPARAMETERS tcarry
LOCAL	lnQntDel, ;
		_PARAM, ;
		lpos, ;
		lcarry

lnQntDel = 0
lcarry = tcarry

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà óäàëåíèå
SELECT lvOrderTvrView
lpos = RECNO()
COUNT ALL FOR lvOrderTvrView.mark TO lnQntDel

IF lnQntDel&gt;0
	*--óäàëèì ïîìå÷åííûå íà óäàëåíèå çàïèñè
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark AND (lcarry OR (!BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)))
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		DELETE FROM lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN
	ThisForm.grdOrder._RSRequery()
ENDIF

SELECT lvOrderTvrView
GO TOP


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0RG33W</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPay</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 600
Height = 50
Width = 50
Picture = ..\graphic\bank_.gif
DownPicture = ..\graphic\bank_pr.gif
Caption = ""
ToolTipText = "Îïëàòà çàêàçà"
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 17
Name = "CmdPay"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lRetVal

		*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._close()
		thisform._ok()

		lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],ThisForm.nfrmid ,thisform.nPayVarNum, 1,0)

ThisForm.grdOrder._RSRequery()
		*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._open()
		IF TYPE([lRetVal])==[L] AND !lRetVal
		RETURN lRetVal
	    ENDIF
	
	thisform.Hide()
	RETURN lRetVal



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPlus</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 62
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\plus.bmp
Caption = ""
Enabled = .T.
TabStop = .F.
ToolTipText = "Óâåëè÷èòü"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 18
Name = "CmdPlus"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM

IF !thisform._qntintable
	*--åñëè õîòèì óâåëè÷èòü êîëè÷åñòâî ãîñòåé
	REPLACE lvFrmEdit.ID_ WITH (lvFrmEdit.ID_+1) IN lvFrmEdit
	
	*--îáíîâèì äàííûå íà ôîðìå
	thisform.Refresh()
	
	*--óñòàíîâèì ôîêóñ
	thisform.txtAttr.SetFocus()
ELSE
	*--åñëè õîòèì óâåëè÷èòü êîëè÷åñòâî äàííîãî òîâàðà
	IF !BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)
		*--ðåäàêòèðîâàíèå âîçìîæíî òîëüêî äëÿ íåçàêðûòûõ ïîçèöèé
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		
		REPLACE lvOrderTvrEdit.TvrQnt WITH (lvOrderTvrEdit.TvrQnt+1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		ThisForm.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[EDIT])

		*--óñòàíîâèì ôîêóñ
		thisform.grdOrder.column3.txt1.SetFocus()
	ENDIF
ENDIF



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdMinus</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 111
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\minus.bmp
Caption = ""
Enabled = .T.
TabStop = .F.
ToolTipText = "Óìåíüøèòü"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 19
Name = "CmdMinus"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM

IF !thisform._qntintable
	*--åñëè õîòèì óìåíüøèòü êîëè÷åñòâî ãîñòåé
	REPLACE lvFrmEdit.ID_ WITH (lvFrmEdit.ID_-1) IN lvFrmEdit

	*--îáíîâèì äàííûå íà ôîðìå
	thisform.Refresh()
	
	*--óñòàíîâèì ôîêóñ
	thisform.txtAttr.SetFocus()
ELSE
	*--åñëè õîòèì óìåíüøèòü êîëè÷åñòâî äàííîãî òîâàðà
	IF !BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)
		*--ðåäàêòèðîâàíèå âîçìîæíî òîëüêî äëÿ íåçàêðûòûõ ïîçèöèé
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		
		REPLACE lvOrderTvrEdit.TvrQnt WITH IIF(lvOrderTvrEdit.TvrQnt&gt;1,(lvOrderTvrEdit.TvrQnt-1),1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		ThisForm.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[EDIT])

		*--óñòàíîâèì ôîêóñ
		thisform.grdOrder.column3.txt1.SetFocus()
	ENDIF
ENDIF





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>932994103</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPrint</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 211
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\servis_printer2007.gif
DownPicture = ..\graphic\servis_printer2007_pr.gif
DisabledPicture = ..\graphic\servis_printer2007_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Ïå÷àòü íà ñåðâèñ-ïðèíòåð"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 20
Name = "CmdPrint"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LPARAMETER tclose &amp;&amp;--ôëàã ïðîâåðêè ïðè çàêðûòèè ôîðìû
LOCAL	lnDiscTvrID, ;
		lnDiscPrice, ;
		_PARAM, ;
		_PARAM1, ;
		_PARAM2, ;
		lcBilTableIDs

IF !this.Enabled
	RETURN .F.
ENDIF

*--ïðè íàæàòèè íà êíîïêó ñåðâèñ-ïå÷àòè
IF !tclose AND MESSAGEBOX([Ïðîèçâåñòè ïå÷àòü íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*-- Ïðîâåðÿåì âêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
thisForm.tblOn()
*--ñôîðìèðóåì äàííûå äëÿ ïå÷àòè íà ñåðâèñíûé ïðèíòåð
USE IN SELECT([lvSPrintView])
_PARAM1 = lvFrmEdit.FrmID
_PARAM2 = thisform.nCashNo

USE lvSPrintView IN 0

*--ïðîâåðêà ïðè çàêðûòèè ôîðìû, åñòü ëè ïîçèöèè, íå ïðîøåäøèå íà ñåðâèñ-ïå÷àòü
IF tclose
	IF RECCOUNT([lvSPrintView])=0
		*--íåò ïîçèöèé äëÿ ñåðâèñ-ïå÷àòè
		RETURN .F.
	ENDIF
	
	IF MESSAGEBOX([Ïðîèçâåñòè ïå÷àòü íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
		RETURN .F.
	ENDIF
ENDIF

*--ïå÷àòü íà ñåðâèñíûé ïðèíòåð
SELECT lvSPrintView.DeviceID, ;
		lvSPrintView.DeviceINI ;
	FROM lvSPrintView ;
	GROUP BY DeviceID ;
	INTO CURSOR curPrint NOFILTER
SELECT curPrint
SCAN ALL
	SELECT lvSPrintView
	LOCAL lcPrinter
	lcPrinter = ALLTRIM(curPrint.DeviceINI)
	IF lcPrinter = [DEFAULT]
				SET PRINTER TO DEFAULT
		ELSE
				SET PRINTER TO NAME ALLTRIM(lcPrinter)
	ENDIF
	PRINTJOB
	REPORT FORM REPORTS\serv_print.frx FOR lvSPrintView.DeviceID = curPrint.DeviceID TO PRINTER
	ENDPRINTJOB
	SELECT curPrint
ENDSCAN

*--óñòàíîâèì ïðèçíàê ïå÷àòè íà ñåðâèñ-ïðèíòåð
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,0) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
ThisForm.grdOrder._RSRequery()
	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblPar</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
Caption = "Ðîäèòåëü"
Height = 22
Left = 2
Top = 333
Visible = .F.
Width = 80
TabIndex = 30
ForeColor = 255,128,0
ZOrderSet = 12
Name = "LblPar"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF thisform._menusel
	*--âîçâðàùàåìñÿ â ãëàâíîå ìåíþ
	thisform._menusel = .F.
	thisform.grdmenu._rsrequery(1)
	thisform.lblPar.Visible = .F.
	thisform.lblPar.caption = []
	thisform.grDMENU.Column1.EDTMENU1.SetFocus()
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UHS9L</uniqueid>
		<timestamp>951881481</timestamp>
		<class>cntnumericpad</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntnumericpad1</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 61
Left = 600
ZOrderSet = 22
Name = "Cntnumericpad1"
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Height = 50
ImgButtonPoint.Width = 50
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Height = 50
ImgButton1.Width = 50
ImgButton1.Name = "ImgButton1"
ImgButton2.Height = 50
ImgButton2.Width = 50
ImgButton2.Name = "ImgButton2"
ImgButton3.Height = 50
ImgButton3.Width = 50
ImgButton3.Name = "ImgButton3"
ImgButton4.Height = 50
ImgButton4.Width = 50
ImgButton4.Name = "ImgButton4"
ImgButton5.Height = 50
ImgButton5.Width = 50
ImgButton5.Name = "ImgButton5"
ImgButton6.Height = 50
ImgButton6.Width = 50
ImgButton6.Name = "ImgButton6"
ImgButton7.Height = 50
ImgButton7.Width = 50
ImgButton7.Name = "ImgButton7"
ImgButton8.Height = 50
ImgButton8.Width = 50
ImgButton8.Name = "ImgButton8"
ImgButton9.Height = 50
ImgButton9.Width = 50
ImgButton9.Name = "ImgButton9"
IMGBUTTONDELETE.Height = 50
IMGBUTTONDELETE.Width = 50
IMGBUTTONDELETE.Name = "IMGBUTTONDELETE"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdClose</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 111
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\clock_.gif
DownPicture = ..\graphic\clock_pr.gif
DisabledPicture = ..\graphic\clock_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 23
Name = "CmdClose"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðèì, äîñòóïíà ëè ïå÷àòü Z-îò÷åòà íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü Z-îò÷åòà íå ïðåäóñìîòðåíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

IF MESSAGEBOX([Çàêðûòü òåêóùóþ ñìåíó?],36,[Îêíî ñîîáùåíèé])=6
	thisform._closeday()
	thisform.Hide()
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDelM</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 161
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\xm_.gif
DownPicture = ..\graphic\xm_pr.gif
DisabledPicture = ..\graphic\xm_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Óäàëåíèå ïîçèöèè ìåíåäæåðîì"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 24
Name = "CmdDelM"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL	lnQntDel, ;
		lnID, ;
		lnQntSP, ;
		lnRsn, ;
		_PARAM

lnID = lvOrderTvrView.FrmPartTvrID
lnQntDel = 0

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà óäàëåíèå ìåíåäæåðîì
SELECT lvOrderTvrView
COUNT ALL FOR lvOrderTvrView.mark TO lnQntDel

IF lnQntDel&gt;0
	*--ïðîâåðèì, ñôîðìèðîâàí ëè ïî ýòèì áëþäàì ñïèñîê îòìåíû äëÿ ñåðâèñ-ïðèíòåðà
	SELECT lvOrderTvrView
	COUNT FOR (lvOrderTvrView.mark AND BITTEST(lvOrderTvrView.TvrAttr,0)) TO lnQntSP
	
	IF lnQntSP&gt;0
		MESSAGEBOX([Ïåðåä óäàëåíèåì íåîáõîäèìî ñäåëàòü ñïèñîê îòìåíû íà ñåðâèñ-ïðèíòåð.],48,[Îêíî ñîîáùåíèé])	 		
		RETURN .F.
	ENDIF
	
	*--îïðåäåëèì ïðè÷èíó îòêàçà îò áëþäà
	lnRsn = oApp.DoModalFormRetValObj([FrmCancelReason;rst_v1.vñx])
	
	IF TYPE([lnRsn])==[N] AND !EMPTY(lnRsn)
		*--ñîõðàíèì ñâåäåíèÿ î ïðè÷èíàõ îòêàçà îò áëþäà (ïðè óäàëåíèè ìåíåäæåðîì áëþäà èç çàêàçà)
		SELECT lvOrderTvrView
		SCAN FOR (lvOrderTvrView.mark AND (BITTEST(lvOrderTvrView.TvrAttr,1) OR BITTEST(lvOrderTvrView.TvrAttr,0)))
			USE IN SELECT([lvTvrCncRsnEdit])
			_PARAM = lvOrderTvrView.FrmPartTvrID
			USE lvTvrCncRsnEdit IN 0
			
			IF RECCOUNT([lvTvrCncRsnEdit]) = 0
				SELECT lvTvrCncRsnEdit
				APPEND BLANK
			ENDIF
			
			REPL lvTvrCncRsnEdit.FrmPartTvrCncRsnID WITH _PARAM, ;
				 lvTvrCncRsnEdit.CancelReasonID WITH lnRsn
				
			IF !TABLEUPDATE(1,.T.,[lvTvrCncRsnEdit])		
				MESSAGEBOX([Îøèáêà ïðè îáíîâëåíèè â òàáëèöå FrmPartTvrCncRsn.],48,[Îêíî ñîîáùåíèé])
				TABLEREVERT(.T.)
				RETURN .F.
			ENDIF
				
			SELECT lvOrderTvrView
		ENDSCAN

		*--óñòàíîâèì ïðèçíàê óäàëåíèÿ ìåíåäæåðîì ïîìå÷åííûõ çàïèñåé
		SELECT lvOrderTvrView
		SCAN FOR (lvOrderTvrView.mark AND (BITTEST(lvOrderTvrView.TvrAttr,1) OR BITTEST(lvOrderTvrView.TvrAttr,0)))
			USE IN SELECT([lvOrderTvrEdit])
			_PARAM = lvOrderTvrView.FrmPartTvrID
			USE lvOrderTvrEdit IN 0
			REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,4) IN lvOrderTvrEdit
			TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
			SELECT lvOrderTvrView
		ENDSCAN
		ThisForm.grdOrder._RSRequery()

	ENDIF
	
ELSE
	MESSAGEBOX([Íå ïîìå÷åíî íè îäíîé çàïèñè.],48,[Îêíî ñîîáùåíèé])	 		
	RETURN .F.
ENDIF
	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>932994103</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPrintCancel</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 211
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\del_servis_printer_.gif
DownPicture = ..\graphic\del_servis_printer_pr.gif
DisabledPicture = ..\graphic\del_servis_printer_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Îòìåíà ïå÷àòè íà ñåðâèñ-ïðèíòåð "
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 25
Name = "CmdPrintCancel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lFrmPartTvrID

IF MESSAGEBOX([Îòïðàâèòü ñïèñîê îòìåíû íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--çàïîìíèì ïîçèöèþ, ÷òîáû âåðíóòüñÿ íà íåå
lFrmPartTvrID = lvOrderTvrView.FrmPartTvrID

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà ñíÿòèå ïðèçíàêà ñåðâèñ-ïå÷àòè
CREATE CURSOR CurMark (FrmPartTvrID I)
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.mark
	SELECT curMark
	APPEND BLANK
	REPLACE curMark.FrmPartTvrID WITH lvOrderTvrView.FrmPartTvrID
	SELECT lvOrderTvrView
ENDSCAN

IF RECCOUNT([curMark])&gt;0
	*--ñôîðìèðóåì äàííûå äëÿ ñïèñêà îòìåíû íà ñåðâèñíûé ïðèíòåð
	USE IN SELECT([lvCancelPrintView])
	_PARAM1 = lvFrmEdit.FrmID
	_PARAM2 = thisform.nCashNo
	USE lvCancelPrintView IN 0

	SELECT ;	
		lvCancelPrintView.* ;
	FROM lvCancelPrintView ;
	INNER JOIN curMark ON curMark.FrmPartTvrID = lvCancelPrintView.FrmPartTvrID ;
	INTO CURSOR curcancel NOFILTER

	*--ðàñïå÷àòàåì íà ñåðâèñ-ïðèíòåðå
	USE IN SELECT([curPrint])
	SELECT curcancel.DeviceID, ;
			curcancel.DeviceINI ;
		FROM curcancel ;
		GROUP BY DeviceID ;
		INTO CURSOR curPrint NOFILTER
		
	SELECT curPrint
	SCAN ALL
		LOCAL lcPrinter
	 	lcPrinter = ALLTRIM(curPrint.DeviceINI)
	 	IF lcPrinter = [DEFAULT]
					SET PRINTER TO DEFAULT
			ELSE
					SET PRINTER TO NAME ALLTRIM(lcPrinter)
	 	ENDIF
		SELECT curcancel
		PRINTJOB
			REPORT FORM REPORTS\serv_print_cancel.frx FOR curcancel.DeviceID = curPrint.DeviceID TO PRINTER
		ENDPRINTJOB
		SELECT curPrint
	ENDSCAN	
	
	*--óñòàíîâèì ïðèçíàê ïðîèçâåäåííîé îòìåíû ñåðâèñ-ïå÷àòè äëÿ âñåõ ïîìå÷åííûõ çàïèñåé
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark AND BITTEST(lvOrderTvrView.TvrAttr,0)
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN

	*-- Ïðîâåðÿåì âûêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
	thisForm.tblOff()

	*--ñíèìåì ïðèçíàê ñåðâèñ-ïå÷àòè äëÿ âñåõ ïîìå÷åííûõ çàïèñåé
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		REPLACE lvOrderTvrEdit.TvrAttr WITH BITCLEAR(lvOrderTvrEdit.TvrAttr,0) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN
	***
	ThisForm.grdOrder._RSRequery()

ELSE
	MESSAGEBOX([Íåîáõîäèìî ïîìåòèòü áëþäà äëÿ ôîðìèðîâàíèÿ ñïèñêà îòìåíû.],48,[Îêíî ñîîáùåíèé]) 		
	RETURN .F.
	
ENDIF


*--âåðíåìñÿ íà íóæíóþ ïîçèöèþ
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.FrmPartTvrID = lFrmPartTvrID

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UHSAH</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPredChkCancel</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\del_prdcheck_.gif
DownPicture = ..\graphic\del_prdcheck_pr.gif
DisabledPicture = ..\graphic\del_prdcheck_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Îòìåíà ïðåä÷åêà"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 26
Name = "CmdPredChkCancel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnDiscTvrID, ;
	  lnPredchk

*--ïðîâåðèì, áûë ëè ñäåëàí ïðåä÷åê
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

IF lnPredchk = 0
	MESSAGEBOX([Ïðåä÷åê íå áûë íàïå÷àòàí],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

IF MESSAGEBOX([Îòìåíèòü ïðåä÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--óñòàíîâèì ïðèçíàê îòìåíû ïðåä÷åêà äëÿ òåõ ïîçèöèé, ïî êîòîðûì îí áûë
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID AND BITTEST(lvOrderTvrView.TvrAttr,2)
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,3) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN

*--î÷èñòèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITCLEAR(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN

*--Îáíîâèì äàííûå â ñåòêå
ThisForm.grdOrder._RSRequery()

*--ðàçáëîêèðóåì ââîä äàííûõ â çàêàç
thisform._block_in(.F.)

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>txtcalcint</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtAttr</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
ControlSource = "lvFrmEdit.ID_"
Format = "R"
Height = 25
InputMask = "999"
Left = 56
Top = 31
Width = 38
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 239,228,250
ZOrderSet = 27
_highlightselfcolor = RGB(239,228,250)
Name = "TxtAttr"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .F.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0WTPKZ</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdOrderDel</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 650
Height = 50
Width = 50
Picture = ..\graphic\del_ord_.gif
DownPicture = ..\graphic\del_ord_pr.gif
DisabledPicture = ..\graphic\del_ord_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 28
Name = "CmdOrderDel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--óäàëåíèå çàêàçà ìåíåäæåðîì (èçìåíèì àòðèáóò çàêàçà )
IF MESSAGEBOX([Óäàëèòü âåñü çàêàç?],36,[Îêíî ñîîáùåíèé]) = 6
	*--äëÿ ñîõðàíåíèÿ çàêàçà ñ àòðèáóòîì óäàëåíèÿ ìåíåäæåðîì
	thisform.lorderDelM = .T.

	*--ñîõðàíèì âñå äàííûå
	thisform._OK()

	*--Ñêðûâåì ôîðìó
	thisform.Hide()
ELSE
	thisform.lorderDelM = .F.
	RETURN .F.
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0WTPLF</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdManager</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 62
Left = 750
Height = 50
Width = 50
FontSize = 20
Picture = ..\graphic\m_.gif
DownPicture = ..\graphic\m_pr.gif
DisabledPicture = ..\graphic\m_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Ôóíêöèè ìåíåäæåðà"
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 29
Name = "CmdManager"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîèçâåäåì àâòîðèçàöèþ ìåíåäæåðà
LOCAL  lnUserKod, ;
		_PARAM, ;
		lnDiscTvrID, ;
		llblock, ;
		lretacc, ;
		_PARAM1, ;
		_PARAM2

IF !thisform.lmanagerwork
	*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíèòîâ
	thisform.olecommprox1._close()
	
	*--Çàïóñêàåì ôîðìó àâòîðèçàöèè è ïàðîëÿ è àíàëèçèðóåì ðåçóëüòàò
	lnUserKod = oApp.DoModalFormRetValObj([login;rst_v1.vcx])

	*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
	thisform.olecommprox1._open()
	
	IF TYPE([lnUserKod])==[N] AND !EMPTY(lnUserKod)
		*--ïðîâåðêà íà ñòàòóñ ìåíåäæåðà
		USE IN SELECT([lvCltEditMgr])
		_PARAM = spUserClt(0,lnUserKod)
		USE lvCltEdit ALIAS lvCltEditMgr IN 0

		IF RECCOUNT([lvCltEditMgr])&gt;0
			DO CASE
				*--ðàçáëîêèðóåì êíîïêè ìåíåäæåðà, åñëè ïîëüçîâàòåëü ÿâëÿåòñÿ ìåíåäæåðîì
				CASE BITTEST(lvCltEditMgr.CltRole,5)
					*--ïðîâåðèì äîñòóïíîñòü âîçâðàòà
					thisform.CmdCHKBACK.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[RETACC])
					
					*--ïðîâåðèì äîñòóïíîñòü çàêðûòèÿ ñìåíû (Z-îò÷åò)
					thisform.cmdClose.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[ZACC])

					*--ïðîâåðèì äîñòóïíîñòü X-îò÷åòà
					thisform.cmdXReport.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[XACC])
					
					*--ïðîâåðèì äîñòóïíîñòü óäàëåíèÿ çàêàçà
					thisform.cmdOrderDel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[DELORDACC])
					
					*--ïðîâåðèì äîñòóïíîñòü îòìåíû ïðåä÷åêà
					thisform.cmdPredChkCancel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[PRCHKACC])

					*--ïðîâåðèì äîñòóïíîñòü îòìåíû ñåðâèñ-ïå÷àòè
					thisform.cmdPrintCancel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[SPRINTACC])
						
					*--ïðîâåðèì äîñòóïíîñòü óäàëåíèÿ ïîçèöèé
					thisform.cmdDelM.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[DELPOSACC])
					
					thisform.lmanagerwork = .T.
					this.BackColor = RGB(252,174,12)
					this.ForeColor = RGB(128,128,255)
					
					*--ñäåëàåì äîïîëíèòåëüíóþ ïðîâåðêó
					*--åñëè â çàêàçå óæå åñòü ñêèäêà, òî çàïðåòèì ðåäàêòèðîâàíèå çàêàçà
					lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
					
					SELECT lvOrderTvrView
					LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
					IF FOUND()
						llblock = .T.
					ENDIF
					
					*--åñëè áûë íàïå÷àòàí ïðåä÷åê, òî çàïðåòèì ââîä äàííûõ
					SELECT lvOrderTvrView
					COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

					IF lnPredchk &gt; 0
						llblock = .T.
					ENDIF	
					
					*--çàáëîêèðóåì ÷àñòü êíîïîê
					IF llblock
						thisform._block_in(.T.)
					ENDIF					
									
				OTHERWISE
					MESSAGEBOX([Äàííûé ïîëüçîâàòåëü íå ÿâëÿåòñÿ ìåíåäæåðîì],48,[Îêíî ñîîáùåíèé])
					RETURN .F.
			ENDCASE
		ELSE
			MESSAGEBOX([Íåò ïðèâÿçêè ïîëüçîâàòåëÿ ê êëèåíòó],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ENDIF
ELSE
	*--çàáëîêèðóåì êíîïêè ìåíåäæåðà
	thisform.cmdPredChkCancel.Enabled = .F.
	thisform.cmdPrintCancel.Enabled = .F.
	thisform.cmdDelM.Enabled = .F.
	thisform.cmdClose.Enabled = .F.
	thisform.cmdOrderDel.Enabled = .F.
	thisform.CmdCHKBACK.Enabled = .F.
	thisform.cmdXReport.Enabled = .F.
	thisform.lmanagerwork = .F.
	this.BackColor = RGB(239,228,250)
	this.ForeColor = RGB(255,128,64)
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdXReport</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 700
Height = 50
Width = 50
Picture = ..\graphic\x_otchet_.gif
DownPicture = ..\graphic\x_otchet_pr.gif
DisabledPicture = ..\graphic\x_otchet_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 30
Name = "CmdXReport"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðèì, äîñòóïíà ëè ïå÷àòü X-îò÷åòà íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü X-îò÷åòà íå ïðåäóñìîòðåíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
thisform.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

thisform.Shtrih.ReportX()
thisform.Shtrih.RELEASE

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdMenu</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>ColumnCount = 7
FontSize = 28
GridLines = 3
HeaderHeight = 0
Height = 239
Left = 1
Panel = 1
ReadOnly = .T.
RecordMark = .F.
RecordSource = "tmpmenu"
RowHeight = 55
ScrollBars = 2
Top = 361
Width = 800
ForeColor = 0,0,160
GridLineColor = 29,29,29
ZOrderSet = 31
Name = "GrdMenu"
Column1.FontSize = 10
Column1.ControlSource = "tmpmenu.t1"
Column1.Width = 106
Column1.ReadOnly = .T.
Column1.Sparse = .F.
Column1.ForeColor = 0,0,160
Column1.Name = "Column1"
Column2.FontSize = 10
Column2.ControlSource = "tmpmenu.t2"
Column2.Width = 106
Column2.ReadOnly = .T.
Column2.Sparse = .F.
Column2.ForeColor = 0,0,160
Column2.Name = "Column2"
Column3.FontSize = 10
Column3.ControlSource = "tmpmenu.t3"
Column3.Width = 106
Column3.ReadOnly = .T.
Column3.Sparse = .F.
Column3.ForeColor = 0,0,160
Column3.Name = "Column3"
Column4.FontSize = 10
Column4.ControlSource = "tmpmenu.t4"
Column4.Width = 106
Column4.ReadOnly = .T.
Column4.Sparse = .F.
Column4.ForeColor = 0,0,160
Column4.Name = "Column4"
Column5.FontSize = 10
Column5.ControlSource = "tmpmenu.t5"
Column5.Width = 106
Column5.ReadOnly = .T.
Column5.Sparse = .F.
Column5.ForeColor = 0,0,160
Column5.Name = "Column5"
Column6.FontSize = 10
Column6.ControlSource = "tmpmenu.t6"
Column6.Width = 106
Column6.ReadOnly = .T.
Column6.Sparse = .F.
Column6.ForeColor = 0,0,160
Column6.Name = "Column6"
Column7.FontSize = 10
Column7.ControlSource = "tmpmenu.t7"
Column7.Width = 108
Column7.ReadOnly = .T.
Column7.Sparse = .F.
Column7.ForeColor = 0,0,160
Column7.Name = "Column7"
</properties>
		<protected/>
		<methods>PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdMenu._RSRequery
* Called by.......: &lt;&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LPARAMETER	tvar,  tcNM	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

IF !EMPTY(tcNM)
	*--îïðåäåëèì ID âûáðàííîãî ìíîæåñòâà
	SELECT lvPOSFuncInSetView
	LOCATE FOR ALLTRIM(lvPOSFuncInSetView.NM)==ALLTRIM(tcNM)
	IF !FOUND()
		MESSAGEBOX([Íå íàéäåí òîâàð. FrmOrderEdit.GrdMenu._rsrequery().],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF		
	thisform._paintmenu(tvar,lvPOSFuncInSetView.ID)
ELSE
	thisform._paintmenu(tvar)
ENDIF
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column1</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>882072490</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column1</parent>
		<properties>Left = 1
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column2</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RX0UFZLH</uniqueid>
		<timestamp>884107607</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column2</parent>
		<properties>Left = 14
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column3</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>887319937</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column3</parent>
		<properties>Left = 3
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>887319937</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column4</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column4</parent>
		<properties>Left = 4
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>887321259</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column5</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column5</parent>
		<properties>Left = 17
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>887327567</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column6</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column6</parent>
		<properties>Left = 6
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>893740843</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column7</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmordereditexclusiv.GrdMenu.Column7</parent>
		<properties>Left = 7
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SC0I42EJ</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdUp</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 320
Left = 509
Height = 32
Width = 34
Picture = ..\graphic\_carry_in.bmp
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .F.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 32
Name = "CmdUp"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF thisform._menusel
	*--âîçâðàùàåìñÿ â ãëàâíîå ìåíþ
	thisform._menusel = .F.
	thisform.grdmenu._rsrequery(1)
	thisform.lblPar.Visible = .F.
	thisform.lblPar.caption = []
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGrdDown</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 111
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow_down_.gif
DownPicture = ..\graphic\arrow_down_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 33
Name = "CmdGrdDown"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF !EOF([lvOrderTvrView])
	SELECT lvOrderTvrView
	SKIP 1

	thisform.grdOrder.Refresh()
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGrdUp</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 61
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow_up_.gif
DownPicture = ..\graphic\arrow_up_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 34
Name = "CmdGrdUp"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF !BOF([lvOrderTvrView])
	SELECT lvOrderTvrView
	SKIP -1

	thisform.grdOrder.Refresh()
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDevOrder</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 161
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow2_.gif
DownPicture = ..\graphic\arrow2_pr.gif
DisabledPicture = ..\graphic\arrow2_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 35
Name = "CmdDevOrder"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnQnt, ;
	  luResAdding, ;
	  lnFrmTypeID, ;
	  llResSaveOrd, ;
	  llResSavePos, ;
	  lNewFrmID, ;
	  lnDefClt,;
	  _PARAM 	

lnQnt = 0
lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

IF MESSAGEBOX([Ïåðåíåñòè ïîìå÷åííûå ïîçèöèè â íîâûé çàêàç?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--ïîñ÷èòàåì ïîçèöèè, ïîìå÷åííûå äëÿ ïåðåíîñà
SELECT lvOrderTvrView
COUNT ALL FOR lvOrderTvrView.mark TO lnQnt

IF lnQnt&lt;=0
	MESSAGEBOX([Íå ïîìå÷åíî íè îäíîé ïîçèöèè äëÿ ïåðåíîñà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--ïåðåíåñåì ïîìå÷åííûå ïîçèöèè â íîâûé çàêàç
USE IN SELECT([lvFrmEdit1])
USE lvFrmEdit IN 0 ALIAS lvFrmEdit1 NODATA
CURSORSETPROP([BUFFERING],3,[lvFrmEdit1])

BEGIN TRANSACTION	
	*--ñôîðìèðóåì øàïêó íîâîãî çàêàçà	
	SELECT lvFrmEdit1
	APPEND BLANK
	REPL lvFrmEdit1.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit1.PointEmiCltID WITH lvFrmEdit.PointEmiCltID, ;
		 lvFrmEdit1.PointEmiOUID WITH lvFrmEdit.PointEmiOUID, ;
		 lvFrmEdit1.FrmTypeID WITH lvFrmEdit.FrmTypeID, ;
		 lvFrmEdit1.FrmDate WITH DATETIME(), ;
		 lvFrmEdit1.ID_ WITH 1, ;
		 lvFrmEdit1.FrmCurTypeID WITH 1, ;
		 lvFrmEdit1.FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,DATETIME(),lvFrmEdit.PointEmiOUID)
	
	*--ñîõðàíèì øàïêó	
	llResSaveOrd = thisform.cstDataWork.Save([lvFrmEdit1]) 		
	IF !llResSaveOrd
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
	*--ïîëó÷èì FrmID íîâîãî çàêàçà
	lNewFrmID = spGetLastIncrementedID([lvFrmEdit1])
	
	*--ñôîðìèðóåì ïîçèöèè íîâîãî çàêàçà
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark
	    _PARAM = lvOrderTvrView.FrmPartTvrID
		USE IN SELECT([lvOrderTvrEdit])
		USE lvOrderTvrEdit IN 0
		SELECT lvOrderTvrEdit
		REPLACE lvOrderTvrEdit.FrmID WITH lNewFrmID IN lvOrderTvrEdit
			
		llResSavePos = TABLEUPDATE(.T.)
		
		IF !llResSavePos
			*--Îòêàòûâàåì òðàíçàêöèþ
			ROLLBACK
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
		SELECT lvOrderTvrView
	ENDSCAN
	
*--Ïîäòâåðæäàåì òðàíçàêöèþ
END TRANSACTION
	
	ThisForm.grdOrder._RSRequery()

MESSAGEBOX([Ïîìå÷åííûå ïîçèöèè ïåðåíåñåíû â íîâûé çàêàç.],64,[Îêíî ñîîáùåíèé])

	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UL11Z7IE</uniqueid>
		<timestamp>921527264</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCardNo</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 3
BackStyle = 0
BorderStyle = 0
Value = 
Enabled = .F.
Height = 25
Left = 338
Top = 31
Width = 93
ForeColor = 0,0,255
BackColor = 239,228,250
DisabledBackColor = 239,228,250
DisabledForeColor = 128,128,255
ZOrderSet = 36
Name = "txtCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UL11Z7IF</uniqueid>
		<timestamp>951881481</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 219
Left = 508
Height = 48
Width = 58
ZOrderSet = 37
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	*------------------------------------------------------------------------------

	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	This.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALBs5tW5wMgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1US0TUWOI</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdCHKBACK</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 262
Left = 500
Height = 50
Width = 50
FontBold = .T.
FontName = "Times New Roman"
FontSize = 18
Picture = ..\graphic\return_.gif
DownPicture = ..\graphic\return_pr.gif
DisabledPicture = ..\graphic\return_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
ForeColor = 128,128,255
BackColor = 239,228,250
DisabledForeColor = 192,192,192
DisabledBackColor = 255,255,255
ZOrderSet = 38
Name = "CmdCHKBACK"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lPayMode


LOCAL lRetVal

		*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._close()
		thisform._ok()

		lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],ThisForm.nfrmid ,thisform.nPayVarNum, 2,0)

ThisForm.grdOrder._RSRequery()
		*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._open()
		IF TYPE([lRetVal])==[L] AND !lRetVal
		RETURN lRetVal
	    ENDIF
	
	thisform.Hide()
	RETURN lRetVal

************************ñÒÀÐÎÅ

*-- ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, äîñòóïåí ëè âîçâðàò çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0 OR VAL(oRes.GetParam([RST],[CHKBACK]))&lt;&gt;1
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå âîçâðàò çàêàçîâ íåäîñòóïåí.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--  ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, ÿâëÿåòñÿ ëè îôèöèàíò êàññèðîì
IF !thisform._iscasher()
	RETURN .F.
ENDIF

*--  ÏÅÐÅÍÅÑÒÈ îïëàòà çàêàçà (èçìåíèì ñòàòóñ çàêàçà, íàïå÷àòàåì ôèñêàëüíûé ÷åê)
IF RECCOUNT([lvOrderTvrView])&gt;0

	*--âûáåðåì òèï îïëàòû ïðè âîçâðàòå
	lPayMode = oApp.DoModalFormRetValObj([FrmBackPayment;rst_v1.vcx],ThisForm.nOrderSum)

	IF TYPE([lPayMode])==[L] AND !lPayMode
		*--îòìåíà îïëàòû çàêàçà
		RETURN .F.
	ENDIF

	*--ñîõðàíèì âñå äàííûå (çàêàç ïîêà íå îïëà÷åí)
	thisform.lorderpay = .F.
	thisform._ok()

	*--ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
	IF thisform._storechktransBACK(lPayMode)
	
		*--äëÿ ñîõðàíåíèÿ çàêàçà ñî ñòàòóñîì "îïëà÷åí"
		thisform.lorderpay = .T.
		
		*--äëÿ ñîõðàíåíèÿ çàêàçà ñ ôëàãîì âîçâðàòà
		thisform.lOrderReturn = .T.

		*--ñîõðàíèì âñå äàííûå
		thisform._ok()
		
		*--Ñêðûâàåì ôîðìó
		thisform.Hide()
	ELSE
		*--çàêàç îñòàëñÿ íåîïëà÷åííûì
		thisform.lorderpay = .F.
		thisform.lOrderReturn = .F.
		RETURN .F.
	ENDIF
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X30ZY8U0</uniqueid>
		<timestamp>922913803</timestamp>
		<class>txtcalcint</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtbarcod</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 3
Value = 0
ControlSource = ""
Format = "R"
Height = 29
InputMask = "9999999999999"
Left = 548
Top = 321
Width = 214
ForeColor = 0,0,255
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 39
_highlightselfcolor = RGB(239,228,250)
nlength = 13
Name = "Txtbarcod"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XI0YT4KX</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdNoDisc</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 31
Left = 729
Height = 27
Width = 31
FontBold = .T.
FontSize = 12
Picture = ..\graphic\stdtlbdele.bmp
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 40
Name = "CmdNoDisc"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--óäàëåíèå ñêèäêè èç çàêàçà
thisform.cntDiscID.cmdClear.Click()

*--ñîõðàíèì íîìåð êàðòû (ïóñòîé)
SELECT lvFrmEdit
REPLACE lvFrmEdit.FrmNote WITH ''
			
*--ñêðîåì ñóììó íàêîïëåíèÿ
thisform.lblSumAccount.Visible  = .F.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDisc</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 31
Left = 768
Height = 27
Width = 31
FontBold = .T.
FontSize = 12
Caption = "%"
Enabled = .T.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 41
Name = "CmdDisc"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnMODEDISC, ;
	  lretNo, ;
	  _PARAM, ;
	  ldiscID, ;
	  lnNoLblSum	

lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))
lnNoLblSum = VAL(oRes.GetParam([RST],[NOLBLSUM]))

IF lnMODEDISC&lt;&gt;1
	RETURN .F.
ENDIF

*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíèòîâ
thisform.olecommprox1._close()

*--ïîëó÷èì ID êàðòû
lretNo = oApp.DoModalFormRetValObj([FrmDiscount;rst_v1.vcx])

*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
thisform.olecommprox1._open()

*--ïðîâåðèì ñ÷èòàííûé íîìåð êàðòî÷êè
IF TYPE([lretNo])==[C]
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvDiscCardByNo])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS
	
	_PARAM = lretNo
	USE lvDiscCardByNo IN 0
	
	IF RECCOUNT([lvDiscCardByNo])&gt;0
		IF lvDiscCardByNo.DiscCardIsActive
			*--ñîõðàíèì íîìåð êàðòû
			SELECT lvFrmEdit
			REPLACE lvFrmEdit.FrmNote WITH ALLTRIM(STR(lvDiscCardByNo.DiscCardID))
			
			*--âûáåðåì ñêèäêó â ñîîòâåòñòâèè ñ êàðòîé
			ldiscID = lvDiscCardByNo.DiscID
			thisform.cntDiscID.Setvalue(ldiscID)
			thisform.cntDiscID._HandleAnyChange()
			
			*--ïîêàæåì ñóììó íàêîïëåíèÿ
			IF EMPTY(lnNoLblSum)
				thisform.lblSumAccount.Caption = [Ñóììà íàêîïëåíèÿ   ]+ALLTRIM(STR(lvDiscCardByNo.DiscCardSumAccount,99,2))
				thisform.lblSumAccount.Visible  = .T.
			ENDIF
			
		ELSE
			MESSAGEBOX([Äàííàÿ êàðòà íå àêòèâíà.]+CHR(13)+;
			[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ELSE
		MESSAGEBOX([Êàðòà íå íàéäåíà.]+CHR(13)+;
		[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
	
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951881481</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñêèäêà"
Height = 25
Left = 524
Top = 32
Width = 63
TabIndex = 26
ForeColor = 0,0,255
ZOrderSet = 8
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>932992837</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdEnter</objname>
		<parent>frmordereditexclusiv</parent>
		<properties>Top = 320
Left = 763
Height = 30
Width = 35
Picture = ..\graphic\barcode_.gif
DownPicture = ..\graphic\barcode_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 42
Name = "CmdEnter"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM, ;
		ltvrid
		
*--îïðåäåëèì êîä òîâàðà ïî øòðèõ-êîäó
	USE IN SELECT([lvTovarLookUpByTLU])

	_PARAM = ALLTRIM(STR(thisform.txtbarcod.value,13,0))
	USE lvTovarLookUpByTLU IN 0
	
	IF RECCOUNT([lvTovarLookUpByTLU])&gt;0
		ltvrid = lvTovarLookUpByTLU.tvrid
	
		*--äîáàâèì áëþäî â çàêàç
		thisform.grdOrder._add(ltvrid)	
		thisform.txtbarcod.Value = 0
		thisform.txtbarcod.SetFocus()
	ELSE
		MESSAGEBOX([Øòðèõ-êîä íå íàéäåí.],0+48,[Îêíî ñîîáùåíèé])
		thisform.txtbarcod.Value = 0
		thisform.txtbarcod.SetFocus()
		RETURN .F.
	ENDIF



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmordereditexclusiv</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 20, 12, 33, 26, 72, 6, 1
Arial, 0, 10, 6, 16, 13, 35, 3, 0
Arial, 1, 20, 13, 33, 25, 71, 7, 1
Arial, 0, 28, 16, 43, 34, 99, 8, 1
Times New Roman, 1, 18, 10, 27, 21, 61, 5, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>951882120</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmorderedit</objname>
		<parent/>
		<properties>Left = 0
Height = 600
Width = 800
ShowWindow = 1
DoCreate = .T.
AutoCenter = .F.
BorderStyle = 2
Caption = ""
ControlBox = .F.
Closable = .F.
Movable = .F.
ClipControls = .F.
BackColor = 241,239,241
nfrmid = 0
lorderpay = .F.
_qntintable = .T.
ncashno = 0
nsalesid = 0
ncheckid = 0
nordersum = 0
lmanagerwork = .F.
_menusel = .F.
lreadonly = .F.
nprctypeid = 0
lorderdelm = .F.
lblock = .F.
npayvarnum = 0
lorderreturn = .F.
Name = "frmorderedit"
cstmsghandler.Top = 32
cstmsghandler.Left = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 32
cstresizable.Left = 22
cstresizable.Name = "cstresizable"
Img1.Left = -122
Img1.Top = 77
Img1.ZOrderSet = 0
Img1.Name = "Img1"
cstdatawork.Top = 32
cstdatawork.Left = 44
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE ___kkmerrorhandler
RETURN
LPARAMETERS tcErrorMsg, ;
			tlNoReset
******    ÏÅÐÅÍÎÑÈÌ  Â ÄÐÀÉÂÅÐ Ôèñêàëüíèêà   **********************
****** Âûçîâ âñòðå÷àåòñÿ 5 ðàç
*11.10.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnECRAdvancedMode, ;
		lnCheckID, ;
		loStatus
***
lnCheckID = This.nCheckID
*------------------------------------------------------------------------------

WITH This

*11.10.2006 16:53 -&gt;Ñîõðàíèì ñîîáùåíèå â ëîãå
IF VARTYPE(tcErrorMsg) == [C]
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + tcErrorMsg,[KKM.LOG],1)
ENDIF
*------------------------------------------------------------------------------

*16.10.2006 15:38 -&gt;
loStatus = oApp.CreateObject([frmKKMStatus;pos_v1.vcx],.Shtrih)

loStatus.Show(1)

IF loStatus.uRetVal
	IF NOT tlNoReset
		.CheckReset()
	ELSE
		.Shtrih.CancelCheck()
	ENDIF
ELSE
	.Shutdown(.T.)
ENDIF
*------------------------------------------------------------------------------

*!*	*12.10.2006 10:15 -&gt;Ïûòàåìñÿ îáðàáîòàòü îøèáêó
*!*	DO WHILE .T.

*!*	*11.10.2006 17:04 -&gt;Ïîëó÷èì ïîäðåæèì ÊÊÌ
*!*	lnECRAdvancedMode = .Shtrih.GetECRAdvancedMode(.T.)
*!*	*------------------------------------------------------------------------------

*!*	*11.10.2006 17:10 -&gt;Àíàëèçèðóåì ïîäðåæèì
*!*	DO CASE
*!*		CASE BETWEEN(.Shtrih.ErrorCode,-6,-1)
*!*			.Shtrih.Beep()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,1,2)
*!*			MESSAGEBOX([Âñòàâüòå ðóëîí áóìàãè â ÊÊÌ],64,[Ïðåäóïðåæäåíèå])
*!*			LOOP
*!*		CASE lnECRAdvancedMode = 3
*!*			.Shtrih.ContinuePrint()
*!*			LOOP
*!*		CASE INLIST(lnECRAdvancedMode,4,5)
*!*			LOOP
*!*		OTHERWISE
*!*			***
*!*			IF NOT tlNoReset
*!*				.CheckReset()
*!*			ELSE
*!*				.Shtrih.CancelCheck()
*!*			ENDIF
*!*			***
*!*			EXIT
*!*	ENDCASE
*!*	*------------------------------------------------------------------------------

*!*	ENDDO
*------------------------------------------------------------------------------
*********** ÏÅÐÅÍÎÑÈÌ
*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
spSaleFiscError(lnCheckID)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE __iscasher
RETURN
*-- ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, ÿâëÿåòñÿ ëè äàííûé îôèöèàíò êàññèðîì
LOCAL _PARAM

USE IN SELECT([lvcashierByCltView])
_PARAM = spUserClt()
USE lvcashierByCltView IN 0

IF RECCOUNT([lvcashierByCltView])&lt;=0
	MESSAGEBOX([Äàííûé îôèöèàíò íå ÿâëÿåòñÿ êàññèðîì],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ELSE
	RETURN .T.
ENDIF
ENDPROC
PROCEDURE __storechktrans
RETURN
*----- ÏÅÐÅÍÎÑÈÌ -------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: tfsctype - òèï îïëàòû, tfscexp - ïàðàìåòðû ôèñêàëüíîãî ÷åêà
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå òðàíçàêöèè ÷åêà
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype, tfscexp

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lnDiscount, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

lfsctype = tfsctype
ls1 = VAL(SUBSTR(tfscexp,AT([(],tfscexp)+1,AT([,],tfscexp,1)-AT([(],tfscexp)-1))
ls2 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,1)+1,AT([,],tfscexp,2)-AT([,],tfscexp,1)-1))
ls3 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,2)+1,AT([,],tfscexp,3)-AT([,],tfscexp,2)-1))
ls4 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,3)+1,AT([)],tfscexp)-AT([,],tfscexp,3)-1))


*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*------------------------------------------------------------------------------

WITH This

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,1,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

*--Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID

	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleTran(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1

	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------

	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.CheckDiscount(lnDiscount)
	WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	
	*--Ïðèâÿçûâàåì äèñêîíòíóþ êàðòó ê ÷åêó
	spBindDisc(.nCheckID,VAL(lvFrmEdit.FrmNote))

	*--Äîáàâëÿåì ïîçèöèþ ñêèäêè  â ÷åê
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
	
	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECCOUNT([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 7, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lnDiscTvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH 1, ;
		lvCheckTransEdit.CheckTransPrc		WITH lnDiscount ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------
ENDIF


*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
WAIT WINDOW [Ïîäîæäèòå...] TIMEOUT 1
	

*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF

*------------------------------------------------------------------------------

WAIT CLEAR
RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE __storechktrans_pred
RETURN
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This

*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
						IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
						+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
						[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

.Shtrih.PrintString(REPLICATE([-],60))

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

IF lcnt&lt;30
	.Shtrih.FeedDocument(30-lcnt)
ENDIF

*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._FooterPrint()

.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
ThisForm.grdOrder._RSRequery()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktrans_slim
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPredChk.Click()&gt;
* Parameters......: tCardID
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ÑËÈÏ (ïðè îïëàòå êàðòîé)
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETERS tCardID

MESSAGEBOX('Ìåòîä â äðóãîé áèáëèîòåêå' , 0+16 , 'Ñîîáùèòå îá ýòîì ðàçàðáîò÷èêó')
RETURN

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lcnt, ;
		lCardID, ;
		lCardNo, ;
		lFIO, ;
		_PARAM

*--ïîëó÷èì èíôîðìàöèþ ïî êàðòå
lCardID = tCardID
lCardNo = []

USE IN SELECT([lvCardViewByCardID])
_PARAM = lCardID
USE lvCardViewByCardID IN 0

IF RECCOUNT([lvCardViewByCardID])&gt;0
	lFIO = lvCardViewByCardID.CltNM
	lCardNo = lvCardViewByCardID.CardNo
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This
*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÑËÈÏ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*12.04.2006 17:22 -&gt;Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,30)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,3)),10)+[*]+ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),40,[ ]))

IF lcnt&lt;15
	.Shtrih.FeedDocument(12-lcnt)
ELSE
	.Shtrih.FeedDocument(3)
ENDIF

IF !EMPTY(lCardID)
	*--Ðàñïå÷àòàåì èíôîðìàöèþ ïî  VIP êàðòå
	.Shtrih.PrintString([¹ êàðòû ]+ALLTRIM(lCardNo))

	IF !EMPTY(lFIO)
		.Shtrih.PrintString(ALLTRIM(lFIO))
	ENDIF
ENDIF

.Shtrih.FeedDocument(1)
.Shtrih.PrintString([Ïîäïèñü]+PADL([_____________________________],35,[ ]))
.Shtrih.FeedDocument(1)
.Shtrih.PrintString(REPLICATE([=],60))
.Shtrih.FeedDocument(10)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*--Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE __storechktransback
RETURN
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTransBACK
* Called by.......: &lt;cmdCHKBACK.Click()&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ôèñêàëüíûé ÷åê íà âîçâðàò
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype

LOCAL   lcUniqueFileNM, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

WITH This

*--ñôîðìèðóåì âûðàæåíèå äëÿ ñóìì â çàâèñèìîñòè îò òèïà îïëàòû
lfsctype = tfsctype
ls1 = IIF(lfsctype=1,.nordersum,0) &amp;&amp;--îïëàòà íàëè÷íûìè
ls2 = IIF(lfsctype=2,.nordersum,0) &amp;&amp;--îïëàòà áàíêîâñêîé êàðòîé
ls3 = IIF(lfsctype=3,.nordersum,0) &amp;&amp;--îïëàòà êóïîíîì
ls4 = IIF(lfsctype=4,.nordersum,0) &amp;&amp;--îïëàòà VIP êàðòîé

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,2,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()

*--Îòêðûâàåì ÄÌ äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN ALL
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleReturn(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
	

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF
*------------------------------------------------------------------------------

RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE _block_in
*--áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
LPARAMETERS tblock

LOCAL ldiscount, ;
	  lpredchk, ;
	  lkol,;
	  lnMODEDISC

*--îïðåäåëèì, áûëà ëè ñäåëàíà ñêèäêà ïî çàêàçó
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
IF FOUND()
	ldiscount = .T.
ENDIF

*--îïðåäåëèì, áûë ëè íàïå÷àòàí ïðåä÷åê ïî çàêàçó
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lkol

IF lkol &gt; 0
	lpredchk = .T.
ENDIF

*--îïðåäåëèì ðåæèì ñêèäêè
lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))
		
WITH thisform
	IF tblock
		*--çàáëîêèðóåì ââîä
		.lblock = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		*--â çàâèñèìîñòè îò ðåæèìà ñêèäêè
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ELSE
			.cmdDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
			.cmdNoDisc.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPredchk.Enabled = IIF(lpredchk,.F.,IIF(ldiscount,.T.,.F.))
		.CmdDelM.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
		.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width)
		.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
		IF ldiscount
			*--ðàçáëîêèðóåì òîëüêî äâå êíîïêè (åñëè ñíÿëè ïðåä÷åê, íî åñòü ñêèäêà)
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.CmdPredchk.Enabled = .T.
		ELSE
			*--ðàçáëîêèðóåì ââîä
			.lblock = .F.
			.GrdOrder.ReadOnly = .F.
			.GrdMenu.ReadOnly = .F.
			.TxtAttr.ReadOnly = .F.
			.cntOUTableID.Enabled = .T.
			
			IF lnMODEDISC&lt;&gt;1
				.CntDiscID.Enabled = .T.
			ELSE
				.cmdDisc.Enabled = .T.
				.cmdNoDisc.Enabled = .T.
			ENDIF
			
			.Cntnumericpad1.ImgButton1.Enabled = .T.
			.Cntnumericpad1.ImgButton2.Enabled = .T.
			.Cntnumericpad1.ImgButton3.Enabled = .T.
			.Cntnumericpad1.ImgButton4.Enabled = .T.
			.Cntnumericpad1.ImgButton5.Enabled = .T.
			.Cntnumericpad1.ImgButton6.Enabled = .T.
			.Cntnumericpad1.ImgButton7.Enabled = .T.
			.Cntnumericpad1.ImgButton8.Enabled = .T.
			.Cntnumericpad1.ImgButton9.Enabled = .T.
			.Cntnumericpad1.ImgButton0.Enabled = .T.
			.Cntnumericpad1.ImgButtonDelete.Enabled = .T.
			.Cntnumericpad1.ImgButtonPoint.Enabled = .T.
			.CmdUp.Enabled = .T.
			.CmdPlus.Enabled = .T.
			.CmdMinus.Enabled = .T.
			.CmdDel.Enabled = .T.
			.CmdDevOrder.Enabled = .T.
			.txtbarcod.Enabled = .T.
			.cmdEnter.Enabled = .T.
			.CmdPredchk.Enabled = .T.
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE _clickmenu
*--ïðè íàæàòèè êíîïêè ìåíþ ðàñêðîåì äåðåâî äëÿ äàëüíåéøåãî âûáîðà èëè ñäåëàåì âûáîð
LPARAMETERS tcNM
LOCAL _PARAM, lcModList, lnModID

IF !thisform.lReadOnly AND !thisform.lblock
	IF !thisform._menusel
		IF !EMPTY(tcNM) AND tcNM&lt;&gt;[ïóñòî]
			*--ðàñêðûâàåì äàëüøå
			thisform.grdmenu._rsrequery(2,tcNM)
			thisform._menusel = .T.
			thisform.lblPar.Visible = .T.
			thisform.lblPar.caption = ALLTRIM(tcNM)
		ENDIF
	ELSE
		*--äåëàåì âûáîð
		SELECT curBuild
		LOCATE FOR ALLTRIM(curBuild.NM)==ALLTRIM(tcNM)
				
		IF FOUND()
			*--äîáàâèì áëþäî â çàêàç
			thisform.grdOrder._add(curBuild.ID)	
			
			*--ïîëó÷èì ñïèñîê ìîäèôèêàòîðîâ äëÿ äàííîãî áëþäà
			_PARAM = curBuild.ID
			REQUERY([lvModList])
			
			*--åñëè ñïèñîê ìîäèôèêàòîðîâ íåïóñò, ïîêàæåì åãî
			IF RECCOUNT([lvModList])&gt;0
				lcModList = oApp.DoModalFormRetValObj([FrmModList;rst_v1.vcx],_PARAM)
			ENDIF
			
			*--åñëè ÷òî-òî âûáðàëè, òî äîáàâèì â çàêàç
			IF TYPE([lcModList])==[C] AND !EMPTY(lcModList)
				DO WHILE !EMPTY(lcModList)
					*--âûäåëèì ID ìîäèôèêàòîðà èç ñïèñêà
					lnModID = VAL(LEFT(lcModList,AT([,],lcModList)-1))
					
					*--äîáàâèì â çàêàç
					thisform.grdOrder._add(lnModID)	
					
					*--îáðåæåì ñïèñîê
					lcModList = RIGHT(lcModList,LEN(lcModList)-AT([,],lcModList))
				ENDDO
			ENDIF
		ELSE
			IF !EMPTY(tcNM)
				MESSAGEBOX([Íå íàéäåí òîâàð ]+ALLTRIM(tcNM),48,[Îêíî ñîîáùåíèé])
			ENDIF
		ENDIF		
	ENDIF
ENDIF
ENDPROC
PROCEDURE _closeday
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmorderedit.CloseDay
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàêðûòèå ñìåíû
*------------------------------------------------------------------------------

*--Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnSalesID, ;
		_PARAM, ;
	    _PARAM_DOP

WITH This
*--Ïðîâåðèì íåîáõîäèìîñòü çàêðûòèÿ ñìåíû
IF .nSalesID = 0
	lnSalesID = spGetOpenDay(.nCashNo,.T.)
	DO CASE
		CASE lnSalesID &gt; 0
			.nSalesID = lnSalesID
		CASE lnSalesID = 0
			MESSAGEBOX([Ñìåíà íå îòêðûòà.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
		OTHERWISE
			MESSAGEBOX([Ëîêàëüíàÿ ñìåíà óæå çàêðûòà]+CHR(13)+;
					[Äëÿ çàêðûòèÿ îáùåé ñìåíû îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[Îêíî ñîîáùåíèé])
			RETURN .F.
	ENDCASE
ENDIF

*--äëÿ Ëèäåðà ïðîâåðèì íàëè÷èå íåîïëà÷åííûõ çàêàçîâ
IF VAL(oRes.GetParam([RST],[CLOSEDAY]))=1 &amp;&amp;--ìîæíî îòêëþ÷èòü ýòó ïðîâåðêó
	*--îòêðîåì ñïèñîê âñåõ íåîïëà÷åííûõ çàêàçîâ
	_PARAM = VAL(oRes.GetParam([RST],[TYPEORD]))
	_PARAM_DOP = VAL(oRes.GetParam([RST],[TBLPAR]))
	USE IN SELECT([lvMgrView])
	USE lvMgrView IN 0
	IF RECCOUNT([lvMgrView])&gt;0
		MESSAGEBOX([Íåëüçÿ çàêðûòü ñìåíó ïðè íàëè÷èè íåîïëà÷åííûõ çàêàçîâ.]+CHR(13)+;
					[Äëÿ ïðîñìîòðà âñåõ íåîïëà÷åííûõ çàêàçîâ âîñïîëüçóéòåñü êàðòî÷êîé ìåíåäæåðà.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
ENDIF

*------------------------------------------------------------------------------

*12.04.2006 14:01 -&gt;Çàêðûâàåì ëîêàëüíûé äåíü
spSaleCloseDay(.nSalesID,.nCashNo)
*------------------------------------------------------------------------------

*--Ïå÷àòàåì Z-îò÷åò
	*13.04.2006 16:22 -&gt;Ïå÷àòàåì Z-îò÷åò
	LOCAL lcIniFileName ,lcKkmLib
	lcIniFileName = FULLPATH([KKM.INI])
	lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
	this.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

	this.Shtrih.CloseShift()
	This.Shtrih.Release()
	*------------------------------------------------------------------------------
*------------------------------------------------------------------------------

*--Ñáðîñèì íîìåð ñìåíû(ïðîäàæ)
.nSalesID = 0
*------------------------------------------------------------------------------

*--ñáðîñèì àâòîíóìåðàòîð
spResetAutoNum(VAL(oRes.GetParam([RST],[TYPEORD])))

MESSAGEBOX([Ëîêàëüíàÿ ñìåíà çàêðûòà.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó äëÿ çàêðûòèÿ îáùåé ñìåíû.],64,[Îêíî ñîîáùåíèé])
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************



ENDPROC
PROCEDURE _footerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì ïîäâàë ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcFooterFile, lnHandleFile, lcLine

lcFooterFile = ALLT(oRes.GetParam([RST],[CHKFTRFL]))
lcFooterFile = IIF(AT([.],lcFooterFile)=0,lcFooterFile+[.TXT],lcFooterFile)

IF !EMPTY(lcFooterFile) AND FILE(lcFooterFile)
	lnHandleFile = FOPEN(lcFooterFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _headerprint
RETURN
*-- ÏÅÐÅÍÎÑÈÌ Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcHeaderFile, lnHandleFile, lcLine

lcHeaderFile = ALLT(oRes.GetParam([RST],[CHKHDRFL]))
lcHeaderFile = IIF(AT([.],lcHeaderFile)=0,lcHeaderFile+[.TXT],lcHeaderFile)

IF !EMPTY(lcHeaderFile) AND FILE(lcHeaderFile)
	lnHandleFile = FOPEN(lcHeaderFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ENDIF

ENDPROC
PROCEDURE _ok
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDEREDIT._OK()
* Called by.......: frmOrderEdit.lblEdit.Click()
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------

LOCAL	llResSaveOrd, ;
		llDataChanged

WITH This			
	
	*--Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*--Ïîäãîòîâèìñÿ ê ñîõðàíåíèþ äàííûõ
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åíà àâòîíóìåðàöèÿ, ïðîèçâîäèì àâòîìàòè÷åñêóþ âñòàâêó íîìåðà çàêàçà
	IF .chkFrmAutoNum.Value
		REPLACE FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,lvFrmEdit.FrmDate,lvFrmEdit.PointEmiOUID) IN lvFrmEdit
	ENDIF
	*-- Îòìå÷àåì äàòó ïîñëåäíåãî èçìåíåíèÿ
	REPLACE FrmDateAcc WITH DATETIME() IN lvFrmEdit
	
	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã óäàëåíèÿ çàêàçà ìåíåäæåðîì, ïîìåíÿåì åãî àòðèáóòû
	IF .lorderDelM
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,30) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Åñëè âêëþ÷åí ôëàã âîçâðàòà, óêàæåì ýòî â àòðèáóòàõ çàêàçà
	IF .lOrderReturn
		REPLACE FrmAttribute WITH BITSET(FrmAttribute,0) IN lvFrmEdit
	ENDIF
	*------------------------------------------------------------------------------
	
	*-- ÎÑÒÀÅÒÑß Ïðîèçâîäèì ñîõðàíåíèå øàïêè çàêàçà
	llDataChanged = .cstDataWork.DataChanged([lvFrmEdit],.T.)
	IF llDataChanged
		llResSaveOrd = .cstDataWork.Save([lvFrmEdit])
	ELSE
		llResSaveOrd = .T.
	ENDIF
	*------------------------------------------------------------------------------

	*-- ÎÑÒÀÅÒÑß Îáðàáîòàåì ðåçóëüòàòû ÂÑÅÕ îïåðàöèé ñîõðàíåíèÿ
	IF llResSaveOrd
		*--Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		.uRetVal = .T.
	ELSE
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		.uRetVal = .F.
	ENDIF
ENDWITH
*------------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _paintmenu
*--íàðèñóåì ìåíþ ñ êíîïêàìè
LPARAMETERS tnVar, tnIDSET
LOCAL i, lcexp, _PARAM

*--ñíà÷àëà âûáåðåì äàííûå âî âðåìåííûé êóðñîð, ïî êîòîðîìó áóäåò ñòðîèòüñÿ ìåíþ
DO CASE
	CASE tnVar = 1
		SELECT ;
			lvPOSFuncInSetView.NM AS NM, ;
			lvPOSFuncInSetView.ID AS ID ;
		FROM lvPOSFuncInSetView ;
		INTO CURSOR curBuild NOFILTER

	CASE tnVar = 2
		USE IN SELECT([lvTvrInSetView])
		_PARAM = tnIDSET
		USE lvTvrInSetView IN 0	
			
		*19.04.2006 15:23 -&gt;Ïîëó÷èì èäåíòèôèêàòîð ïðàéñà
		USE IN SELECT([lvTvrSetInfo])
		_PARAM = tnIDSET
		USE lvTvrSetInfo IN 0
		ThisForm.nPrcTypeID = lvTvrSetInfo.PrcTypeID
		*------------------------------------------------------------------------------
			
		SELECT ;
			lvTvrInSetView.TvrNM AS NM, ;
			lvTvrInSetView.TvrID AS ID ;
		FROM lvTvrInSetView ;
		INTO CURSOR curBuild NOFILTER
	
ENDCASE

*--ïîñòðîèì ïî ýòîìó êóðñîðó  òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(80),t2 C(80),t3 C(80),t4 C(80),t5 C(80),t6 C(80),t7 C(80))

*--çàïîëíèì òàáëèöó äëÿ ìåíþ
i = 1
SELECT tmpmenu
APPEND BLANK

SELECT curBuild
GO TOP
DO WHILE !EOF([curBuild])
	IF i&lt;=thisform.GrdMenu.ColumnCount
		lcexp = [REPL tmpmenu.t]+ALLTRIM(STR(i))+[ WITH NVL(curBuild.NM,'ïóñòî')]
		&amp;lcexp
		i = i+1
		SKIP 1
	ELSE
		*--ïåðåéäåì íà çàïîëíåíèå íîâîé ñòðîêè
		i = 1
		SELECT tmpmenu
		APPEND BLANK
	ENDIF
	SELECT curBuild
ENDDO

SELECT tmpmenu
GO TOP
ENDPROC
PROCEDURE _storechecktrans_pred
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmPayment._StoreCheckTrans_pred
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = UPPER(ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName))) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì

WITH This

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

IF !lcKkmLib  = [SPARK]

				.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

				*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
				LOCAL   _PARAM

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._HeaderPrint()

				*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
				.Shtrih.FeedDocument(2)
				.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
				.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
				*-* 20080410 äîáàëåíî âðåìÿ îòêðûòèÿ çàêàçà
				.Shtrih.PrintString([Íîìåð çàêàçà:]+PADR(ALLTRIM(lvFrmEdit.FrmNum),10,[ ])+[Îòêðûò:]+ TTOC(lvFrmEdit.FrmDate))
				.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
				.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
				.Shtrih.FeedDocument(3)
				.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
				.Shtrih.FeedDocument(3)

				*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
				lcnt = 0
				SELECT lvOrderTvrView
				GO TOP
				SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
					lcnt = lcnt+1
					*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
					.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
										IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
										+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
										[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
				 	*------------------------------------------------------------------------------

					*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
					IF .Shtrih.ErrorCode # 0
						STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
								  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
								  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
								  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
								  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
								
						*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
						spSaleFiscError(.nCheckID)
						*------------------------------------------------------------------------------
				    RETURN .F.
					ENDIF
					*------------------------------------------------------------------------------
					SELECT lvOrderTvrView
				ENDSCAN

				.Shtrih.PrintString(REPLICATE([-],50))

				*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
				SELECT lvOrderTvrView
				LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
				IF FOUND()
					lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
					.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
				ENDIF

				*--Ïå÷àòàåì èòîã ÷åêà
				.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

				IF lcnt&lt;10
					.Shtrih.FeedDocument(10-lcnt)
					else
					.Shtrih.FeedDocument(3)
				ENDIF

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._FooterPrint()

				.Shtrih.FeedDocument(3)
				.Shtrih.CutCheck()
				*------------------------------------------------------------------------------

				*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
				IF .Shtrih.ErrorCode # 0
					STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
							  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
							  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
							  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
							
					*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
					spSaleFiscError(.nCheckID)
				    RETURN .F.
					*------------------------------------------------------------------------------
							
				ENDIF
				*------------------------------------------------------------------------------
				This.Shtrih.Release()

	ELSE
	this.printpredtoprint()
ENDIF

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	SELECT lvOrderTvrEdit
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
RETURN .T.
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE addvip
LOCAL _PARAM

WITH thisform
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		*--Ïðîâåðèì, ÿâëÿåòñÿ ëè ýòà êàðòà ïëàòèíîâîé èëè çîëîòîé
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0

		IF RECCOUNT([lvCardViewByCardID])&gt;0 AND ;
			(lvCardViewByCardID.CardTypeID = 1 OR lvCardViewByCardID.CardTypeID = 2) AND;
			!([5]$.nPayVarNum)
			
			.nPayVarNum = .nPayVarNum + [,5]
		ENDIF
	ENDIF
ENDWITH
ENDPROC
PROCEDURE checkreset
*------- ÏÅÐÅÍÎÑÈÌ -----------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: POS_V1.vcx
* Class.Module....: FRMPOS.CHECKRESET
* Called by.......: &lt;This.KeyPress()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñáðîñ ÷åêà
*-------- ÏÅÐÅÍÎÑÈÌ ----------------------------------------------------------------------

WITH This

*16.04.2006 10:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnCheckID
***
lnCheckID = .nCheckID
*------------------------------------------------------------------------------

IF RECCOUNT([lvOrderTvrView])#0

	*12.04.2006 18:34 -&gt;Ñáðîñèì ÷åê íà ÔÐ
	.Shtrih.CancelCheck()
	*------------------------------------------------------------------------------

	*16.04.2006 10:26 -&gt;
	IF .Shtrih.ErrorCode # 0
	
		*16.04.2006 10:27 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå]
		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ñáðîñå ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(lnCheckID)), .T.)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

	*16.04.2006 10:27 -&gt;Îòìåòèì, ÷òî ÷åê ñáðîøåí îïåðàòîðîì
	spCheckSaleSucces(lnCheckID)
	*------------------------------------------------------------------------------

	*12.04.2006 15:32 -&gt;Ñáðîñèì ÷åê
	spCheckReset(.nCheckID)	
	*------------------------------------------------------------------------------

	
	.nCheckID = 0
ENDIF

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode

LOCAL   _PARAM

*--ïðîâåðèì, íå çàáëîêèðîâàí ëè ââîä
IF thisform.lReadOnly
	MESSAGEBOX([Èçìåíåíèå äàííûõ ìåíåäæåðîì íå ïðåäóñìîòðåíî.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.cntCltID.SetValue(lvCardViewByCardCode.CltID)
		.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð VIP êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspCltSAccID WITH lvCardViewByCardCode.CardID
				
		*--Äîáàâèì âîçìîæíîñòü âûáðàòü òèï îïëàòû VIP êàðòîé
		thisform.addVIP()
	ENDIF
	thisform.cmdpay.Click()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE GotFocus
DODEFAULT()
		thisform.olecommprox1._open()

ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDERADD.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnFrmTypeID - òèï äîêóìåíòà
* Returns.........: &lt;none&gt;
* LastEditDate....: 26 October 2006
* Notes...........: &lt;~&gt;
*------------------------------------------------------------------------------
LPARAMETERS tnFrmID, tlReadOnly

LOCAL	lnDefClt, ;
		lnTblType, ;
		lnTblPar, ;
		lnWaiterID, ;
		_PARAM1, ;
	_PARAM2, ;
	_PARAM, ;
	lcTableNM, ;
	lnPredchk, ;
	lnDiscTvrID, ;
	llblock, ;
	lnSalesID, ;
	lnMODEDISC


*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------
WITH thisform
	*--ID çàêàçà
	.nFrmID = tnFrmID
	
	.lblFrmId.Caption = ALLTRIM(STR(tnFrmID,10))

	*--Íîìåð ìàøèíû (êàññû)
	.nCashNo = VAL(oRes.GetParam([RST],[CASH]))

	*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
	lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

	*--ïîëó÷èì òèï ïîäðàçäåëåíèÿ "ñòîë"
	lnTblType = VAL(oRes.GetParam([RST],[TBLTYPE]))

	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))

	*--ïîëó÷èì êîä òåêóùåãî îôèöèàíòà
	lnWaiterID = spUserClt()
	
	*--ïîëó÷èì ðåæèì ñêèäêè
	lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))	
	*------------------------------------------------------------------------------

	*--  ÏÅÐÅÍÎÑÈÌ  Â ÔÓÍÊÖÈÈ ÌÅÍÅÄÆÅÐÀ îïðåäåëèì äîñòóïíîñòü êíîïîê X-îò÷åò è Z-îò÷åò äëÿ äàííîãî ïîëüçîâàòåëÿ
	.cmdClose.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[ZACC])
	.cmdXReport.Enabled = _spVerifyUserGrant(oApp.nUserKod,[CustomFunc],[XACC])

	*--------------------------------------------------------------------------------
	*--Ïîëó÷àåì èäåíòèôèêàòîð íåçàêðûòîé ñìåíû
	lnSalesID = spGetOpenDay(This.nCashNo)

	*--Ïðîâåðèì êîððåêòíîñòü äàííûõ î ïðîäàæàõ
	DO CASE
		CASE lnSalesID = -1
			MESSAGEBOX([Äåíü óæå çàêðûò.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE INLIST(lnSalesID,-2,-3)
			MESSAGEBOX([Îñòàëèñü íå çàêðûòûìè áîëåå îäíîãî äíÿ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
			oApp.lUserChange = .T.
			RETURN .F.

		CASE lnSalesID = -4

			*--Åñëè ñìåíà îòêðûòà áîëåå ñóòîê, òðåáóåì çàêðûòü åå
			IF MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
						  [áîëåå 24 ÷àñîâ.Çàêðûòü ñìåíó?],4+32,[Ñìåíà]) = 6
				***
			    This._CloseDay()
				***
			ENDIF
			
			RETURN .F.
			
		CASE lnSalesID = -5
			MESSAGEBOX([Íåèçâåcòíàÿ îøèáêà],16,[Îøèáêà])
			RETURN .F.
			
		OTHERWISE
			thisform.nsalesid = lnSalesID
	ENDCASE
	*------------------------------------------------------------------------------

	*--Îáíîâèì ñïðàâî÷íèê ñòîëîâ
	_PARAM1 = lnTblType
	_PARAM2 = lnTblPar
	REQUERY([lvOUTableList])
	*-------------------------------------------------------------------------------
IF tnFrmID = 0 &amp;&amp; Áûñòðîå äîáàâëåíèå çàêàçà
	*--îòêðîåì ñ÷åò  è óñòàíîâèì çíà÷åíèÿ ïî óìîë÷àíèþ
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	SELECT lvFrmEdit
	APPEND BLANK
	*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
	lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))
	*------------------------------------------------------------------------------
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnWaiterID, ;  &amp;&amp; ýòî îñòàâèì âðåììåíî - ïîòîì óáåðåì
		 lvFrmEdit.DevCltId WITH lnWaiterID, ;
		 lvFrmEdit.FrmTypeID WITH lnFrmTypeID, ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
	IF TABLEUPDATE(1,.T.,[lvFrmEdit])
.nFrmID = spGetLastIncrementedID([lvFrmEdit])
ELSE
MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ äàííûõ ïðîèçîøëà îøèáêà',0+16,'Ïåðäóïðåæäåíèå')
RETURN .f.
	ENDIF
ENDIF

	*09.04.2006 14:54 -&gt;îáíîâèì Alias-û äëÿ ðåäàêòèðîâàíèÿ çàêàçà (øàïêà è ïîçèöèè)
	_PARAM = .nFrmID
	REQUERY([lvFrmEdit])
	REQUERY([lvOrderTvrView])
	USE lvFrmSumView IN 0

	*--îïðåäåëèì íîìåð ñòîëà (èç íàçâàíèÿ ñòîëà)
	USE IN SELECT([lvOrgUnitEdit])
	_PARAM = lvFrmEdit.PointEmiOUID
	USE lvOrgUnitEdit IN 0

	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

	*--íàïèøåì â çàãîëîâêå ôîðìû íîìåð çàêàçà
	.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)
	.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)

	**.lblEdit.Caption = [Âñåãî: ...]

	*--ïîêàæåì èìÿ êëèåíòà
	.cntCltID.Enabled = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.T.,.F.)
	.cntCltID.txtText.Width = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.txtText.Width,.cntCltID.Width+1)
	.cntCltID.cmdShow.Left = IIF(VAL(oRes.GetParam([RST],[SELCLT]))=1,.cntCltID.cmdShow.Left,.cntCltID.Width+2)
	
	*--åñëè åñòü íîìåð êàðòî÷êè, ïîêàæåì åãî
	IF !ISNULL(lvFrmEdit.PointIspOUID) AND !EMPTY(lvFrmEdit.PointIspOUID)
		USE IN SELECT([lvCardViewByCardID])
		_PARAM = lvFrmEdit.PointIspOUID
		USE lvCardViewByCardID IN 0
		
		IF RECCOUNT([lvCardViewByCardID])&gt;0
			.txtCardNo.value = ALLTRIM(lvCardViewByCardID.CardNo)
		ENDIF
	ENDIF
	
	*--îïðåäåëèì âîçìîæíûå âàðèàíòû îïëàòû (â çàâèñèìîñòè îò íàñòðîéêè è êàðòî÷êè)
	.nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
	
	*--äîáàâèì âàðèàíò îïëàòû ïî VIP êàðòå, åñëè ýòî âîçìîæíî
	.addVIP()
	
	*--íàðèñóåì êíîïî÷íîå ìåíþ
	.grdmenu._rsrequery(1)

	*--åñëè ðàáîòàåò ìåíåäæåð, òî çàïðåòèì ðåäàêòèðîâàíèå äàííûõ, äîñòóïíî òîëüêî çàêðûòèå ñìåíû
	IF tlReadOnly
		.lReadOnly = .T.
		.GrdOrder.ReadOnly = .T.
		.GrdMenu.ReadOnly = .T.
		.TxtAttr.ReadOnly = .T.
		.cntOUTableID.Enabled = .F.
		
		IF lnMODEDISC&lt;&gt;1
			.CntDiscID.Enabled = .F.
		ELSE
			.cmdDisc.Enabled = .F.
			.cmdNoDisc.Enabled = .F.
		ENDIF
		
		.Cntnumericpad1.ImgButton1.Enabled = .F.
		.Cntnumericpad1.ImgButton2.Enabled = .F.
		.Cntnumericpad1.ImgButton3.Enabled = .F.
		.Cntnumericpad1.ImgButton4.Enabled = .F.
		.Cntnumericpad1.ImgButton5.Enabled = .F.
		.Cntnumericpad1.ImgButton6.Enabled = .F.
		.Cntnumericpad1.ImgButton7.Enabled = .F.
		.Cntnumericpad1.ImgButton8.Enabled = .F.
		.Cntnumericpad1.ImgButton9.Enabled = .F.
		.Cntnumericpad1.ImgButton0.Enabled = .F.
		.Cntnumericpad1.ImgButtonDelete.Enabled = .F.
		.Cntnumericpad1.ImgButtonPoint.Enabled = .F.
		.CmdUp.Enabled = .F.
		.CmdPlus.Enabled = .F.
		.CmdMinus.Enabled = .F.
		.CmdDel.Enabled = .F.
		.CmdDevOrder.Enabled = .F.
		.txtbarcod.Enabled = .F.
		.cmdEnter.Enabled = .F.
		.CmdPrint.Enabled = .F.
		.CmdOrderDel.Enabled = .F.
		.CmdCHKBACK.Enabled = .F.
		.CmdPredchk.Enabled = .F.
		.CmdPay.Enabled = .F.
		.CmdManager.Enabled = .F.
		.cntCltID.Enabled = .F.
	ELSE
		*--åñëè â çàêàçå óæå åñòü ñêèäêà, òî çàïðåòèì ðåäàêòèðîâàíèå çàêàçà
		lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
		
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
		IF FOUND()
			llblock = .T.
		ENDIF
		
		*--åñëè áûë íàïå÷àòàí ïðåä÷åê, òî çàïðåòèì ââîä äàííûõ
		SELECT lvOrderTvrView
		COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

		IF lnPredchk &gt; 0
			llblock = .T.
		ENDIF	
		
		IF llblock
			thisform._block_in(.T.)
		ENDIF
	ENDIF


	*--âîçìîæíû ðàçëè÷íûå âàðèàíòû ïðåäîñòàâëåíèÿ ñêèäêè
	DO CASE
		CASE lnMODEDISC=1
			*--äëÿ Ëèäåðà
			.cntDiscID.Width = .cntDiscID.txtText.Width-1
			.cmdDisc.Left = .cntDiscID.Left+.cntDiscID.Width+1
			.cmdNoDisc.Left = .cmdDisc.Left+.cmdDisc.Width+1
			
		OTHERWISE
			*--äëÿ Êîëüöîâî
			.cmdDisc.Enabled = .F.
			.cmdDisc.Visible = .F.
			.cmdNoDisc.Enabled = .F.
			.cmdNoDisc.Visible = .F.
	ENDCASE
.grdOrder.SetFocus()
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRORDEREDIT.LOAD
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*------------------------------------------------------------------------------
*--Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*--Îòêðûâàåì è óñòàíàâëèâàåì òåêóùóþ ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*--Îòêðûâàåì lv äëÿ ðåäàêòèðîâàíèÿ äîêóìåíòîâ (ïóñòîé)
USE lvFrmEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
*------------------------------------------------------------------------------

*--Îòêðîåì ñïðàâî÷íèê ñòîëîâ
USE lvOUTableList IN 0 NODATA

*--Îòêðîåì ñïðàâî÷íèê êëèåíòîâ ðåñòîðàíà
USE lvCltRSTList IN 0

*--Îòêðîåì ñïðàâî÷íèê ñêèäîê
USE lvDiscList IN 0

*--îòêðîåì ñïðàâî÷íèê áûñòðîãî âûáîðà áëþä
_PARAM =  VAL(oRes.GetParam([RST],[SETNUM]))
USE lvPOSFuncInSetView IN 0

*--Îòêðîåì ñîäåðæèìîå çàêàçà
USE lvOrderTvrView IN 0 NODATA

*--îòêðîåì lv äëÿ ïðèâÿçîê ïðè÷èí îòêàçà ê áëþäàì (ïðè óäàëåíèè ìåíåäæåðîì) - ïóñòîé
USE lvTvrCncRsnEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvTvrCncRsnEdit])

*--îòêðîåì ñïèñîê ìîäèôèêàòîðîâ (ïóñòîé)
USE lvModList IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModList])

*--ñîçäàäèì ïóñòóþ òàáëèöó äëÿ ìåíþ (â çàâèñèìîñòè îò ÷èñëà êîëîíîê)
CREATE TABLE tmp\tmpmenu.dbf FREE (t1 C(40),t2 C(40),t3 C(40),t4 C(40),t5 C(40),t6 C(40),t7 C(40))

*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE LostFocus
DODEFAULT()
		thisform.olecommprox1._close()

ENDPROC
PROCEDURE tbloff
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âûêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOff(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
PROCEDURE tblon
LOCAL lcBilTableIDs, lnTableNum
*--îïðåäåëèì ID òîâàðîâ "áèëüÿðäíûå ñòîëû, êîòîðûå íàäî âêëþ÷èòü"
lcBilTableIDs = ALLT(oRes.GetParam([RST],[BIL_TABLE]))
IF NOT EMPTY(lcBilTableIDs )
	thisform.NewObject('MPOS','MPOS','MPOS.vcx')
	SELECT VAL(SUBSTR(TvrNM,1,3)) AS TableNum FROM lvOrderTvrView WHERE TvrID IN (&amp;lcBilTableIDs) INTO CURSOR BilTbl
	SELECT BilTbl
	SCAN
		thisform.MPOS.ChannelOn(BilTbl.TableNum)
	ENDSCAN
	USE IN BilTbl
	thisform.MPOS.Destroy
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>65</reserved2>
		<reserved3>nfrmid
lorderpay
_qntintable
ncashno Íîìåð êàññû (óíèêàëüíûé)
nsalesid
ncheckid
nordersum èòîã ïî çàêàçó
lmanagerwork
_menusel îêîí÷àòåëüíûé âûáîð áëþäà èç ìåíþ
lreadonly
nprctypeid èäåíòèôèêàòîð ïðàéñà
lorderdelm ïðèçíàê óäàëåíèÿ âñåãî çàêàçà ìåíåäæåðîì
lblock ôëàã áëîêèðîâêè ââîäà
npayvarnum ÷èñëî âàðèàíòîâ îïëàòû
lorderreturn ôëàã âîçâðàòà
*_ok âûõîä èç ôîðìû ñ ñîõðàíåíèåì
*__storechktrans 
*__storechktrans_pred ïå÷àòü ïðåä÷åêà
*_paintmenu 
*_clickmenu 
*_closeday çàêðûòèå äíÿ (ñìåíû)
*_headerprint 
*__storechktrans_slim ïå÷àòü ÑËÈÌ (ïðè îïëàòå êàðòîé)
*_block_in áëîêèðîâêà/ðàçáëîêèðîâêà ââîäà äàííûõ
*getcardinfo 
*addvip 
*__storechktransback ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
*__iscasher 
*_footerprint Ïå÷àòü ïîäâàëà ïðåä÷åêà
*___kkmerrorhandler 
*checkreset 
*_storechecktrans_pred ïå÷àòü ïðåä÷åêà
*tblon Âêëþ÷åíèå áèëüÿðäíîãî ñòîëà
*tbloff Îòêëþ÷åíèå áèëüÿðäíîãî ñòîëà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>ôîðìà äëÿ ðåäàêòèðîâàíèÿ çàêàçà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblEdit</objname>
		<parent>frmorderedit</parent>
		<properties>AutoSize = .F.
FontSize = 18
Alignment = 2
BackStyle = 1
Caption = "Çàêàç ¹"
Height = 30
Left = -2
Top = 0
Width = 803
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 2
Name = "LblEdit"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðêà íà íóëåâîå êîëè÷åñòâî
SELECT lvOrderTvrView
GO TOP
SCAN ALL
	IF lvOrderTvrView.TvrQnt = 0
		MESSAGEBOX([Çàêàç ñîäåðæèò íóëåâîå êîëè÷åñòâî!],48,[Îêíî ñîîáùåíèé])
		thisform.grdOrder.SetFocus()
		RETURN .F.
	ENDIF
	SELECT lvOrderTvrView
ENDSCAN

thisform.cmdPrint.Click(.T.)
thisform._OK()
*--Ñêðûâåì ôîðìó
thisform.Hide()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU11T5VB</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblAttr</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ãîñòè"
Height = 25
Left = 1
Top = 31
Width = 51
TabIndex = 6
ForeColor = 0,0,255
ZOrderSet = 5
Name = "LblAttr"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RX0W2RGH</uniqueid>
		<timestamp>951882120</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkFrmAutoNum</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 333
Left = 156
FontBold = .T.
Alignment = 0
Caption = "Àâòîíóìåðàöèÿ"
Value = .F.
TabIndex = 5
Visible = .F.
ZOrderSet = 6
ReadOnly = .T.
Name = "chkFrmAutoNum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOUTableID</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñòîë"
Height = 25
Left = 1
Top = 3
Width = 45
TabIndex = 26
ForeColor = 255,255,255
ZOrderSet = 7
Name = "lblOUTableID"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2700OUVTJ</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblFrmId</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .F.
FontSize = 8
BackStyle = 0
Caption = "Ñêèäêà"
Height = 16
Left = 744
Top = 348
Width = 37
TabIndex = 26
ForeColor = 0,0,255
ZOrderSet = 8
Name = "LblFrmId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951882120</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCltID</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 31
Left = 107
Width = 216
Height = 25
BackStyle = 0
TabIndex = 27
ForeColor = 252,174,12
ZOrderSet = 9
_allowresizecontent = .T.
_rsaliasname = lvCltRstList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 1
_controlsource = lvFrmEdit.PointIspCltID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntCltID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.BorderStyle = 0
txtText.Height = 22
txtText.Left = 0
txtText.Top = 0
txtText.Width = 214
txtText.ForeColor = 0,0,255
txtText.BackColor = 239,228,250
txtText.DisabledBackColor = 239,228,250
txtText._highlightselfcolor = RGB(239,228,250)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 183
cmdShow.Height = 26
cmdShow.Width = 33
cmdShow.Visible = .F.
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 219
cmdClear.Height = 26
cmdClear.Width = 26
cmdClear.Enabled = .T.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE txtText.Click
this.Parent.cmdShow.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0OHYRT</uniqueid>
		<timestamp>951882120</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntDiscID</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 31
Left = 590
Width = 135
Height = 30
BackStyle = 0
TabIndex = 27
ForeColor = 252,174,12
ZOrderSet = 10
_allowresizecontent = .T.
_rsaliasname = lvDiscList
_rsfieldnametext = NM
_rsfieldnameid = ID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "CntDiscID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.Height = 29
txtText.Left = -1
txtText.Top = 0
txtText.Width = 131
txtText.ForeColor = 0,0,255
txtText._highlightselfcolor = RGB(239,228,250)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 132
cmdShow.Height = 29
cmdShow.Width = 33
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 167
cmdClear.Height = 29
cmdClear.Width = 33
cmdClear.Enabled = .T.
cmdClear.BackColor = 239,228,250
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
LOCAL lnDiscTvrID, ;
		lnDiscPrice, ;
		_PARAM, ;
		lAltSum, ;
		lAltPr, ;
		lFrmSum, ;
		lOstSum

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--îïðåäåëèì ãðàíè÷íóþ ñóììó äëÿ àëüòåðíàòèâíîé ñêèäêè
lAltSum = VAL(oRes.GetParam([RST],[ALTSUM]))

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--óäàëèì ñêèäêó, åñëè îíà óæå åñòü â çàêàçå
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
IF FOUND()
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	DELETE FROM lvOrderTvrEdit
	IF TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		Thisform.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[DELETE])
	ENDIF
ENDIF

*--ñôîðìèðóåì ñêèäêó ïî çàêàçó â çàâèñèìîñòè îò âûáðàííîãî òèïà ñêèäêè
IF EMPTY(this.value)
	*--ðàçáëîêèðóåì äàëüíåéøåå èçìåíåíèå èíôîðìàöèè
	thisform._block_in(.F.)
	
	RETURN .F.
ENDIF

USE IN SELECT([lvDiscType])
_PARAM = this.value
USE lvDiscType IN 0

*--ðàññ÷èòàåì ñêèäêó
DO CASE
	CASE lvDiscType.disctypeid = 1
		*--ïðîöåíòíàÿ ñêèäêà
		lnDiscPrice = ROUND(ThisForm.nOrderSum/100*lvDiscType.discrate,2)*(-1)
	
	CASE lvDiscType.disctypeid = 2
		*--ñóììîâàÿ ñêèäêà
		lnDiscPrice = lvDiscType.discrate*(-1)

	CASE lvDiscType.disctypeid = 3
		*--àëüòåðíàòèâíàÿ ñêèäêà (äëÿ Àéñáåðãà)
		lAltPr = lvDiscType.discrate
		
		*--ïîñ÷èòàåì ñóììó çàêàçîâ ïî äàííîé êàðòî÷êå çà òåêóùóþ ñìåíó
		USE IN SELECT([lvShiftSumView])
		_PARAM = VAL(lvFrmEdit.FrmNote)
		USE lvShiftSumView IN 0
		
		IF RECCOUNT([lvShiftSumView])&gt;0
			lFrmSum = lvShiftSumView.FrmSum
		ELSE
			lFrmSum = 0
		ENDIF
		
		*--ïðîâåðèì, âûáðàíà ëè ëèìèò ñêèäêè çà òåêóùóþ ñìåíó
		IF lFrmSum&gt;=lAltSum
			*--ñêèäêè â òåêóùóþ ñìåíó áîëüøå íåò
			lnDiscPrice=0
		ELSE
			*--ïîñ÷èòàåì, ñêîëüêî ìîæíî åùå äàòü ñêèäêè (ñóììà îñòàòêà îò ëèìèòà)
			lOstSum = (lAltSum-lFrmSum)/(100-lAltPr)*100
			
			IF lOstSum&gt;=thisform.nordersum
				*--äàåì ñêèäêó ñ ñóììû çàêàçà
				lnDiscPrice = ROUND(ThisForm.nOrderSum/100*lAltPr,2)*(-1)
			ELSE
				*--äàåì ôèêñèðîâàííóþ ñêèäêó ñ ñóììû îñòàòêà îò ëèìèòà
				lnDiscPrice = ROUND(lOstSum/100*lAltPr,2)*(-1)
			ENDIF
		ENDIF
		
	OTHERWISE
		lnDiscPrice = 0
ENDCASE

IF lnDiscPrice&lt;&gt;0
	*--äîáàâèì òîâàð "ñêèäêà" â çàêàç
	thisform.grdOrder._add(lnDiscTvrID,lnDiscPrice)

	*--çàáëîêèðóåì äàëüíåéøåå èçìåíåíèå èíôîðìàöèè
	thisform._block_in(.T.)
ENDIF
ENDPROC
PROCEDURE cmdClear.Click
DODEFAULT()

this.Parent._handleanychange()
ENDPROC
PROCEDURE cmdShow.Click
LOCAL ldiscflag, ;
	  lnMODEDISC

ldiscflag = VAL(oRes.GetParam([RST],[DISCFLAG]))
lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))	

*--ïðîâåðèì äîñòóïíîñòü ñêèäîê
IF !EMPTY(ldiscflag)
	MESSAGEBOX([Ñêèäêè íå ïðåäóñìîòðåíû íàñòðîéêîé.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--ñêèäêè äîëæíû äàâàòüñÿ òîëüêî ìåíåäæåðîì (ïðè âûáîðå ñêèäêè èç ñïèñêà)
IF !thisform.lmanagerwork AND EMPTY(lnMODEDISC)
	MESSAGEBOX([Äëÿ âûáîðà ñêèäêè àêòèâèçèðóéòå áëîê êíîïîê ìåíåäæåðà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--åñëè âñå â ïîðÿäêå, âûáèðàåì ñêèäêó
DODEFAULT()

this.Parent._handleanychange()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1V60T2FBI</uniqueid>
		<timestamp>951882120</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntOUTableID</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 0
Left = 57
Width = 169
Height = 31
BackStyle = 0
TabIndex = 27
ColorSource = 0
ForeColor = 255,255,255
BackColor = 0,0,255
ZOrderSet = 11
_allowresizecontent = .T.
_rsaliasname = lvOUTableList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 1
_controlsource = lvFrmEdit.PointEmiOUID
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntOUTableID"
txtText.FontBold = .T.
txtText.FontSize = 12
txtText.BackStyle = 0
txtText.BorderStyle = 0
txtText.Height = 21
txtText.Left = 0
txtText.SpecialEffect = 0
txtText.Top = 4
txtText.Width = 168
txtText.ColorSource = 0
txtText.ForeColor = 255,255,255
txtText.BackColor = 0,0,255
txtText.DisabledBackColor = 0,0,255
txtText.DisabledForeColor = 255,255,255
txtText.SelectedBackColor = 0,0,255
txtText._highlightselfcolor = RGB(0,0,255)
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 175
cmdShow.Height = 13
cmdShow.Width = 5
cmdShow.BackColor = 239,228,250
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 219
cmdClear.Height = 26
cmdClear.Width = 26
cmdClear.Enabled = .T.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*--ïðè ñìåíå ñòîëà äîëæåí âêëþ÷èòüñÿ àâòîíóìåðàòîð
WITH ThisForm
	.lblEdit.Caption = [             Çàêàç ¹ ]
	.Caption = [             Çàêàç ¹ ]
	.chkFrmAutoNum.Value = .T.
ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************




ENDPROC
PROCEDURE txtText.Click
this.Parent.cmdShow.Click()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1Y90TVA66</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSumAccount</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
Caption = "Ñóììà íàêîïëåíèÿ "
Height = 22
Left = 324
Top = 333
Visible = .F.
Width = 157
TabIndex = 30
ForeColor = 255,128,0
ZOrderSet = 12
Name = "LblSumAccount"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSum</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñóììà "
Enabled = .F.
Height = 25
Left = 728
Top = 2
Visible = .F.
Width = 66
TabIndex = 30
ForeColor = 0,0,255
ZOrderSet = 13
Name = "LblSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPredChk</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\prdcheck_new_.gif
DownPicture = ..\graphic\prdcheck_new_pr.gif
DisabledPicture = ..\graphic\prdcheck_new_dis_.gif
Caption = ""
MousePointer = 0
Style = 0
ToolTipText = "Ïå÷àòü ïðåä÷åêà"
Visible = .T.
SpecialEffect = 0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 14
Name = "CmdPredChk"
</properties>
		<protected/>
		<methods>PROCEDURE Click
**RETURN
*--ïå÷àòü ïðåä÷åêà
LOCAL lnPredchk, ;
lmaxid, ;
lnDiscTvrID

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü ïðåä÷åêà íåäîñòóïíà.],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

IF MESSAGEBOX([Íàïå÷àòàòü ïðåä÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
RETURN .F.
ENDIF

*--ïðîâåðêà íà íåïóñòîé çàêàç
IF RECCOUNT([lvOrderTvrView])&lt;=0
MESSAGEBOX([Çàêàç íå ñîäåðæèò íè îäíîãî áëþäà!],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

*--ïðîâåðêà íà íóëåâîå êîëè÷åñòâî
SELECT lvOrderTvrView
GO TOP
SCAN ALL
IF lvOrderTvrView.TvrQnt = 0
IF TYPE('thisform.grdOrder')=[O]
MESSAGEBOX([Çàêàç ñîäåðæèò íóëåâîå êîëè÷åñòâî!],48,[Îêíî ñîîáùåíèé])
thisform.grdOrder.SetFocus()
RETURN .F.
ENDIF
ENDIF
SELECT lvOrderTvrView
ENDSCAN

*--åñëè ïðåä÷åê óæå áûë íàïå÷àòàí, òî äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà íóæíà îòìåíèòü ïåðâûé ïðåä÷åê
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

IF lnPredchk = 0
*--ïðîèçâåäåì ïðîâåðêó ñêèäêè (ñêèäêà äîëæíà ñòîÿòü ïîñëåäíåé ïîçèöèåé â çàêàçå)
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

CALCULATE MAX(lvOrderTvrView.FrmPartTvrID) TO lmaxid

SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID

IF (FOUND() AND lvOrderTvrView.FrmPartTvrID&lt;&gt;lmaxid)
MESSAGEBOX([Íåîáõîäèìî ïåðåñ÷èòàòü ñêèäêó.],48,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF

*--âûïîëíèì ïå÷àòü ïðåä÷åêà è óñòàíîâèì ïðèçíàê ïðîèçâåäåííîé ïå÷àòè ïðåä÷åêà
thisform._storechecktrans_pred()

	*-- Ïðîâåðÿåì âûêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
	thisForm.tblOff()

*--ïîñëå ïå÷àòè ïðåä÷åêà ââîä äàííûõ áóäåò çàáëîêèðîâàí
thisform._block_in(.T.)
ELSE
MESSAGEBOX([Ïðåä÷åê óæå áûë íàïå÷àòàí.]+CHR(13)+;
[Äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà îáðàòèòåñü ê ìåíåäæåðó.],64,[Îêíî ñîîáùåíèé])
RETURN .F.
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766915</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdOrder</objname>
		<parent>frmorderedit</parent>
		<properties>ColumnCount = 5
FontSize = 20
Anchor = 0
HeaderHeight = 0
Height = 267
Left = 0
Panel = 1
ReadOnly = .F.
RecordSource = "lvOrderTvrView"
RowHeight = 36
Top = 59
Width = 499
ForeColor = 0,0,160
GridLineColor = 0,0,160
ZOrderSet = 15
AllowAutoColumnFit = 2
_activerowhighlight = .T.
_activerowhighlightcoloractive = RGB(239,228,250)
_activerowhighlightcolorunactive = RGB(255,255,255)
Name = "GrdOrder"
Column1.FontSize = 20
Column1.ColumnOrder = 1
Column1.ControlSource = "lvOrderTvrView.mark"
Column1.Width = 30
Column1.ReadOnly = .F.
Column1.Sparse = .F.
Column1.ForeColor = 255,255,255
Column1.Name = "Column1"
Column2.FontSize = 10
Column2.ColumnOrder = 2
Column2.ControlSource = "lvOrderTvrView.TvrNM"
Column2.Width = 180
Column2.ReadOnly = .T.
Column2.ForeColor = 0,0,160
Column2.Name = "Column2"
Column3.FontBold = .T.
Column3.FontSize = 20
Column3.ColumnOrder = 4
Column3.ControlSource = "lvOrderTvrView.TvrQnt"
Column3.Width = 60
Column3.ReadOnly = .F.
Column3.Sparse = .F.
Column3.ForeColor = 0,0,160
Column3.Name = "Column3"
Column4.FontSize = 10
Column4.ColumnOrder = 3
Column4.ControlSource = "lvOrderTvrView.TvrPrcSale"
Column4.Width = 60
Column4.ReadOnly = .T.
Column4.Format = "R"
Column4.InputMask = "999999.99"
Column4.ForeColor = 0,0,160
Column4.Name = "Column4"
Column5.FontSize = 10
Column5.ControlSource = "lvOrderTvrView.TvrSum"
Column5.Width = 64
Column5.ReadOnly = .T.
Column5.Format = "R"
Column5.InputMask = "999999.99"
Column5.ForeColor = 0,0,160
Column5.Name = "Column5"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._Add
* Called by.......: &lt;&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå áëþäà â çàêàç
*-------------------------------------------------------
LPARAMETERS tnTvrID, tnPrice
*09.08.2005 16:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes, ;
		laAddRec[1], ;
		_PARAM, ;
		lnMsuID, ;
		lnPrice, ;
		lnRes, ;
		lCountScroll
*------------------------------------------------------------------------------

*09.08.2005 16:47 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([tnTvrID])==[N] AND !EMPTY(tnTvrID)
	
	WITH This
			*09.08.2005 16:47 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .T.
		*------------------------------------------------------------------------------
		
		*--íàéäåì öåíó áëþäà
		IF INLIST(TYPE([tnPrice]),[N],[Y])
			lnPrice = tnPrice
		ELSE

			*11.04.2006 12:02 -&gt;Ïîëó÷èì èíôîðìàöèþ î öåíå íà òîâàð
			USE IN SELECT([lvPriceTvr])
			***

			*05.05.2006 09:41 -&gt;Ïîëó÷èì öåíó ïî ïðàéñó
			_PARAM1 = tnTvrID
			_PARAM2 = ThisForm.nPrcTypeID
			USE lvPriceTvr IN 0
			***

			*05.05.2006 09:41 -&gt;Åñëè öåíà íóëåâàÿ - ïîëó÷èì öåíó èç ïðàéñà ïî óìîë÷àíèþ
			IF lvPriceTvr.Price = 0
				USE IN SELECT([lvPriceTvrDef])
				***
				
				_PARAM = tnTvrID
				USE lvPriceTvrDef IN 0
				lnPrice = lvPriceTvrDef.Price	
				
			ELSE
				lnPrice = lvPriceTvr.Price
			ENDIF
			*------------------------------------------------------------------------------

		ENDIF
		
		*--Ïîëó÷èì èíôîðìàöèþ î åäåíèöàõ èçìåðåíèÿ
		USE IN SELECT([lvMsuIDByTvr])
		***
		_PARAM = tnTvrID
		USE lvMsuIDByTvr IN 0
		***
		IF RECCOUNT([lvMsuIDByTvr])&gt;0 AND !EMPTY(lvMsuIDByTvr.MsuID) AND !ISNULL(lvMsuIDByTvr.MsuID)
			lnMsuID = lvMsuIDByTvr.MsuID
		ELSE
			lnMsuID = 1
		ENDIF
		
		***
		USE IN SELECT([lvMsuIDByTvr])
		*-------------------------------------------------------------------------------

		*--Äîáàâèì ïîçèöèþ
		USE IN SELECT([lvOrderTvrEdit])
		USE lvOrderTvrEdit IN 0 NODATA
		APPEND BLANK IN lvOrderTvrEdit
		REPLACE ;
			FrmID WITH ThisForm.nFrmID, ;
			TvrId WITH tnTvrID, ;
			MsuId WITH lnMsuID, ;
			TvrQnt WITH 1, ;
			TvrPrcSale WITH lnPrice ;
		IN lvOrderTvrEdit
		llResult = TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		*------------------------------------------------------------------------------
		
		IF llResult
			This._RSRequeryOne(spGetLastIncrementedID([lvOrderTvrEdit]),[ADD])
		ENDIF
		*-------------------------------------------------------------------------------


		*09.08.2005 16:48 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .F.
		*------------------------------------------------------------------------------
			
		*09.08.2005 16:48 -&gt; Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
		.Refresh(.T.)
		*------------------------------------------------------------------------------
		
		*--ïîêàæåì çàêàç â ñåòêå êðàñèâî è óäîáíî
		lCountScroll = MIN(6,RECCOUNT([lvOrderTvrView]))-1
		
		FOR i= 1 TO lCountScroll
			.DoScroll(0)
		ENDFOR
		
		.SetFocus()
		
	ENDWITH
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _refreshrelatedobjects
*--ïîêàæåì îáíîâëåííóþ ñóììó çàêàçà íà ôîðìå
LOCAL lcTableNM
USE IN SELECT([lvFrmSumView])
_PARAM = thisform.nFrmID
USE lvFrmSumView IN 0

*--ñîõðàíèì èòîã ïî çàêàçó
ThisForm.nOrderSum = lvFrmSumView.FrmSum
*-------------------------------------------------------------------------------
	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

*thisform.lblSum.caption = [Ñóììà ]+ALLTRIM(STR(lvFrmSumView.FrmSum,99,2))
	thisform.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)+ [     íà ñóììó: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
	thisform.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)+ [     íà ñóììó: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
USE IN SELECT([lvFrmSumView])
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._RSRequery
* Called by.......: &lt;&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
_PARAM = thisform.nFrmID
REQUERY([lvOrderTvrView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequeryone
LPARAMETERS tnFrmPartTvrID, tcMode

*17.01.2005 15:30 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL 	lcOldAlias, ;
		lnId, ;
		laReplaceArray[1]
***
PRIVATE	_PARAM
***
lcOldAlias = ALIAS()
lnId = tnFrmPartTvrID
laReplaceArray = .NULL.
*------------------------------------------------------------------------------

*12.05.2004 03:35 -&gt;Îòêëþ÷àåì èñòî÷íèê äàííûõ
This.SourceKeep()
This.SourceReset()
*------------------------------------------------------------------------------

* Â çàâèñèìîñòè îò ðåæèìà âûïîëíèì äåéñòâèÿ
DO CASE
	CASE UPPER(tcMode) == [DELETE]

		*22.12.2004 15:11 -&gt;Óäàëÿåì çàïèñü
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnId
		IF FOUND()
			DELETE IN lvOrderTvrView
			IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
				TABLEUPDATE(.T.)
			ENDIF
		ENDIF
		*------------------------------------------------------------------------------

		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

	CASE UPPER(tcMode) == [ADD] OR UPPER(tcMode) == [EDIT]
	
		*--Ïîëó÷èì äàííûå î äîáàâëåííîé çàïèñè
		IF USED([lvOrderTvrViewRepl])
			USE IN lvOrderTvrViewRepl
		ENDIF
		_PARAM = lnId
		USE lvOrderTvrViewRepl IN 0
		*------------------------------------------------------------------------------

		*17.01.2005 15:34 -&gt; Îáíîâèì äàííûå â lvOrderTvrView
		SELECT lvOrderTvrViewRepl
		SCATTER TO laReplaceArray
		SELECT lvOrderTvrView
		IF UPPER(tcMode) == [ADD]
			APPEND BLANK
		ENDIF
		GATHER FROM laReplaceArray
		IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
			TABLEUPDATE(.T.)
		ENDIF
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:35 -&gt; Çàêðîåì Alis
		USE IN lvOrderTvrViewRepl
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

ENDCASE
*-------------------------------------------------------------------------------

*12.05.2004 03:37 -&gt;Âîññòàíàâëèâàåì èñòî÷íèê äàííûõ
This.SourceRecall()
*------------------------------------------------------------------------------

*22.12.2004 15:35 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
	SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
DODEFAULT()

this.column1.DynamicBackColor = [IIF(BITTEST(lvOrderTvrView.TvrAttr,0),RGB(252,174,12),IIF(BITTEST(lvOrderTvrView.TvrAttr,1),RGB(252,242,218),]+this.column1.DynamicBackColor+[))]
								

ENDPROC
PROCEDURE Valid
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
PROCEDURE When
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdOrder.Column1</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951882120</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>CHK1</objname>
		<parent>frmorderedit.GrdOrder.Column1</parent>
		<properties>Top = 23
Left = 13
FontSize = 20
Alignment = 0
Caption = " "
ColorSource = 0
ForeColor = 255,255,255
ReadOnly = .F.
Name = "CHK1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdOrder.Column2</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S207614U</uniqueid>
		<timestamp>932992837</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmorderedit.GrdOrder.Column2</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S20QARPV</uniqueid>
		<timestamp>882074301</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdOrder.Column3</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S2078FZK</uniqueid>
		<timestamp>932992837</timestamp>
		<class>txtcalctype</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt1</objname>
		<parent>frmorderedit.GrdOrder.Column3</parent>
		<properties>FontBold = .T.
FontSize = 9
Format = "R"
InputMask = "999999.99"
Left = 22
ReadOnly = .F.
Top = 10
ForeColor = 0,0,160
_highlightself = .F.
Name = "Txt1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
USE IN SELECT([lvOrderTvrEdit])
_PARAM = lvOrderTvrView.FrmPartTvrID
USE lvOrderTvrEdit IN 0

REPLACE lvOrderTvrEdit.TvrQnt WITH this.value IN lvOrderTvrEdit
TABLEUPDATE(1,.T.,[lvOrderTvrEdit])

REPLACE lvOrderTvrView.TvrSum WITH ROUND(lvOrderTvrView.TvrPrcSale*this.value,2)
ThisForm.grdOrder._RefreshRelatedObjects()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdOrder.Column4</parent>
		<properties>FontSize = 20
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>932992837</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmorderedit.GrdOrder.Column4</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdOrder.Column5</parent>
		<properties>Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RU10F0GH</uniqueid>
		<timestamp>887319332</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>frmorderedit.GrdOrder.Column5</parent>
		<properties>FontSize = 10
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDel</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 161
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\stdtlbdele_.gif
DownPicture = ..\graphic\stdtlbdele_pr.gif
DisabledPicture = ..\graphic\stdtlbdele_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Óäàëåíèå ïîçèöèé"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 16
Name = "CmdDel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LPARAMETERS tcarry
LOCAL	lnQntDel, ;
		_PARAM, ;
		lpos, ;
		lcarry

lnQntDel = 0
lcarry = tcarry

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà óäàëåíèå
SELECT lvOrderTvrView
lpos = RECNO()
COUNT ALL FOR lvOrderTvrView.mark TO lnQntDel

IF lnQntDel&gt;0
	*--óäàëèì ïîìå÷åííûå íà óäàëåíèå çàïèñè
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark AND (lcarry OR (!BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)))
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		DELETE FROM lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN
	ThisForm.grdOrder._RSRequery()
ENDIF

SELECT lvOrderTvrView
GO TOP


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0RG33W</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPay</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 600
Height = 50
Width = 50
Picture = ..\graphic\bank_.gif
DownPicture = ..\graphic\bank_pr.gif
Caption = ""
ToolTipText = "Îïëàòà çàêàçà"
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 17
Name = "CmdPay"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lRetVal

		*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._close()
		thisform._ok()

		lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],ThisForm.nfrmid ,thisform.nPayVarNum, 1,0)

ThisForm.grdOrder._RSRequery()
		*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._open()
		IF TYPE([lRetVal])==[L] AND !lRetVal
		RETURN lRetVal
	    ENDIF
	
	thisform.Hide()
	RETURN lRetVal



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPlus</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 62
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\plus.bmp
Caption = ""
Enabled = .T.
TabStop = .F.
ToolTipText = "Óâåëè÷èòü"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 18
Name = "CmdPlus"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM

IF !thisform._qntintable
	*--åñëè õîòèì óâåëè÷èòü êîëè÷åñòâî ãîñòåé
	REPLACE lvFrmEdit.ID_ WITH (lvFrmEdit.ID_+1) IN lvFrmEdit
	
	*--îáíîâèì äàííûå íà ôîðìå
	thisform.Refresh()
	
	*--óñòàíîâèì ôîêóñ
	thisform.txtAttr.SetFocus()
ELSE
	*--åñëè õîòèì óâåëè÷èòü êîëè÷åñòâî äàííîãî òîâàðà
	IF !BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)
		*--ðåäàêòèðîâàíèå âîçìîæíî òîëüêî äëÿ íåçàêðûòûõ ïîçèöèé
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		
		REPLACE lvOrderTvrEdit.TvrQnt WITH (lvOrderTvrEdit.TvrQnt+1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		ThisForm.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[EDIT])

		*--óñòàíîâèì ôîêóñ
		thisform.grdOrder.column3.txt1.SetFocus()
	ENDIF
ENDIF



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdMinus</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 111
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\minus.bmp
Caption = ""
Enabled = .T.
TabStop = .F.
ToolTipText = "Óìåíüøèòü"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 19
Name = "CmdMinus"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM

IF !thisform._qntintable
	*--åñëè õîòèì óìåíüøèòü êîëè÷åñòâî ãîñòåé
	REPLACE lvFrmEdit.ID_ WITH (lvFrmEdit.ID_-1) IN lvFrmEdit

	*--îáíîâèì äàííûå íà ôîðìå
	thisform.Refresh()
	
	*--óñòàíîâèì ôîêóñ
	thisform.txtAttr.SetFocus()
ELSE
	*--åñëè õîòèì óìåíüøèòü êîëè÷åñòâî äàííîãî òîâàðà
	IF !BITTEST(lvOrderTvrView.TvrAttr,0) AND !BITTEST(lvOrderTvrView.TvrAttr,1)
		*--ðåäàêòèðîâàíèå âîçìîæíî òîëüêî äëÿ íåçàêðûòûõ ïîçèöèé
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		
		REPLACE lvOrderTvrEdit.TvrQnt WITH IIF(lvOrderTvrEdit.TvrQnt&gt;1,(lvOrderTvrEdit.TvrQnt-1),1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		ThisForm.grdOrder._RSRequeryOne(lvOrderTvrView.FrmPartTvrID,[EDIT])

		*--óñòàíîâèì ôîêóñ
		thisform.grdOrder.column3.txt1.SetFocus()
	ENDIF
ENDIF





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPrint</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 211
Left = 550
Height = 50
Width = 50
Picture = ..\graphic\servis_printer2007.gif
DownPicture = ..\graphic\servis_printer2007_pr.gif
DisabledPicture = ..\graphic\servis_printer2007_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Ïå÷àòü íà ñåðâèñ-ïðèíòåð"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 20
Name = "CmdPrint"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LPARAMETER tclose &amp;&amp;--ôëàã ïðîâåðêè ïðè çàêðûòèè ôîðìû
LOCAL	lnDiscTvrID, ;
		lnDiscPrice, ;
		_PARAM, ;
		_PARAM1, ;
		_PARAM2, ;
		lcBilTableIDs

IF !this.Enabled
	RETURN .F.
ENDIF

*--ïðè íàæàòèè íà êíîïêó ñåðâèñ-ïå÷àòè
IF !tclose AND MESSAGEBOX([Ïðîèçâåñòè ïå÷àòü íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*-- Ïðîâåðÿåì âêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
thisForm.tblOn()
*--ñôîðìèðóåì äàííûå äëÿ ïå÷àòè íà ñåðâèñíûé ïðèíòåð
USE IN SELECT([lvSPrintView])
_PARAM1 = lvFrmEdit.FrmID
_PARAM2 = thisform.nCashNo

USE lvSPrintView IN 0

*--ïðîâåðêà ïðè çàêðûòèè ôîðìû, åñòü ëè ïîçèöèè, íå ïðîøåäøèå íà ñåðâèñ-ïå÷àòü
IF tclose
	IF RECCOUNT([lvSPrintView])=0
		*--íåò ïîçèöèé äëÿ ñåðâèñ-ïå÷àòè
		RETURN .F.
	ENDIF
	
	IF MESSAGEBOX([Ïðîèçâåñòè ïå÷àòü íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
		RETURN .F.
	ENDIF
ENDIF

*--ïå÷àòü íà ñåðâèñíûé ïðèíòåð
SELECT lvSPrintView.DeviceID, ;
		lvSPrintView.DeviceINI ;
	FROM lvSPrintView ;
	GROUP BY DeviceID ;
	INTO CURSOR curPrint NOFILTER
SELECT curPrint
SCAN ALL
	SELECT lvSPrintView
	LOCAL lcPrinter
	lcPrinter = ALLTRIM(curPrint.DeviceINI)
	IF lcPrinter = [DEFAULT]
				SET PRINTER TO DEFAULT
		ELSE
				SET PRINTER TO NAME ALLTRIM(lcPrinter)
	ENDIF
	PRINTJOB
	REPORT FORM REPORTS\serv_print.frx FOR lvSPrintView.DeviceID = curPrint.DeviceID TO PRINTER
	ENDPRINTJOB
	SELECT curPrint
ENDSCAN

*--óñòàíîâèì ïðèçíàê ïå÷àòè íà ñåðâèñ-ïðèíòåð
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,0) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
ThisForm.grdOrder._RSRequery()
	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblPar</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
Caption = "Ðîäèòåëü"
Height = 22
Left = 2
Top = 333
Visible = .F.
Width = 80
TabIndex = 30
ForeColor = 255,128,0
ZOrderSet = 21
Name = "LblPar"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF thisform._menusel
	*--âîçâðàùàåìñÿ â ãëàâíîå ìåíþ
	thisform._menusel = .F.
	thisform.grdmenu._rsrequery(1)
	thisform.lblPar.Visible = .F.
	thisform.lblPar.caption = []
	thisform.grDMENU.Column1.EDTMENU1.SetFocus()
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UHS9L</uniqueid>
		<timestamp>951882120</timestamp>
		<class>cntnumericpad</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntnumericpad1</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 61
Left = 600
ZOrderSet = 22
Name = "Cntnumericpad1"
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Height = 50
ImgButtonPoint.Width = 50
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Height = 50
ImgButton1.Width = 50
ImgButton1.Name = "ImgButton1"
ImgButton2.Height = 50
ImgButton2.Width = 50
ImgButton2.Name = "ImgButton2"
ImgButton3.Height = 50
ImgButton3.Width = 50
ImgButton3.Name = "ImgButton3"
ImgButton4.Height = 50
ImgButton4.Width = 50
ImgButton4.Name = "ImgButton4"
ImgButton5.Height = 50
ImgButton5.Width = 50
ImgButton5.Name = "ImgButton5"
ImgButton6.Height = 50
ImgButton6.Width = 50
ImgButton6.Name = "ImgButton6"
ImgButton7.Height = 50
ImgButton7.Width = 50
ImgButton7.Name = "ImgButton7"
ImgButton8.Height = 50
ImgButton8.Width = 50
ImgButton8.Name = "ImgButton8"
ImgButton9.Height = 50
ImgButton9.Width = 50
ImgButton9.Name = "ImgButton9"
IMGBUTTONDELETE.Height = 50
IMGBUTTONDELETE.Width = 50
IMGBUTTONDELETE.Name = "IMGBUTTONDELETE"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdClose</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 111
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\clock_.gif
DownPicture = ..\graphic\clock_pr.gif
DisabledPicture = ..\graphic\clock_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 23
Name = "CmdClose"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðèì, äîñòóïíà ëè ïå÷àòü Z-îò÷åòà íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü Z-îò÷åòà íå ïðåäóñìîòðåíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

IF MESSAGEBOX([Çàêðûòü òåêóùóþ ñìåíó?],36,[Îêíî ñîîáùåíèé])=6
	thisform._closeday()
	thisform.Hide()
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDelM</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 161
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\xm_.gif
DownPicture = ..\graphic\xm_pr.gif
DisabledPicture = ..\graphic\xm_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Óäàëåíèå ïîçèöèè ìåíåäæåðîì"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 24
Name = "CmdDelM"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL	lnQntDel, ;
		lnID, ;
		lnQntSP, ;
		lnRsn, ;
		_PARAM

lnID = lvOrderTvrView.FrmPartTvrID
lnQntDel = 0

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà óäàëåíèå ìåíåäæåðîì
SELECT lvOrderTvrView
COUNT ALL FOR lvOrderTvrView.mark TO lnQntDel

IF lnQntDel&gt;0
	*--ïðîâåðèì, ñôîðìèðîâàí ëè ïî ýòèì áëþäàì ñïèñîê îòìåíû äëÿ ñåðâèñ-ïðèíòåðà
	SELECT lvOrderTvrView
	COUNT FOR (lvOrderTvrView.mark AND BITTEST(lvOrderTvrView.TvrAttr,0)) TO lnQntSP
	
	IF lnQntSP&gt;0
		MESSAGEBOX([Ïåðåä óäàëåíèåì íåîáõîäèìî ñäåëàòü ñïèñîê îòìåíû íà ñåðâèñ-ïðèíòåð.],48,[Îêíî ñîîáùåíèé])	 		
		RETURN .F.
	ENDIF
	
	*--îïðåäåëèì ïðè÷èíó îòêàçà îò áëþäà
	lnRsn = oApp.DoModalFormRetValObj([FrmCancelReason;rst_v1.vñx])
	
	IF TYPE([lnRsn])==[N] AND !EMPTY(lnRsn)
		*--ñîõðàíèì ñâåäåíèÿ î ïðè÷èíàõ îòêàçà îò áëþäà (ïðè óäàëåíèè ìåíåäæåðîì áëþäà èç çàêàçà)
		SELECT lvOrderTvrView
		SCAN FOR (lvOrderTvrView.mark AND (BITTEST(lvOrderTvrView.TvrAttr,1) OR BITTEST(lvOrderTvrView.TvrAttr,0)))
			USE IN SELECT([lvTvrCncRsnEdit])
			_PARAM = lvOrderTvrView.FrmPartTvrID
			USE lvTvrCncRsnEdit IN 0
			
			IF RECCOUNT([lvTvrCncRsnEdit]) = 0
				SELECT lvTvrCncRsnEdit
				APPEND BLANK
			ENDIF
			
			REPL lvTvrCncRsnEdit.FrmPartTvrCncRsnID WITH _PARAM, ;
				 lvTvrCncRsnEdit.CancelReasonID WITH lnRsn
				
			IF !TABLEUPDATE(1,.T.,[lvTvrCncRsnEdit])		
				MESSAGEBOX([Îøèáêà ïðè îáíîâëåíèè â òàáëèöå FrmPartTvrCncRsn.],48,[Îêíî ñîîáùåíèé])
				TABLEREVERT(.T.)
				RETURN .F.
			ENDIF
				
			SELECT lvOrderTvrView
		ENDSCAN

		*--óñòàíîâèì ïðèçíàê óäàëåíèÿ ìåíåäæåðîì ïîìå÷åííûõ çàïèñåé
		SELECT lvOrderTvrView
		SCAN FOR (lvOrderTvrView.mark AND (BITTEST(lvOrderTvrView.TvrAttr,1) OR BITTEST(lvOrderTvrView.TvrAttr,0)))
			USE IN SELECT([lvOrderTvrEdit])
			_PARAM = lvOrderTvrView.FrmPartTvrID
			USE lvOrderTvrEdit IN 0
			REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,4) IN lvOrderTvrEdit
			TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
			SELECT lvOrderTvrView
		ENDSCAN
		ThisForm.grdOrder._RSRequery()

	ENDIF
	
ELSE
	MESSAGEBOX([Íå ïîìå÷åíî íè îäíîé çàïèñè.],48,[Îêíî ñîîáùåíèé])	 		
	RETURN .F.
ENDIF
	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0SRSJL</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPrintCancel</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 211
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\del_servis_printer_.gif
DownPicture = ..\graphic\del_servis_printer_pr.gif
DisabledPicture = ..\graphic\del_servis_printer_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Îòìåíà ïå÷àòè íà ñåðâèñ-ïðèíòåð "
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 25
Name = "CmdPrintCancel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lFrmPartTvrID

IF MESSAGEBOX([Îòïðàâèòü ñïèñîê îòìåíû íà ñåðâèñ-ïðèíòåð?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--çàïîìíèì ïîçèöèþ, ÷òîáû âåðíóòüñÿ íà íåå
lFrmPartTvrID = lvOrderTvrView.FrmPartTvrID

*--ïîñ÷èòàåì, ñêîëüêî çàïèñåé ïîìå÷åíî íà ñíÿòèå ïðèçíàêà ñåðâèñ-ïå÷àòè
CREATE CURSOR CurMark (FrmPartTvrID I)
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.mark
	SELECT curMark
	APPEND BLANK
	REPLACE curMark.FrmPartTvrID WITH lvOrderTvrView.FrmPartTvrID
	SELECT lvOrderTvrView
ENDSCAN

IF RECCOUNT([curMark])&gt;0
	*--ñôîðìèðóåì äàííûå äëÿ ñïèñêà îòìåíû íà ñåðâèñíûé ïðèíòåð
	USE IN SELECT([lvCancelPrintView])
	_PARAM1 = lvFrmEdit.FrmID
	_PARAM2 = thisform.nCashNo
	USE lvCancelPrintView IN 0

	SELECT ;	
		lvCancelPrintView.* ;
	FROM lvCancelPrintView ;
	INNER JOIN curMark ON curMark.FrmPartTvrID = lvCancelPrintView.FrmPartTvrID ;
	INTO CURSOR curcancel NOFILTER

	*--ðàñïå÷àòàåì íà ñåðâèñ-ïðèíòåðå
	USE IN SELECT([curPrint])
	SELECT curcancel.DeviceID, ;
			curcancel.DeviceINI ;
		FROM curcancel ;
		GROUP BY DeviceID ;
		INTO CURSOR curPrint NOFILTER
		
	SELECT curPrint
	SCAN ALL
		LOCAL lcPrinter
	 	lcPrinter = ALLTRIM(curPrint.DeviceINI)
	 	IF lcPrinter = [DEFAULT]
					SET PRINTER TO DEFAULT
			ELSE
					SET PRINTER TO NAME ALLTRIM(lcPrinter)
	 	ENDIF
		SELECT curcancel
		PRINTJOB
			REPORT FORM REPORTS\serv_print_cancel.frx FOR curcancel.DeviceID = curPrint.DeviceID TO PRINTER
		ENDPRINTJOB
		SELECT curPrint
	ENDSCAN	
	
	*--óñòàíîâèì ïðèçíàê ïðîèçâåäåííîé îòìåíû ñåðâèñ-ïå÷àòè äëÿ âñåõ ïîìå÷åííûõ çàïèñåé
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark AND BITTEST(lvOrderTvrView.TvrAttr,0)
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,1) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN

	*-- Ïðîâåðÿåì âûêëþ÷åíèå áèëüÿðäíûõ ñòîëîâ
	thisForm.tblOff()

	*--ñíèìåì ïðèçíàê ñåðâèñ-ïå÷àòè äëÿ âñåõ ïîìå÷åííûõ çàïèñåé
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark
		USE IN SELECT([lvOrderTvrEdit])
		_PARAM = lvOrderTvrView.FrmPartTvrID
		USE lvOrderTvrEdit IN 0
		REPLACE lvOrderTvrEdit.TvrAttr WITH BITCLEAR(lvOrderTvrEdit.TvrAttr,0) IN lvOrderTvrEdit
		TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		SELECT lvOrderTvrView
	ENDSCAN
	***
	ThisForm.grdOrder._RSRequery()

ELSE
	MESSAGEBOX([Íåîáõîäèìî ïîìåòèòü áëþäà äëÿ ôîðìèðîâàíèÿ ñïèñêà îòìåíû.],48,[Îêíî ñîîáùåíèé]) 		
	RETURN .F.
	
ENDIF


*--âåðíåìñÿ íà íóæíóþ ïîçèöèþ
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.FrmPartTvrID = lFrmPartTvrID

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UHSAH</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdPredChkCancel</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 750
Height = 50
Width = 50
Picture = ..\graphic\del_prdcheck_.gif
DownPicture = ..\graphic\del_prdcheck_pr.gif
DisabledPicture = ..\graphic\del_prdcheck_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = "Îòìåíà ïðåä÷åêà"
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 26
Name = "CmdPredChkCancel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnDiscTvrID, ;
	  lnPredchk

*--ïðîâåðèì, áûë ëè ñäåëàí ïðåä÷åê
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

IF lnPredchk = 0
	MESSAGEBOX([Ïðåä÷åê íå áûë íàïå÷àòàí],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

IF MESSAGEBOX([Îòìåíèòü ïðåä÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

*--óñòàíîâèì ïðèçíàê îòìåíû ïðåä÷åêà äëÿ òåõ ïîçèöèé, ïî êîòîðûì îí áûë
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID AND BITTEST(lvOrderTvrView.TvrAttr,2)
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,3) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN

*--î÷èñòèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITCLEAR(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN

*--Îáíîâèì äàííûå â ñåòêå
ThisForm.grdOrder._RSRequery()

*--ðàçáëîêèðóåì ââîä äàííûõ â çàêàç
thisform._block_in(.F.)

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>txtcalcint</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtAttr</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .T.
FontSize = 12
BackStyle = 0
ControlSource = "lvFrmEdit.ID_"
Format = "R"
Height = 25
InputMask = "999"
Left = 56
Top = 31
Width = 38
ForeColor = 0,0,255
BackColor = 241,239,241
DisabledBackColor = 239,228,250
ZOrderSet = 27
_highlightselfcolor = RGB(239,228,250)
Name = "TxtAttr"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .F.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0WTPKZ</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdOrderDel</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 650
Height = 50
Width = 50
Picture = ..\graphic\del_ord_.gif
DownPicture = ..\graphic\del_ord_pr.gif
DisabledPicture = ..\graphic\del_ord_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 28
Name = "CmdOrderDel"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--óäàëåíèå çàêàçà ìåíåäæåðîì (èçìåíèì àòðèáóò çàêàçà )
IF MESSAGEBOX([Óäàëèòü âåñü çàêàç?],36,[Îêíî ñîîáùåíèé]) = 6
	*--äëÿ ñîõðàíåíèÿ çàêàçà ñ àòðèáóòîì óäàëåíèÿ ìåíåäæåðîì
	thisform.lorderDelM = .T.

	*--ñîõðàíèì âñå äàííûå
	thisform._OK()

	*--Ñêðûâåì ôîðìó
	thisform.Hide()
ELSE
	thisform.lorderDelM = .F.
	RETURN .F.
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0WTPLF</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdManager</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 62
Left = 750
Height = 50
Width = 50
FontSize = 20
Picture = ..\graphic\m_.gif
DownPicture = ..\graphic\m_pr.gif
DisabledPicture = ..\graphic\m_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = "Ôóíêöèè ìåíåäæåðà"
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 29
Name = "CmdManager"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîèçâåäåì àâòîðèçàöèþ ìåíåäæåðà
LOCAL  lnUserKod, ;
		_PARAM, ;
		lnDiscTvrID, ;
		llblock, ;
		lretacc, ;
		_PARAM1, ;
		_PARAM2

IF !thisform.lmanagerwork
	*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíèòîâ
	thisform.olecommprox1._close()
	
	*--Çàïóñêàåì ôîðìó àâòîðèçàöèè è ïàðîëÿ è àíàëèçèðóåì ðåçóëüòàò
	lnUserKod = oApp.DoModalFormRetValObj([login;rst_v1.vcx])

	*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
	thisform.olecommprox1._open()
	
	IF TYPE([lnUserKod])==[N] AND !EMPTY(lnUserKod)
		*--ïðîâåðêà íà ñòàòóñ ìåíåäæåðà
		USE IN SELECT([lvCltEditMgr])
		_PARAM = spUserClt(0,lnUserKod)
		USE lvCltEdit ALIAS lvCltEditMgr IN 0

		IF RECCOUNT([lvCltEditMgr])&gt;0
			DO CASE
				*--ðàçáëîêèðóåì êíîïêè ìåíåäæåðà, åñëè ïîëüçîâàòåëü ÿâëÿåòñÿ ìåíåäæåðîì
				CASE BITTEST(lvCltEditMgr.CltRole,5)
					*--ïðîâåðèì äîñòóïíîñòü âîçâðàòà
					thisform.CmdCHKBACK.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[RETACC])
					
					*--ïðîâåðèì äîñòóïíîñòü çàêðûòèÿ ñìåíû (Z-îò÷åò)
					thisform.cmdClose.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[ZACC])

					*--ïðîâåðèì äîñòóïíîñòü X-îò÷åòà
					thisform.cmdXReport.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[XACC])
					
					*--ïðîâåðèì äîñòóïíîñòü óäàëåíèÿ çàêàçà
					thisform.cmdOrderDel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[DELORDACC])
					
					*--ïðîâåðèì äîñòóïíîñòü îòìåíû ïðåä÷åêà
					thisform.cmdPredChkCancel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[PRCHKACC])

					*--ïðîâåðèì äîñòóïíîñòü îòìåíû ñåðâèñ-ïå÷àòè
					thisform.cmdPrintCancel.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[SPRINTACC])
						
					*--ïðîâåðèì äîñòóïíîñòü óäàëåíèÿ ïîçèöèé
					thisform.cmdDelM.Enabled = _spVerifyUserGrant(lnUserKod,[CustomFunc],[DELPOSACC])
					
					thisform.lmanagerwork = .T.
					this.BackColor = RGB(252,174,12)
					this.ForeColor = RGB(128,128,255)
					
					*--ñäåëàåì äîïîëíèòåëüíóþ ïðîâåðêó
					*--åñëè â çàêàçå óæå åñòü ñêèäêà, òî çàïðåòèì ðåäàêòèðîâàíèå çàêàçà
					lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
					
					SELECT lvOrderTvrView
					LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
					IF FOUND()
						llblock = .T.
					ENDIF
					
					*--åñëè áûë íàïå÷àòàí ïðåä÷åê, òî çàïðåòèì ââîä äàííûõ
					SELECT lvOrderTvrView
					COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

					IF lnPredchk &gt; 0
						llblock = .T.
					ENDIF	
					
					*--çàáëîêèðóåì ÷àñòü êíîïîê
					IF llblock
						thisform._block_in(.T.)
					ENDIF					
									
				OTHERWISE
					MESSAGEBOX([Äàííûé ïîëüçîâàòåëü íå ÿâëÿåòñÿ ìåíåäæåðîì],48,[Îêíî ñîîáùåíèé])
					RETURN .F.
			ENDCASE
		ELSE
			MESSAGEBOX([Íåò ïðèâÿçêè ïîëüçîâàòåëÿ ê êëèåíòó],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ENDIF
ELSE
	*--çàáëîêèðóåì êíîïêè ìåíåäæåðà
	thisform.cmdPredChkCancel.Enabled = .F.
	thisform.cmdPrintCancel.Enabled = .F.
	thisform.cmdDelM.Enabled = .F.
	thisform.cmdClose.Enabled = .F.
	thisform.cmdOrderDel.Enabled = .F.
	thisform.CmdCHKBACK.Enabled = .F.
	thisform.cmdXReport.Enabled = .F.
	thisform.lmanagerwork = .F.
	this.BackColor = RGB(239,228,250)
	this.ForeColor = RGB(255,128,64)
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdXReport</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 700
Height = 50
Width = 50
Picture = ..\graphic\x_otchet_.gif
DownPicture = ..\graphic\x_otchet_pr.gif
DisabledPicture = ..\graphic\x_otchet_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 30
Name = "CmdXReport"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--ïðîâåðèì, äîñòóïíà ëè ïå÷àòü X-îò÷åòà íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü X-îò÷åòà íå ïðåäóñìîòðåíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
thisform.NewObject('Shtrih',lcKkmLib,'kkms.vcx')

thisform.Shtrih.ReportX()
thisform.Shtrih.RELEASE

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdMenu</objname>
		<parent>frmorderedit</parent>
		<properties>ColumnCount = 7
FontSize = 28
GridLines = 3
HeaderHeight = 0
Height = 239
Left = 1
Panel = 1
ReadOnly = .T.
RecordMark = .F.
RecordSource = "tmpmenu"
RowHeight = 55
ScrollBars = 2
Top = 361
Width = 800
ForeColor = 0,0,160
GridLineColor = 29,29,29
ZOrderSet = 31
Name = "GrdMenu"
Column1.FontSize = 10
Column1.ControlSource = "tmpmenu.t1"
Column1.Width = 106
Column1.ReadOnly = .T.
Column1.Sparse = .F.
Column1.ForeColor = 0,0,160
Column1.Name = "Column1"
Column2.FontSize = 10
Column2.ControlSource = "tmpmenu.t2"
Column2.Width = 106
Column2.ReadOnly = .T.
Column2.Sparse = .F.
Column2.ForeColor = 0,0,160
Column2.Name = "Column2"
Column3.FontSize = 10
Column3.ControlSource = "tmpmenu.t3"
Column3.Width = 106
Column3.ReadOnly = .T.
Column3.Sparse = .F.
Column3.ForeColor = 0,0,160
Column3.Name = "Column3"
Column4.FontSize = 10
Column4.ControlSource = "tmpmenu.t4"
Column4.Width = 106
Column4.ReadOnly = .T.
Column4.Sparse = .F.
Column4.ForeColor = 0,0,160
Column4.Name = "Column4"
Column5.FontSize = 10
Column5.ControlSource = "tmpmenu.t5"
Column5.Width = 106
Column5.ReadOnly = .T.
Column5.Sparse = .F.
Column5.ForeColor = 0,0,160
Column5.Name = "Column5"
Column6.FontSize = 10
Column6.ControlSource = "tmpmenu.t6"
Column6.Width = 106
Column6.ReadOnly = .T.
Column6.Sparse = .F.
Column6.ForeColor = 0,0,160
Column6.Name = "Column6"
Column7.FontSize = 10
Column7.ControlSource = "tmpmenu.t7"
Column7.Width = 108
Column7.ReadOnly = .T.
Column7.Sparse = .F.
Column7.ForeColor = 0,0,160
Column7.Name = "Column7"
</properties>
		<protected/>
		<methods>PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdMenu._RSRequery
* Called by.......: &lt;&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LPARAMETER	tvar,  tcNM	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

IF !EMPTY(tcNM)
	*--îïðåäåëèì ID âûáðàííîãî ìíîæåñòâà
	SELECT lvPOSFuncInSetView
	LOCATE FOR ALLTRIM(lvPOSFuncInSetView.NM)==ALLTRIM(tcNM)
	IF !FOUND()
		MESSAGEBOX([Íå íàéäåí òîâàð. FrmOrderEdit.GrdMenu._rsrequery().],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF		
	thisform._paintmenu(tvar,lvPOSFuncInSetView.ID)
ELSE
	thisform._paintmenu(tvar)
ENDIF
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column1</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>882072490</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column1</parent>
		<properties>Left = 1
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column2</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RX0UFZLH</uniqueid>
		<timestamp>884107607</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column2</parent>
		<properties>Left = 14
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column3</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SG0NUEC5</uniqueid>
		<timestamp>887319937</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column3</parent>
		<properties>Left = 3
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00R6MO9</uniqueid>
		<timestamp>887319937</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column4</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column4</parent>
		<properties>Left = 4
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1S802IZ6O</uniqueid>
		<timestamp>887321259</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column5</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column5</parent>
		<properties>Left = 17
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>887327567</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column6</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column6</parent>
		<properties>Left = 6
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>893740843</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>frmorderedit.GrdMenu.Column7</parent>
		<properties>FontSize = 28
Caption = "Header1"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class>edtmenu</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>Edtmenu1</objname>
		<parent>frmorderedit.GrdMenu.Column7</parent>
		<properties>Left = 7
ReadOnly = .T.
Top = 11
ForeColor = 0,0,160
Name = "Edtmenu1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SC0I42EJ</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdUp</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 320
Left = 509
Height = 32
Width = 34
Picture = ..\graphic\_carry_in.bmp
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .F.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 32
Name = "CmdUp"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF thisform._menusel
	*--âîçâðàùàåìñÿ â ãëàâíîå ìåíþ
	thisform._menusel = .F.
	thisform.grdmenu._rsrequery(1)
	thisform.lblPar.Visible = .F.
	thisform.lblPar.caption = []
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGrdDown</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 111
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow_down_.gif
DownPicture = ..\graphic\arrow_down_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 33
Name = "CmdGrdDown"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF !EOF([lvOrderTvrView])
	SELECT lvOrderTvrView
	SKIP 1

	thisform.grdOrder.Refresh()
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGrdUp</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 61
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow_up_.gif
DownPicture = ..\graphic\arrow_up_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 34
Name = "CmdGrdUp"
</properties>
		<protected/>
		<methods>PROCEDURE Click
IF !BOF([lvOrderTvrView])
	SELECT lvOrderTvrView
	SKIP -1

	thisform.grdOrder.Refresh()
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDevOrder</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 161
Left = 500
Height = 50
Width = 50
Picture = ..\graphic\arrow2_.gif
DownPicture = ..\graphic\arrow2_pr.gif
DisabledPicture = ..\graphic\arrow2_dis.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 35
Name = "CmdDevOrder"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnQnt, ;
	  luResAdding, ;
	  lnFrmTypeID, ;
	  llResSaveOrd, ;
	  llResSavePos, ;
	  lNewFrmID, ;
	  lnDefClt,;
	  _PARAM 	

lnQnt = 0
lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))

IF MESSAGEBOX([Ïåðåíåñòè ïîìå÷åííûå ïîçèöèè â íîâûé çàêàç?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--ïîñ÷èòàåì ïîçèöèè, ïîìå÷åííûå äëÿ ïåðåíîñà
SELECT lvOrderTvrView
COUNT ALL FOR lvOrderTvrView.mark TO lnQnt

IF lnQnt&lt;=0
	MESSAGEBOX([Íå ïîìå÷åíî íè îäíîé ïîçèöèè äëÿ ïåðåíîñà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--ïåðåíåñåì ïîìå÷åííûå ïîçèöèè â íîâûé çàêàç
USE IN SELECT([lvFrmEdit1])
USE lvFrmEdit IN 0 ALIAS lvFrmEdit1 NODATA
CURSORSETPROP([BUFFERING],3,[lvFrmEdit1])

BEGIN TRANSACTION	
	*--ñôîðìèðóåì øàïêó íîâîãî çàêàçà	
	SELECT lvFrmEdit1
	APPEND BLANK
	REPL lvFrmEdit1.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit1.PointEmiCltID WITH lvFrmEdit.PointEmiCltID, ;
		 lvFrmEdit1.PointEmiOUID WITH lvFrmEdit.PointEmiOUID, ;
		 lvFrmEdit1.FrmTypeID WITH lvFrmEdit.FrmTypeID, ;
		 lvFrmEdit1.FrmDate WITH DATETIME(), ;
		 lvFrmEdit1.ID_ WITH 1, ;
		 lvFrmEdit1.FrmCurTypeID WITH 1, ;
		 lvFrmEdit1.FrmNum WITH spFrmAutoNum(lvFrmEdit.FrmTypeID,DATETIME(),lvFrmEdit.PointEmiOUID)
	
	*--ñîõðàíèì øàïêó	
	llResSaveOrd = thisform.cstDataWork.Save([lvFrmEdit1]) 		
	IF !llResSaveOrd
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
	*--ïîëó÷èì FrmID íîâîãî çàêàçà
	lNewFrmID = spGetLastIncrementedID([lvFrmEdit1])
	
	*--ñôîðìèðóåì ïîçèöèè íîâîãî çàêàçà
	SELECT lvOrderTvrView
	SCAN FOR lvOrderTvrView.mark
	    _PARAM = lvOrderTvrView.FrmPartTvrID
		USE IN SELECT([lvOrderTvrEdit])
		USE lvOrderTvrEdit IN 0
		SELECT lvOrderTvrEdit
		REPLACE lvOrderTvrEdit.FrmID WITH lNewFrmID IN lvOrderTvrEdit
			
		llResSavePos = TABLEUPDATE(.T.)
		
		IF !llResSavePos
			*--Îòêàòûâàåì òðàíçàêöèþ
			ROLLBACK
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
		SELECT lvOrderTvrView
	ENDSCAN
	
*--Ïîäòâåðæäàåì òðàíçàêöèþ
END TRANSACTION
	
	ThisForm.grdOrder._RSRequery()

MESSAGEBOX([Ïîìå÷åííûå ïîçèöèè ïåðåíåñåíû â íîâûé çàêàç.],64,[Îêíî ñîîáùåíèé])

	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UL11Z7IE</uniqueid>
		<timestamp>950766734</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCardNo</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 3
BackStyle = 0
BorderStyle = 0
Value = 
Enabled = .F.
Height = 25
Left = 338
Top = 31
Width = 93
ForeColor = 0,0,255
BackColor = 239,228,250
DisabledBackColor = 239,228,250
DisabledForeColor = 128,128,255
ZOrderSet = 36
Name = "txtCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UL11Z7IF</uniqueid>
		<timestamp>951882120</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 219
Left = 508
Height = 48
Width = 58
ZOrderSet = 37
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	*------------------------------------------------------------------------------

	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	This.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHBbhxC8wMgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1US0TUWOI</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdCHKBACK</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 262
Left = 500
Height = 50
Width = 50
FontBold = .T.
FontName = "Times New Roman"
FontSize = 18
Picture = ..\graphic\return_.gif
DownPicture = ..\graphic\return_pr.gif
DisabledPicture = ..\graphic\return_dis.gif
Caption = ""
Enabled = .F.
ToolTipText = ""
Visible = .T.
ForeColor = 128,128,255
BackColor = 239,228,250
DisabledForeColor = 192,192,192
DisabledBackColor = 255,255,255
ZOrderSet = 38
Name = "CmdCHKBACK"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lPayMode


LOCAL lRetVal

		*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._close()
		thisform._ok()

		lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],ThisForm.nfrmid ,thisform.nPayVarNum, 2,0)

ThisForm.grdOrder._RSRequery()
		*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
		thisform.olecommprox1._open()
		IF TYPE([lRetVal])==[L] AND !lRetVal
		RETURN lRetVal
	    ENDIF
	
	thisform.Hide()
	RETURN lRetVal

************************ñÒÀÐÎÅ

*-- ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, äîñòóïåí ëè âîçâðàò çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0 OR VAL(oRes.GetParam([RST],[CHKBACK]))&lt;&gt;1
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå âîçâðàò çàêàçîâ íåäîñòóïåí.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--  ÏÅÐÅÍÅÑÒÈ ïðîâåðèì, ÿâëÿåòñÿ ëè îôèöèàíò êàññèðîì
IF !thisform._iscasher()
	RETURN .F.
ENDIF

*--  ÏÅÐÅÍÅÑÒÈ îïëàòà çàêàçà (èçìåíèì ñòàòóñ çàêàçà, íàïå÷àòàåì ôèñêàëüíûé ÷åê)
IF RECCOUNT([lvOrderTvrView])&gt;0

	*--âûáåðåì òèï îïëàòû ïðè âîçâðàòå
	lPayMode = oApp.DoModalFormRetValObj([FrmBackPayment;rst_v1.vcx],ThisForm.nOrderSum)

	IF TYPE([lPayMode])==[L] AND !lPayMode
		*--îòìåíà îïëàòû çàêàçà
		RETURN .F.
	ENDIF

	*--ñîõðàíèì âñå äàííûå (çàêàç ïîêà íå îïëà÷åí)
	thisform.lorderpay = .F.
	thisform._ok()

	*--ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
	IF thisform._storechktransBACK(lPayMode)
	
		*--äëÿ ñîõðàíåíèÿ çàêàçà ñî ñòàòóñîì "îïëà÷åí"
		thisform.lorderpay = .T.
		
		*--äëÿ ñîõðàíåíèÿ çàêàçà ñ ôëàãîì âîçâðàòà
		thisform.lOrderReturn = .T.

		*--ñîõðàíèì âñå äàííûå
		thisform._ok()
		
		*--Ñêðûâàåì ôîðìó
		thisform.Hide()
	ELSE
		*--çàêàç îñòàëñÿ íåîïëà÷åííûì
		thisform.lorderpay = .F.
		thisform.lOrderReturn = .F.
		RETURN .F.
	ENDIF
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1X30ZY8U0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>txtcalcint</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtbarcod</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 3
Value = 0
ControlSource = ""
Format = "R"
Height = 29
InputMask = "9999999999999"
Left = 548
Top = 321
Width = 214
ForeColor = 0,0,255
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 39
_highlightselfcolor = RGB(239,228,250)
nlength = 13
Name = "Txtbarcod"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1XI0YT4KX</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdNoDisc</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 31
Left = 729
Height = 27
Width = 31
FontBold = .T.
FontSize = 12
Picture = ..\graphic\stdtlbdele.bmp
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 40
Name = "CmdNoDisc"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*--óäàëåíèå ñêèäêè èç çàêàçà
thisform.cntDiscID.cmdClear.Click()

*--ñîõðàíèì íîìåð êàðòû (ïóñòîé)
SELECT lvFrmEdit
REPLACE lvFrmEdit.FrmNote WITH ''
			
*--ñêðîåì ñóììó íàêîïëåíèÿ
thisform.lblSumAccount.Visible  = .F.
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdDisc</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 31
Left = 768
Height = 27
Width = 31
FontBold = .T.
FontSize = 12
Caption = "%"
Enabled = .T.
ToolTipText = ""
Visible = .T.
ForeColor = 255,128,0
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 41
Name = "CmdDisc"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL lnMODEDISC, ;
	  lretNo, ;
	  _PARAM, ;
	  ldiscID, ;
	  lnNoLblSum	

lnMODEDISC = VAL(oRes.GetParam([RST],[MODEDISC]))
lnNoLblSum = VAL(oRes.GetParam([RST],[NOLBLSUM]))

IF lnMODEDISC&lt;&gt;1
	RETURN .F.
ENDIF

*--çàáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíèòîâ
thisform.olecommprox1._close()

*--ïîëó÷èì ID êàðòû
lretNo = oApp.DoModalFormRetValObj([FrmDiscount;rst_v1.vcx])

*--ðàçáëîêèðóåì ñ÷èòûâàíèå êàðòî÷åê êëèåíòîâ
thisform.olecommprox1._open()

*--ïðîâåðèì ñ÷èòàííûé íîìåð êàðòî÷êè
IF TYPE([lretNo])==[C]
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvDiscCardByNo])

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS
	
	_PARAM = lretNo
	USE lvDiscCardByNo IN 0
	
	IF RECCOUNT([lvDiscCardByNo])&gt;0
		IF lvDiscCardByNo.DiscCardIsActive
			*--ñîõðàíèì íîìåð êàðòû
			SELECT lvFrmEdit
			REPLACE lvFrmEdit.FrmNote WITH ALLTRIM(STR(lvDiscCardByNo.DiscCardID))
			
			*--âûáåðåì ñêèäêó â ñîîòâåòñòâèè ñ êàðòîé
			ldiscID = lvDiscCardByNo.DiscID
			thisform.cntDiscID.Setvalue(ldiscID)
			thisform.cntDiscID._HandleAnyChange()
			
			*--ïîêàæåì ñóììó íàêîïëåíèÿ
			IF EMPTY(lnNoLblSum)
				thisform.lblSumAccount.Caption = [Ñóììà íàêîïëåíèÿ   ]+ALLTRIM(STR(lvDiscCardByNo.DiscCardSumAccount,99,2))
				thisform.lblSumAccount.Visible  = .T.
			ENDIF
			
		ELSE
			MESSAGEBOX([Äàííàÿ êàðòà íå àêòèâíà.]+CHR(13)+;
			[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],48,[Îêíî ñîîáùåíèé])
			RETURN .F.
		ENDIF
	ELSE
		MESSAGEBOX([Êàðòà íå íàéäåíà.]+CHR(13)+;
		[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF
	
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951882120</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmorderedit</parent>
		<properties>FontBold = .F.
FontSize = 14
BackStyle = 0
Caption = "Ñêèäêà"
Height = 25
Left = 524
Top = 32
Width = 63
TabIndex = 26
ForeColor = 0,0,255
ZOrderSet = 42
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>950766734</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdEnter</objname>
		<parent>frmorderedit</parent>
		<properties>Top = 320
Left = 763
Height = 30
Width = 35
Picture = ..\graphic\barcode_.gif
DownPicture = ..\graphic\barcode_pr.gif
Caption = ""
Enabled = .T.
ToolTipText = ""
Visible = .T.
BackColor = 239,228,250
DisabledBackColor = 255,255,255
ZOrderSet = 43
Name = "CmdEnter"
</properties>
		<protected/>
		<methods>PROCEDURE Click
LOCAL _PARAM, ;
		ltvrid
		
*--îïðåäåëèì êîä òîâàðà ïî øòðèõ-êîäó
	USE IN SELECT([lvTovarLookUpByTLU])

	_PARAM = ALLTRIM(STR(thisform.txtbarcod.value,13,0))
	USE lvTovarLookUpByTLU IN 0
	
	IF RECCOUNT([lvTovarLookUpByTLU])&gt;0
		ltvrid = lvTovarLookUpByTLU.tvrid
	
		*--äîáàâèì áëþäî â çàêàç
		thisform.grdOrder._add(ltvrid)	
		thisform.txtbarcod.Value = 0
		thisform.txtbarcod.SetFocus()
	ELSE
		MESSAGEBOX([Øòðèõ-êîä íå íàéäåí.],0+48,[Îêíî ñîîáùåíèé])
		thisform.txtbarcod.Value = 0
		thisform.txtbarcod.SetFocus()
		RETURN .F.
	ENDIF



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmorderedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 20, 12, 33, 26, 72, 6, 1
Arial, 0, 10, 6, 16, 13, 35, 3, 0
Arial, 1, 20, 13, 33, 25, 71, 7, 1
Arial, 0, 28, 16, 43, 34, 99, 8, 1
Times New Roman, 1, 18, 10, 27, 21, 61, 5, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SY124ZSI</uniqueid>
		<timestamp>982862355</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmpayment</objname>
		<parent/>
		<properties>DataSession = 1
Top = 2
Left = 1
Height = 433
Width = 685
ShowWindow = 1
DoCreate = .T.
AutoCenter = .F.
BorderStyle = 3
Caption = "Îïëàòà çàêàçà"
KeyPreview = .F.
TitleBar = 0
BackColor = 241,239,241
nordersum = 0
ncoupon = .F.
nnal = .F.
nsalesid = 0
ncashno = 0
ncheckid = 0
lorderreturn = .F.
lorderpay = .F.
nopereation = 1
ncltbalans = 0
ncltlimit = 0
nfreesumm = 0
nchkid = 0
ctparam = 
withedel = .F.
guestaccountid = 
edel_clt =  
nfrmid = 0
Name = "frmpayment"
cstmsghandler.Top = 12
cstmsghandler.Left = 56
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 12
cstresizable.Left = 24
cstresizable.Name = "cstresizable"
Img1.ZOrderSet = 0
Img1.Name = "Img1"
cstdatawork.Top = 12
cstdatawork.Left = 84
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _footerprint
*-- Íàïå÷àòàåì ïîäâàë ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcFooterFile, lnHandleFile, lcLine


lcFooterFile = ALLT(oRes.GetParam([RST],[CHKFTRFL]))
lcFooterFile = IIF(AT([.],lcFooterFile)=0,lcFooterFile+[.TXT],lcFooterFile)

IF !EMPTY(lcFooterFile) AND FILE(lcFooterFile)
	lnHandleFile = FOPEN(lcFooterFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
ELSE
		this.Shtrih.PrintHeader()
ENDIF

ENDPROC
PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMPAYMENT._HANDLECNTCANCELSAVEEVENT
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcMessage
LOCAL lfullsum
lfullsum = IIF(thisform.txtcalcnum1.value&gt;thisform.nOrderSum,thisform.txtcalcnum1.value,thisform.nOrderSum)
this.olecommprox1._close()
WITH This
	IF tcMessage = [OK]
		*--â çàâèñèìîñòè îò âûáðàííîãî òèïà äîêóìåíòà ïðîèçâåäåì ñîõðàíåíèå
		IF .CntFrmTypeID.value&lt;&gt;22
			IF MESSAGEBOX([Èçìåíèòü òèï äîêóìåíòà?],36,[Îêíî ñîîáùåíèé])=7
				.CntFrmTypeID.setvalue(22)
				.CntFrmTypeID.SetFocus()
				RELEASE pccardcode
				RETURN .F.
			ELSE
				*--ñîõðàíåíèå çàêàçà êàê äîêóìåíòà äðóãîãî òèïà (çàÿâêà, èíâåíòàðíàÿ âåäîìîñòü)
				.lorderpay = .T.
				._ok(.T.)
			ENDIF
		ENDIF
		*--Ïðîèçâåäåì ïðîâåðêó êîððåêòíîñòè äàííûõ è ñôîðìèðóåì âîçâðàùàåìîå çíà÷åíèå
		DO CASE
			CASE .CntPayTypeID.Value = 1
				*--îïëàòà íàëè÷íûìè
				.uRetVal = [(]+ALLTRIM(STR(lfullsum,99,2))+[,0,0,0)1]
				
			CASE .CntPayTypeID.Value = 2
				*--îïëàòà áàíêîâñêîé êàðòîé
				.uRetVal = [(0,]+ALLTRIM(STR(.nOrderSum,99,2))+[,0,0)2]
				
			CASE .CntPayTypeID.Value = 3
				*--îïëàòà êóïîíîì
				IF EMPTY(.cntOUID.Value) OR EMPTY(.cntCouponID.Value)
					MESSAGEBOX([Óêàæèòå âñå äàííûå äëÿ äàííîãî òèïà îïëàòû.],48,[Îêíî ñîîáùåíèé])
					RETURN .F.
				ENDIF
				
				.uRetVal = ALLTRIM(STR(.cntCouponID.Value))+[(]+ALLTRIM(STR(.nNal,99,2))+[,0,]+ALLTRIM(STR(.nCoupon,99,2))+[,0)3]
				
			CASE .CntPayTypeID.Value = 4
				*--îïëàòà VIP êàðòîé
				.uRetVal = [(0,0,0,]+ALLTRIM(STR(.nOrderSum,99,2))+[)4]
				
		ENDCASE
		.uRetVal = this.printcheckfr()
	ELSE
		*--tcMessage = [ESC]
		.uRetVal = .F.
	ENDIF
	*--Ñêðûâåì ôîðìó
	IF 	VARTYPE(.uRetVal)='L' AND .uRetVal

		*03.11.2008 11:42 -&gt;Ïîêàæåì íà äèñïëåå ïîêóïàòåëÿ ðàñ÷åò
		IF VARTYPE(LnDisp)=[O]
			LnDisp.ClearText()
			LnDisp.displaytextat(0,0,[ÏÎËÓ×ÅÍÎ:]+STR(.txtcalcnum1.Value,10,2),1)
			LnDisp.displaytextat(1,0,[ÑÄÀ×À   :]+STR(VAL(.lblChange.Caption),10,2),1)
		ENDIF
		*------------------------------------------------------------------------------
		MESSAGEBOX('Ðåãèñòðàöèÿ îïëàòû ïðîèçâåäåíà...'+chr(13)+;
				   [ÏÎËÓ×ÅÍÎ:]+STR(.txtcalcnum1.Value,10,2)+chr(13)+;
				   [ÑÄÀ×À   :]+STR(VAL(.lblChange.Caption),10,2),0+64,'Èíôîðìàöèÿ îá îïëàòå')
	ENDIF
	.hide()
	*------------------------------------------------------------------------------
	RELEASE pccardcode
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _headerprint
*-- Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
LOCAL lcHeaderFile, lnHandleFile, lcLine

lcHeaderFile = ALLT(oRes.GetParam([RST],[CHKHDRFL]))
lcHeaderFile = IIF(AT([.],lcHeaderFile)=0,lcHeaderFile+[.TXT],lcHeaderFile)

IF !EMPTY(lcHeaderFile) AND FILE(lcHeaderFile)
	lnHandleFile = FOPEN(lcHeaderFile)
	IF lnHandleFile &gt; 0
		DO WHILE !FEOF(lnHandleFile)
			*--ñ÷èòûâàåì ïîñòðî÷íî
			lcLine = FGETS(lnHandleFile)
			lcLine = [*]+PADC(ALLTRIM(lcLine),48)+[*]
			*--íàïå÷àòàåì
			this.Shtrih.PrintString(lcLine)
		ENDDO
		FCLOSE(lnHandleFile)
		this.Shtrih.FeedDocument(2)
	ENDIF
	ELSE
		this.Shtrih.PrintHeader()
ENDIF

ENDPROC
PROCEDURE _iscasher
*-- ïðîâåðèì, ÿâëÿåòñÿ ëè äàííûé îôèöèàíò êàññèðîì
LOCAL _PARAM

USE IN SELECT([lvcashierByCltView])
_PARAM = spUserClt()
USE lvcashierByCltView IN 0

IF RECCOUNT([lvcashierByCltView])&lt;=0
	MESSAGEBOX([Äàííûé ñîòðóäíèê íå ÿâëÿåòñÿ êàññèðîì],48,[Îáðàòèòåñü ê àäìèíèñòðàòîðó])
	RETURN .F.
ELSE
	RETURN .T.
ENDIF
ENDPROC
PROCEDURE _ok
*-------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMORDEREDIT._OK()
* Called by.......: frmOrderEdit.lblEdit.Click()
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETER tChangeTypeOrd

LOCAL	llResSaveOrd, ;
		llDataChanged, _PARAM,lPayMode

WITH This			
	
	*--Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*--Ïîäãîòîâèìñÿ ê ñîõðàíåíèþ äàííûõ

	*-- Åñëè âêëþ÷åí ôëàã îïëàòû çàêàçà, ïîìåíÿåì åãî ñòàòóñ
	IF .lorderpay
		USE IN SELECT([lvFrmEdit])
		_PARAM = .nFrmID
		USE lvFrmEdit IN 0
		SELECT lvFrmEdit
		IF lvFrmEdit.FrmTypeId = 30 &amp;&amp; Ñ÷åò çà ïðîæèâàíèå
			REPLACE FrmIsPayed WITH .T. IN lvFrmEdit
		ELSE
			REPLACE FrmStatusID WITH 3 , FrmIsPayed WITH .T. IN lvFrmEdit
		ENDIF
		*--ïðè ñîõðàíåíèè çàêàçà êàê äîêóìåíòà äðóãîãî òèïà
		IF tChangeTypeOrd
			REPLACE FrmTypeID WITH .CntFrmTypeID.value IN lvFrmEdit
		ELSE
		 		USE lvFrmPartFrm IN 0 NODATA
				**CURSORSETPROP([BUFFERING],3,[lvFrmPartFrm])
				* Åñëè åñòü äàííûå ïî çàêàçó - äîáàâëÿåì èíôó ïî ÷åêó â çàêàç
			lPayMode = VAL(RIGHT(this.uretval,1))
		    	INSERT INTO lvFrmPartFrm ;
						           (FrmID        ;
						           ,CntFrmID     ;
						           ,CntFrmIncludeSum ;
						           ,CntFrmIncludeSumVAT ;
						           ,CntFrmIncludeSumVATRate ;
						           ,CntFrmSumSplitProcID ;
						           ,FrmPartFrmNote ;
						           ,FrmCheckID) ;
			     VALUES ;
						           (.nFrmID ;
						           ,.nFrmID  ;
						           ,IIF(lPayMode=4,0,.nOrderSum*IIF(.lOrderReturn,1,-1)) ;
						           ,0 ;
						           ,0 ;
						           ,1 ;
						           ,ALLTRIM(STR(.nCheckID))+'÷åêID' ;
						           ,.nCheckID)
				IF !TABLEUPDATE(1,.T.,[lvFrmPartFrm])
							TABLEREVERT(.T.,[lvFrmPartFrm])
							MESSAGEBOX([Îøèáêà ïðè äîáàâëåíèè â çàêàç äàííûõ îá îïëàòå.],48,[Îêíî ñîîáùåíèé])
				ENDIF
		        USE IN lvFrmPartFrm
		        *--- óäàëÿåì èç çàêàçà ñëóæåáíûå ïîçèöèè
		        SET DATABASE TO BASIS
		        LOCAL lnConnectHandle ,lnSqlExeResult
		        #DEFINE	pcvCONNECTIONNAME	'SQLBASISCONNECTION'
		        lnConnectHandle = SQLCONNECT(pcvCONNECTIONNAME)
				*------------------------------------------------------------------------------
				*07.04.2006 16:45 -&gt; Âûïîëíÿåì çàïðîñ
				lnSqlExeResult = 0
							***
							DO WHILE (lnSqlExeResult = 0) AND (lnSqlExeResult # -1)
								lnSqlExeResult = SQLEXEC(lnConnectHandle, ;
									[SET LOCK_TIMEOUT ] + [1000] + [ ] + ;
									[DELETE FROM FrmPartTvr WHERE FrmId = ]+ ALLTRIM(STR(.nFrmID))+[ AND TvrId = -1] )
							ENDDO
							***
							IF lnSqlExeResult = -1
								*11.08.2006 14:53 -&gt;Âûçîâåì ïðîöåäóðó îáðàáîòêè îøèáîê
								spHandleODBCError()
								*------------------------------------------------------------------------------
							ENDIF
		ENDIF
	ENDIF
	*------------------------------------------------------------------------------
	*-- Ïðîèçâîäèì ñîõðàíåíèå øàïêè çàêàçà
	llDataChanged = .cstDataWork.DataChanged([lvFrmEdit],.T.)
	IF llDataChanged
		llResSaveOrd = .cstDataWork.Save([lvFrmEdit])
	ELSE
		llResSaveOrd = .T.
	ENDIF
	*------------------------------------------------------------------------------
	this.nfrmid = 0
	this.ncheckid=0
	this.nchkid=0
	*-- Îáðàáîòàåì ðåçóëüòàòû ÂÑÅÕ îïåðàöèé ñîõðàíåíèÿ
	IF llResSaveOrd
		*--Ïîäòâåðæäàåì òðàíçàêöèþ

			LOCAL lRetVal , lPayMode
	        lRetVal = this.uretval
			IF TYPE([lRetVal])==[C] &amp;&amp;
				*--òèï îïëàòû
				lPayMode = VAL(RIGHT(lRetVal,1))
			ENDIF
			IF .withedel AND TYPE('lPayMode')='N' AND lPayMode = 4
				.WriteToEdel(ALLTRIM(pccardcode))
			ENDIF
		END TRANSACTION
		.uRetVal = .T.
	ELSE
		*--Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],48,[Îêíî ñîîáùåíèé])
		.uRetVal = .F.
	ENDIF
ENDWITH
*------------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************

ENDPROC
PROCEDURE _storechktrans
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: tfsctype - òèï îïëàòû, tfscexp - ïàðàìåòðû ôèñêàëüíîãî ÷åêà
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå òðàíçàêöèè ÷åêà
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
LPARAMETER tfsctype, tfscexp

LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lnDiscount, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

lfsctype = tfsctype
ls1 = VAL(SUBSTR(tfscexp,AT([(],tfscexp)+1,AT([,],tfscexp,1)-AT([(],tfscexp)-1))
ls2 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,1)+1,AT([,],tfscexp,2)-AT([,],tfscexp,1)-1))
ls3 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,2)+1,AT([,],tfscexp,3)-AT([,],tfscexp,2)-1))
ls4 = VAL(SUBSTR(tfscexp,AT([,],tfscexp,3)+1,AT([)],tfscexp)-AT([,],tfscexp,3)-1))


*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*------------------------------------------------------------------------------

WITH This
*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF TYPE('.nSalesID')&lt;&gt;'N'
		MESSAGEBOX([Îøèáêà îòêðûòèÿ ñìåíû],0+64,[×åê íåëüçÿ íàïå÷àòàòü])
		RETURN .F.
	ENDIF
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ ñìåíû.Âîçìîæíî, ñìåíà ïðåâûñèëà 24 ÷àñà],0+64,[×åê íåëüçÿ íàïå÷àòàòü])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,.nopereation *-1,.nCashNo,spUserClt())
	IF VARTYPE(lcUniqueFileNM)&lt;&gt;'C'
		MESSAGEBOX('Îøèáêà ïîäãîòîâêè ÷åêà.Âîçìîæíî, ñìåíà ïðåâûñèëà 24 ÷àñà.'+CHR(13)+'Ñìåíà:'+STR(.nSalesID,10,0),0+64,'×åê íåëüçÿ íàïå÷àòàòü')
		RETURN .F.
	ENDIF
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()
WAIT WINDOW [Ïîäîæäèòå...] NOWAIT &amp;&amp;TIMEOUT 1

*--Îòêðûâàåì LV äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID

	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

IF this.nchkid=0 AND this.nfrmid&lt;&gt;0
	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------
ENDIF
	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	IF !SELECT('lvCheckTransView')=0
		SELECT lvCheckTransView
		LOCATE ALL FOR lvCheckTransView.CheckTransTvrID = lvOrderTvrView.TvrId
		IF FOUND()
			SELECT lvOrderTvrView
			REPLACE lvOrderTvrView.TvrNM WITH lvCheckTransView.TvrNm
		ENDIF
	ENDIF
		DO CASE
		  CASE this.nopereation = 1 AND lvOrderTvrView.TvrQnt&lt;&gt;0&amp;&amp; ïðîäàæà
		       .Shtrih.CheckSaleTran(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale,lvOrderTvrView.TvrVatRate)
		  CASE this.nopereation = 2  &amp;&amp; Âîçâðàò
			   .Shtrih.CheckSaleReturn(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale,lvOrderTvrView.TvrVatRate)
		  CASE this.nopereation = 8  &amp;&amp; âíåñíåíèå äåíåã
		  CASE this.nopereation = 9  &amp;&amp; èçúÿòèå äåíåã
		ENDCASE

	WAIT WINDOW [Ïîäîæäèòå...] NOWAIT &amp;&amp; TIMEOUT .3

	*------------------------------------------------------------------------------
	LOCAL lnError
	.Shtrih.ErrorCode = IIF(VARTYPE(.Shtrih.ErrorCode)=[N],.Shtrih.ErrorCode,-1000)
	lnError = .Shtrih.ErrorCode
	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF  (VARTYPE(lnError)=[N] AND lnError # 0)   &amp;&amp;OR lnError
		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------

	SELECT lvOrderTvrView
ENDSCAN
*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.CheckDiscount(lnDiscount)
	WAIT WINDOW [Ïîäîæäèòå...] NOWAIT &amp;&amp;TIMEOUT 1
	
	*--Ïðèâÿçûâàåì äèñêîíòíóþ êàðòó ê çàêàçó
	spBindDisc(.nCheckID,VAL(lvFrmEdit.FrmNote))

	*--Äîáàâëÿåì ïîçèöèþ ñêèäêè  â ÷åê
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])
	
	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECCOUNT([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 7, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lnDiscTvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH 1, ;
		lvCheckTransEdit.CheckTransPrc		WITH lnDiscount ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------
ENDIF


*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
WAIT WINDOW [Ïîäîæäèòå...] NOWAIT &amp;&amp;TIMEOUT 1
	

*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF

*------------------------------------------------------------------------------

WAIT CLEAR

RETURN spCloseCheck(.nCheckID)

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE _storechktrans_pred
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmPayment._StoreCheckTrans_pred
* Called by.......: &lt;cmdPay.Click()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ïðåä÷åêà
*------------------------------------------------------------------------------

*15.04.2006 10:41 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcUniqueFileNM, lnDiscTvrID, lcnt
*------------------------------------------------------------------------------

*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
LOCAL lcIniFileName ,lcKkmLib
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = UPPER(ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName))) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì

WITH This
*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

IF !lcKkmLib  = [SPARK]

				*12.04.2006 15:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
				LOCAL   _PARAM
				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._HeaderPrint()
				*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
				.Shtrih.FeedDocument(2)
				.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
				.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
				.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
				.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
				.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
				.Shtrih.FeedDocument(3)
				.Shtrih.PrintString([*]+PADC([ÇÀÊÀÇ],48,[ ])+[*])
				.Shtrih.FeedDocument(3)

				*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
				lcnt = 0
				SELECT lvOrderTvrView
				GO TOP
				SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
					lcnt = lcnt+1
					*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
					.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,25)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,;
										IIF(lvOrderTvrView.TvrQnt&lt;&gt;INT(lvOrderTvrView.TvrQnt),1,0))),6)+[*];
										+PADL(ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)),8)+;
										[=]+PADL(ALLTRIM(STR(ROUND(lvOrderTvrView.TvrQnt*lvOrderTvrView.TvrPrcSale,2),99,2)),9))
				 	*------------------------------------------------------------------------------

					*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
					IF .Shtrih.ErrorCode # 0
						STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
								  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
								  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
								  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
								  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
								
						*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
						spSaleFiscError(.nCheckID)
						*------------------------------------------------------------------------------
				    RETURN .F.
					ENDIF
					*------------------------------------------------------------------------------
					SELECT lvOrderTvrView
				ENDSCAN

				.Shtrih.PrintString(REPLICATE([-],50))

				*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
				SELECT lvOrderTvrView
				LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
				IF FOUND()
					lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
					.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
				ENDIF

				*--Ïå÷àòàåì èòîã ÷åêà
				.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),44,[ ]))

				IF lcnt&lt;10
					.Shtrih.FeedDocument(10-lcnt)
					else
					.Shtrih.FeedDocument(3)
				ENDIF

				*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
				._FooterPrint()

				.Shtrih.FeedDocument(3)
				.Shtrih.CutCheck()
				*------------------------------------------------------------------------------

				*16.04.2006 10:26 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
				IF .Shtrih.ErrorCode # 0
					STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
							  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
							  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
							  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
							
					*16.04.2006 10:30 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
					spSaleFiscError(.nCheckID)
				    RETURN .F.
					*------------------------------------------------------------------------------
							
				ENDIF
				*------------------------------------------------------------------------------

	ELSE
	this.printpredtoprint()
ENDIF

*--óñòàíîâèì ïðèçíàê ïå÷àòè ïðåä÷åêà
SELECT lvOrderTvrView
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	USE IN SELECT([lvOrderTvrEdit])
	_PARAM = lvOrderTvrView.FrmPartTvrID
	USE lvOrderTvrEdit IN 0
	SELECT lvOrderTvrEdit
	REPLACE lvOrderTvrEdit.TvrAttr WITH BITSET(lvOrderTvrEdit.TvrAttr,2) IN lvOrderTvrEdit
	TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
	SELECT lvOrderTvrView
ENDSCAN
RETURN .T.
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _storechktrans_slip
*------ ÏÅÐÅÍÎÑÈÌ ------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTrans_Slim
* Called by.......: &lt;cmdPredChk.Click()&gt;
* Parameters......: tCardID
* Returns.........: &lt;none&gt;
* Notes...........: Ïå÷àòü ÑËÈÏ (ïðè îïëàòå êàðòîé)
*------------------------------------------------------------------------------
LPARAMETERS tCardID
LOCAL   lcUniqueFileNM, ;
		lnDiscTvrID, ;
		lcnt, ;
		lCardID, ;
		lCardNo, ;
		lFIO, ;
		_PARAM

*--ïîëó÷èì èíôîðìàöèþ ïî êàðòå
lCardID = tCardID
lCardNo = []

USE IN SELECT([lvCardViewByCardID])
_PARAM = lCardID
USE lvCardViewByCardID IN 0

IF RECCOUNT([lvCardViewByCardID])&gt;0
	lFIO = lvCardViewByCardID.CltNM
	lCardNo = lvCardViewByCardID.CardNo
ENDIF

*--îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

WITH This
*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
._HeaderPrint()

*--íàïå÷àòàåì äîïîëíèòåëüíóþ èíôîðìàöèþ î çàêàçå
.Shtrih.FeedDocument(2)
.Shtrih.PrintString([Äàòà ]+PADR(ALLTRIM(DTOC(DATE())),24,[ ])+[Âðåìÿ ]+PADR(ALLTRIM(TIME()),14,[ ]))
.Shtrih.PrintString(PADR(ALLTRIM(lvOUTableList.NM),29,[ ])+[Êîë-âî ãîñòåé ]+PADR(ALLTRIM(STR(lvFrmEdit.ID_)),6,[ ]))
.Shtrih.PrintString([Íîìåð çàêàçà ]+PADR(ALLTRIM(lvFrmEdit.FrmNum),36,[ ]))
.Shtrih.PrintString([Îôèöèàíò ]+PADR(ALLTRIM(spUserClt(1)),40,[ ]))
.Shtrih.PrintString([Êëèåíò ]+PADR(ALLTRIM(lvCltRSTList.NM),42,[ ]))
.Shtrih.FeedDocument(3)
.Shtrih.PrintString([*]+PADC([ÑËÈÏ],48,[ ])+[*])
.Shtrih.FeedDocument(3)

*--íàïå÷àòàåì òîâàðíûå ïîçèöèè
lcnt = 0
SELECT lvOrderTvrView
GO TOP
SCAN FOR lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID
	lcnt = lcnt+1
	*12.04.2006 17:22 -&gt;Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.PrintString(LEFT(lvOrderTvrView.TvrNM,30)+PADL(ALLTRIM(STR(lvOrderTvrView.TvrQnt,99,3)),10)+[*]+ALLTRIM(STR(lvOrderTvrView.TvrPrcSale,99,2)))
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0
		STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
				  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
				  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvCheckTransView]))) + CHR(13), [KKM.LOG], 1)
				
		*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáëòå ñ ÔÐ âîçíèêëà îøèáêà
		spSaleFiscError(.nCheckID)
		*------------------------------------------------------------------------------

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì ñêèäêó (åñëè îíà åñòü)
SELECT lvOrderTvrView
LOCATE FOR lvOrderTvrView.TvrID=lnDiscTvrID
IF FOUND()
	lnDiscount = (-1)*lvOrderTvrView.TvrPrcSale
	.Shtrih.PrintString([Ñêèäêà ]+ALLTRIM(STR(lnDiscount,99,2)))
ENDIF

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.PrintString([ÈÒÎÃÎ ]+PADL(ALLTRIM(STR(.nOrderSum,99,2)),40,[ ]))
.Shtrih.PrintString([Ñïîñîá îïëàòû – Áåçíàëè÷íûé ðàñ÷åò])
.Shtrih.PrintString([Ñòàòóñ - îäîáðåíî])
IF lcnt&lt;15
	.Shtrih.FeedDocument(12-lcnt)
ELSE
	.Shtrih.FeedDocument(3)
ENDIF

IF !EMPTY(lCardID)
	*--Ðàñïå÷àòàåì èíôîðìàöèþ ïî  VIP êàðòå
	.Shtrih.PrintString([¹ êàðòû ]+ALLTRIM(lCardNo))

	IF !EMPTY(lFIO)
		.Shtrih.PrintString(ALLTRIM(lFIO))
	ENDIF
ENDIF

.Shtrih.FeedDocument(1)
.Shtrih.PrintString([Ïîäïèñü êëèåíòà]+PADL([_______________________],35,[ ]))
.Shtrih.FeedDocument(1)
.Shtrih.FeedDocument(1)
.Shtrih.PrintString([Ïîäïèñü êàññèðà]+PADL([_______________________],35,[ ]))
.Shtrih.FeedDocument(1)
.Shtrih.PrintString(REPLICATE([=],50))
**.Shtrih.PrintString([ÎÎÎ «Ñåäüìàÿ ïîëÿíà»])
.Shtrih.FeedDocument(3)
.Shtrih.CutCheck()
*------------------------------------------------------------------------------
.Shtrih.FeedDocument(2)

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + ;
			  [Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè èòîãà ÷åêà. ] + ;
			  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
			  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + CHR(13), [KKM.LOG], 1)
			
	*--Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
	spSaleFiscError(.nCheckID)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------
.Shtrih.PrintHeader()

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _storechktransback
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: RST_V1.vcx
* Class.Module....: frmOrderEdit._StoreCheckTransBACK
* Called by.......: &lt;cmdCHKBACK.Click()&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ôèñêàëüíûé ÷åê íà âîçâðàò
*------------------------------------------------------------------------------
LPARAMETER tfsctype

LOCAL   lcUniqueFileNM, ;
		lfsctype, ;
		ls1, ;
		ls2, ;
		ls3, ;
		ls4
*------------------------------------------------------------------------------

WITH This

*--ñôîðìèðóåì âûðàæåíèå äëÿ ñóìì â çàâèñèìîñòè îò òèïà îïëàòû
lfsctype = tfsctype
ls1 = IIF(lfsctype=1,.nordersum,0) &amp;&amp;--îïëàòà íàëè÷íûìè
ls2 = IIF(lfsctype=2,.nordersum,0) &amp;&amp;--îïëàòà áàíêîâñêîé êàðòîé
ls3 = IIF(lfsctype=3,.nordersum,0) &amp;&amp;--îïëàòà êóïîíîì
ls4 = IIF(lfsctype=4,.nordersum,0) &amp;&amp;--îïëàòà VIP êàðòîé

*--Åñëè äåíü íå îòêðûò, òî îòêðîåì
IF .nSalesID = 0
	.nSalesID = spSaleOpenDay(.nCashNo)
	IF .nSalesID &lt; 0
		MESSAGEBOX([Îøèáêà îòêðûòèÿ äíÿ],16,[×åê])
		RETURN .F.
	ENDIF
ENDIF
*------------------------------------------------------------------------------


*--Åñëè ÷åê íå îòêðûò - îòêðîåì åãî
IF .nCheckID = 0
	lcUniqueFileNM = spOpenCheck(.nSalesID,2*-1,.nCashNo,spUserClt())
	
	*15.04.2006 10:51 -&gt;Ñîõðàíèì ïàðàìåòðû ÷åêà
	USE ([tmp\]+lcUniqueFileNM) IN 0 ALIAS CheckParam
	.nCheckID = CheckParam.CheckID
	*------------------------------------------------------------------------------
	
	*15.04.2006 10:51 -&gt;Óäàëèì ôàéë ñ ïàðàìåòðàìè
	USE IN SELECT([CheckParam])
	IF FILE([tmp\]+lcUniqueFileNM+[.dbf])
	   ERASE ([tmp\]+lcUniqueFileNM+[.dbf])
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------


*--Íàïå÷àòàåì çàãîëîâîê ÷åêà èç ñïåöèàëüíîãî ôàéëà
thisform._HeaderPrint()

*--Îòêðûâàåì ÄÌ äëÿ äîáàâëåíèÿ òðàíçàêöèè
*------------------------------------------------------------------------------

SELECT lvOrderTvrView
GO TOP
SCAN ALL
	USE IN SELECT([lvCheckTransEdit])
	USE lvCheckTransEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvCheckTransEdit])

	APPEND BLANK IN lvCheckTransEdit
	REPLACE ;
		lvCheckTransEdit.CheckTransID		WITH RECNO([lvOrderTvrView]), ;
		lvCheckTransEdit.CheckID 			WITH .nCheckID, ;
		lvCheckTransEdit.CheckTransTypeID	WITH 1, ;
		lvCheckTransEdit.CheckTransTvrId	WITH lvOrderTvrView.TvrID, ;
		lvCheckTransEdit.CheckTransQnt		WITH lvOrderTvrView.TvrQnt, ;
		lvCheckTransEdit.CheckTransPrc		WITH lvOrderTvrView.TvrPrcSale ;
	IN lvCheckTransEdit
	***
	TABLEUPDATE(0,.T.,[lvCheckTransEdit])
	*------------------------------------------------------------------------------

	*--Ôèêñèðóåì òðàíçàêöèþ íà ÔÐ
	.Shtrih.CheckSaleReturn(lvOrderTvrView.TvrNM,lvOrderTvrView.TvrQnt,lvOrderTvrView.TvrPrcSale)
	
	*------------------------------------------------------------------------------

	*16.04.2006 10:10 -&gt;Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
	IF .Shtrih.ErrorCode # 0

		.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
					  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
					  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + ;
					  [Ïîç.  # ] + ALLTRIM(STR(RECCOUNT([lvOrderTvrView]))) + CHR(13))
		RETURN .F.

	ENDIF
	*------------------------------------------------------------------------------
	SELECT lvOrderTvrView
ENDSCAN

*--Ïå÷àòàåì èòîã ÷åêà
.Shtrih.CloseCheck(ls1,ls2,ls3,ls4)
	

*--Çàïèøåì â Log èíôîðìàöèþ îá îøèáêå
IF .Shtrih.ErrorCode # 0

	.KKMErrorHandler([Îøèáêà ]  + PADL(ALLTRIM(STR(.Shtrih.ErrorCode)),3) + [ ïðè ïå÷àòè òðàíçàêöèè ÷åêà. ] + ;
				  [Ñìåíà # ] + ALLTRIM(STR(.nSalesID)) + [ ] + ;
				  [×åê   # ] + ALLTRIM(STR(.nCheckID)) + [ ] + CHR(13))
	RETURN .F.

ENDIF
*------------------------------------------------------------------------------

RETURN .T.

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************






ENDPROC
PROCEDURE calcbalansedel
LPARAMETERS lcCodeCard
LOCAL _PARAM,bad_edel
PUBLIC edel_ord
WAIT WINDOW 'Çàïðàøèâàåì áàëàíñ â Åäåëâåéñ ...' NOWAIT
bad_edel =.f.
USE IN SELECT('edel_tillypad_guests')
USE IN SELECT('tmp')
_PARAM = lcCodeCard    &amp;&amp;'742B4B7B'

TRY
		USE edel_tillypad_guests IN 0 ALIAS edel_tmp
	CATCH
		 WAIT CLEAR
		MESSAGEBOX('Îòñóòñòâóåò ñâÿçü ñ ñåðâåðîì Åäåëüâåéñ.'+CHR(13)+;
		  			'Îïëàòà òîëüêî çà íàëè÷íûé ðàññ÷åò.',0+64,'Áåçíàëè÷íàÿ îïëàòà íåâîçìîæíà')
		 bad_edel = .t.
	EXIT
ENDTRY

IF lcCodeCard='742B4B7B1'
bad_edel = .f.
	WITH This
		.edel_clt='Íîìåð: ÏÐÎÁÀ Ãîñòü: ÏÐÎÁÀ ÏÐÎÁÀ. äî: 12.12.2012'
		.GuestAccountID  = 0
		.ncltlimit =  150
		.nfreesumm =  .ncltlimit &amp;&amp;+ .ncltbalans
		.txtBalans.Value = .ncltbalans
		.txtLimit.Value = .ncltlimit
		.txtFree.Value = .nfreesumm
		.lbledel.Caption = .edel_clt
	ENDWITH
	RETURN
endif

IF bad_edel
	RETURN
ENDIF
IF !RECCOUNT('edel_tmp')&gt;0
USE IN SELECT('edel_tmp')
WAIT CLEAR
RETURN
ENDIF
edel_ord = edel_tmp.GuestAccountID
	WITH This
		.edel_clt='Íîìåð:'+ALLT(edel_tmp.RoomNumber)+'. Ãîñòü:'+ ALLTRIM(edel_tmp.GuestName)+'. äî:'+DTOC(edel_tmp.EndDate)
		.GuestAccountID  = edel_tmp.GuestAccountID
		.ncltlimit =  edel_tmp.y &amp;&amp;+ .ncltlimit
		.nfreesumm =  .ncltlimit &amp;&amp;+ .ncltbalans
		.txtBalans.Value = .ncltbalans
		.txtLimit.Value = .ncltlimit
		.txtFree.Value = .nfreesumm
		.lbledel.Caption = .edel_clt
	ENDWITH
USE IN SELECT('edel_tmp')
WAIT CLEAR


ENDPROC
PROCEDURE calcbalanslimitfree
*-- Îïðåäåëÿåì ëèìèò è áàëàíñ êëèåíòà
LOCAL lnConnectHandle ,lnSqlExeResult , lnCltId, pcvLOCKTIMEOUT
		lnCltId = NVL(lvFrmEdit.PointIspCltID,0)
lcIniFileName = FULLPATH([BASIS.INI])

	WITH This
		.ncltbalans = 0
		.ncltlimit =  0
		.nfreesumm =  0

		.withedel = (VAL(oRes.GetParam([BASIS],[EDELV],lcIniFileName)) &gt;0)
		IF .withedel AND TYPE('pccardcode') = 'C'
			.calcBalansEdel(ALLTRIM(pccardcode))
		ENDIF
	ENDWITH
		IF NOT VAL(oRes.GetParam([RST],[DEFCLT])) = lnCltId

		        lnConnectHandle = SQLCONNECT(pcvCONNECTIONNAME)
				lnSqlExeResult = 0
		        pcvLOCKTIMEOUT	=	[1000]
				DO WHILE (lnSqlExeResult = 0) AND (lnSqlExeResult # -1)
					lnSqlExeResult = SQLEXEC(lnConnectHandle , ;
						[SET LOCK_TIMEOUT ] + pcvLOCKTIMEOUT + [ ] + ;
						[SELECT dbo.GetBalansClt(]+ ALLTRIM(STR(lnCltId,10))+[,71]+[ ) AS  X ,dbo.GetLimitClt(]+ ALLTRIM(STR(lnCltId,10))+[) AS  Y],[tmp])
				ENDDO
				***
				IF lnSqlExeResult = -1
					spHandleODBCError()
					RETURN 0
				ENDIF


	WITH This
		.ncltbalans = .ncltbalans+tmp.x
		.ncltlimit =  .ncltlimit+tmp.y
		.nfreesumm =  .nfreesumm+.ncltlimit+.ncltbalans
*		.nfreesumm =  .nfreesumm+tmp.y+tmp.x
		.txtBalans.Value = tmp.x
		.txtLimit.Value = tmp.y
*		.txtFree.Value = tmp.y+tmp.x
		.txtFree.Value = .nfreesumm
		*.lblBalans.Caption=[Áàëàíñ:]+STR(.ncltbalans,10,4)+[ ïðè Ëèìèòå:]+STR(.ncltlimit,10,4)+ [ îñòàòîê:]+STR(.nfreesumm,10,4)+ IIF(tmp.y+tmp.x&lt;0,[],[ÏÐÅÂÛØÅÍ])
	ENDWITH
		USE IN tmp
	ELSE
	IF !This.withedel
	WITH This
		.ncltbalans = 0
		.ncltlimit =  0
		.nfreesumm =  0
		.txtBalans.Value = 0
		.txtLimit.Value = 0
		.txtFree.Value = 0
	ENDWITH
	ENDIF
ENDIF
	WITH This
		IF .nfreesumm - .nordersum =&gt;0 AND .nordersum&gt;0 AND .nopereation=1
		*--Äîáàâèì âîçìîæíîñòü âûáðàòü òèï îïëàòû VIP êàðòîé
		 .ctparam = .ctparam +[,5]
		ENDIF
		*--òèïû îïëàòû
		USE IN SELECT([lvPayTypeView])
		_PARAM = .ctparam
		USE lvPayTypeView IN 0

		SELECT lvPayTypeView

		DO CASE
			CASE [5]$ .ctparam
				.cntPayTypeID.SetValue(4)
				thisform.cntcancelsavehandled1.cmdOk.Enabled=.t.
			CASE [1]$ .ctparam
				.cntPayTypeID.SetValue(1)
			CASE [2]$ .ctparam
				.cntPayTypeID.SetValue(2)
			CASE [3]$ .ctparam
				.cntPayTypeID.SetValue(3)
				OTHERWISE
				.cntPayTypeID.enabled   = .F.
				.Cntnumericpad1.Enabled = .F.
				.Cntnumericpad1.visible = .F.
		ENDCASE
	ENDWITH


ENDPROC
PROCEDURE getcardinfo
*------------------------------------------------------------------------------
* Project.........: BASIS_RST.pjx
* Library.........: rst_v1.vcx
* Class.Module....: frmOrderEdit.GetCardInfo
* Called by.......: &lt;This.OleCommProx&gt;
* Parameters......: &lt;tccardcode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïîëó÷åíèå èíôîðìàöèè î êàðòå
*------------------------------------------------------------------------------
LPARAMETERS tccardcode
LOCAL   _PARAM,lcIniFileName
pccardcode = tccardcode
*--ïðîâåðèì, íå çàáëîêèðîâàí ëè ââîä
*!*	IF thisform.lReadOnly
*!*		MESSAGEBOX([Èçìåíåíèå äàííûõ ìåíåäæåðîì íå ïðåäóñìîòðåíî.],48,[Îêíî ñîîáùåíèé])
*!*		RETURN .F.
*!*	ENDIF

_PARAM1 = tccardcode
_PARAM2 = VAL([0x]+SUBSTR(tccardcode,4,8))

WITH This
	*--Ïîëó÷èì äàííûå î êàðòå
	USE IN SELECT([lvCardViewByCardCode])
	.cntcancelsavehandled1.cmdOk.enabled = .f.

	IF !DBUSED([BASIS])
		OPEN DATABASE BASIS SHARED
	ENDIF

	SET DATABASE TO BASIS

	USE lvCardViewByCardCode IN 0
	IF RECCOUNT([lvCardViewByCardCode])&gt;0
		*--Ïîêàæåì äàííûå ïî êàðòå
		.cntclTID.Enabled= .T.
		.cntCLTID.Visible= .T.
		.cntCltID.SetValue(lvCardViewByCardCode.CltID)
		*.txtCardNo.Value   = lvCardViewByCardCode.CardNo

		*--Ñîõðàíèì íîìåð VIP êàðòû
		SELECT lvFrmEdit
		REPLACE lvFrmEdit.PointIspCltID WITH lvCardViewByCardCode.CardOwnerID, ;
				lvFrmEdit.PointIspCltSAccID WITH lvCardViewByCardCode.CardID
		.calcbalanslimitfree()
		IF .nfreesumm - .nordersum =&gt;0 AND  .nordersum &gt; 0 AND MESSAGEBOX('Ïðîèçâåñòè îïëàòó ñ áàëàíñà?',4+48,'Îïëàòà ñ áàëàíñà')=6
			.cntcancelsavehandled1.cmdOk.Click()
		ENDIF
			ELSE
			.cntclTID.Enabled= .F.
			.cntCLTID.Visible= .F.
ENDIF
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.PJX
* Library.........: RST_V1.VCX
* Class.Module....: FRMPAYMENT.INIT
* Called by.......: &lt;Sys Event&gt;
* Parameters......: tnOrderSum - ñóììà çàêàçà
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS lnFrmId, tparam,lnOpereation, lnIdCheck
* Ïàðàìåòðû: lnFrmId - èä ôîðìû çàêàçà
* tparam - íîìåðà äîñòóïíûõ îïëàò íà ýòîì ðàáî÷åì ìåñòå
* lnOpereation - âèä îïåðàöèè ñ äåíüãàìè: 1 - ïðîäàæà; 2 - âîçâðàò; 3-ñòîðíî ÷åêà;
* 								    		4 - ïðîäàæà (ñáðîøåíûé); 5 - âîçâðàò(ñáðîøåíûé); 6-ñòîðíî ÷åêà(ñáðîøåíûé);
*									        7 - îòëîæåíûé;8 - âíåñåíèå; 9 - èçúÿòèå;
* lnIdCheck - èä ãîòîâîãî ÷åêà
*** Áûëî tnOrderSum - îïðåäåëÿåì ïî Lv
LOCAL _PARAM
LOCAL lcIniFileName ,lcKkmLib
PUBLIC pccardcode
lcIniFileName = FULLPATH([KKM.INI])
lcKkmLib = ALLTRIM(oRes.GetParam([KKM],[KKMLIB],lcIniFileName)) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì

**this.cntcancelsavehandled1.cmdOk.enabled = .f.

this.NewObject('Shtrih',lcKkmLib,'kkms.vcx')
thisform.nfrmid = lnFrmId
thisform.nchkid = lnIdCheck
thisform.nOpereation = lnOpereation
thisform.lblfrmId.Caption =ALLTRIM(STR(lnFrmId,10))
this.ctparam = tparam
DODEFAULT()
*--Ïîëó÷àåì èäåíòèôèêàòîð îòêðûòîé ñìåíû
This.nCashNo = VAL(oRes.GetParam([RST],[CASH]))
lnSalesID = spGetOpenDay(This.nCashNo)  &amp;&amp; !!!!!!!!!!!!! Ãäå åãî áðàòü??????

IF lnSalesID &lt;0
this.cntcancelsavehandled1.cmdOk.Enabled= .F.
this.txtcalcnum1.Enabled= .F.
this.txtcalcnum1.ReadOnly= .T.
ENDIF
	*--Ïðîâåðèì êîððåêòíîñòü äàííûõ î ïðîäàæàõ
	DO CASE
		CASE lnSalesID = -1
			MESSAGEBOX([Äåíü óæå çàêðûò.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[×åê íåëüçÿ íàïå÷àòàòü])
			oApp.lUserChange = .T.
			*RETURN .F.

		CASE INLIST(lnSalesID,-2,-3)
			MESSAGEBOX([Îñòàëèñü íå çàêðûòûìè áîëåå îäíîãî äíÿ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[×åê íåëüçÿ íàïå÷àòàòü])
			oApp.lUserChange = .T.
			*RETURN .F.

		CASE lnSalesID = -5
			MESSAGEBOX([Íåèçâåcòíàÿ îøèáêà],16,[×åê íåëüçÿ íàïå÷àòàòü])
			*RETURN .F.
			
		CASE lnSalesID &lt;0

			*--Åñëè ñìåíà îòêðûòà áîëåå ñóòîê, òðåáóåì çàêðûòü åå
			*IF
			*MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
			*			  [áîëåå 24 ÷àñîâ.Çàêðûòü ñìåíó?],4+32,[Ñìåíà]) = 6
			MESSAGEBOX([C ìîìåíòà íà÷àëà ïîñëåäíåé ñìåíû ïðîøëî] + CHR(13) + ;
						  [áîëåå 24 ÷àñîâ.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],64,[×åê íåëüçÿ íàïå÷àòàòü])
				***
			    *This._CloseDay()
				***
			*ENDIF
			
***			RETURN .F.
			
		OTHERWISE
			thisform.nsalesid = lnSalesID
	ENDCASE
	*------------------------------------------------------------------------------


IF This.nCashNo&lt;1
MESSAGEBOX('Ïðîâåðòå íàñòðîéêè íîìåðà êàññû CASH',0+16,'×åê íåëüçÿ íàïå÷àòàòü')
this.cntcancelsavehandled1.cmdOk.Enabled= .F.
this.txtcalcnum1.Enabled= .F.
this.txtcalcnum1.ReadOnly= .T.
ENDIF


IF this.nchkid&lt;&gt;0 AND this.nfrmid=0
	this.nCheckID = this.nchkid
	*!*	   ñîçäàåì çàêàç - äîêóìåíò ïî ÷åêó
	this.makeorderoncheck()
*!*		this.cntcancelsavehandled1.cmdCancel.Enabled= .F.
*!*		this.cntcancelsavehandled1.cmdCancel.Visible= .F.
ENDIF

*** Îïðåäåëÿåì ñóììó çàêàçà
_PARAM  = thisform.nfrmid
USE IN SELECT([lvFrmSumView])
USE lvFrmSumView IN 0
thisform.nOrderSum = lvFrmSumView.FrmSum
thisform.lblCash.caption = ALLTRIM(STR(ABS(thisform.nOrderSum) ,99,2))
*03.11.2008 12:16 -&gt;Ïîêàæåì íà äèñïëåå èòîãî ïî ÷åêó

IF VARTYPE(LnDisp)=[O]
	LnDisp.ClearText()
	LnDisp.displaytextat(0,0,[ÈÒÎÃÎ   :]+STR(thisform.nOrderSum,10,2),1)
ENDIF

USE IN lvFrmSumView
thisform.txtcalcnum1.SetFocus()

****** Îòêðûâåì ïîçèöèè çàêàçà, ñàì çàêàç
USE IN SELECT([lvOrderTvrView])
USE lvOrderTvrView IN 0
USE IN SELECT([lvFrmEdit])
USE lvFrmEdit IN 0
SELECT lvFrmEdit
IF lvFrmEdit.FrmStatusId &gt;2 AND lvFrmEdit.FrmIsPayed
*!*	   MESSAGEBOX('Îòñóòñòâóåò ôèñêàëüíûé ðåãèñòðàòîð.',0+48,'Ïðåäóïðåæäåíèå')
	  MESSAGEBOX('Ñ÷åò óæå îïëà÷åí.',0+48,'Ïðåäóïðåæäåíèå')
this.cntcancelsavehandled1.cmdOk.Enabled= .F.
this.txtcalcnum1.Enabled= .F.
this.txtcalcnum1.ReadOnly= .T.
ENDIF

	*--ïîëó÷èì òèï ïîäðàçäåëåíèÿ "ñòîë"
	lnTblType = VAL(oRes.GetParam([RST],[TBLTYPE]))

	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))

	*--Îáíîâèì ñïðàâî÷íèê ñòîëîâ
	_PARAM1 = lnTblType
	_PARAM2 = lnTblPar
USE IN SELECT([lvOUTableList])
USE lvOUTableList IN 0


*--Îòêðîåì ñïðàâî÷íèê êëèåíòîâ ðåñòîðàíà
USE IN SELECT([lvCltRSTList])
USE lvCltRSTList IN 0
*!*	SELECT lvCltRSTList
*!*	LOCATE ALL FOR lvCltRSTList.Id = lvFrmEdit.PointIspCltID

this.calcbalanslimitfree()

DO CASE
CASE this.nopereation = 1 &amp;&amp; ïðîäàæà
CASE this.nopereation = 2  &amp;&amp; Âîçâðàò
this.lbl3.Caption ='Âåðíóëè'
this.lblSum.Caption='Íàäî âåðíóòü'
this.cntcancelsavehandled1.cmdOk.Caption='Âûäàòü'
CASE this.nopereation = 8  &amp;&amp; âíåñíåíèå äåíåã
this.lbl3.Caption ='Âíåñåíî'
this.cntcancelsavehandled1.cmdOk.Caption='Ïîëó÷èòü'
CASE this.nopereation = 9  &amp;&amp; èçúÿòèå äåíåã
this.lbl3.Caption ='Èçúÿòî'
this.cntcancelsavehandled1.cmdOk.Caption='Âûäàòü'
ENDCASE
		this.cntclTID.Enabled= .F.
		this.cntCLTID.Visible= .F.

ENDPROC
PROCEDURE KeyPress
*-------------------------------------------------------
* Project.........: GLOBAL.PJX
* Library.........: BASEFORM_V1.VCX
* Class.Module....: FRMEDIT.KEYPRESS
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnKeyCode, tnShiftAltCtrl&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;sysevent&gt; Îáðàáîòêà íàæàòèÿ êëàâèø Ctrl+Enter, ESC
*-------------------------------------------------------
LPARAMETERS tnKeyCode, tnShiftAltCtrl
*21.12.2003 20:42 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	loControl
*------------------------------------------------------------------------------

*21.12.2003 20:52 -&gt;Åñëè áûëî íàæàòèå ESÑ ëèáî Ctrl+Enter
IF tnKeyCode=10 OR tnKeyCode=24 OR tnKeyCode=27
			IF tnKeyCode=10	OR tnKeyCode=24 &amp;&amp;Ctrl+Enter èëè Enter
				IF  thisform.cntcancelsavehandled1.cmdOk.Enabled
					thisform.cntcancelsavehandled1.cmdOk.Click()
				ENDIF	
			ELSE			&amp;&amp;ESC
				IF this.nchkid=0
					thisform.cntcancelsavehandled1.cmdCancel.Click()
				ENDIF
			ENDIF	
			***
			NODEFAULT
			*}
ENDIF
*------------------------------------------------------------------------------
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************	
ENDPROC
PROCEDURE kkmerrorhandler
LPARAMETERS tcErrorMsg, ;
			tlNoReset
*11.10.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnECRAdvancedMode, ;
		lnCheckID, ;
		loStatus
***
lnCheckID = This.nCheckID
*------------------------------------------------------------------------------

WITH This

*11.10.2006 16:53 -&gt;Ñîõðàíèì ñîîáùåíèå â ëîãå
IF VARTYPE(tcErrorMsg) == [C]
	STRTOFILE(TTOC(DATETIME()) + [ -&gt; ] + tcErrorMsg,[KKM.LOG],1)
ENDIF
*------------------------------------------------------------------------------

*!*	*16.10.2006 15:38 -&gt;
*!*	loStatus = oApp.CreateObject([frmKKMStatus;kkms.vcx],.Shtrih)

*!*	loStatus.Show(1)

*!*	IF loStatus.uRetVal
*!*		IF NOT tlNoReset
*!*			.CheckReset()
*!*		ELSE
		.Shtrih.CancelCheck()
*!*		ENDIF
*!*	ELSE
*!*		.Shutdown(.T.)
*!*	ENDIF
*------------------------------------------------------------------------------
*********** ÎÑÒÀÂÈÌ
*16.04.2006 10:29 -&gt;Îòìåòèì â ÷åêå, ÷òî ïðè ðàáîòå ñ ÔÐ âîçíèêëà îøèáêà
spSaleFiscError(lnCheckID)
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Load
DODEFAULT()

IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	

USE IN SELECT([lvOUCouponList])
USE lvOUCouponList IN 0

USE IN SELECT([lvOUCouponList])
USE lvOUCouponList IN 0


CREATE TABLE TMP\lvFrmTypeSaveOrdView FREE ( ID_ int, NM char(20))
INSERT INTO lvFrmTypeSaveOrdView (ID_ , NM ) VALUES (22,'Ñ÷åò Ãîñòÿ')
INSERT INTO lvFrmTypeSaveOrdView (ID_ , NM ) VALUES (17,'Çàÿâêà Ïîñòàâùèêó')
INSERT INTO lvFrmTypeSaveOrdView (ID_ , NM ) VALUES (18,'Èíâåíòàðèçà.âåäîìîñòü')

ENDPROC
PROCEDURE makeorderoncheck
LOCAL lnFrmTypeID ,lnDefClt ,lnDefEmiClt,lnTblPar ,nPayVarNum ,lnNewFrmID
	*** Äîáàâëÿåì çàêàç (øàïêó)
	*--ïîëó÷èì êîä òèïà äîêóìåíòà "çàêàç"
	lnFrmTypeID = VAL(oRes.GetParam([RST],[TYPEORD]))
	
	*--ïîëó÷èì êîä êëèåíòà ïî óìîë÷àíèþ ("ãîñòü")
	lnDefClt = VAL(oRes.GetParam([RST],[DEFCLT]))
	*lnDefClt = 1551
	*--ïîëó÷èì êîä êëèåíòà - îïåðàòîðà
	lnDefEmiClt = spUserClt()
	*--ïîëó÷èì êîä ïîäðàçäåëåíèÿ, ñîäåðæàùåãî ñòîëû
	lnTblPar = VAL(oRes.GetParam([RST],[TBLPAR]))
	*lnTblPar = 71
	USE IN SELECT([lvFrmEdit])
	USE lvFrmEdit IN 0 NODATA
	CURSORSETPROP([BUFFERING],3,[lvFrmEdit])
	SELECT lvFrmEdit
	APPEND BLANK
	*------------------------------------------------------------------------------
	REPL lvFrmEdit.PointIspCltID WITH lnDefClt, ;
		 lvFrmEdit.PointEmiCltID WITH lnDefEmiClt, ;
		 lvFrmEdit.DevCltId WITH lnDefEmiClt, ;
		 lvFrmEdit.PointEmiOUID WITH lnTblPar, ;
		 lvFrmEdit.FrmTypeID WITH lnFrmTypeID , ;
		 lvFrmEdit.FrmDate WITH DATETIME(), ;
		 lvFrmEdit.ID_ WITH 1, ;
		 lvFrmEdit.FrmCurTypeID WITH 1
	IF TABLEUPDATE(1,.T.,[lvFrmEdit])
	lnNewFrmID = spGetLastIncrementedID([lvFrmEdit])

					*** Äîáàâëÿåì ïîçèöèè
					USE IN SELECT('lvCheckTransView')
					IF FILE('TMP\lvCheckTransViewTmp.dbf')
							USE TMP\lvCheckTransViewTmp IN 0 &amp;&amp;ALIAS lvCheckTransView
							SELECT Lvchecktransviewtmp.checktrans as CheckTransUID,;
								  Lvchecktransviewtmp.checktran2 as CheckTransID, Lvchecktransviewtmp.checktran3 as CheckTransType,;
								  Lvchecktransviewtmp.checktran4 as CheckTransTypeSign, Lvchecktransviewtmp.departnm,;
								  Lvchecktransviewtmp.checktran5 as CheckTransTvrID, Lvchecktransviewtmp.tvrnm,;
								  Lvchecktransviewtmp.checktran6 as CheckTransPLU, Lvchecktransviewtmp.checktran7 as CheckTransQnt,;
								  Lvchecktransviewtmp.checktran8 as CheckTransPrc, Lvchecktransviewtmp.mark;
								 FROM lvchecktransviewtmp INTO CURSOR lvCheckTransView
							USE IN lvCheckTransViewTmp
						ELSE
							_PARAM = this.nchkid
							USE lvCheckTransView IN 0
					ENDIF
					USE IN SELECT([lvOrderTvrEdit])
					USE lvOrderTvrEdit IN 0 NODATA
					CURSORSETPROP([BUFFERING],5,[lvOrderTvrEdit])

					INSERT INTO lvOrderTvrEdit (FrmID, TvrId, MsuId, TvrQnt, TvrPrcSale) ;
					SELECT lnNewFrmID AS FrmID, CheckTransTvrID AS TvrId, 1 AS MsuId, ;
					        IIF(this.nopereation=2,-CheckTransQnt,CheckTransQnt) AS TvrQnt, ABS(CheckTransPrc) AS TvrPrcSale ;
					FROM lvCheckTransView

					IF !TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
					    MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ ïîçèöèé çàêàçà ïðîèçîøëà îøèáêà',0+16,'Ïðåäóïðåæäåíèå')
					    *RETURN .f.
					ENDIF
ELSE
	    MESSAGEBOX('Âî âðåìÿ ñîõðàíåíèÿ çàãîëîâêà çàêàçà ïðîèçîøëà îøèáêà',0+16,'Ïðåäóïðåæäåíèå')
	    *RETURN .f.
	ENDIF
	this.nfrmid= lnNewFrmID
		IF TYPE('lnNewFrmID')='N' AND lnNewFrmID&gt;0
			*nPayVarNum = ALLT(oRes.GetParam([RST],[PAYTYPE]))
			*16.09.2007 18:10 -&gt;Îïëàòà ñ÷åòà êëèåíòà
			*lRetVal = oApp.DoModalFormRetValObj([FrmPayment;rst_v1.vcx],lnNewFrmID ,nPayVarNum,1,0 )
		ENDIF

ENDPROC
PROCEDURE printcheckfr
LOCAL lnNoPredchk, ;
	  lnDiscTvrID, ;
	  lPayMode, ;
	  llRes, ;
	  lRetVal, ;
	  lCouponID, ;
	  lPANNo, ;
	  lSum, ;
	  lSumAccount, ;
	  lDiscID, ;
	  lflag, ;
	  lCouponQnt, ;
	  lCouponPrc, ;
	  _PARAM

*--  ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå îïëàòà çàêàçîâ íåäîñòóïíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*-- ïðîâåðèì, ÿâëÿåòñÿ ëè îôèöèàíò êàññèðîì
IF !thisform._iscasher()
	RETURN .F.
ENDIF
	_PARAM = this.nfrmid
	_PARAM1 = this.lndisctvrid
	REQUERY('lvOrderTvrView')
*-- îïðåäåëèì ID òîâàðà "ñêèäêà"
lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))
*-- îïëàòà çàêàçà (èçìåíèì ñòàòóñ çàêàçà, íàïå÷àòàåì ôèñêàëüíûé ÷åê)
IF RECCOUNT([lvOrderTvrView])&gt;0
	SELECT lvOrderTvrView
	COUNT FOR (!BITTEST(lvOrderTvrView.TvrAttr,2) AND lvOrderTvrView.TvrID&lt;&gt;lnDiscTvrID) TO lnNoPredchk
*thisform.printprecheck()
	IF lnNoPredchk &gt;0
		**MESSAGEBOX([Îïëàòà çàêàçà ïðîèçâîäèòñÿ òîëüêî ïîñëå ïå÷àòè ïðåä÷åêà!],48,[Îêíî ñîîáùåíèé])
		thisform.lorderpay = .F.
		IF this.nchkid=0   and !thisform.printprecheck()
		     RETURN .F.
	    ENDIF
		IF this.nchkid=0  and MESSAGEBOX([Íàïå÷àòàòü Ôèñêàëüíûé ÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
			RETURN .F.
		ENDIF
ENDIF

IF this.nchkid&lt;&gt;0   OR .t. &amp;&amp;MESSAGEBOX('Îïëàòèòü ñ÷åò, ïîäãîòîâèòü ÷åê?' ,4+48+256+4096, 'Ðàáîòà ñ äåíüãàìè', 60000)=6
		lSum = This.nOrderSum
lRetVal = this.uretval
		IF TYPE([lRetVal])==[C] &amp;&amp;
			*--òèï îïëàòû
			lPayMode = VAL(RIGHT(lRetVal,1))
			lRetVal = LEFT(lRetVal,AT([)],lRetVal))
			
			IF lPayMode = 3
				*--ïðè îïëàòå êóïîíîì ïîëó÷èì ID êóïîíà
				lCouponID = VAL(LEFT(lRetVal,AT([(],lRetVal)-1))
				lRetVal = SUBSTR(lRetVal,AT([(],lRetVal),LEN(lRetVal)-AT([(],lRetVal)+1)
				
				*--ïîëó÷èì ñóììó êóïîíà è êîëè÷åñòâî êóïîíîâ
				USE IN SELECT([lvCouponByIDView])
				_PARAM = lCouponID
				USE lvCouponByIDView IN 0
				
				IF RECCOUNT([lvCouponByIDView])&gt;0
					lCouponPrc = lvCouponByIDView.CouponPrc
				ENDIF
				
				lSum = VAL(SUBSTR(lRetVal,AT([,],lRetVal,2)+1,AT([,],lRetVal,3)-AT([,],lRetVal,2)-1))
				lCouponQnt = INT(lSum/lCouponPrc)+IIF(lSum/lCouponPrc&gt;INT(lSum/lCouponPrc),1,0)
			ENDIF	
				
			
			IF lPayMode=4 OR lPayMode=3
				*--ïå÷àòü ÑËÈÏ â ñëó÷àå îïëàòû VIP êàðòîé
				FOR i = 1 TO 2
					WAIT WINDOW [Ïîäîæäèòå. Ñëèïû ïå÷àòàþòñÿ ...] NOWAIT TIMEOUT 1
					thisform._storechktrans_slip(IIF(lPayMode=4,lvFrmEdit.PointIspOUID,0))
				ENDFOR
			ENDIF
*--ïå÷àòü ôèñêàëüíîãî ÷åêà

DO CASE
CASE this.nopereation = 1 AND lPayMode&lt; 4 &amp;&amp; ïðîäàæà

		 			IF !thisform._storechktrans(lPayMode,lRetVal) &amp;&amp;

						*--îòìåíà îïëàòû çàêàçà
						thisform.lorderpay = .F.
						RETURN .F.
					ENDIF  &amp;&amp;
CASE this.nopereation = 2  &amp;&amp; Âîçâðàò
**  IF !thisform._storechktransBACK(lPayMode)
IF !thisform._storechktrans(lPayMode,lRetVal)
						*--îòìåíà âîçâðàòà çàêàçà
						thisform.lorderpay = .F.
						RETURN .F.
ENDIF
		thisform.lOrderReturn = .T.
CASE this.nopereation = 8 &amp;&amp; âíåñíåíèå äåíåã
CASE this.nopereation = 9 &amp;&amp; èçúÿòèå äåíåã
ENDCASE

			*--äëÿ ñîõðàíåíèÿ çàêàçà ñî ñòàòóñîì "îïëà÷åí"
			thisform.lorderpay = .T.

			*--ïåðåñ÷èòàåì íàêîïèòåëüíóþ ñóììó è ñêèäêó ïî äèñêîíòíîé êàðòå (åñëè îíà áûëà)
*********** ïåðåäåëàòü íà êëèåíòà
			IF !EMPTY(lvFrmEdit.FrmNote)  &amp;&amp;
				*--îòêðîåì RV äëÿ ðåäàêòèðîâàíèÿ ñâåäåíèé ïî äàííîé êàðòå
				USE IN SELECT([lvDiscCardEdit])
				_PARAM = VAL(lvFrmEdit.FrmNote)
				USE IN SELECT([lvDiscCardEdit])
				_PARAM = VAL(lvFrmEdit.FrmNote)
				USE lvDiscCardEdit IN 0
				CURSORSETPROP([BUFFERING],3,[lvDiscCardEdit])
				
				SELECT lvDiscCardEdit
				*--ïîñ÷èòàåì ñóììó íàêîïëåíèÿ
				lSumAccount = lvDiscCardEdit.DiscCardSumAccount+ThisForm.nOrderSum
				lDiscID = lvDiscCardEdit.DiscID

				*--ïðèñâîèì äèñêîíòíîé êàðòå òèï ñêèäêè â ñîîòâåòñòâèè
				*--ñ íàêîïëåííîé ñóììîé (åñëè ðàçðåøåí ïåðåñ÷åò)
				IF EMPTY(lvDiscCardEdit.DiscCardRestrictUp) &amp;&amp;
					USE IN SELECT([lvDiscountList])
					USE lvDiscountList IN 0
					
					IF RECCOUNT([lvDiscountList])&gt;0 &amp;&amp;
						lflag = .f.
						SELECT lvDiscountList
						GO TOP
						SCAN ALL
							IF !lflag AND lSumAccount&lt;lvDiscountList.DiscRK
								SELECT lvDiscountList
								SKIP -1
								lDiscID = lvDiscountList.DiscID
								lflag = .T.
								EXIT
							ENDIF
							SELECT lvDiscountList
						ENDSCAN	
						IF !lflag &amp;&amp;
							SELECT lvDiscountList
							GO BOTTOM
							lDiscID = lvDiscountList.DiscID
						ENDIF    &amp;&amp; IF !lflag
					  ELSE &amp;&amp; IF RECCOUNT([lvDiscountList])&gt;0
						MESSAGEBOX([Íåò äàííûõ â ñïðàâî÷íèêå ñêèäîê DISCOUNT.]+CHR(13)+;
									[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],48,[Îêíî ñîîáùåíèé])						
					ENDIF  &amp;&amp; IF RECCOUNT([lvDiscountList])&gt;0
				ENDIF &amp;&amp; IF EMPTY(lvDiscCardEdit.DiscCardRestrictUp)
				*--ñîõðàíèì èçìåíåíèÿ
				SELECT lvDiscCardEdit
				REPL lvDiscCardEdit.DiscCardSumAccount WITH lSumAccount,;
					lvDiscCardEdit.DiscID WITH lDiscID
					
				IF !TABLEUPDATE(1,.T.,[lvDiscCardEdit]) &amp;&amp;
					TABLEREVERT(.T.,[lvDiscCardEdit])
					MESSAGEBOX([Îøèáêà ïðè îáíîâëåíèè íàêîïèòåëüíîé ñóììû.],48,[Îêíî ñîîáùåíèé])
				ENDIF &amp;&amp;
			ENDIF &amp;&amp; IF !EMPTY(lvFrmEdit.FrmNote)
			
		ENDIF &amp;&amp; IF TYPE([lRetVal])==[C]
	
			*--â ñëó÷àå îïëàòû êàðòî÷êîé èëè êóïîíîì ñîõðàíèì èíôîðìàöèþ î òèïå îïëàòû
			IF lPayMode&lt;&gt;1 &amp;&amp;
				DO CASE
					CASE lPayMode=2
						lPANNo = [Áàíê.êàðòà]
						
					CASE lPayMode=3
						lPANNo = ALLTRIM(STR(lCouponID))
						
					CASE lPayMode=4
						lPANNo = [Îïëà÷åíî ñ áàëàíñà êëèåíòà]
				ENDCASE
				
				IF thisform.nCheckID&lt;&gt;0
						USE IN SELECT([lvCheckPaymentEdit])
						USE lvCheckPaymentEdit IN 0
						CURSORSETPROP([BUFFERING],3,[lvCheckPaymentEdit])
					
						APPEND BLANK IN lvCheckPaymentEdit
						REPLACE ;
							lvCheckPaymentEdit.CheckPaymentTypeID WITH lPayMode, ;
							lvCheckPaymentEdit.CheckID 			  WITH thisform.nCheckID, ;
							lvCheckPaymentEdit.CheckPaymentPANNo  WITH lPANNo, ;
							lvCheckPaymentEdit.CouponID WITH IIF(lPayMode=3,lCouponID,.NULL.), ;
		                    lvCheckPaymentEdit.CheckPaymentQnt    WITH IIF(lPayMode=3,lCouponQnt,1), ;
							lvCheckPaymentEdit.CheckPaymentPrcSum WITH NTOM(lSum) ;
						IN lvCheckPaymentEdit
			 			
						llRes = TABLEUPDATE(0,.T.,[lvCheckPaymentEdit])
				ENDIF
			ENDIF &amp;&amp; IF lPayMode&lt;&gt;1
	ELSE
	    RETURN .F.
	ENDIF  &amp;&amp; IF lnNoPredchk &gt;0
	thisform._ok()
	
		*--Ñêðûâàåì ôîðìó
		*thisform.Hide()
ENDIF
RETURN this.uretval


ENDPROC
PROCEDURE printprecheck
*--ïå÷àòü ïðåä÷åêà
LOCAL lnPredchk, ;
		lmaxid, ;
		lnDiscTvrID


IF !VAL(oRes.GetParam([RST],[PRINTPRE]))&gt;0

RETURN .t.
ENDIF
*--ïðîâåðèì, äîñòóïíà ëè îïëàòà çàêàçîâ íà äàííîì ðàáî÷åì ìåñòå
IF VAL(oRes.GetParam([RST],[CMDPAY])) = 0
	MESSAGEBOX([Íà äàííîì ðàáî÷åì ìåñòå ïå÷àòü ïðåä÷åêà íåäîñòóïíà.],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

IF MESSAGEBOX([Íàïå÷àòàòü ïðåä÷åê?],36,[Îêíî ñîîáùåíèé]) = 7
	RETURN .F.
ENDIF

*--ïðîâåðêà íà íåïóñòîé çàêàç
IF RECCOUNT([lvOrderTvrView])&lt;=0
	MESSAGEBOX([Çàêàç íå ñîäåðæèò íè îäíîãî áëþäà!],48,[Îêíî ñîîáùåíèé])
	RETURN .F.
ENDIF

*--ïðîâåðêà íà íóëåâîå êîëè÷åñòâî
SELECT lvOrderTvrView
GO TOP
SCAN ALL
	IF lvOrderTvrView.TvrQnt = 0
		IF TYPE('thisform.grdOrder')=[O]
			MESSAGEBOX([Çàêàç ñîäåðæèò íóëåâîå êîëè÷åñòâî!],48,[Îêíî ñîîáùåíèé])
			thisform.grdOrder.SetFocus()
			RETURN .F.
		ENDIF
	ENDIF
	SELECT lvOrderTvrView
ENDSCAN

*--åñëè ïðåä÷åê óæå áûë íàïå÷àòàí, òî äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà íóæíà îòìåíèòü ïåðâûé ïðåä÷åê
SELECT lvOrderTvrView
COUNT FOR BITTEST(lvOrderTvrView.TvrAttr,2) TO lnPredchk

IF lnPredchk = 0
	*--ïðîèçâåäåì ïðîâåðêó ñêèäêè (ñêèäêà äîëæíà ñòîÿòü ïîñëåäíåé ïîçèöèåé â çàêàçå)
	lnDiscTvrID = VAL(oRes.GetParam([RST],[DISCTVRID]))

	CALCULATE MAX(lvOrderTvrView.FrmPartTvrID) TO lmaxid
	
	SELECT lvOrderTvrView
	LOCATE FOR lvOrderTvrView.TvrID = lnDiscTvrID
	
	IF (FOUND() AND lvOrderTvrView.FrmPartTvrID&lt;&gt;lmaxid)
		MESSAGEBOX([Íåîáõîäèìî ïåðåñ÷èòàòü ñêèäêó.],48,[Îêíî ñîîáùåíèé])
		RETURN .F.
	ENDIF	
	
	*--âûïîëíèì ïå÷àòü ïðåä÷åêà è óñòàíîâèì ïðèçíàê ïðîèçâåäåííîé ïå÷àòè ïðåä÷åêà
	RETURN thisform._storechktrans_pred()
	
*!*		*--ïîñëå ïå÷àòè ïðåä÷åêà ââîä äàííûõ áóäåò çàáëîêèðîâàí
*!*		thisform._block_in(.T.)
ELSE
	*MESSAGEBOX([Ïðåä÷åê óæå áûë íàïå÷àòàí.]+CHR(13)+;
	*			[Äëÿ ïîâòîðíîé ïå÷àòè ïðåä÷åêà îáðàòèòåñü ê ìåíåäæåðó.],64,[Îêíî ñîîáùåíèé])
	RETURN .t.
ENDIF


ENDPROC
PROCEDURE printpredtoprint
LOCAL	lcPrinter
PUBLIC pcName
pcName = spUserClt(1)

lcPrinter = ALLTRIM(oRes.GetParam([RST],[SERVPRINT],[],[DEFAULT]))

	IF lcPrinter = [DEFAULT]
				SET PRINTER TO DEFAULT
		ELSE
				SET PRINTER TO NAME ALLTRIM(lcPrinter)
	ENDIF
	PRINTJOB
	SELECT * FROM lvOrderTvrView INTO TABLE TMP\lvOrderTvrView1
	USE IN lvOrderTvrView1
	IF llDebugModeFlg
		MODIFY REPORT REPORTS\pred_print.frx
	ENDIF
	REPORT FORM REPORTS\pred_print.frx TO PRINTER &amp;&amp;PREVIEW
	ENDPRINTJOB
	USE IN SELECT('lvOrderTvrView1')
	ERASE TMP\lvOrderTvrView1.dbf
	RELEASE pcName

ENDPROC
PROCEDURE writetoedel
LPARAMETERS lcCodeCard
LOCAL _PARAM, lnDefEmiClt , lnGuest,lcEdelPodr,lcspUserClt
WAIT WINDOW 'Ðåãèñòðèðóåì ïðîäàæó â Åäåëâåéñ ...' NOWAIT
lcIniFileName = FULLPATH([BASIS.INI])
**** Íàõîäèì ïî êàðòå ïàðàìåòðû ãîñòÿ â edel
_PARAM = lcCodeCard &amp;&amp; '742B4B7B'
lcEdelPodr = ALLTRIM(oRes.GetParam([BASIS],[EDELPDR],lcIniFileName,'1')) &amp;&amp; Êëàññ ñ êàññîâûì àïïàðàòîì
lnGuest = edel_ord
	*--ïîëó÷èì êîä êëèåíòà - îïåðàòîðà
	lnDefEmiClt = spUserClt()
	lcspUserClt = spUserClt(1)
*** Îòêðûâàåì òàáëèöó äëÿ âíåñåíèÿ ïîòðà÷åíûõ äåíåã
	USE IN SELECT([edel_tillypad_import_edit])
	USE edel_tillypad_import_edit IN 0 NODATA
	*CURSORSETPROP([BUFFERING],3,[edel_tillypad_import_edit])

	APPEND BLANK IN edel_tillypad_import_edit
	REPLACE ;
		edel_tillypad_import_edit.AccountID		WITH lnGuest  , ;
		edel_tillypad_import_edit.OrderTime		WITH DATETIME(), ;
		edel_tillypad_import_edit.OrderSum		WITH thisform.nOrderSum, ;
		edel_tillypad_import_edit.Note			WITH [Id ]+ALLTRIM(lvFrmEdit.FrmNum)+;
													 [(]+ALLTRIM(STR(lvFrmEdit.FrmID,10,0))+[)]+ ;
													 [ Îôèöèàíò ]+ALLTRIM(lcspUserClt) + ;
													 [ Âðåìÿ :]+SUBSTR(TTOC(DATETIME()),11), ;
		edel_tillypad_import_edit.WaiterName		WITH ALLTRIM(lcspUserClt), ;
		edel_tillypad_import_edit.DepartCode		WITH lcEdelPodr, ;
		edel_tillypad_import_edit.ResCode		WITH 0 ;
	IN edel_tillypad_import_edit


*!*	, ;
*!*			Edel_accountcontent.OrigOrderSum		WITH lvOrderTvrView.TvrQnt, ;
*!*			Edel_accountcontent.TPadGUID		WITH lvOrderTvrView.TvrPrcSale
		
	TABLEUPDATE(1,.T.,[edel_tillypad_import_edit])
WAIT CLEAR
* thisform.nOrderSum - ñóììà ïî îïëàòå
USE IN SELECT('tmp')
USE IN SELECT('edel_tillypad_import_edit')

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>30</reserved2>
		<reserved3>nordersum
ncoupon
nnal
nsalesid Èäåíòèôôèêàòîð äîñòóïíîé äëÿ ðàáîòû ñìåíû. &gt; 0
ncashno Íîìåð ìåñòà ðåãèñòðàöèè
ncheckid Íîìåð ôèñêàëüíîãî ÷åêà â ñèñòåìå
lorderreturn Åñëè ÷åê âîçâðàòà
lorderpay Ôëàã îïëàòû çàêàçà
nopereation âèä îïåðàöèè ñ äåíüãàìè: 1 - ïðîäàæà; 2 - âîçâðàò; 3-ñòîðíî ÷åêà; 4 - ïðîäàæà (ñáðîøåíûé); 5 - âîçâðàò(ñáðîøåíûé); 6-ñòîðíî ÷åêà(ñáðîøåíûé); 7 - îòëîæåíûé;8 - âíåñåíèå; 9 - èçúÿòèå;
ncltbalans Áàëàíñ ïî êëèåíòó áåç ó÷åòà ëèìèòà
ncltlimit Ëèìèò ïî êëèåíòó
nfreesumm Ñóììà , äîñòóïíàÿ êëèåíòó
nchkid èä ÷åêà, ïîäãîòîâëåííãî ðàíåå
ctparam Ïàðàìåòð âèäîâ îïëàòû
withedel Ðàáîòàåì ñ Edelv
guestaccountid Íîìåð ëèöåâîãî ñ÷åòà ãîñòÿ â Åäåëüâåéñå
edel_clt Ñâåäåíèÿ î êëèåíòå ãîñòèííèöû
*printcheckfr Ïå÷àòü äîêóìåíòà - ïîäòâåðæäåíèÿ îïëàòû
*_storechktrans_slip ïå÷àòü ÑËÈÏÀ ïðè áåçíàëè÷íîé îïëàòå
*_headerprint Ïå÷àòü çàãîëîâêà ÷åêà èç ñïåöèàëüíîãî ôàéëà
*_storechktrans ïå÷àòü ôèñêàëüíîãî ÷åêà
*_footerprint Ïå÷àòü ïîäâàëà ÷åêà
*kkmerrorhandler çàïèñü â Log èíôîðìàöèè îá îøèáêàõ ÊÊÌ
*printprecheck Ïå÷àòü ïðåä÷åêà
*_storechktrans_pred Ïå÷àòü ïðåä÷åêà è ðåãèñòðàöèÿ ýòîãî ñîáûòèÿ
*_storechktransback ïå÷àòü ôèñêàëüíîãî ÷åêà íà âîçâðàò
*_iscasher ïðîâåðÿåì: ÿâëÿåòñÿ ëè äàííûé îôèöàíò êàññèðîì
*_ok ñîõðàíåíè èçìåíåíèé
*calcbalanslimitfree Ðàññ÷åò áàëàíñà, ëèìèòà è äîñòóïíîé ýòîìó êëèåíòó ñóììû
*getcardinfo ïîëó÷èòü èíôîðìàöèþ ïî êàðòå
*makeorderoncheck ñîçäàåì çàêàç ïî  ñóùåñòâóþùåìó ÷åêó
*printpredtoprint 
*calcbalansedel Çàïðîñ áàëàíñà èç Edelv
*writetoedel Çàïèñü äàííûõ â Edelv
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>îïëàòà çàêàçà, ëþáûì ñïîñîáî, ïå÷àòü ÷åêà, ñëèïà, îïðåäåëåíèå ñêèäêè</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB10JMQW</uniqueid>
		<timestamp>982862355</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmpayment</parent>
		<properties>Top = 0
Left = 0
Height = 432
Width = 667
BackStyle = 0
BorderWidth = 6
BorderColor = 0,0,255
ZOrderSet = 1
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WV0WZW6S</uniqueid>
		<timestamp>982862355</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp3</objname>
		<parent>frmpayment</parent>
		<properties>Top = 2
Left = 6
Height = 213
Width = 655
BackColor = 218,214,218
ZOrderSet = 2
Name = "Shp3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp2</objname>
		<parent>frmpayment</parent>
		<properties>Top = 380
Left = 6
Height = 46
Width = 655
BackColor = 218,214,218
ZOrderSet = 4
Name = "Shp2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmpayment</parent>
		<properties>Top = 385
Left = 153
Width = 360
Height = 34
TabIndex = 5
TabStop = .F.
ZOrderSet = 6
Name = "Cntcancelsavehandled1"
cmdCancel.Top = 2
cmdCancel.Left = 0
cmdCancel.Height = 34
cmdCancel.Width = 162
cmdCancel.FontBold = .T.
cmdCancel.FontSize = 12
cmdCancel.ForeColor = 0,0,255
cmdCancel.BackColor = 241,239,241
cmdCancel.DisabledForeColor = 0,0,255
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 198
cmdOk.Height = 34
cmdOk.Width = 162
cmdOk.FontBold = .T.
cmdOk.FontSize = 12
cmdOk.Caption = "Îïëàòèòü "
cmdOk.ForeColor = 0,0,255
cmdOk.BackColor = 241,239,241
cmdOk.DisabledForeColor = 0,0,255
cmdOk.DisabledBackColor = 252,242,218
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblSum</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .F.
FontSize = 24
BackStyle = 0
Caption = "Ñóììà "
Left = 28
Top = 14
TabIndex = 6
ForeColor = 0,0,255
ZOrderSet = 7
Name = "LblSum"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblCash</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .F.
FontSize = 36
Alignment = 1
BackStyle = 0
Caption = "1234567.89"
Left = 190
Top = 10
TabIndex = 7
ForeColor = 0,0,255
ZOrderSet = 8
Name = "LblCash"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UP12UGWV</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblCoupon</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontName = "Times New Roman"
FontSize = 20
BackStyle = 0
Caption = "Òàëîí"
Left = 22
Top = 349
Visible = .F.
TabIndex = 8
ForeColor = 0,0,255
ZOrderSet = 9
Name = "LblCoupon"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UP0WV2SO</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntOUID</objname>
		<parent>frmpayment</parent>
		<properties>Top = 264
Left = 21
Width = 297
Height = 43
BackStyle = 0
Enabled = .F.
Visible = .F.
TabIndex = 3
ForeColor = 228,151,22
BackColor = 252,242,218
ZOrderSet = 10
_allowresizecontent = .T.
_rsaliasname = lvOUCouponList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "CntOUID"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 256
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.DisabledForeColor = 0,0,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 256
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 296
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
USE IN SELECT([lvCouponByOUView])
_PARAM = this.value
USE lvCouponByOUView IN 0

thisform.cntCouponID.Visible = .T.
thisform.cntCouponID.Enabled = .T.
thisform.cntCouponID.SetValue(0)

thisform.SpnQntCoupon.Visible = .T.
thisform.SpnQntCoupon.Enabled = .T.
thisform.SpnQntCoupon.Value = 0

WITH thisform
	.nCoupon = 0
	.nNal = 0
	.lblCoupon.Caption = []
	.lblNal.Caption = []
	.lblCoupon.Visible = .F.
	.lblNal.Visible = .F.
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UP0WV2T4</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntCouponID</objname>
		<parent>frmpayment</parent>
		<properties>Top = 307
Left = 21
Width = 297
Height = 43
BackStyle = 0
Enabled = .F.
Visible = .F.
TabIndex = 4
ForeColor = 228,151,22
BackColor = 252,242,218
ZOrderSet = 11
_allowresizecontent = .T.
_rsaliasname = lvCouponByOUView
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "CntCouponID"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 256
txtText.ForeColor = 0,0,255
txtText.BackColor = 252,242,218
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 256
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.DisabledForeColor = 241,239,241
cmdShow.DisabledBackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 296
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
WITH thisform
	*--êîëè÷åñòâî òàëîíîâ
	thisform.SpnQntCoupon.Value = 1

	*--îïëàòà òàëîíîì
	.nCoupon = MIN((lvCouponByOUView.CouponPrc*thisform.SpnQntCoupon.Value),.nordersum)
	
	*--äîáàâëåíèå íàëè÷íûìè
	.nNal = MAX((.nordersum - .nCoupon),0)
	
	.lblCoupon.Caption = [Êóïîí  ]+ALLTRIM(STR(lvCouponByOUView.CouponPrc,99,2))
	.lblNal.Caption = [Íàëè÷íûå  ]+ALLTRIM(STR(.nNal,99,2))
	.lblCoupon.Visible = .T.
	.lblNal.Visible = .T.
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPayTypeID</objname>
		<parent>frmpayment</parent>
		<properties>Top = 218
Left = 21
Width = 297
Height = 43
BackStyle = 0
TabIndex = 2
ColorSource = 0
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 12
_allowresizecontent = .T.
_rsaliasname = lvPayTypeView
_rsfieldnametext = NM
_rsfieldnameid = ID_
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
Name = "cntPayTypeID"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 257
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.DisabledForeColor = 0,0,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 257
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.DisabledForeColor = 0,0,255
cmdShow.DisabledBackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 297
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
*!*	IF this.value = 3
*!*		*--îïëàòà êóïîíîì
*!*		thisform.cntOUID.Visible = .T.
*!*		thisform.cntOUID.Enabled = .T.
*!*	ELSE	
	thisform.cntOUID.Visible = .F.
	thisform.cntOUID.Enabled = .F.
*!*	ENDIF
	IF this.value = 1 &amp;&amp; îïëàòà íàëè÷íûìè
		thisform.cntcancelsavehandled1.cmdOk.Enabled=.f.
	ENDIF

thisform.cntCouponID.Visible = .F.
thisform.cntCouponID.Enabled = .F.

thisform.spnQntCoupon.Visible = .F.
thisform.spnQntCoupon.Enabled = .F.

WITH thisform
	.nCoupon = 0
	.nNal = 0
	.lblCoupon.Caption = []
	.lblNal.Caption = []
	.lblCoupon.Visible = .F.
	.lblNal.Visible = .F.
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UP12UGWW</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblNal</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontName = "Times New Roman"
FontSize = 20
BackStyle = 0
Caption = "Íàëè÷íûå"
Left = 359
Top = 349
Visible = .F.
TabIndex = 9
ForeColor = 0,0,255
ZOrderSet = 13
Name = "LblNal"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1US0VK8MN</uniqueid>
		<timestamp>953840433</timestamp>
		<class>spn</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>spinner</baseclass>
		<objname>SpnQntCoupon</objname>
		<parent>frmpayment</parent>
		<properties>FontSize = 20
Enabled = .F.
Height = 43
Left = 359
TabIndex = 13
Top = 307
Visible = .F.
Width = 72
BackColor = 241,239,241
ForeColor = 0,0,255
DisabledBackColor = 241,239,241
DisabledForeColor = 0,0,255
ZOrderSet = 14
Name = "SpnQntCoupon"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
WITH thisform
	*--îïëàòà òàëîíîì
	.nCoupon = MIN((lvCouponByOUView.CouponPrc*this.Value),.nordersum)
	
	*--äîáàâëåíèå íàëè÷íûìè
	.nNal = MAX((.nordersum - .nCoupon),0)
	
	.lblCoupon.Caption = [Êóïîí  ]+ALLTRIM(STR(lvCouponByOUView.CouponPrc,99,2))+[ * ]+;
						ALLTRIM(STR(this.Value))+[ = ]+ALLTRIM(STR((lvCouponByOUView.CouponPrc*this.Value)))
	.lblNal.Caption = [Íàëè÷íûå  ]+ALLTRIM(STR(.nNal,99,2))
	.lblCoupon.Visible = .T.
	.lblNal.Visible = .T.
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_29214ZD3T</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblEdel</objname>
		<parent>frmpayment</parent>
		<properties>AutoSize = .F.
FontBold = .F.
FontSize = 12
WordWrap = .F.
BackStyle = 0
Caption = " "
Height = 24
Left = 94
Top = 108
Width = 399
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 15
Name = "LblEdel"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26W0XO9S6</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl4</objname>
		<parent>frmpayment</parent>
		<properties>AutoSize = .T.
FontBold = .F.
FontSize = 12
WordWrap = .T.
BackStyle = 0
Caption = "Äîñòóïíûå ñðåäñòâà êëèåíòà:"
Height = 38
Left = 28
Top = 133
Width = 153
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 16
Name = "Lbl4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblFrmId</objname>
		<parent>frmpayment</parent>
		<properties>AutoSize = .T.
FontBold = .F.
FontSize = 12
WordWrap = .T.
BackStyle = 0
Caption = "Ëèìèò êëèåíòà:"
Height = 21
Left = 12
Top = 396
Width = 109
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 17
Name = "LblFrmId"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblBalans</objname>
		<parent>frmpayment</parent>
		<properties>AutoSize = .T.
FontBold = .F.
FontSize = 12
WordWrap = .T.
BackStyle = 0
Caption = "Áàëàíñ êëèåíòà:"
Enabled = .F.
Height = 21
Left = 28
Top = 97
Visible = .F.
Width = 117
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 18
Name = "LblBalans"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .F.
FontSize = 24
BackStyle = 0
Caption = "Ñäà÷à"
Left = 28
Top = 177
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 19
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WV0WAZZD</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl3</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .F.
FontSize = 24
BackStyle = 0
Caption = "Ïîëó÷åíî"
Left = 28
Top = 62
TabIndex = 11
ForeColor = 0,0,255
ZOrderSet = 20
Name = "Lbl3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WV0WFMZ2</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntnumericpad</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntnumericpad1</objname>
		<parent>frmpayment</parent>
		<properties>Top = 12
Left = 493
TabIndex = 14
ZOrderSet = 21
Name = "Cntnumericpad1"
ImgButton0.Name = "ImgButton0"
ImgButtonPoint.Height = 50
ImgButtonPoint.Width = 50
ImgButtonPoint.Name = "ImgButtonPoint"
ImgButton1.Height = 50
ImgButton1.Width = 50
ImgButton1.Name = "ImgButton1"
ImgButton2.Height = 50
ImgButton2.Width = 50
ImgButton2.Name = "ImgButton2"
ImgButton3.Height = 50
ImgButton3.Width = 50
ImgButton3.Name = "ImgButton3"
ImgButton4.Height = 50
ImgButton4.Width = 50
ImgButton4.Name = "ImgButton4"
ImgButton5.Height = 50
ImgButton5.Width = 50
ImgButton5.Name = "ImgButton5"
ImgButton6.Height = 50
ImgButton6.Width = 50
ImgButton6.Name = "ImgButton6"
ImgButton7.Height = 50
ImgButton7.Width = 50
ImgButton7.Name = "ImgButton7"
ImgButton8.Height = 50
ImgButton8.Width = 50
ImgButton8.Name = "ImgButton8"
ImgButton9.Height = 50
ImgButton9.Width = 50
ImgButton9.Name = "ImgButton9"
ImgbuttonDelete.Height = 50
ImgbuttonDelete.Width = 50
ImgbuttonDelete.Name = "ImgbuttonDelete"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntFrmTypeID</objname>
		<parent>frmpayment</parent>
		<properties>Top = 218
Left = 353
Width = 297
Height = 43
BackStyle = 0
TabIndex = 2
ColorSource = 0
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 22
_allowresizecontent = .T.
_rsaliasname = lvFrmTypeSaveOrdView
_rsfieldnametext = NM
_rsfieldnameid = ID_
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
value = 22
Name = "CntFrmTypeID"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 42
txtText.Left = 0
txtText.Top = 0
txtText.Width = 257
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.DisabledForeColor = 0,0,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 257
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.BackColor = 241,239,241
cmdShow.DisabledForeColor = 0,0,255
cmdShow.DisabledBackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 297
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF this.value = 3
	*--îïëàòà êóïîíîì
	thisform.cntOUID.Visible = .T.
	thisform.cntOUID.Enabled = .T.
ELSE	
	thisform.cntOUID.Visible = .F.
	thisform.cntOUID.Enabled = .F.
ENDIF

thisform.cntCouponID.Visible = .F.
thisform.cntCouponID.Enabled = .F.

thisform.spnQntCoupon.Visible = .F.
thisform.spnQntCoupon.Enabled = .F.

WITH thisform
	.nCoupon = 0
	.nNal = 0
	.lblCoupon.Caption = []
	.lblNal.Caption = []
	.lblCoupon.Visible = .F.
	.lblNal.Visible = .F.
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WV0WFN2K</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>LblChange</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .F.
FontSize = 36
Alignment = 1
BackStyle = 0
Caption = "0.00"
Height = 59
Left = 360
Top = 167
Width = 96
TabIndex = 12
ForeColor = 0,0,255
ZOrderSet = 23
Name = "LblChange"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2700OB70E</uniqueid>
		<timestamp>982862355</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl5</objname>
		<parent>frmpayment</parent>
		<properties>AutoSize = .T.
FontBold = .F.
FontSize = 12
WordWrap = .T.
BackStyle = 0
Caption = "Ëèìèò êëèåíòà:"
Enabled = .F.
Height = 21
Left = 28
Top = 122
Visible = .F.
Width = 109
TabIndex = 10
ForeColor = 0,0,255
ZOrderSet = 24
Name = "Lbl5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28T0P51OK</uniqueid>
		<timestamp>982862355</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntCltId</objname>
		<parent>frmpayment</parent>
		<properties>Top = 100
Left = 25
Width = 464
Height = 34
BackStyle = 0
TabIndex = 2
ColorSource = 0
ForeColor = 0,0,255
BackColor = 241,239,241
ZOrderSet = 25
_allowresizecontent = .T.
_rsaliasname = lvCltRSTList
_rsfieldnametext = NM
_rsfieldnameid = ID
_controlsourcetype = 0
_selectobject = frmidctlgridintop;rst_v1.vcx
value = 22
_controlsource = lvFrmEdit.PointIspCltID
_showtextnotfound = ... çà íàëè÷íûå
Name = "CntCltId"
txtText.FontSize = 16
txtText.BackStyle = 0
txtText.Height = 33
txtText.Left = 0
txtText.Top = 2
txtText.Width = 463
txtText.ForeColor = 0,0,255
txtText.BackColor = 241,239,241
txtText.DisabledBackColor = 241,239,241
txtText.SelectedForeColor = 128,128,255
txtText.DisabledForeColor = 0,0,255
txtText.SelectedBackColor = 252,242,218
txtText._highlightself = .F.
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 257
cmdShow.Height = 42
cmdShow.Width = 42
cmdShow.Enabled = .F.
cmdShow.Visible = .F.
cmdShow.BackColor = 241,239,241
cmdShow.DisabledForeColor = 0,0,255
cmdShow.DisabledBackColor = 241,239,241
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 297
cmdClear.Height = 42
cmdClear.Width = 23
cmdClear.Enabled = .F.
cmdClear.Visible = .F.
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>953840434</timestamp>
		<class>txtcalcnum</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtcalcnum1</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontSize = 14
Height = 29
Left = 202
MaxLength = 12
Top = 64
Width = 239
ForeColor = 0,0,255
BackColor = 218,214,218
SelectedForeColor = 255,128,64
SelectedBackColor = 239,228,250
ZOrderSet = 27
_highlightself = .F.
Name = "Txtcalcnum1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF this.Value&gt;=ABS(thisform.nOrderSum)
	**thisform.lblChange.Caption = ALLTRIM(STR((this.Value-thisform.nOrderSum*2+thisform.ncltbalans+thisform.ncltlimit),99,2))
	thisform.lblChange.Caption = ALLTRIM(STR((this.Value-ABS(thisform.nOrderSum)),99,2))
	thisform.cntcancelsavehandled1.cmdOk.Enabled=.t.
ELSE
	thisform.lblChange.Caption = [0.00]
	thisform.cntcancelsavehandled1.cmdOk.Enabled=.f.
ENDIF
thisform.txtFree.Value = ALLTRIM(STR((this.Value+thisform.ncltbalans+thisform.ncltlimit),99,2))

ENDPROC
PROCEDURE KeyPress
LPARAMETERS	tnKeyCode, tnShiftAltCtrl
		LOCAL _PARAM,lcPOSFuncMsg
		IF NOT USED('lvPOSKeyMap')
				*19.05.2008 18:20 -&gt;Çàãðóçèì ðàñêëàäêó êëàâèàòóðû
				LOCAL _PARAM
				***
				_PARAM = VAL(oRes.GetParam([SET],[KEYBOARD]))
				SET DATABASE TO BASIS
				USE lvPOSKeyMap IN 0
		ENDIF
		SELECT lvPOSKeyMap
		LOCATE FOR PosKeyCode = tnKeyCode
				lcPOSFuncMsg	 = ALLTRIM(lvPOSKeyMap.POSFuncMsg)
				lcPOSEnabledMode = ICASE(EMPTY(lvPOSKeyMap.POSEnabledMode),[0],ISNULL(lvPOSKeyMap.POSEnabledMode),[0],ALLTRIM(lvPOSKeyMap.POSEnabledMode))
				*------------------------------------------------------------------------------
		IF FOUND() AND INLIST(lcPOSFuncMsg,[CLEAR],[ESC],[ERROR])  &amp;&amp;,[ONEUP],[ONEDOWN])
				*22.04.2006 12:32 -&gt;Åñëè ñêèäêà ïðåäîñòàâëåíà, òî ÷åê ìîæíî ëèáî çàâåðøèòü, ëèáî ñáðîñèòü
				DO CASE
					CASE  INLIST(lcPOSFuncMsg,[CLEAR],[ESC],[ERROR])
						  thisform.cntcancelsavehandled1.cmdCancel.Click()
					CASE  lcPOSFuncMsg = [SELECT]
						  KEYBOARD '{ENTER}'
					CASE  lcPOSFuncMsg = [ONEUP]
						  KEYBOARD '{UPARROW}'
					CASE  lcPOSFuncMsg = [ONEDOWN]
						  KEYBOARD '{DNARROW}'
				ENDCASE
			 	RETURN
		ENDIF

		*04.05.2006 13:44 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
		DODEFAULT(tnKeyCode, tnShiftAltCtrl)
		*------------------------------------------------------------------------------

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26W0XO9S7</uniqueid>
		<timestamp>953840434</timestamp>
		<class>txtcalcnum</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtBalans</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontSize = 11
Value = (thisform.ncltbalans)
Enabled = .F.
Height = 25
Left = 202
MaxLength = 12
Top = 93
Visible = .F.
Width = 239
ForeColor = 0,0,255
BackColor = 218,214,218
SelectedForeColor = 255,128,64
SelectedBackColor = 239,228,250
ZOrderSet = 28
_highlightself = .F.
Name = "TxtBalans"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26W0XO9S9</uniqueid>
		<timestamp>953840434</timestamp>
		<class>txtcalcnum</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtLimit</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontSize = 11
Value = (thisform.ncltlimit)
Enabled = .F.
Height = 25
Left = 202
MaxLength = 12
Top = 118
Visible = .F.
Width = 239
ForeColor = 0,0,255
BackColor = 218,214,218
SelectedForeColor = 255,128,64
SelectedBackColor = 239,228,250
ZOrderSet = 29
_highlightself = .F.
Name = "TxtLimit"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_26W0XO9SA</uniqueid>
		<timestamp>953840434</timestamp>
		<class>txtcalcnum</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtFree</objname>
		<parent>frmpayment</parent>
		<properties>FontBold = .T.
FontSize = 14
Value = (thisform.nfreesumm)
Height = 33
Left = 202
MaxLength = 12
ReadOnly = .T.
Top = 137
Width = 239
ForeColor = 0,0,255
BackColor = 218,214,218
SelectedForeColor = 255,128,64
SelectedBackColor = 239,228,250
ZOrderSet = 30
_highlightself = .F.
Name = "TxtFree"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2700ZNVFU</uniqueid>
		<timestamp>982862355</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmpayment</parent>
		<properties>Top = 294
Left = 540
Height = 48
Width = 58
ZOrderSet = 31
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------
WITH This
	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	IF EMPTY(lcMsg)
		RETURN
	ENDIF
	*------------------------------------------------------------------------------
	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANA8g5QvwskBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\MSCOMM32.OCX
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_29F0VSXC0</uniqueid>
		<timestamp>953840434</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>frmpayment</parent>
		<properties>Top = 324
Left = 684
Height = 84
Width = 72
Enabled = .F.
ZOrderSet = 32
Name = "Cmd1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
thisform.getcardinfo('742B4B7B1')
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmpayment</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
Arial, 0, 16, 9, 25, 19, 56, 5, 1
Arial, 0, 20, 12, 33, 26, 72, 6, 1
Arial, 1, 14, 9, 23, 18, 50, 4, 1
Arial, 1, 11, 7, 18, 14, 39, 4, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2CK18FOY9</uniqueid>
		<timestamp>982862434</timestamp>
		<class>container</class>
		<classloc/>
		<baseclass>container</baseclass>
		<objname>cntorddetail</objname>
		<parent/>
		<properties>Width = 192
Height = 468
Name = "cntorddetail"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>19</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ald Ðàçâåðíóòà èíô î çàêàçå  ñ èçì êîëè÷åñòâà è ñêèäêàìè</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951877050</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGstPlus</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 0
Left = 0
Height = 52
Width = 64
Caption = ""
Enabled = .F.
Visible = .F.
Name = "CmdGstPlus"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RZ0ZZVSE</uniqueid>
		<timestamp>951877050</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>CmdGstMinus</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 0
Left = 129
Height = 52
Width = 64
Caption = ""
Enabled = .F.
Visible = .F.
Name = "CmdGstMinus"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SA0UTS7Y</uniqueid>
		<timestamp>951881574</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd21</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 364
Left = 96
Height = 52
Width = 96
FontBold = .T.
Caption = "Ñêèäêà íà çàêàç"
Name = "Cmd21"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>951874780</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd22</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 416
Left = 96
Height = 52
Width = 48
Picture = ..\graphic\arrow_up_.gif
DownPicture = ..\graphic\arrow_up_pr.gif
Name = "Cmd22"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1WW0QWPEA</uniqueid>
		<timestamp>951874780</timestamp>
		<class>cmd</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd23</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 416
Left = 144
Height = 52
Width = 48
Picture = ..\graphic\arrow_down_.gif
DownPicture = ..\graphic\arrow_down_pr.gif
Themes = .F.
Name = "Cmd23"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1RY0N4UD0</uniqueid>
		<timestamp>951874780</timestamp>
		<class>cnttxtinfo</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntSubTotal</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 364
Left = 0
Name = "CntSubTotal"
lblname.Name = "lblname"
LblSumm.Name = "LblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0TI3HU</uniqueid>
		<timestamp>951874780</timestamp>
		<class>cnttxtinfo</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntDisc</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 398
Left = 0
Name = "CntDisc"
lblname.Name = "lblname"
LblSumm.Name = "LblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0TI3HY</uniqueid>
		<timestamp>951874780</timestamp>
		<class>cnttxtinfo</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntTotal</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 432
Left = 0
Name = "CntTotal"
lblname.Name = "lblname"
LblSumm.Name = "LblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39KN</uniqueid>
		<timestamp>982862434</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>GrdOrder</objname>
		<parent>cntorddetail</parent>
		<properties>ColumnCount = 4
FontSize = 8
Anchor = 0
HeaderHeight = 15
Height = 312
Highlight = .T.
Left = 0
Panel = 1
PanelLink = .F.
ReadOnly = .F.
RecordMark = .F.
RecordSource = "lvOrderTvrView"
RowHeight = 17
ScrollBars = 0
Top = 51
Width = 192
ForeColor = 0,0,160
GridLineColor = 0,0,160
ZOrderSet = 15
AllowAutoColumnFit = 2
_activerowhighlight = .T.
_activerowhighlightcoloractive = RGB(239,228,250)
_activerowhighlightcolorunactive = RGB(255,255,255)
Name = "GrdOrder"
Column1.FontSize = 8
Column1.ColumnOrder = 1
Column1.ControlSource = "lvOrderTvrView.TvrNM"
Column1.Width = 98
Column1.ReadOnly = .T.
Column1.ForeColor = 0,0,160
Column1.Name = "Column2"
Column2.FontBold = .T.
Column2.FontSize = 8
Column2.ColumnOrder = 2
Column2.ControlSource = "lvOrderTvrView.TvrQnt"
Column2.Width = 32
Column2.ReadOnly = .F.
Column2.Sparse = .F.
Column2.ForeColor = 0,0,160
Column2.Name = "Column3"
Column3.FontSize = 8
Column3.ColumnOrder = 4
Column3.ControlSource = "lvOrderTvrView.TvrPrcSale"
Column3.Width = 20
Column3.ReadOnly = .T.
Column3.Format = "R"
Column3.InputMask = "999999.99"
Column3.ForeColor = 0,0,160
Column3.Name = "Column4"
Column4.FontSize = 8
Column4.ColumnOrder = 3
Column4.ControlSource = "lvOrderTvrView.TvrSum"
Column4.Width = 58
Column4.ReadOnly = .T.
Column4.Format = "R"
Column4.InputMask = "999999.99"
Column4.ForeColor = 0,0,160
Column4.Name = "Column5"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._Add
* Called by.......: &lt;&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå áëþäà â çàêàç
*-------------------------------------------------------
LPARAMETERS tnTvrID, tnPrice
*09.08.2005 16:46 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luAddRes, ;
		laAddRec[1], ;
		_PARAM, ;
		lnMsuID, ;
		lnPrice, ;
		lnRes, ;
		lCountScroll
*------------------------------------------------------------------------------

*09.08.2005 16:47 -&gt; Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([tnTvrID])==[N] AND !EMPTY(tnTvrID)
	
	WITH This
			*09.08.2005 16:47 -&gt; Çàáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .T.
		*------------------------------------------------------------------------------
		
		*--íàéäåì öåíó áëþäà
		IF INLIST(TYPE([tnPrice]),[N],[Y])
			lnPrice = tnPrice
		ELSE

			*11.04.2006 12:02 -&gt;Ïîëó÷èì èíôîðìàöèþ î öåíå íà òîâàð
			USE IN SELECT([lvPriceTvr])
			***

			*05.05.2006 09:41 -&gt;Ïîëó÷èì öåíó ïî ïðàéñó
			_PARAM1 = tnTvrID
			_PARAM2 = ThisForm.nPrcTypeID
			USE lvPriceTvr IN 0
			***

			*05.05.2006 09:41 -&gt;Åñëè öåíà íóëåâàÿ - ïîëó÷èì öåíó èç ïðàéñà ïî óìîë÷àíèþ
			IF lvPriceTvr.Price = 0
				USE IN SELECT([lvPriceTvrDef])
				***
				
				_PARAM = tnTvrID
				USE lvPriceTvrDef IN 0
				lnPrice = lvPriceTvrDef.Price	
				
			ELSE
				lnPrice = lvPriceTvr.Price
			ENDIF
			*------------------------------------------------------------------------------

		ENDIF
		
		*--Ïîëó÷èì èíôîðìàöèþ î åäåíèöàõ èçìåðåíèÿ
		USE IN SELECT([lvMsuIDByTvr])
		***
		_PARAM = tnTvrID
		USE lvMsuIDByTvr IN 0
		***
		IF RECCOUNT([lvMsuIDByTvr])&gt;0 AND !EMPTY(lvMsuIDByTvr.MsuID) AND !ISNULL(lvMsuIDByTvr.MsuID)
			lnMsuID = lvMsuIDByTvr.MsuID
		ELSE
			lnMsuID = 1
		ENDIF
		
		***
		USE IN SELECT([lvMsuIDByTvr])
		*-------------------------------------------------------------------------------

		*--Äîáàâèì ïîçèöèþ
		USE IN SELECT([lvOrderTvrEdit])
		USE lvOrderTvrEdit IN 0 NODATA
		APPEND BLANK IN lvOrderTvrEdit
		REPLACE ;
			FrmID WITH ThisForm.nFrmID, ;
			TvrId WITH tnTvrID, ;
			MsuId WITH lnMsuID, ;
			TvrQnt WITH 1, ;
			TvrPrcSale WITH lnPrice ;
		IN lvOrderTvrEdit
		llResult = TABLEUPDATE(1,.T.,[lvOrderTvrEdit])
		*------------------------------------------------------------------------------
		
		IF llResult
			This._RSRequeryOne(spGetLastIncrementedID([lvOrderTvrEdit]),[ADD])
		ENDIF
		*-------------------------------------------------------------------------------


		*09.08.2005 16:48 -&gt; Ðàçáëîêèðóåì îáíîâëåíèå RunTime ñâîéñòâ Grid-à
		.lNoExtendedRefresh = .F.
		*------------------------------------------------------------------------------
			
		*09.08.2005 16:48 -&gt; Âûçîâåì ìåòîä ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
		.Refresh(.T.)
		*------------------------------------------------------------------------------
		
		*--ïîêàæåì çàêàç â ñåòêå êðàñèâî è óäîáíî
		lCountScroll = MIN(6,RECCOUNT([lvOrderTvrView]))-1
		
		FOR i= 1 TO lCountScroll
			.DoScroll(0)
		ENDFOR
		
		.SetFocus()
		
	ENDWITH
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _refreshrelatedobjects
*--ïîêàæåì îáíîâëåííóþ ñóììó çàêàçà íà ôîðìå
LOCAL lcTableNM
USE IN SELECT([lvFrmSumView])
_PARAM = thisform.nFrmID
USE lvFrmSumView IN 0

*--ñîõðàíèì èòîã ïî çàêàçó
ThisForm.nOrderSum = lvFrmSumView.FrmSum
*-------------------------------------------------------------------------------
	IF RECCOUNT([lvOrgUnitEdit])&gt;0
		lcTableNM = lvOrgUnitEdit.OUNM
	ELSE
		lcTableNM = []
	ENDIF

*thisform.lblSum.caption = [Ñóììà ]+ALLTRIM(STR(lvFrmSumView.FrmSum,99,2))
	thisform.lblEdit.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)+ [     íà ñóììó: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
	thisform.Caption = [           Çàêàç ¹ ]+ALLTRIM(SUBSTR(lcTableNM,AT([¹],lcTableNM)+1,LEN(lcTableNM)-AT([¹],lcTableNM)))+[.]+ALLTRIM(lvFrmEdit.FrmNum)+ [     íà ñóììó: ]+ALLTRIM(STR(lvFrmSumView.FrmSum,15,2))
USE IN SELECT([lvFrmSumView])
ENDPROC
PROCEDURE _rsrequery
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: rst_v1.vcx
* Class.Module....: grdOrder._RSRequery
* Called by.......: &lt;&gt;
* Parameters......:
* Returns.........: &lt;none&gt;
* Notes...........: Ïåðå÷èòûâàíèå Alias-à Grid-à
*-------------------------------------------------------
*11.01.2004 17:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM	
*------------------------------------------------------------------------------

WITH This

*11.01.2004 17:44 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Ïåðå÷èòàåì Local View
_PARAM = thisform.nFrmID
REQUERY([lvOrderTvrView])
*------------------------------------------------------------------------------

*11.01.2004 17:46 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequeryone
LPARAMETERS tnFrmPartTvrID, tcMode

*17.01.2005 15:30 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL 	lcOldAlias, ;
		lnId, ;
		laReplaceArray[1]
***
PRIVATE	_PARAM
***
lcOldAlias = ALIAS()
lnId = tnFrmPartTvrID
laReplaceArray = .NULL.
*------------------------------------------------------------------------------

*12.05.2004 03:35 -&gt;Îòêëþ÷àåì èñòî÷íèê äàííûõ
This.SourceKeep()
This.SourceReset()
*------------------------------------------------------------------------------

* Â çàâèñèìîñòè îò ðåæèìà âûïîëíèì äåéñòâèÿ
DO CASE
	CASE UPPER(tcMode) == [DELETE]

		*22.12.2004 15:11 -&gt;Óäàëÿåì çàïèñü
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnId
		IF FOUND()
			DELETE IN lvOrderTvrView
			IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
				TABLEUPDATE(.T.)
			ENDIF
		ENDIF
		*------------------------------------------------------------------------------

		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

	CASE UPPER(tcMode) == [ADD] OR UPPER(tcMode) == [EDIT]
	
		*--Ïîëó÷èì äàííûå î äîáàâëåííîé çàïèñè
		IF USED([lvOrderTvrViewRepl])
			USE IN lvOrderTvrViewRepl
		ENDIF
		_PARAM = lnId
		USE lvOrderTvrViewRepl IN 0
		*------------------------------------------------------------------------------

		*17.01.2005 15:34 -&gt; Îáíîâèì äàííûå â lvOrderTvrView
		SELECT lvOrderTvrViewRepl
		SCATTER TO laReplaceArray
		SELECT lvOrderTvrView
		IF UPPER(tcMode) == [ADD]
			APPEND BLANK
		ENDIF
		GATHER FROM laReplaceArray
		IF CURSORGETPROP([Buffering],[lvOrderTvrView])#1
			TABLEUPDATE(.T.)
		ENDIF
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:35 -&gt; Çàêðîåì Alis
		USE IN lvOrderTvrViewRepl
		*------------------------------------------------------------------------------
			
		*17.01.2005 15:33 -&gt; Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
		SELECT lvOrderTvrView
		LOCATE FOR lvOrderTvrView.FrmPartTvrID = lnID
		*------------------------------------------------------------------------------

ENDCASE
*-------------------------------------------------------------------------------

*12.05.2004 03:37 -&gt;Âîññòàíàâëèâàåì èñòî÷íèê äàííûõ
This.SourceRecall()
*------------------------------------------------------------------------------

*22.12.2004 15:35 -&gt;Âîññòàíîâèì òåêóùèé Alias
IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
	SELECT(lcOldAlias)
ENDIF
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
DODEFAULT()

this.column1.DynamicBackColor = [IIF(BITTEST(lvOrderTvrView.TvrAttr,0),RGB(252,174,12),IIF(BITTEST(lvOrderTvrView.TvrAttr,1),RGB(252,242,218),]+this.column1.DynamicBackColor+[))]
								

ENDPROC
PROCEDURE Valid
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
PROCEDURE When
DODEFAULT()
this.AllowCellSelection =.t.	


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39KY</uniqueid>
		<timestamp>951873652</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>cntorddetail.GrdOrder.Column2</parent>
		<properties>FontSize = 8
Caption = "Íàçâàíèå"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39KZ</uniqueid>
		<timestamp>951873652</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>cntorddetail.GrdOrder.Column2</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39L2</uniqueid>
		<timestamp>951873652</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>cntorddetail.GrdOrder.Column3</parent>
		<properties>FontSize = 8
Caption = "Êîëè÷åñòâî"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39L3</uniqueid>
		<timestamp>951873652</timestamp>
		<class>txtcalctype</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt1</objname>
		<parent>cntorddetail.GrdOrder.Column3</parent>
		<properties>FontBold = .T.
FontSize = 8
Format = "R"
InputMask = "999999.99"
Left = 22
ReadOnly = .F.
Top = 10
ForeColor = 0,0,160
_highlightself = .F.
Name = "Txt1"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
USE IN SELECT([lvOrderTvrEdit])
_PARAM = lvOrderTvrView.FrmPartTvrID
USE lvOrderTvrEdit IN 0

REPLACE lvOrderTvrEdit.TvrQnt WITH this.value IN lvOrderTvrEdit
TABLEUPDATE(1,.T.,[lvOrderTvrEdit])

REPLACE lvOrderTvrView.TvrSum WITH ROUND(lvOrderTvrView.TvrPrcSale*this.value,2)
ThisForm.grdOrder._RefreshRelatedObjects()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39XF</uniqueid>
		<timestamp>951873652</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>cntorddetail.GrdOrder.Column4</parent>
		<properties>FontSize = 8
Caption = "Öåíà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39XJ</uniqueid>
		<timestamp>951873652</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>cntorddetail.GrdOrder.Column4</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
thisform._qntintable = .T.
DODEFAULT()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39XK</uniqueid>
		<timestamp>951873652</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>cntorddetail.GrdOrder.Column5</parent>
		<properties>FontSize = 8
Caption = "Ñóììà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0U39XN</uniqueid>
		<timestamp>951873652</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>cntorddetail.GrdOrder.Column5</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,160
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2DP0VE8IJ</uniqueid>
		<timestamp>951877050</timestamp>
		<class>cnttxtinfo</class>
		<classloc>rst_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntGuest</objname>
		<parent>cntorddetail</parent>
		<properties>Top = 0
Left = 63
Width = 65
Height = 52
Name = "CntGuest"
lblname.Name = "lblname"
LblSumm.Name = "LblSumm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntorddetail</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 0, 8, 5, 14, 11, 29, 3, 0
Arial, 1, 8, 5, 14, 11, 29, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
