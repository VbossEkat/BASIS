<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0MXLOO</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntactcard</objname>
		<parent/>
		<properties>Width = 250
Height = 45
BorderWidth = 0
Name = "cntactcard"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0MZO15</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblActCard</objname>
		<parent>cntactcard</parent>
		<properties>FontBold = .T.
Caption = "Àêòèâèðîâàíà"
Left = 83
Top = 1
Name = "lblActCard"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0N595D</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtActDate</objname>
		<parent>cntactcard</parent>
		<properties>Alignment = 2
ControlSource = "lvCardRepl.CardActivationDate"
Enabled = .F.
Height = 23
Left = 0
Top = 18
Width = 250
DisabledForeColor = 0,0,0
NullDisplay = " "
Name = "txtActDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntactcard</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN0S4O5I</uniqueid>
		<timestamp>0</timestamp>
		<class>cntauth</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntauthadmin</objname>
		<parent/>
		<properties>Name = "cntauthadmin"
olecommprox.Top = 1
olecommprox.Left = 1
olecommprox.Height = 38
olecommprox.Width = 39
olecommprox.Name = "olecommprox"
txtCode.Name = "txtCode"
</properties>
		<protected/>
		<methods>PROCEDURE authresult
LPARAMETERS tnAuthResult, ;
			tcCardCode

*16.07.2006 13:37 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - c÷èòàíà êàðòà ñ êîäîì ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud_admin.log],1)
*------------------------------------------------------------------------------

*16.07.2006 13:28 -&gt;Åñëè ðàáîòàòü ñ êàðòîé ìîæíî...
IF tnAuthResult = 0

	*16.07.2006 13:33 -&gt;è îíà íå ïðîñðî÷åíà...
	IF TTOC(lvSearchCard.CardExpiredDate,1) &gt;= TTOC(DATETIME(),1)

		*16.07.2006 13:37 -&gt;Ñîõðàíèì â ëîã ñîáûòèå çàïóñêà îêíà ðåãèñòðàöèè
		STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - êàðòà ñ êîäîì ]+tcCardCode+[ - ðåãèñòðàöèÿ]+CHR(13),This.cLogFileDir+[Scud_admin.log],1)
		*------------------------------------------------------------------------------

		*16.07.2006 13:28 -&gt;...çàïóñêàåì ôîðìó äëÿ ðàáîòû ñ êàðòîé
		oApp.DoFormObj(lvSearchCard.WPODNM,lvSearchCard.CardID)
		*------------------------------------------------------------------------------

	ELSE

		*16.07.2006 13:40 -&gt;Ñîõðàíèì â ëîã èíôîðìàöèþ î òîì, ÷òî êàðòà ïðîñðî÷åíà
		STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - êàðòà ñ êîäîì ]+tcCardCode+[ - ïðîñðî÷åíà]+CHR(13),This.cLogFileDir+[Scud_admin.log],1)
		*------------------------------------------------------------------------------

		*16.07.2006 13:41 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([Ñðîê äåéñòâèÿ êàðòû èñòåê],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------

	ELSE
	
		*16.07.2006 13:42 -&gt;Ñîõðàíèì â ëîã èíôîðìàöèþ î òîì, ÷òî c êàðòîé ðàáîòàòü íåâîçìîæíî
		STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - êàðòà ñ êîäîì ]+tcCardCode+[ - ðàáîòà ñ êàðòîé íåâîçìîæíà]+CHR(13),This.cLogFileDir+[Scud_admin.log],1)
		*------------------------------------------------------------------------------

		*16.07.2006 13:43 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([C äàííûì âèäîì êàðò ðàáîòà íåâîçìîæíà],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntauthadmin</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0M1UT9</uniqueid>
		<timestamp>0</timestamp>
		<class>cntauth</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntauthio</objname>
		<parent/>
		<properties>nmodeio = 0
clastcardcode = 
ccardtypelist = 
ncardmask = 0
Name = "cntauthio"
olecommprox.Top = 1
olecommprox.Left = 1
olecommprox.Height = 38
olecommprox.Width = 39
olecommprox.Name = "olecommprox"
txtCode.Name = "txtCode"
</properties>
		<protected/>
		<methods>PROCEDURE authresult
LPARAMETERS tnAuthResult, ;
			tcCardCode
			
			
*17.07.2006 09:49 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcCardTypeList
*------------------------------------------------------------------------------

WITH This

*05.07.2006 15:15 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ ñ÷èò.],This.nModeIO=3,[ÂÛÕÎÄ êàðò.],[])+[ - c÷èòàíà êàðòà ñ êîäîì ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

*17.07.2006 09:49 -&gt;Ïîëó÷èì ñïèñîê òèïîâ êàðò
IF  !EMPTY(.cCardTypeList)
	lcCardTypeList = [ AND !INLIST(lvSearchCard.CardTypeID,]+.cCardTypeList+[)]
ELSE
	lcCardTypeList = []
ENDIF
*------------------------------------------------------------------------------

*07.07.2006 11:10 -&gt;Ïðîâåðèì âîçìîæíîñòü ðàáîòû ñ êàðòîé
IF tnAuthResult = 0

	IF TTOC(lvSearchCard.CardExpiredDate,1) &gt;= TTOC(DATETIME(),1) AND ;
	   (ISNULL(lvSearchCard.CardActivationDate) OR TTOC(lvSearchCard.CardActivationDate+60*60*24,1) &gt;= TTOC(DATETIME(),1))

		*17.07.2006 10:40 -&gt;Ïðè îïóñêàíèè êàðòû â êàðòîïðèåìíèê - ðàçáëîêèðóåì åãî
		IF .nModeIO = 3
			
			*17.07.2006 10:29 -&gt;çàáèðàåì êàðòó
			oDoorDrv.GetCard()
			*------------------------------------------------------------------------------
				
		ENDIF
		*------------------------------------------------------------------------------
		
		*17.07.2006 10:41 -&gt;Îïðåäåëÿåì âîçìîæíîñòü âûõîäà ïî êàðòå
		IF INLIST(.nModeIO,2,3) &amp;lcCardTypeList
		
			*16.07.2006 16:04 -&gt;&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
			STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - Âûõîä ïî äàííîìó òèïó êàðò íåâîçìîæåí]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
			*------------------------------------------------------------------------------
			
			RETURN
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*09.07.2006 11:43 -&gt;Ðåãèñòðèðóåì ñîáûòèå
		This.EventReg(lvSearchCard.CardID,IIF(.nModeIO=1,1,2))
		*------------------------------------------------------------------------------

		*08.08.2006 09:48 -&gt;Ïðè îïóñêàíèè êàðòû â êàðòîïðèåìíèê - Ïîãàñèì êàðòó
		IF .nModeIO = 3

			*07.08.2006 19:42 -&gt;Ïîãàñèì êàðòó
			This.EventReg(lvSearchCard.CardID,7)
			*------------------------------------------------------------------------------

		ENDIF
		*------------------------------------------------------------------------------

		*05.07.2006 13:11 -&gt;Îòêðûâàåì äâåðü
		oDoorDrv.BeginCycle(This.nModeIO)
		*------------------------------------------------------------------------------
		
		*05.07.2006 10:27 -&gt;Çàêðûâàåì âñå îêíà
		oApp.WindowCloseAll()
		*------------------------------------------------------------------------------
		
		*05.07.2006 10:27 -&gt;Ïîêàçûâàåì îêíî
		oApp.DoFormObj(lvSearchCard.WPODNM,lvSearchCard.CardID,IIF(.nModeIO=1,1,2))
		*------------------------------------------------------------------------------

	ELSE
		
		*05.07.2006 10:53 -&gt;Ðåãèñòðèðóåì ñîáûòèå
		This.EventReg(lvSearchCard.CardID,4)
		*------------------------------------------------------------------------------

		*05.07.2006 15:22 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
		STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ ñ÷èò.],This.nModeIO=3,[ÂÛÕÎÄ êàðò.],[])+[ - Ñðîê äåéñòâèÿ êàðòû èñòåê ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
		*------------------------------------------------------------------------------

		*05.07.2006 10:54 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([Ñðîê äåéñòâèÿ êàðòû èñòåê],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE
		
	*05.07.2006 10:53 -&gt;Ðåãèñòðèðóåì ñîáûòèå
*	This.EventReg(lvCardViewByCLU.CardID,5)
	*------------------------------------------------------------------------------

	*05.07.2006 15:22 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
	STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ ñ÷èò.],This.nModeIO=3,[ÂÛÕÎÄ êàðò.],[])+[ - Êàðòà íå çàðåãèñòðèðîâàíà ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
	*------------------------------------------------------------------------------
		
	*05.07.2006 10:54 -&gt;Ïîêàæåì ñîîáùåíèå
	MESSAGEBOX([C äàííûì âèäîì êàðò ðàáîòà íåâîçìîæíà],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE eventreg
LPARAMETERS	tnCardID, tnEventID

*05.07.2006 10:45 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH tnCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH tnEventID, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*09.07.2006 10:17 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
LPARAMETERS	tnModeIO, tcCardTypeList

*05.07.2006 10:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

*05.07.2006 10:23 -&gt;Ñîõðàíèì ðåæèì ðàáîòû
This.nModeIO = tnModeIO
*------------------------------------------------------------------------------

*08.07.2006 11:28 -&gt;Ñîæðàíèì ñïèñîê òèïîâ êàðò
IF PCOUNT()=2
	This.cCardTypeList = tcCardTypeList
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 10:38 -&gt;Îòêðûâàåì ïîðò
This.OleCommProx.OpenCom()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE olecommprox.Init
OleComm::Init()
ENDPROC
PROCEDURE olecommprox.opencom
WITH This

*05.07.2006 10:20 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcComName
*------------------------------------------------------------------------------

*05.07.2006 10:20 -&gt;Îïðåäåëèì èìÿ ïîðòà
lcComName = ICASE(.Parent.nModeIO=1,[COMI],.Parent.nModeIO=2,[COMOR],.Parent.nModeIO=3,[COMOC],[COM])
*------------------------------------------------------------------------------

*28.04.2006 11:54 -&gt;Ïîëó÷èì íîìåð COM-ïîðòà
IF TYPE([oRes]) == [O]
	This._ComPort = VAL(oRes.GetParam([PROX],lcComName))
ENDIF
*------------------------------------------------------------------------------

*28.04.2006 11:54 -&gt;Îòêðûâàåì ïîðò
This._Open()
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE restorecardcode
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: CNTAUTHIO.RESTORECARDCODE
* Called by.......: &lt;This.SearchCardByDecode()&gt;_PARAM
* Parameters......: &lt;tnCardID, tcCardCode&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Âîññòàíîâëåíèå êîäà êàðòû
*------------------------------------------------------------------------------
LPARAMETERS tnCardID, tcCardCode

*08.07.2006 10:37 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tnCardID
*------------------------------------------------------------------------------

*08.07.2006 10:39 -&gt;Ïîëó÷àåì äàííûå ïî êàðòå
USE IN SELECT([lvCardEdit])
USE lvCardEdit IN 0
CURSORSETPROP([BUFFERING],3,[lvCardEdit])
*------------------------------------------------------------------------------

*08.07.2006 10:39 -&gt;Çàïèñûâàåì êîä
REPLACE lvCardEdit.CardCode WITH tcCardCode IN lvCardEdit
TABLEUPDATE(1,.T.,[lvCardEdit])
*------------------------------------------------------------------------------

*08.07.2006 10:42 -&gt;Çàêðûâàåì LV äëÿ ðåäàêòèðîâàíèÿ êàðòû
USE IN SELECT([lvCardEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nmodeio 1- âõîä, 2 - âûõîä
clastcardcode ïîñëåäíèé ñ÷èòàííûé êîä êàðòû
ccardtypelist ñïèñîê ðàñïîçíàâàåìûõ òèïîâ êàðò
ncardmask
*eventreg ðåãèñòðàöèÿ ñîáûòèÿ íà âõîäíîé ãðóïïå
*restorecardcode 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntauthio</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1W10WYXKX</uniqueid>
		<timestamp>0</timestamp>
		<class>cntauthio</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntauthturn</objname>
		<parent/>
		<properties>nturnno = 0
Name = "cntauthturn"
olecommprox.Top = 1
olecommprox.Left = 1
olecommprox.Height = 38
olecommprox.Width = 39
olecommprox.Name = "olecommprox"
txtCode.Name = "txtCode"
</properties>
		<protected/>
		<methods>PROCEDURE authresult
LPARAMETERS tnAuthResult, ;
			tcCardCode
			
WITH This

*04.09.2006 15:26 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ],This.nModeIO=3,[ÐÀÇÁËÎÊ],[])+[ - c÷èòàíà êàðòà ñ êîäîì ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

*04.09.2006 15:28 -&gt;Ïðîâåðèì âîçìîæíîñòü ðàáîòû ñ êàðòîé
IF tnAuthResult = 0

	IF TTOC(lvSearchCard.CardExpiredDate,1) &gt;= TTOC(DATETIME(),1)

		*04.09.2006 15:30 -&gt;Ðåãèñòðèðóåì ñîáûòèå
		This.EventReg(lvSearchCard.CardID,.nModeIO)
		*------------------------------------------------------------------------------

		*05.07.2006 13:11 -&gt;Âûïîëíÿåì äåéñòâèå
		oTurnDrv.Action(This.nTurnNo,This.nModeIO)
		*------------------------------------------------------------------------------
		
		*04.09.2006 15:31 -&gt;Çàêðûâàåì âñå îêíà
		oApp.WindowCloseAll()
		*------------------------------------------------------------------------------
		
		*04.09.2006 15:31 -&gt;Ïîêàçûâàåì îêíî
		oApp.DoFormObj(lvSearchCard.WPODNM,.nTurnNo,lvSearchCard.CardID,.nModeIO)
		*------------------------------------------------------------------------------

	ELSE
		
		*04.09.2006 15:31 -&gt;Ðåãèñòðèðóåì ñîáûòèå
		This.EventReg(lvSearchCard.CardID,4)
		*------------------------------------------------------------------------------

		*04.09.2006 15:31 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
		STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ],This.nModeIO=3,[ÐÀÇÁËÎÊ],This.nModeIO=4,[ÁËÎÊ],[])+[ - Ñðîê äåéñòâèÿ êàðòû èñòåê ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
		*------------------------------------------------------------------------------

		*04.09.2006 15:31 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([Ñðîê äåéñòâèÿ êàðòû èñòåê],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE
		
	*05.07.2006 10:53 -&gt;Ðåãèñòðèðóåì ñîáûòèå
*	This.EventReg(lvCardViewByCLU.CardID,5)
	*------------------------------------------------------------------------------

	*04.09.2006 15:31 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
	STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: ]+ICASE(This.nModeIO=1,[ÂÕÎÄ],This.nModeIO=2,[ÂÛÕÎÄ],This.nModeIO=3,[ÐÀÇÁËÎÊ],This.nModeIO=4,[ÁËÎÊ],[])+[ - Êàðòà íå çàðåãèñòðèðîâàíà ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud.log],1)
	*------------------------------------------------------------------------------
		
	*04.09.2006 15:32 -&gt;Ïîêàæåì ñîîáùåíèå
	MESSAGEBOX([C äàííûì âèäîì êàðò ðàáîòà íåâîçìîæíà],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
LPARAMETERS	tnTurnNo,tnModeIO

*06.09.2006 09:45 -&gt;Ñîõðàíèì íîìåð òóðíèêåòà
This.nTurnNo = tnTurnNo
*------------------------------------------------------------------------------

*05.07.2006 10:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnModeIO,[])
*----------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE olecommprox.opencom
WITH This

*06.09.2006 09:42 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcComName
*------------------------------------------------------------------------------

*06.09.2006 09:44 -&gt;Îïðåäåëèì èìÿ ïîðòà
lcComName = ICASE(.Parent.nModeIO=1,[COMI],.Parent.nModeIO=2,[COMO],.Parent.nModeIO=3,[COMUL],.Parent.nModeIO=4,[COML],[COM])
*------------------------------------------------------------------------------

*06.09.2006 09:44 -&gt;Ïîëó÷èì íîìåð COM-ïîðòà
IF TYPE([oRes]) == [O]
	This._ComPort = VAL(oRes.GetParam([TURN]+ALLTRIM(STR(.Parent.nTurnNo)),lcComName))
ENDIF
*------------------------------------------------------------------------------

*28.04.2006 11:54 -&gt;Îòêðûâàåì ïîðò
This._Open()
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nturnno íîìåð òóðíèêåòà
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntauthturn</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA0Z46MG</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntcardinfo</objname>
		<parent/>
		<properties>Width = 310
Height = 78
Name = "cntcardinfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA1029PA</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>cntcardinfo</parent>
		<properties>Top = 0
Left = 0
Height = 78
Width = 310
SpecialEffect = 0
ZOrderSet = 0
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA1029PC</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtDeliveryDate</objname>
		<parent>cntcardinfo</parent>
		<properties>DragMode = 1
FontSize = 18
Alignment = 0
ControlSource = "lvCardRepl.CardDeliveryDate"
Enabled = .F.
Format = "D"
Height = 32
Left = 177
Top = 5
Width = 128
DisabledForeColor = 0,0,0
ZOrderSet = 1
Name = "txtDeliveryDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA1029PD</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtExpiredDate</objname>
		<parent>cntcardinfo</parent>
		<properties>DragMode = 1
FontSize = 18
Alignment = 0
ControlSource = "lvCardRepl.CardExpiredDate"
Enabled = .F.
Format = "D"
Height = 32
Left = 177
Top = 40
Width = 128
DisabledForeColor = 0,0,0
ZOrderSet = 2
Name = "txtExpiredDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VI3EV</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeliveryDate</objname>
		<parent>cntcardinfo</parent>
		<properties>FontBold = .T.
FontSize = 12
Caption = "Äàòà âûäà÷è"
Left = 5
Top = 12
Name = "lblDeliveryDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA10JEK7</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblExpiredDate</objname>
		<parent>cntcardinfo</parent>
		<properties>FontBold = .T.
FontSize = 12
Caption = "Îêîí÷àíèå äåéñòâèÿ"
Left = 5
Top = 47
Name = "lblExpiredDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntcardinfo</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0O6VYL</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntdoordriver</objname>
		<parent/>
		<properties>ndoormask = 0
nrelaydelay = 0
ndooropendelay = 0
ndebug = 0
nstartcounter = 0
ndooropendelayout = 0
ncardmask = 0
ncarddelay = 0
clogfiledir = 
nrelaydelayout = 0
nrelaydelaynext = 0
nmodeio = 0
Name = "cntdoordriver"
</properties>
		<protected/>
		<methods>PROCEDURE begincycle
LPARAMETERS	tnModeIO

WITH This

*05.07.2006 15:23 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[DOOR: Çàïóñê öèêëà îòêðûòèÿ äâåðè]+CHR(13),.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

*08.07.2006 11:56 -&gt;Ïðîâåðèì êîëè÷åñòâî çàïóñêîâ öèêëà îòêðûòèÿ äâåðè
IF .nStartCounter = 0

	*05.07.2006 15:23 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
	STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[DOOR: Çàïóñê çàäåðæêè íà îòêðûòèå äâåðè]+CHR(13),.cLogFileDir+[Scud.log],1)
	*------------------------------------------------------------------------------

	*09.08.2006 09:33 -&gt;Ñîõðàíèì ñîáûòèå
	.nModeIO = tnModeIO
	*------------------------------------------------------------------------------

	*05.07.2006 11:46 -&gt;Çàïóñòèì öèêë îòêðûòèÿ äâåðè
	IF !.tmrDelayOpenDoor.Enabled
		.tmrDelayOpenDoor.Interval = IIF(tnModeIO=1,.nDoorOpenDelay,.nDoorOpenDelayOut)
		.tmrDelayOpenDoor.Enabled  = .T.
	ENDIF
	*------------------------------------------------------------------------------

	*07.07.2006 12:01 -&gt;Â ðåæèìå îòëàäêè ïîêàçûâàåì ñîîáùåíèÿ
	IF .nDebug = 1
		WAIT WINDOW [Íà÷àëî öèêëà îòêðûâàíèÿ äâåðè...] NOWAIT
	ENDIF
	*------------------------------------------------------------------------------

ELSE

	IF .Timer.Enabled

		*05.07.2006 15:23 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
		STRTOFILE(TTOC(DATETIME())+[ -&gt; DOOR: Óâåëè÷åíèå âðåìåíè óäåðæàíèÿ äâåðè]+CHR(13),.cLogFileDir+[Scud.log],1)
		*------------------------------------------------------------------------------
	
		.Timer.Interval = .Timer.Interval + 1000
		
	ENDIF

ENDIF
*------------------------------------------------------------------------------

*08.07.2006 12:07 -&gt;Óâåëè÷èâàåì ñ÷åò÷èê çàïóñêîâ
.nStartCounter = .nStartCounter + 1
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
*05.07.2006 12:20 -&gt;Çàêðûâàåì äðàéâåð êàðòû ââîäà/âûâîäà
IF This.nDebug = 0
	This.PISO_P8R8.DriverClose()
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 12:20 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE endcycle
WITH This

*05.07.2006 11:50 -&gt;Çàâåðøèì öèêë îòêðûòèÿ äâåðè
.Timer.Enabled = .F.
*------------------------------------------------------------------------------

*08.07.2006 12:08 -&gt;Îáíóëèì ñ÷åò÷èê çàïóñêîâ
.nStartCounter = 0
*------------------------------------------------------------------------------

*07.07.2006 12:03 -&gt;Â ðåæèìå îòëàäêè ïîêàçûâàåì ñîîáùåíèÿ
IF .nDebug = 1
	WAIT WINDOW [Çàâåðøåííèå öèêëà îòêðûâàíèÿ äâåðè...] NOWAIT
ELSE
	.PISO_P8R8.RelayOFF(.nDoorMask)
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 15:23 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
STRTOFILE(TTOC(DATETIME())+[ -&gt; DOOR: Âûäà÷à êîìàíäû íà çàêðûòèå äâåðè]+CHR(13),.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

ENDWITH

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE getcard
WITH This


*17.07.2006 10:37 -&gt;Â ðåæèìå îòëàäêè ïîêàçûâàåì ñîîáùåíèÿ
IF .nDebug = 1
	WAIT WINDOW [Ðàçáëîêîðóåì êàðòîïðèåìíèê...] NOWAIT
ELSE
	.PISO_P8R8.RelayON(.nCardMask)
ENDIF
*------------------------------------------------------------------------------

*17.07.2006 10:37 -&gt;Çàïóñêàåì òàéìåð äëÿ óäåðæàíèÿ ý/ì
.TmrCard.Interval = .nCardDelay
.TmrCard.Enabled  = .T.

*05.07.2006 15:28 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
STRTOFILE(TTOC(DATETIME())+[ -&gt; CARD: Ðàçáëîêèðîâàíèå êàðòîïðèåìíèêà]+CHR(13),.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

ENDWITH
ENDPROC
PROCEDURE Init
WITH This

*04.09.2006 16:38 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.09.2006 16:38 -&gt;ìàñêà îòêðûòèÿ äâåðè
.nDoorMask   = VAL(oRes.GetParam([SCUD],[DOOR_MASK]))
*------------------------------------------------------------------------------

*09.08.2006 09:25 -&gt;âðåìÿ óäåðæàíèÿ äâåðåé îòêðûòûìè ïðè âõîäå
.nRelayDelay = VAL(oRes.GetParam([SCUD],[RELAY_DELAY]))
*------------------------------------------------------------------------------

*09.08.2006 09:25 -&gt;âðåìÿ óäåðæàíèÿ äâåðåé îòêðûòûìè ïðè âûõîäå
.nRelayDelayOut = VAL(oRes.GetParam([SCUD],[RELAY_DELAY_OUT]))
*------------------------------------------------------------------------------

*17.07.2006 10:14 -&gt;Ïîëó÷èì èìÿ êàòàëîãà äëÿ çàïèñè Log-ôàéëà
.cLogFileDir = ADDBS(oRes.GetParam([SCUD],[LOG_FILE_DIR]))
*------------------------------------------------------------------------------

*17.07.2006 10:14 -&gt;Ðåæèì îòëàäêè
.nDebug		 = VAL(oRes.GetParam([SCUD],[DEBUG]))
*------------------------------------------------------------------------------

*05.07.2006 11:52 -&gt;Èíèöèàëèçèðóåì äðàéâåð êàðòû ââîäà/âûâîäà
IF .nDebug = 0
	.PISO_P8R8.DriverInit()
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE opendoor
WITH This

*05.07.2006 15:27 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[DOOR: Âûäà÷à êîìàíäû íà îòêðûâàíèå äâåðè]+CHR(13),.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------

*07.07.2006 12:03 -&gt;Â ðåæèìå îòëàäêè ïîêàçûâàåì ñîîáùåíèÿ
IF .nDebug = 1
	WAIT WINDOW [Îòêðûâàåì äâåðü...] NOWAIT
ELSE
	.PISO_P8R8.RelayON(.nDoorMask)
ENDIF
*------------------------------------------------------------------------------

.Timer.Interval = IIF(.nModeIO = 1,.nRelayDelay,.nRelayDelayOut)+.nRelayDelayNext*(.nStartCounter-1)
.Timer.Enabled  = .T.
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>ndoormask ïîçèöèÿ âêëþ÷àåìîãî ðåëå
nrelaydelay 0Âðåìÿ âêëþ÷åíèÿ ðåëå(ìñ)
ndooropendelay
ndebug
nstartcounter ñ÷åò÷èê öèêëîâ çàïóñêà
ndooropendelayout
ncardmask
ncarddelay
clogfiledir
nrelaydelayout Âðåìÿ óäåðæàíèÿ äâåðåé ïðè âûõîäå
nrelaydelaynext Âðåìÿ óäåðæàíèÿ äâåðåé ïðè ïîñëåäóþùèõ ñîáûòèÿõ îòêðûòèÿ/çàêðûòèÿ äâåðè
nmodeio ñîáûòèå, âûçâàâøåå çàïóñê ïåðâîãî öèêëà îòêðûâàíèÿ äâåðè
*opendoor çàïóñê öèêëà îòêðûòèÿ äâåðè
*endcycle çàâåðøåíèå öèêëà îòêðûòèÿ äâåðè
*begincycle íà÷àëî öèêëà îòêðûâàíèÿ äâåðè
*getcard 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0O88DQ</uniqueid>
		<timestamp>0</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>Timer</objname>
		<parent>cntdoordriver</parent>
		<properties>Top = 0
Left = 1
Height = 23
Width = 23
Enabled = .F.
Name = "Timer"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
This.Parent.EndCycle()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0O88DR</uniqueid>
		<timestamp>0</timestamp>
		<class>piso_p8r8</class>
		<classloc>dio.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>Piso_p8r8</objname>
		<parent>cntdoordriver</parent>
		<properties>Top = 23
Height = 23
Width = 23
Name = "Piso_p8r8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UE0PJ9VL</uniqueid>
		<timestamp>0</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>tmrDelayOpenDoor</objname>
		<parent>cntdoordriver</parent>
		<properties>Left = 23
Height = 23
Width = 23
Enabled = .F.
Name = "tmrDelayOpenDoor"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
This.Enabled = .F.
This.Parent.OpenDoor()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UL11754N</uniqueid>
		<timestamp>0</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>tmrCard</objname>
		<parent>cntdoordriver</parent>
		<properties>Top = 49
Left = 34
Height = 23
Width = 23
Name = "tmrCard"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
*17.07.2006 10:38 -&gt;áëîêèðóåì òàéìåð
This.Enabled = .F.
*------------------------------------------------------------------------------

*07.07.2006 12:03 -&gt;Â ðåæèìå îòëàäêè ïîêàçûâàåì ñîîáùåíèÿ
IF This.Parent.nDebug = 1
	WAIT WINDOW [Áëîêèðóåì êàðòîïðèåìíèê...] NOWAIT
ELSE
	This.Parent.PISO_P8R8.RelayOFF(This.Parent.nCardMask)
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 15:28 -&gt;Ñîõðàíèì â ëîã ñîáûòèå
STRTOFILE(TTOC(DATETIME())+[ -&gt; CARD: Áëîêèðîâàíèå êàðòîïðèåìíèêà]+CHR(13),This.Parent.cLogFileDir+[Scud.log],1)
*------------------------------------------------------------------------------


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntdoordriver</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VXVCI</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>..\library\base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntfio</objname>
		<parent/>
		<properties>Width = 310
Height = 112
Name = "cntfio"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN3</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>sphOwnerInfo</objname>
		<parent>cntfio</parent>
		<properties>Height = 112
Width = 310
SpecialEffect = 0
ZOrderSet = 0
Name = "sphOwnerInfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN4</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltFNM</objname>
		<parent>cntfio</parent>
		<properties>FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysFNM"
Enabled = .F.
Height = 32
Left = 5
Top = 5
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
NullDisplay = " "
Name = "txtCltFNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN5</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltINM</objname>
		<parent>cntfio</parent>
		<properties>FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysINM"
Enabled = .F.
Height = 32
Left = 5
Top = 40
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 5
NullDisplay = " "
Name = "txtCltINM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN6</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltONM</objname>
		<parent>cntfio</parent>
		<properties>FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysONM"
Enabled = .F.
Height = 32
Left = 5
Top = 75
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 6
NullDisplay = " "
Name = "txtCltONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntfio</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VXVCI</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>..\library\base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntorg</objname>
		<parent/>
		<properties>Width = 310
Height = 78
Name = "cntorg"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN3</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>sphOwnerInfo</objname>
		<parent>cntorg</parent>
		<properties>Top = 0
Left = 0
Height = 78
Width = 310
SpecialEffect = 0
ZOrderSet = 0
Name = "sphOwnerInfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN4</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtOrgNM</objname>
		<parent>cntorg</parent>
		<properties>FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltJrdNM"
Enabled = .F.
Height = 32
Left = 5
Top = 5
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
NullDisplay = " "
Name = "txtOrgNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VYTN5</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPostNM</objname>
		<parent>cntorg</parent>
		<properties>FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPostNM"
Enabled = .F.
Height = 32
Left = 5
Top = 40
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 5
NullDisplay = " "
Name = "txtPostNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntorg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P3JQC</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntpassp</objname>
		<parent/>
		<properties>Width = 310
Height = 127
BorderWidth = 0
Name = "cntpassp"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>9</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPG</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>sphPassp</objname>
		<parent>cntpassp</parent>
		<properties>Left = 0
Height = 127
Width = 310
SpecialEffect = 0
ZOrderSet = 0
Name = "sphPassp"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPM</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblPasspSeries</objname>
		<parent>cntpassp</parent>
		<properties>AutoSize = .T.
FontBold = .T.
WordWrap = .T.
Caption = "Ïàñïîðò ñåðèÿ"
Height = 32
Left = 4
Top = 3
Width = 51
TabIndex = 2
Name = "lblPasspSeries"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPH</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPasspSeries</objname>
		<parent>cntpassp</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysPasspSeries"
Enabled = .F.
Height = 26
Left = 54
TabIndex = 3
Top = 6
Width = 70
DisabledForeColor = 0,0,0
ZOrderSet = 4
_highlightobject = .Parent.lblPasspSeries
Name = "txtPasspSeries"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPJ</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPasspNumber</objname>
		<parent>cntpassp</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysPasspNumber"
Enabled = .F.
Height = 26
Left = 179
TabIndex = 5
Top = 6
Width = 125
DisabledForeColor = 0,0,0
ZOrderSet = 4
_highlightobject = .Parent.lblPasspNumber
Name = "txtPasspNumber"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPK</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtIssueDate</objname>
		<parent>cntpassp</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltPhysPasspIssueDate"
Enabled = .F.
Height = 25
Left = 54
TabIndex = 7
Top = 36
Width = 90
DisabledForeColor = 0,0,0
ZOrderSet = 5
_highlightobject = .Parent.lblPasspIssueBy
Name = "txtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPN</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblPasspNumber</objname>
		<parent>cntpassp</parent>
		<properties>FontBold = .T.
Caption = "íîìåð"
Left = 140
Top = 9
TabIndex = 4
Name = "lblPasspNumber"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPO</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblPasspIssueBy</objname>
		<parent>cntpassp</parent>
		<properties>FontBold = .T.
Caption = "Âûäàí"
Left = 5
Top = 40
TabIndex = 6
Name = "lblPasspIssueBy"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPP</uniqueid>
		<timestamp>0</timestamp>
		<class>edt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtIssueDate</objname>
		<parent>cntpassp</parent>
		<properties>FontSize = 12
Enabled = .F.
Height = 57
Left = 54
ScrollBars = 0
TabIndex = 8
Top = 65
Width = 251
DisabledForeColor = 0,0,0
ControlSource = "lvCardOwnerInfoByID.CltPhysPasspIssueBy"
_highlightobject = .Parent.lblPasspIssueBy
Name = "edtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntpassp</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P3JQC</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntreg</objname>
		<parent/>
		<properties>Width = 310
Height = 127
BorderWidth = 0
Name = "cntreg"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>10</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPG</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>sphPassp</objname>
		<parent>cntreg</parent>
		<properties>Top = 0
Left = 0
Height = 127
Width = 310
SpecialEffect = 0
ZOrderSet = 0
Name = "sphPassp"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPM</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFlightNo</objname>
		<parent>cntreg</parent>
		<properties>FontBold = .T.
Caption = "Ðåéñ"
Left = 5
Top = 40
TabIndex = 3
Name = "lblFlightNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VIYPV</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtFligthNo</objname>
		<parent>cntreg</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvPassRegEdit.PassRegFlightNo"
Enabled = .T.
Height = 26
Left = 95
TabIndex = 4
Top = 36
Width = 105
DisabledForeColor = 0,0,0
ZOrderSet = 4
_highlightobject = .Parent.lblFlightNo
Name = "txtFligthNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U510FPB2</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCompanyCode</objname>
		<parent>cntreg</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvPassRegEdit.PassRegCompanyCode"
Enabled = .T.
Height = 26
Left = 95
TabIndex = 6
Top = 67
Width = 105
DisabledForeColor = 0,0,0
ZOrderSet = 4
_highlightobject = .Parent.lblCompanyCode
Name = "txtCompanyCode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50YKPLL</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txRegTime</objname>
		<parent>cntreg</parent>
		<properties>FontSize = 12
Alignment = 0
ControlSource = "lvPassRegEdit.PassRegTime"
Enabled = .T.
Height = 25
Left = 95
TabIndex = 8
Top = 98
Width = 156
DisabledForeColor = 0,0,0
ZOrderSet = 5
_highlightobject = .Parent.lblFlightTime
Name = "txRegTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VIYPV</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCompanyCode</objname>
		<parent>cntreg</parent>
		<properties>FontBold = .T.
Caption = "Àâèàêîìïàíèÿ"
Left = 5
Top = 71
TabIndex = 5
Name = "lblCompanyCode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0P5LPO</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFlightType</objname>
		<parent>cntreg</parent>
		<properties>FontBold = .T.
Caption = "Ïðèçíàê ðåéñà"
Left = 5
Top = 9
TabIndex = 1
Name = "lblFlightType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VIYPV</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIDCtlGridType</objname>
		<parent>cntreg</parent>
		<properties>Top = 5
Left = 95
Width = 208
Height = 26
TabIndex = 2
_controlsource = lvPassRegEdit.FlightTypeID
_controlsourcetype = 1
_rsaliasname = lvFligthTypeList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "cntIDCtlGridType"
txtText.FontSize = 12
txtText.Height = 26
txtText.Left = 0
txtText.Top = 0
txtText.Width = 153
txtText._highlightobject = .Parent.Parent.lblFlightType
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 157
cmdShow.Height = 26
cmdShow.Width = 26
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 183
cmdClear.Height = 26
cmdClear.Width = 26
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0Q96LV</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFlightTime</objname>
		<parent>cntreg</parent>
		<properties>FontBold = .T.
Caption = "Âðåìÿ âûëåòà"
Left = 5
Top = 102
TabIndex = 7
Name = "lblFlightTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntreg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1W10YKC28</uniqueid>
		<timestamp>0</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntturndriver</objname>
		<parent/>
		<properties>nturncount = 0
clogfiledir = 
ndebug = 0
Name = "cntturndriver"
</properties>
		<protected/>
		<methods>PROCEDURE action
LPARAMETERS	tnTurnNo, ;
			tnActionID

WITH This			



*05.09.2006 14:11 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnRelayMask, ;
		lcTmrName
***
lnRelayMask = ICASE(tnActionID = 1,.nMaskIn[tnTurnNo],tnActionID = 2,.nMaskOut[tnTurnNo],tnActionID = 3,.nMaskMiddle[tnTurnNo],tnActionID = 4,.nMaskIn[tnTurnNo]+.nMaskOut[tnTurnNo],0)
*------------------------------------------------------------------------------
	
*05.09.2006 11:42 -&gt;Ïðîâåðèì ïðàâèëüíîñòü íîìåðà òóðíèêåòà
IF tnTurnNo &lt; 1 OR tnTurnNo &gt; .nTurnCount
	RETURN -1
ENDIF
*------------------------------------------------------------------------------

*05.09.2006 14:18 -&gt;Ïîëó÷èì èìÿ òàéìåðà
lcTmrName = [tmr]+SYS(2015)
*------------------------------------------------------------------------------

*05.09.2006 14:19 -&gt;Ñîçäàäèì îáüåêò
.NewObject(lcTmrName,[tmrTurn],[auth_v1.vcx],[auth.app],lnRelayMask)
*------------------------------------------------------------------------------

*05.09.2006 14:19 -&gt;Çàïóñòèì òàéìåð
.&amp;lcTmrName..Interval = .nRelayDelay[tnTurnNo]
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
*05.09.2006 11:13 -&gt;Çàêðûâàåì äðàéâåð êàðòû ââîäà/âûâîäà
IF This.nDebug = 0
	This.PCI_P16R16.DriverClose()
ENDIF
*------------------------------------------------------------------------------

*05.09.2006 11:13 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Init
WITH This

*05.09.2006 11:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lnTurnCnt
*------------------------------------------------------------------------------

*05.09.2006 11:00 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*05.09.2006 11:27 -&gt;Ïîëó÷èì êîëè÷åñòâî òóðíèêåòîâ
.nTurnCount = VAL(oRes.GetParam([COMMON],[TURN_COUNT]))
*------------------------------------------------------------------------------

*05.09.2006 11:37 -&gt;Óñòàíîâèì ðàçìåðû ìàññèâîâ ïàðàìåòðîâ
DIMENSION .nMaskIn[.nTurnCount]
DIMENSION .nMaskOut[.nTurnCount]
DIMENSION .nMaskMiddle[.nTurnCount]
DIMENSION .nRelayDelay[.nTurnCount]
*------------------------------------------------------------------------------

*05.09.2006 11:30 -&gt;Ïîëó÷èì ïàðàìåòðû òóðíèêåòîâ
FOR lnTurnCnt = 1 TO .nTurnCount

	*05.09.2006 11:00 -&gt;ìàñêà îòêðûòèÿ òóðíèêåòà íà âõîä
	.nMaskIn[lnTurnCnt]		= VAL(oRes.GetParam([TURN]+ALLTRIM(STR(lnTurnCnt)),[MASK_IN]))
	*------------------------------------------------------------------------------

	*05.09.2006 11:06 -&gt;ìàñêà îòêðûòèÿ òóðíèêåòà íà âûõîä
	.nMaskOut[lnTurnCnt]	= VAL(oRes.GetParam([TURN]+ALLTRIM(STR(lnTurnCnt)),[MASK_OUT]))
	*------------------------------------------------------------------------------

	*08.09.2006 08:55 -&gt;ìàñêà "ñðåäíåé" êíîïêè
	.nMaskMiddle[lnTurnCnt]	= VAL(oRes.GetParam([TURN]+ALLTRIM(STR(lnTurnCnt)),[MASK_LOCK]))
	*------------------------------------------------------------------------------

	*09.08.2006 09:25 -&gt;âðåìÿ óäåðæàíèÿ "êíîïêè" íàæàòîé
	.nRelayDelay[lnTurnCnt]	= VAL(oRes.GetParam([TURN]+ALLTRIM(STR(lnTurnCnt)),[RELAY_DELAY]))
	*------------------------------------------------------------------------------

ENDFOR
*------------------------------------------------------------------------------

*05.09.2006 11:09 -&gt;Ðåæèì îòëàäêè
.nDebug		 = VAL(oRes.GetParam([COMMON],[DEBUG]))
*------------------------------------------------------------------------------

*05.09.2006 11:09 -&gt;Ïîëó÷èì èìÿ êàòàëîãà äëÿ çàïèñè Log-ôàéëà
.cLogFileDir = ADDBS(oRes.GetParam([COMMON],[LOG_FILE_DIR]))
*------------------------------------------------------------------------------

*05.09.2006 11:11 -&gt;Èíèöèàëèçèðóåì äðàéâåð êàðòû ââîäà/âûâîäà
IF .nDebug = 0
	.PCI_P16R16.DriverInit()
ENDIF
*------------------------------------------------------------------------------

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>nturncount íîìåð òóðíèêåòà
clogfiledir êàòàëîã Log-ôàéëà
ndebug ôëàã ðåæèìà îòëàäêè
^nmaskout[1,0] ìàñêà ðåëå íà âûõîä
^nrelaydelay[1,0] âðåìÿ óäåðæàíèÿ "êíîïêè" íàæàòîé
^nmaskin[1,0] ìàñêà ðåëå íà âõîä
*action äåéñòâèå ñ òóðíèêåòîì
^nmaskmiddle[1,0] ìàñêà "ñðåäíåé" êëàâèøè
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1W20N8UEA</uniqueid>
		<timestamp>0</timestamp>
		<class>pci_p16r16</class>
		<classloc>dio.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>Pci_p16r16</objname>
		<parent>cntturndriver</parent>
		<properties>Top = 33
Left = 2
Height = 17
Width = 71
Name = "Pci_p16r16"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntturndriver</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VI3EV</uniqueid>
		<timestamp>0</timestamp>
		<class>frmview</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcardownerinfo</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 310
Width = 375
DoCreate = .T.
_allowmultiple = .T.
ncardid = 0
Name = "frmcardownerinfo"
cstmsghandler.Top = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmCardOwnerInfo.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tnCardID&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS   tnCardID

*28.06.2006 14:58 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
***
_PARAM = tnCardID
*------------------------------------------------------------------------------

*03.07.2006 17:22 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*07.08.2006 19:02 -&gt;Ñîõðàíèì ID êàðòû
This.nCardID = tnCardID
*------------------------------------------------------------------------------

*28.06.2006 15:00 -&gt;Ïåðå÷èòûâàåì èíôîðìàöèþ î âëàäåëüöå êàðòû
REQUERY([lvCardOwnerInfoByID])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmCardOwnerInfo.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*03.07.2006 17:31 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*28.06.2006 14:57 -&gt;Åñëè ÁÄ çàêðûòà - îòêðîåì åå
IF !DBUSED([BASIS])
	OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*28.06.2006 14:57 -&gt;Îòêðûâàåì LV ñ äàííûìè î âëàäåëüöå êàðòû
USE lvCardOwnerInfoByID IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>ncardid èäåíòèôèêàòîð êàðòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U511MTH1</uniqueid>
		<timestamp>0</timestamp>
		<class>img</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>ImgPhoto</objname>
		<parent>frmcardownerinfo</parent>
		<properties>Stretch = 2
Height = 300
Left = 5
Top = 5
Width = 250
ZOrderSet = 3
Name = "ImgPhoto"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcardownerinfo</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VIYPV</uniqueid>
		<timestamp>0</timestamp>
		<class>frmcardownerinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmgoldcard</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 310
Width = 575
DoCreate = .T.
cpicturefilenm = 
Name = "frmgoldcard"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.Name = "ImgPhoto"
</properties>
		<protected/>
		<methods>PROCEDURE Destroy
*28.06.2006 16:22 -&gt;Óäàëèì ôàéë ñ ôîòîãðàôèåé
IF FILE(([tmp\]+This.cPictureFileNM))
	ERASE (([tmp\]+This.cPictureFileNM))
ENDIF
*------------------------------------------------------------------------------

*28.06.2006 16:48 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
LPARAMETERS   tnCardID

*28.06.2006 16:08 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*28.06.2006 16:19 -&gt;Ñôîðìèðóåì èìÿ ôàéëà
This.cPictureFileNM = [_ph]+SYS(2015)+[.jpg]
*------------------------------------------------------------------------------

*28.06.2006 16:34 -&gt;Ôîðìèðóåì çàãîëîâîê ôîðìû
This.Caption = ALLTRIM(lvCardOwnerInfoByID.CltPhysFNM) + [ ] + ;
			   LEFT(ALLTRIM(lvCardOwnerInfoByID.CltPhysINM),1) + [.] + ;
			   LEFT(ALLTRIM(lvCardOwnerInfoByID.CltPhysONM),1) + [.] + ;
			   [ - ] + ALLTRIM(lvCardOwnerInfoByID.CardTypeNM)
*------------------------------------------------------------------------------

*28.06.2006 16:37 -&gt;Ïîêàçûâàåì ôîòîãðàôèþ âëàäåëüöà
IF !ISNULL(lvCardOwnerInfoByID.CltImage) AND !EMPTY(lvCardOwnerInfoByID.CltImage)

	*28.06.2006 16:21 -&gt;Âûãðóçèì ôîòîãðàôèþ â ôàéë
	COPY MEMO lvCardOwnerInfoByID.CltImage TO ([tmp\]+This.cPictureFileNM)
	*------------------------------------------------------------------------------

	*28.06.2006 16:23 -&gt;Ïðèâÿæåì ôàéë ñ ôîòîãðàôèåé
	This.ImgPhoto.Picture = [tmp\]+This.cPictureFileNM
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3>cpicturefilenm èìÿ ôàéëà ñ ôîòîãðàôèåé âëÿäåëüöà êàðòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0VZN6P</uniqueid>
		<timestamp>0</timestamp>
		<class>cntfio</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntfio1</objname>
		<parent>frmgoldcard</parent>
		<properties>Top = 5
Left = 259
Name = "Cntfio1"
sphOwnerInfo.Name = "sphOwnerInfo"
txtCltFNM.Name = "txtCltFNM"
txtCltINM.Name = "txtCltINM"
txtCltONM.Name = "txtCltONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmgoldcard</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA10KLZQ</uniqueid>
		<timestamp>0</timestamp>
		<class>frmgoldcard</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmgoldcardident</objname>
		<parent/>
		<properties>Height = 320
Width = 575
DoCreate = .T.
AutoCenter = .T.
Name = "frmgoldcardident"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.Name = "ImgPhoto"
CNTFIO1.SPHOWNERINFO.Name = "SPHOWNERINFO"
CNTFIO1.TXTCLTFNM.Name = "TXTCLTFNM"
CNTFIO1.TXTCLTINM.Name = "TXTCLTINM"
CNTFIO1.TXTCLTONM.Name = "TXTCLTONM"
CNTFIO1.Left = 259
CNTFIO1.Name = "CNTFIO1"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnCardID,tnModeIO

*03.07.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tnCardID
*------------------------------------------------------------------------------

*03.07.2006 17:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*03.07.2006 17:06 -&gt;Ñ÷èòûâàåì èíôîðìàöèþ î êàðòå
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*05.07.2006 11:00 -&gt;Ïîêàæåì ðåæèì ðàáîòû
This.txtModeIO.Value = ICASE(tnModeIO=1,[ÂÕÎÄ],tnModeIO=2,[ÂÛÕÎÄ],[ÐÅÆÈÌ ÍÅÈÇÂÅÑÒÅÍ])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*03.07.2006 17:04 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.07.2006 17:04 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA11GERD</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcardinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcardinfo1</objname>
		<parent>frmgoldcardident</parent>
		<properties>Top = 202
Left = 259
Name = "Cntcardinfo1"
Shp1.Name = "Shp1"
txtDeliveryDate.Name = "txtDeliveryDate"
txtExpiredDate.Name = "txtExpiredDate"
lblDeliveryDate.Name = "lblDeliveryDate"
lblExpiredDate.Name = "lblExpiredDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0NQHAA</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtModeIO</objname>
		<parent>frmgoldcardident</parent>
		<properties>FontSize = 18
Alignment = 2
Enabled = .F.
Height = 32
Left = 263
Top = 283
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtModeIO"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UE0QWXP2</uniqueid>
		<timestamp>0</timestamp>
		<class>cntorg</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntOrg</objname>
		<parent>frmgoldcardident</parent>
		<properties>Top = 121
Left = 259
Name = "cntOrg"
sphOwnerInfo.Name = "sphOwnerInfo"
txtOrgNM.Name = "txtOrgNM"
txtPostNM.Name = "txtPostNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmgoldcardident</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0O3AF2</uniqueid>
		<timestamp>0</timestamp>
		<class>frmgoldcard</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmgoldcardreg</objname>
		<parent/>
		<properties>Top = 0
Left = 1
Height = 410
Width = 575
DoCreate = .T.
Closable = .F.
Name = "frmgoldcardreg"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.ZOrderSet = 4
ImgPhoto.Name = "ImgPhoto"
Cntfio1.sphOwnerInfo.Name = "sphOwnerInfo"
Cntfio1.txtCltFNM.Name = "txtCltFNM"
Cntfio1.txtCltINM.Name = "txtCltINM"
Cntfio1.txtCltONM.Name = "txtCltONM"
Cntfio1.ZOrderSet = 3
Cntfio1.Name = "Cntfio1"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmGoldCardReg._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*04.07.2006 14:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*04.07.2006 14:15 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*04.07.2006 14:15 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:15 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:16 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*04.07.2006 14:16 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
	ELSE
		
		*04.07.2006 14:16 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*04.07.2006 14:16 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*04.07.2006 14:16 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*04.07.2006 14:16 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*04.07.2006 14:16 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvPassRegEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*04.07.2006 14:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 14:17 -&gt;Ñêðûâàåì ôîðìó
.Release()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Destroy
*04.07.2006 14:45 -&gt;Îòêàòûâàåì ðåãèñòðàöèþ
This._HandleCntCancelSaveEvent([CANCEL])
*------------------------------------------------------------------------------

*04.07.2006 14:41 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
LPARAMETERS   tnCardID

*04.07.2006 13:47 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*04.07.2006 13:47 -&gt;Äîáàâëÿåì çàïèñü â òàáëèöó äëÿ ðåãèñòðàöèè
APPEND BLANK IN lvPassRegEdit
*------------------------------------------------------------------------------

*04.07.2006 13:48 -&gt;Ñîõðàíèì èäåíòèôèêàòîð êàðòû, êëèåíòà, òåêóùåå âðåìÿ
REPLACE ;
	lvPassRegEdit.CardID WITH tnCardID ;
	lvPassRegEdit.CltID  WITH lvCardOwnerInfoByID.CltID, ;
	lvPassRegEdit.PassRegTime WITH DATETIME() ;
	IN lvPassRegEdit
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*04.07.2006 12:49 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.07.2006 12:49 -&gt;Îòêðûâàåì íåîáõîäèìûå ñïðàâî÷íèêè
USE lvFligthTypeList IN 0
*------------------------------------------------------------------------------

*04.07.2006 12:50 -&gt;Îòêðîåì LV äëÿ ðåäàêòèðîâàíèÿ èíôîðìàöèè î ðåéñå
USE lvPassRegEdit IN 0 NODATA
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>*_handlecntcancelsaveevent 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0UY8HB</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmgoldcardreg</parent>
		<properties>Top = 0
Left = 42
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VIYPV</uniqueid>
		<timestamp>0</timestamp>
		<class>cntpassp</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPassp</objname>
		<parent>frmgoldcardreg</parent>
		<properties>Top = 120
Left = 259
ZOrderSet = 5
Name = "cntPassp"
sphPassp.Top = 1
sphPassp.Left = 0
sphPassp.Height = 125
sphPassp.Width = 310
sphPassp.Name = "sphPassp"
lblPasspSeries.Name = "lblPasspSeries"
txtPasspSeries.Name = "txtPasspSeries"
txtPasspNumber.Name = "txtPasspNumber"
lblPasspNumber.Name = "lblPasspNumber"
txtIssueDate.Name = "txtIssueDate"
lblPasspIssueBy.Name = "lblPasspIssueBy"
edtIssueDate.Name = "edtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U510FPB2</uniqueid>
		<timestamp>0</timestamp>
		<class>cntreg</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntReg</objname>
		<parent>frmgoldcardreg</parent>
		<properties>Top = 249
Left = 259
Width = 310
ZOrderSet = 6
Name = "cntReg"
sphPassp.Name = "sphPassp"
lblFlightNo.Name = "lblFlightNo"
txtFligthNo.Name = "txtFligthNo"
txtCompanyCode.Name = "txtCompanyCode"
lblCompanyCode.Name = "lblCompanyCode"
txRegTime.Name = "txRegTime"
lblFlightType.Name = "lblFlightType"
cntIDCtlGridType.txtText.Name = "txtText"
cntIDCtlGridType.cmdShow.Name = "cmdShow"
cntIDCtlGridType.cmdClear.Name = "cmdClear"
cntIDCtlGridType.Name = "cntIDCtlGridType"
lblFlightTime.Name = "lblFlightTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50YKPLL</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmgoldcardreg</parent>
		<properties>Top = 382
Left = 259
Width = 310
ZOrderSet = 7
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 210
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmgoldcardreg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VJOA3</uniqueid>
		<timestamp>0</timestamp>
		<class>frmcardownerinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglemany</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 310
Width = 575
DoCreate = .T.
Name = "frmsinglemany"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Picture = ..\imgbmp\cardmany.jpg
ImgPhoto.Top = 5
ImgPhoto.Name = "ImgPhoto"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS   tnCardID

*28.06.2006 17:14 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*28.06.2006 17:14 -&gt;Ôîðìèðóåì çàãîëîâîê ôîðìû
This.Caption = ALLTRIM(NVL(lvCardOwnerInfoByID.CardTypeNM,[]))+[ ¹]+ALLTRIM(NVL(lvCardOwnerInfoByID.CardNo,[]))
*------------------------------------------------------------------------------

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0XIYE3</uniqueid>
		<timestamp>0</timestamp>
		<class>cntfio</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntFIO</objname>
		<parent>frmsinglemany</parent>
		<properties>Top = 5
Left = 260
Name = "cntFIO"
sphOwnerInfo.Name = "sphOwnerInfo"
txtCltFNM.Name = "txtCltFNM"
txtCltINM.Name = "txtCltINM"
txtCltONM.Name = "txtCltONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglemany</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA12P4DP</uniqueid>
		<timestamp>0</timestamp>
		<class>frmsinglemany</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglemanyident</objname>
		<parent/>
		<properties>DoCreate = .T.
AutoCenter = .T.
Name = "frmsinglemanyident"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.Name = "ImgPhoto"
cntfio.SPHOWNERINFO.Name = "SPHOWNERINFO"
cntfio.TXTCLTFNM.Name = "TXTCLTFNM"
cntfio.TXTCLTINM.Name = "TXTCLTINM"
cntfio.TXTCLTONM.Name = "TXTCLTONM"
cntfio.Name = "cntfio"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnCardID,tnModeIO

*03.07.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tnCardID
*------------------------------------------------------------------------------

*03.07.2006 17:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*03.07.2006 17:06 -&gt;Ñ÷èòûâàåì èíôîðìàöèþ î êàðòå
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*05.07.2006 11:00 -&gt;Ïîêàæåì ðåæèì ðàáîòû
This.txtModeIO.Value = ICASE(tnModeIO=1,[ÂÕÎÄ],tnModeIO=2,[ÂÛÕÎÄ],[ÐÅÆÈÌ ÍÅÈÇÂÅÑÒÅÍ])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*03.07.2006 18:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.07.2006 18:05 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA12QVDS</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcardinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcardinfo1</objname>
		<parent>frmsinglemanyident</parent>
		<properties>Top = 191
Left = 260
Name = "Cntcardinfo1"
Shp1.Name = "Shp1"
txtDeliveryDate.Name = "txtDeliveryDate"
txtExpiredDate.Name = "txtExpiredDate"
lblDeliveryDate.Name = "lblDeliveryDate"
lblExpiredDate.Name = "lblExpiredDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0NSVX2</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtModeIO</objname>
		<parent>frmsinglemanyident</parent>
		<properties>FontSize = 18
Alignment = 2
Enabled = .F.
Height = 32
Left = 265
Top = 273
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtModeIO"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglemanyident</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0W2H7N</uniqueid>
		<timestamp>0</timestamp>
		<class>frmsinglemany</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglemanyreg</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 410
Width = 575
DoCreate = .T.
Closable = .F.
Name = "frmsinglemanyreg"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Left = 5
ImgPhoto.Width = 250
ImgPhoto.ZOrderSet = 3
ImgPhoto.Name = "ImgPhoto"
cntfio.sphOwnerInfo.Name = "sphOwnerInfo"
cntfio.txtCltFNM.ControlSource = "lvPassRegEdit.CltFNM"
cntfio.txtCltFNM.Enabled = .T.
cntfio.txtCltFNM.Name = "txtCltFNM"
cntfio.txtCltINM.ControlSource = "lvPassRegEdit.CltINM"
cntfio.txtCltINM.Enabled = .T.
cntfio.txtCltINM.Name = "txtCltINM"
cntfio.txtCltONM.ControlSource = "lvPassRegEdit.CltONM"
cntfio.txtCltONM.Enabled = .T.
cntfio.txtCltONM.Name = "txtCltONM"
cntfio.TabIndex = 1
cntfio.ZOrderSet = 4
cntfio.Name = "cntfio"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmGoldCardReg._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*04.07.2006 14:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*04.07.2006 14:15 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*04.07.2006 14:15 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:15 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:16 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*04.07.2006 14:16 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
	ELSE
		
		*04.07.2006 14:16 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*04.07.2006 14:16 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*04.07.2006 14:16 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*04.07.2006 14:16 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*04.07.2006 14:16 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvPassRegEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*04.07.2006 14:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 14:17 -&gt;Ñêðûâàåì ôîðìó
.Release()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE cardactivation
LPARAMETERS tnCardID

RETURN

*08.08.2006 10:39 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH tnCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 6, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE carddeactivation
*07.08.2006 19:05 -&gt;Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû ïîëüçîâàòåëåì
IF MESSAGEBOX([Ïîãàñèòü êàðòó?],4+32+256,[Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû]) = 7
	RETURN
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 10:45 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH This.nCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 7, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*09.07.2006 10:17 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = This.nCardID
*------------------------------------------------------------------------------

*08.08.2006 10:51 -&gt;Îáíîâèì âðåìÿ àêòèâàöèè
REQUERY([lvCardRepl])
***
This.cntActCard.Refresh()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
*04.07.2006 14:45 -&gt;Îòêàòûâàåì ðåãèñòðàöèþ
This._HandleCntCancelSaveEvent([CANCEL])
*------------------------------------------------------------------------------

*04.07.2006 14:41 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
LPARAMETERS   tnCardID

*08.08.2006 10:36 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*08.08.2006 10:36 -&gt;Ïîëó÷èì äàííûå ïî êàðòå
_PARAM = tnCardID
***
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*08.08.2006 10:38 -&gt;Ïðîâåðèì, àêòèâèðîâàíà ëè êàðòà
IF ISNULL(lvCardRepl.CardActivationDate)
	This.CardActivation(tnCardID)
	***
	REQUERY([lvCardRepl])
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Äîáàâëÿåì çàïèñü â òàáëèöó äëÿ ðåãèñòðàöèè
APPEND BLANK IN lvPassRegEdit
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Ñîõðàíèì èäåíòèôèêàòîð êàðòû, êëèåíòà, òåêóùåå âðåìÿ
REPLACE ;
	lvPassRegEdit.CardID WITH tnCardID ;
	lvPassRegEdit.PassRegTime WITH DATETIME() ;
IN lvPassRegEdit
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*04.07.2006 15:14 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðûâàåì íåîáõîäèìûå ñïðàâî÷íèêè
USE lvFligthTypeList IN 0
*------------------------------------------------------------------------------

*08.08.2006 10:35 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðîåì LV äëÿ ðåäàêòèðîâàíèÿ èíôîðìàöèè î ðåéñå
USE lvPassRegEdit IN 0 NODATA
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>*_handlecntcancelsaveevent 
*carddeactivation ãàøåíèå êàðòû
*cardactivation 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VK451</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 0
Left = 43
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0W5TNL</uniqueid>
		<timestamp>0</timestamp>
		<class>cntpassp</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPassp1</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 120
Left = 260
TabIndex = 2
ZOrderSet = 5
Name = "cntPassp1"
sphPassp.Top = 1
sphPassp.Left = 0
sphPassp.Height = 125
sphPassp.Width = 310
sphPassp.Name = "sphPassp"
lblPasspSeries.Name = "lblPasspSeries"
txtPasspSeries.Anchor = 0
txtPasspSeries.ControlSource = "lvPassRegEdit.CltPasspSeries"
txtPasspSeries.Enabled = .T.
txtPasspSeries.Name = "txtPasspSeries"
txtPasspNumber.Anchor = 0
txtPasspNumber.ControlSource = "lvPassRegEdit.CltPasspNumber"
txtPasspNumber.Enabled = .T.
txtPasspNumber.Name = "txtPasspNumber"
lblPasspNumber.Name = "lblPasspNumber"
txtIssueDate.Anchor = 0
txtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueDate"
txtIssueDate.Enabled = .T.
txtIssueDate.Name = "txtIssueDate"
lblPasspIssueBy.Name = "lblPasspIssueBy"
edtIssueDate.Anchor = 0
edtIssueDate.Enabled = .T.
edtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueBy"
edtIssueDate.Name = "edtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0W5TNR</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 382
Left = 260
Width = 310
TabIndex = 4
ZOrderSet = 6
Name = "Cntcancelsavehandled1"
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 210
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB0W5TNO</uniqueid>
		<timestamp>0</timestamp>
		<class>cntreg</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntReg</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 249
Left = 260
Width = 310
TabIndex = 3
ZOrderSet = 7
Name = "cntReg"
sphPassp.Name = "sphPassp"
lblFlightNo.Name = "lblFlightNo"
txtFligthNo.Name = "txtFligthNo"
txtCompanyCode.Name = "txtCompanyCode"
lblCompanyCode.Name = "lblCompanyCode"
txRegTime.Name = "txRegTime"
lblFlightType.Name = "lblFlightType"
cntIDCtlGridType.txtText.Name = "txtText"
cntIDCtlGridType.cmdShow.Name = "cmdShow"
cntIDCtlGridType.cmdClear.Name = "cmdClear"
cntIDCtlGridType.Name = "cntIDCtlGridType"
lblFlightTime.Name = "lblFlightTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VI3EV</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDeactCard</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 382
Left = 5
Width = 250
Caption = "Ãàøåíèå ðàçîâîé êàðòû"
Name = "cmdDeactCard"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.CardDeactivation()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0N71GM</uniqueid>
		<timestamp>0</timestamp>
		<class>cntactcard</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>CntActCard</objname>
		<parent>frmsinglemanyreg</parent>
		<properties>Top = 334
Left = 5
Name = "CntActCard"
lblActCard.Name = "lblActCard"
txtActDate.Name = "txtActDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglemanyreg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U50VK451</uniqueid>
		<timestamp>0</timestamp>
		<class>frmcardownerinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglenmany</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 310
Width = 575
DoCreate = .T.
Name = "frmsinglenmany"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Picture = ..\imgbmp\cardnomany.jpg
ImgPhoto.Name = "ImgPhoto"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS   tnCardID

*29.06.2006 09:37 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*29.06.2006 09:37 -&gt;Ôîðìèðóåì çàãîëîâîê ôîðìû
This.Caption = IIF(!ISNULL(lvCardOwnerInfoByID.CltLegalTypeAbbr), ALLTRIM(lvCardOwnerInfoByID.CltLegalTypeAbbr) + [ ], []) + ;
			   ALLTRIM(NVL(lvCardOwnerInfoByID.CltJrdNM,[])) + ;
			   [ - ] + ALLTRIM(NVL(lvCardOwnerInfoByID.CardTypeNM,[]))+[ ¹]+ALLTRIM(NVL(lvCardOwnerInfoByID.CardNo,[]))
*------------------------------------------------------------------------------

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U60KLZVN</uniqueid>
		<timestamp>0</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>sphOwnerInfo</objname>
		<parent>frmsinglenmany</parent>
		<properties>Top = 4
Left = 262
Height = 96
Width = 310
Anchor = 0
SpecialEffect = 0
ZOrderSet = 0
Name = "sphOwnerInfo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U60LYK5O</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltLegalTypeNM</objname>
		<parent>frmsinglenmany</parent>
		<properties>DragMode = 1
FontSize = 14
ControlSource = "lvCardOwnerInfoByID.CltLegalTypeNM"
Enabled = .F.
Height = 55
Left = 267
Top = 8
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtCltLegalTypeNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U312AZ71</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltJrdNM</objname>
		<parent>frmsinglenmany</parent>
		<properties>DragMode = 1
FontSize = 18
Alignment = 0
ControlSource = "lvCardOwnerInfoByID.CltJrdNM"
Enabled = .F.
Height = 32
Left = 267
Top = 63
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtCltJrdNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglenmany</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA13GV9R</uniqueid>
		<timestamp>0</timestamp>
		<class>frmsinglenmany</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglenmanyident</objname>
		<parent/>
		<properties>DoCreate = .T.
AutoCenter = .T.
Name = "frmsinglenmanyident"
sphOwnerInfo.Left = 262
sphOwnerInfo.Name = "sphOwnerInfo"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.Name = "ImgPhoto"
txtCltJrdNM.Name = "txtCltJrdNM"
txtCltLegalTypeNM.Name = "txtCltLegalTypeNM"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnCardID,tnModeIO

*03.07.2006 17:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tnCardID
*------------------------------------------------------------------------------

*03.07.2006 17:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*03.07.2006 17:06 -&gt;Ñ÷èòûâàåì èíôîðìàöèþ î êàðòå
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*05.07.2006 11:00 -&gt;Ïîêàæåì ðåæèì ðàáîòû
This.txtModeIO.Value = ICASE(tnModeIO=1,[ÂÕÎÄ],tnModeIO=2,[ÂÛÕÎÄ],[ÐÅÆÈÌ ÍÅÈÇÂÅÑÒÅÍ])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*03.07.2006 17:04 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.07.2006 17:04 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UC0NTI5S</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>..\..\basis\library\base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtModeIO</objname>
		<parent>frmsinglenmanyident</parent>
		<properties>FontSize = 18
Alignment = 2
Enabled = .F.
Height = 32
Left = 268
Top = 273
Width = 300
DisabledForeColor = 0,0,0
ZOrderSet = 4
Name = "txtModeIO"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UA13LHYF</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcardinfo</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcardinfo1</objname>
		<parent>frmsinglenmanyident</parent>
		<properties>Top = 192
Left = 262
Name = "Cntcardinfo1"
Shp1.Name = "Shp1"
txtDeliveryDate.Name = "txtDeliveryDate"
txtExpiredDate.Name = "txtExpiredDate"
lblDeliveryDate.Name = "lblDeliveryDate"
lblExpiredDate.Name = "lblExpiredDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglenmanyident</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB137GGL</uniqueid>
		<timestamp>0</timestamp>
		<class>frmsinglenmany</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsinglenmanyreg</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 505
Width = 575
DoCreate = .T.
Closable = .F.
Name = "frmsinglenmanyreg"
sphOwnerInfo.Left = 262
sphOwnerInfo.ZOrderSet = 2
sphOwnerInfo.Name = "sphOwnerInfo"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
ImgPhoto.Left = 5
ImgPhoto.ZOrderSet = 4
ImgPhoto.Name = "ImgPhoto"
txtCltJrdNM.TabIndex = 2
txtCltJrdNM.ZOrderSet = 5
txtCltJrdNM.Name = "txtCltJrdNM"
txtCltLegalTypeNM.Left = 267
txtCltLegalTypeNM.TabIndex = 1
txtCltLegalTypeNM.ZOrderSet = 9
txtCltLegalTypeNM.Name = "txtCltLegalTypeNM"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmGoldCardReg._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*04.07.2006 14:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*04.07.2006 14:15 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*04.07.2006 14:15 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:15 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:16 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*04.07.2006 14:16 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
	ELSE
		
		*04.07.2006 14:16 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*04.07.2006 14:16 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*04.07.2006 14:16 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*04.07.2006 14:16 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*04.07.2006 14:16 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvPassRegEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*04.07.2006 14:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 14:17 -&gt;Ñêðûâàåì ôîðìó
.Release()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE cardactivation
LPARAMETERS tnCardID

RETURN

*08.08.2006 10:39 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH tnCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 6, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE carddeactivation
*07.08.2006 19:05 -&gt;Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû ïîëüçîâàòåëåì
IF MESSAGEBOX([Ïîãàñèòü êàðòó?],4+32+256,[Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû]) = 7
	RETURN
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 10:45 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH This.nCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 7, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*09.07.2006 10:17 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = This.nCardID
*------------------------------------------------------------------------------

*08.08.2006 10:51 -&gt;Îáíîâèì âðåìÿ àêòèâàöèè
REQUERY([lvCardRepl])
***
This.cntActCard.Refresh()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
*04.07.2006 14:45 -&gt;Îòêàòûâàåì ðåãèñòðàöèþ
This._HandleCntCancelSaveEvent([CANCEL])
*------------------------------------------------------------------------------

*04.07.2006 14:41 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
LPARAMETERS   tnCardID

*04.07.2006 15:15 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*08.08.2006 10:57 -&gt;Ïîëó÷èì äàííûå ïî êàðòå
_PARAM = tnCardID
***
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*08.08.2006 10:57 -&gt;Ïðîâåðèì, àêòèâèðîâàíà ëè êàðòà
IF ISNULL(lvCardRepl.CardActivationDate)
	This.CardActivation(tnCardID)
	***
	REQUERY([lvCardRepl])
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Äîáàâëÿåì çàïèñü â òàáëèöó äëÿ ðåãèñòðàöèè
APPEND BLANK IN lvPassRegEdit
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Ñîõðàíèì èäåíòèôèêàòîð êàðòû, êëèåíòà, òåêóùåå âðåìÿ
REPLACE ;
	lvPassRegEdit.CardID WITH tnCardID ;
	lvPassRegEdit.PassRegTime WITH DATETIME() ;
IN lvPassRegEdit
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*04.07.2006 15:14 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðûâàåì íåîáõîäèìûå ñïðàâî÷íèêè
USE lvFligthTypeList IN 0
*------------------------------------------------------------------------------

*08.08.2006 10:56 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðîåì LV äëÿ ðåäàêòèðîâàíèÿ èíôîðìàöèè î ðåéñå
USE lvPassRegEdit IN 0 NODATA
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3>*_handlecntcancelsaveevent 
*carddeactivation 
*cardactivation 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13K8UG</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 0
Left = 96
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMI</uniqueid>
		<timestamp>0</timestamp>
		<class>cntpassp</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPassp1</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 217
Left = 262
TabIndex = 4
ZOrderSet = 6
Name = "cntPassp1"
sphPassp.Top = 1
sphPassp.Left = 0
sphPassp.Height = 125
sphPassp.Width = 310
sphPassp.Name = "sphPassp"
lblPasspSeries.Name = "lblPasspSeries"
txtPasspSeries.Anchor = 0
txtPasspSeries.ControlSource = "lvPassRegEdit.CltPasspSeries"
txtPasspSeries.Enabled = .T.
txtPasspSeries.Name = "txtPasspSeries"
txtPasspNumber.Anchor = 0
txtPasspNumber.ControlSource = "lvPassRegEdit.CltPasspNumber"
txtPasspNumber.Enabled = .T.
txtPasspNumber.Name = "txtPasspNumber"
lblPasspNumber.Name = "lblPasspNumber"
txtIssueDate.Anchor = 0
txtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueDate"
txtIssueDate.Enabled = .T.
txtIssueDate.Name = "txtIssueDate"
lblPasspIssueBy.Name = "lblPasspIssueBy"
edtIssueDate.Anchor = 0
edtIssueDate.Enabled = .T.
edtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueBy"
edtIssueDate.Name = "edtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXML</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 478
Left = 262
Width = 310
TabIndex = 6
ZOrderSet = 7
Name = "Cntcancelsavehandled1"
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 210
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMN</uniqueid>
		<timestamp>0</timestamp>
		<class>cntreg</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntreg1</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 346
Left = 262
Width = 310
TabIndex = 5
ZOrderSet = 8
Name = "Cntreg1"
sphPassp.Name = "sphPassp"
lblFlightNo.Name = "lblFlightNo"
txtFligthNo.Name = "txtFligthNo"
txtCompanyCode.Name = "txtCompanyCode"
lblCompanyCode.Name = "lblCompanyCode"
txRegTime.Name = "txRegTime"
lblFlightType.Name = "lblFlightType"
cntIDCtlGridType.txtText.Name = "txtText"
cntIDCtlGridType.cmdShow.Name = "cmdShow"
cntIDCtlGridType.cmdClear.Name = "cmdClear"
cntIDCtlGridType.Name = "cntIDCtlGridType"
lblFlightTime.Name = "lblFlightTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMQ</uniqueid>
		<timestamp>0</timestamp>
		<class>cntfio</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntfio1</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 103
Left = 262
TabIndex = 3
ZOrderSet = 10
Name = "Cntfio1"
sphOwnerInfo.Name = "sphOwnerInfo"
txtCltFNM.ControlSource = "lvPassRegEdit.CltFNM"
txtCltFNM.Enabled = .T.
txtCltFNM.Name = "txtCltFNM"
txtCltINM.ControlSource = "lvPassRegEdit.CltINM"
txtCltINM.Enabled = .T.
txtCltINM.Name = "txtCltINM"
txtCltONM.ControlSource = "lvPassRegEdit.CltONM"
txtCltONM.Enabled = .T.
txtCltONM.Name = "txtCltONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1V915DEQE</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDeactCard</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 478
Left = 5
Width = 250
Caption = "Ãàøåíèå ðàçîâîé êàðòû"
Name = "cmdDeactCard"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.CardDeactivation()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0NKIF7</uniqueid>
		<timestamp>0</timestamp>
		<class>cntactcard</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntActCard</objname>
		<parent>frmsinglenmanyreg</parent>
		<properties>Top = 431
Left = 5
Name = "cntActCard"
lblActCard.Name = "lblActCard"
txtActDate.Name = "txtActDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsinglenmanyreg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB137GGL</uniqueid>
		<timestamp>0</timestamp>
		<class>frmsinglenmany</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsingleorgreg</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 455
Width = 575
DoCreate = .T.
Closable = .F.
Name = "frmsingleorgreg"
sphOwnerInfo.Top = 313
sphOwnerInfo.Left = 5
sphOwnerInfo.Height = 21
sphOwnerInfo.Width = 27
sphOwnerInfo.Visible = .F.
sphOwnerInfo.ZOrderSet = 2
sphOwnerInfo.Name = "sphOwnerInfo"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
ImgPhoto.Left = 5
ImgPhoto.Top = 5
ImgPhoto.ZOrderSet = 4
ImgPhoto.Name = "ImgPhoto"
txtCltJrdNM.Height = 4
txtCltJrdNM.Left = 5
txtCltJrdNM.TabIndex = 12
txtCltJrdNM.Top = 325
txtCltJrdNM.Visible = .F.
txtCltJrdNM.Width = 19
txtCltJrdNM.ZOrderSet = 5
txtCltJrdNM.Name = "txtCltJrdNM"
txtCltLegalTypeNM.Height = 5
txtCltLegalTypeNM.Left = 5
txtCltLegalTypeNM.TabIndex = 11
txtCltLegalTypeNM.Top = 317
txtCltLegalTypeNM.Visible = .F.
txtCltLegalTypeNM.Width = 18
txtCltLegalTypeNM.ZOrderSet = 9
txtCltLegalTypeNM.Name = "txtCltLegalTypeNM"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx
* Class.Module....: frmGoldCardReg._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*04.07.2006 14:15 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*04.07.2006 14:15 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*04.07.2006 14:15 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:15 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
	*04.07.2006 14:16 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*04.07.2006 14:16 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
	ELSE
		
		*04.07.2006 14:16 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*04.07.2006 14:16 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*04.07.2006 14:16 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*04.07.2006 14:16 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*04.07.2006 14:16 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvPassRegEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*04.07.2006 14:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvPassRegEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 14:17 -&gt;Ñêðûâàåì ôîðìó
.Release()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE cardactivation
LPARAMETERS tnCardID

RETURN

*08.08.2006 10:39 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH tnCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 6, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:40 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE carddeactivation
*07.08.2006 19:05 -&gt;Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû ïîëüçîâàòåëåì
IF MESSAGEBOX([Ïîãàñèòü êàðòó?],4+32+256,[Ïîäòâåðæäåíèå ãàøåíèÿ êàðòû]) = 7
	RETURN
ENDIF
*------------------------------------------------------------------------------

*05.07.2006 10:45 -&gt;Îòêðîåì æóðíàë äëÿ çàïèñè ñîáûòèé
USE IN SELECT([lvIOJrnEdit])
USE lvIOJrnEdit IN 0 NODATA
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Äîáàâëÿåì çàïèñü â æóðíàë
APPEND BLANK IN lvIOJrnEdit
*------------------------------------------------------------------------------

*05.07.2006 10:46 -&gt;Ñîõðàíÿåì ñîáûòèå
REPLACE ;
	lvIOJrnEdit.IOJrnCardID WITH This.nCardID, ;
	lvIOJrnEdit.IOActionTypeID WITH 7, ;
	lvIOJrnEdit.User_ WITH oApp.nUserKod ;
IN lvIOJrnEdit
***
TABLEUPDATE(1,.T.,[lvIOJrnEdit])
*------------------------------------------------------------------------------

*09.07.2006 10:17 -&gt;Çàêðîåì æóðíàë
USE IN SELECT([lvIOJrnEdit])
*------------------------------------------------------------------------------

*08.08.2006 10:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = This.nCardID
*------------------------------------------------------------------------------

*08.08.2006 10:51 -&gt;Îáíîâèì âðåìÿ àêòèâàöèè
REQUERY([lvCardRepl])
***
This.cntActCard.Refresh()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Destroy
*04.07.2006 14:45 -&gt;Îòêàòûâàåì ðåãèñòðàöèþ
This._HandleCntCancelSaveEvent([CANCEL])
*------------------------------------------------------------------------------

*04.07.2006 14:41 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------
ENDPROC
PROCEDURE Init
LPARAMETERS   tnCardID

*04.07.2006 15:15 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID)
*------------------------------------------------------------------------------

*08.08.2006 10:57 -&gt;Ïîëó÷èì äàííûå ïî êàðòå
_PARAM = tnCardID
***
REQUERY([lvCardRepl])
*------------------------------------------------------------------------------

*08.08.2006 10:57 -&gt;Ïðîâåðèì, àêòèâèðîâàíà ëè êàðòà
IF ISNULL(lvCardRepl.CardActivationDate)
	This.CardActivation(tnCardID)
	***
	REQUERY([lvCardRepl])
ENDIF
*------------------------------------------------------------------------------

*09.08.2006 18:19 -&gt;Ïîëó÷àåì äàííûå îðåãèñòðàöèè êàðòû
REQUERY([lvPassRegEdit])
*------------------------------------------------------------------------------

*09.08.2006 18:20 -&gt;Åñëè êàðòà çàðåãèñòðèðîâàíà, ïîêàæåì äàííûå ðåãèñòðàöèè
IF RECCOUNT([lvPassRegEdit]) # 0
	RETURN
ENDIF
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Äîáàâëÿåì çàïèñü â òàáëèöó äëÿ ðåãèñòðàöèè
APPEND BLANK IN lvPassRegEdit
*------------------------------------------------------------------------------

*04.07.2006 15:15 -&gt;Ñîõðàíèì èäåíòèôèêàòîð êàðòû, êëèåíòà, òåêóùåå âðåìÿ
REPLACE ;
	lvPassRegEdit.CardID WITH tnCardID ;
	lvPassRegEdit.PassRegTime WITH DATETIME() ;
IN lvPassRegEdit
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*04.07.2006 15:14 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðûâàåì íåîáõîäèìûå ñïðàâî÷íèêè
USE lvFligthTypeList IN 0
USE lvCltJuridicalList IN 0
*------------------------------------------------------------------------------

*08.08.2006 10:56 -&gt;Îòêðîåì LV ñ äàííûìè î êàðòå
USE lvCardRepl IN 0 NODATA
*------------------------------------------------------------------------------

*04.07.2006 15:14 -&gt;Îòêðîåì LV äëÿ ðåäàêòèðîâàíèÿ èíôîðìàöèè î ðåéñå
USE lvPassRegEdit IN 0 NODATA
*------------------------------------------------------------------------------
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>12</reserved2>
		<reserved3>*_handlecntcancelsaveevent 
*carddeactivation 
*cardactivation 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13K8UG</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 0
Left = 96
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMI</uniqueid>
		<timestamp>0</timestamp>
		<class>cntpassp</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntPassp1</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 165
Left = 262
TabIndex = 4
ZOrderSet = 6
Name = "cntPassp1"
sphPassp.Top = 1
sphPassp.Left = 0
sphPassp.Height = 125
sphPassp.Width = 310
sphPassp.Name = "sphPassp"
lblPasspSeries.Name = "lblPasspSeries"
txtPasspSeries.Anchor = 0
txtPasspSeries.ControlSource = "lvPassRegEdit.CltPasspSeries"
txtPasspSeries.Enabled = .T.
txtPasspSeries.Name = "txtPasspSeries"
txtPasspNumber.Anchor = 0
txtPasspNumber.ControlSource = "lvPassRegEdit.CltPasspNumber"
txtPasspNumber.Enabled = .T.
txtPasspNumber.Name = "txtPasspNumber"
lblPasspNumber.Name = "lblPasspNumber"
txtIssueDate.Anchor = 0
txtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueDate"
txtIssueDate.Enabled = .T.
txtIssueDate.Name = "txtIssueDate"
lblPasspIssueBy.Name = "lblPasspIssueBy"
edtIssueDate.Anchor = 0
edtIssueDate.Enabled = .T.
edtIssueDate.ControlSource = "lvPassRegEdit.CltPasspIssueBy"
edtIssueDate.Name = "edtIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXML</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntcancelsavehandled1</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 426
Left = 262
Width = 310
TabIndex = 10
ZOrderSet = 7
Name = "Cntcancelsavehandled1"
cmdCancel.Name = "cmdCancel"
cmdOk.Top = 0
cmdOk.Left = 210
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMN</uniqueid>
		<timestamp>0</timestamp>
		<class>cntreg</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntreg1</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 294
Left = 262
Width = 310
TabIndex = 5
ZOrderSet = 8
Name = "Cntreg1"
sphPassp.Name = "sphPassp"
lblFlightNo.Name = "lblFlightNo"
txtFligthNo.Name = "txtFligthNo"
txtCompanyCode.Name = "txtCompanyCode"
lblCompanyCode.Name = "lblCompanyCode"
txRegTime.Name = "txRegTime"
lblFlightType.Name = "lblFlightType"
cntIDCtlGridType.txtText.Name = "txtText"
cntIDCtlGridType.cmdShow.Name = "cmdShow"
cntIDCtlGridType.cmdClear.Name = "cmdClear"
cntIDCtlGridType.Name = "cntIDCtlGridType"
lblFlightTime.Name = "lblFlightTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UB13CXMQ</uniqueid>
		<timestamp>0</timestamp>
		<class>cntfio</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Cntfio1</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 51
Left = 262
Width = 310
TabIndex = 3
ZOrderSet = 10
Name = "Cntfio1"
sphOwnerInfo.Name = "sphOwnerInfo"
txtCltFNM.ControlSource = "lvPassRegEdit.CltFNM"
txtCltFNM.Enabled = .T.
txtCltFNM.Name = "txtCltFNM"
txtCltINM.ControlSource = "lvPassRegEdit.CltINM"
txtCltINM.Enabled = .T.
txtCltINM.Name = "txtCltINM"
txtCltONM.ControlSource = "lvPassRegEdit.CltONM"
txtCltONM.Enabled = .T.
txtCltONM.Name = "txtCltONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1V915DEQE</uniqueid>
		<timestamp>0</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdDeactCard</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 426
Left = 5
Width = 250
Caption = "Ãàøåíèå ðàçîâîé êàðòû"
TabIndex = 9
Name = "cmdDeactCard"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.CardDeactivation()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VA0NKIF7</uniqueid>
		<timestamp>0</timestamp>
		<class>cntactcard</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntActCard</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 379
Left = 5
Width = 250
TabIndex = 8
Name = "cntActCard"
lblActCard.Name = "lblActCard"
txtActDate.Name = "txtActDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VB0OQGDJ</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOrg</objname>
		<parent>frmsingleorgreg</parent>
		<properties>FontBold = .T.
Caption = "Îðãàíèçàöèÿ"
Left = 262
Top = 5
TabIndex = 1
Name = "lblOrg"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VB0OQGDK</uniqueid>
		<timestamp>0</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIDCtlGridOrg</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Top = 23
Left = 262
Width = 310
TabIndex = 2
_controlsource = lvPassRegEdit.CltJrdID
_controlsourcetype = 1
_rsaliasname = lvCltJuridicalList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "cntIDCtlGridOrg"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 260
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 264
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 287
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VB0P124Z</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblNote</objname>
		<parent>frmsingleorgreg</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå"
Left = 5
Top = 308
TabIndex = 6
Name = "lblNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1VB0P1250</uniqueid>
		<timestamp>0</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtNote</objname>
		<parent>frmsingleorgreg</parent>
		<properties>Left = 5
TabIndex = 7
Top = 324
Width = 250
ControlSource = "lvPassRegEdit.PassRegNote"
_highlightobject = .Parent.lblNote
Name = "edtNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsingleorgreg</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1W30MI8EI</uniqueid>
		<timestamp>0</timestamp>
		<class>frmgoldcardident</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmturnident</objname>
		<parent/>
		<properties>Height = 310
Width = 575
DoCreate = .T.
BorderStyle = 1
MaxButton = .F.
MinButton = .F.
Icon = ..\graphic\login.ico
Name = "frmturnident"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
ImgPhoto.Top = 5
ImgPhoto.ZOrderSet = 3
ImgPhoto.Name = "ImgPhoto"
Cntfio1.sphOwnerInfo.Name = "sphOwnerInfo"
Cntfio1.txtCltFNM.Name = "txtCltFNM"
Cntfio1.txtCltINM.Name = "txtCltINM"
Cntfio1.txtCltONM.Name = "txtCltONM"
Cntfio1.ZOrderSet = 4
Cntfio1.Name = "Cntfio1"
txtModeIO.Top = 273
txtModeIO.ZOrderSet = 5
txtModeIO.Name = "txtModeIO"
Cntcardinfo1.Shp1.Name = "Shp1"
Cntcardinfo1.txtDeliveryDate.Name = "txtDeliveryDate"
Cntcardinfo1.txtExpiredDate.Name = "txtExpiredDate"
Cntcardinfo1.lblDeliveryDate.Name = "lblDeliveryDate"
Cntcardinfo1.lblExpiredDate.Name = "lblExpiredDate"
Cntcardinfo1.Top = 189
Cntcardinfo1.Left = 259
Cntcardinfo1.ZOrderSet = 6
Cntcardinfo1.Name = "Cntcardinfo1"
cntorg.sphOwnerInfo.Name = "sphOwnerInfo"
cntorg.txtOrgNM.Name = "txtOrgNM"
cntorg.txtPostNM.Name = "txtPostNM"
cntorg.Top = 121
cntorg.Enabled = .F.
cntorg.Visible = .F.
cntorg.ZOrderSet = 0
cntorg.Name = "cntorg"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnTurnNo,tnCardID,tnModeIO

*06.09.2006 10:32 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnCardID,tnModeIO)
*------------------------------------------------------------------------------

*06.09.2006 10:32 -&gt;Èçìåíèì çàãîëîâîê ôîðìû
This.Caption = [Òóðíèêåò ¹]+ALLTRIM(STR(tnTurnNo)) + SPACE(5) + [Êàðòà - ] + lvCardRepl.CardNo
*------------------------------------------------------------------------------

*08.09.2006 09:07 -&gt;Ïîêàæåì ðåæèì ðàáîòû
This.txtModeIO.Value = ICASE(tnModeIO=1,[ÂÕÎÄ],tnModeIO=2,[ÂÛÕÎÄ],tnModeIO=3,[ÁËÎÊÈÐÎÂÊÀ],tnModeIO=4,[ÐÀÇÁËÎÊÈÐÎÂÊÀ],[ÐÅÆÈÌ ÍÅÈÇÂÅÑÒÅÍ])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmturnident</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1W20UC594</uniqueid>
		<timestamp>0</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>tmrturn</objname>
		<parent/>
		<properties>Height = 23
Width = 23
nrelaymask = 0
Name = "tmrturn"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS tnRelayMask

*05.09.2006 14:14 -&gt;Ñîõðàíèì ìàñêó âûêëþ÷àåìîãî ðåëå
This.nRelayMask = tnRelayMask
*------------------------------------------------------------------------------

*05.09.2006 14:57 -&gt;Âêëþ÷àåì ðåëå
This.Parent.PCI_P16R16.RelayOn(This.nRelayMask)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Timer
*05.09.2006 14:15 -&gt;Âûêëþ÷àåì ðåëå
This.Parent.PCI_P16R16.RelayOff(This.nRelayMask)
*------------------------------------------------------------------------------

*05.09.2006 14:15 -&gt;Óäàëÿì òàéìåð
This.Parent.RemoveObject(This.Name)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>nrelaymask
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>tmrturn</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U411NDHC</uniqueid>
		<timestamp>927370005</timestamp>
		<class>cnt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntauth</objname>
		<parent/>
		<properties>Visible = .F.
clogfiledir = 
Name = "cntauth"
</properties>
		<protected/>
		<methods>PROCEDURE authorization
*------------------------------------------------------------------------------
* Project.........: Scud.pjx
* Library.........: Auth_v1.vcx.vcx
* Class.Module....: CNTAUTH.AUTHORIZATION
* Called by.......: &lt;This.oleCommProx.OnComm&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðàñïîçíîâàíèå êàðòû è çàíãðóçêà äàííûõ î âëàäåëüöå
*------------------------------------------------------------------------------

*29.06.2006 08:57 -&gt;Ïðîâåðèì, áûë ëè âûïîëíåí âõîä â ñèñòåìó
IF oApp.nUserKod = 0
	RETURN
ENDIF
*------------------------------------------------------------------------------

*28.06.2006 11:45 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcCardCode, ;
		lnSearchCardResult
***
lcCardCode = This.txtCode.Value
IF EMPTY(lcCardCode)
	RETURN
ENDIF
*------------------------------------------------------------------------------

*28.06.2006 11:46 -&gt;Åñëè ÁÄ çàêðûòà - îòêðîåì åå
IF !DBUSED([BASIS])
	OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*07.07.2006 11:07 -&gt;Èùåì êàðòó ïî êîäó
lnSearchCardResult = This.SearchCardByCLU(lcCardCode)
*------------------------------------------------------------------------------

*07.07.2006 11:08 -&gt;Åñëè êàðòà íå íàéäåíà...
IF lnSearchCardResult = 5
	*07.07.2006 11:08 -&gt;...èùåì åå ïî äåêîäèðîâàííîìó êîäó
	
	lnSearchCardResult = This.SearchCardByDecode(lcCardCode)
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*16.07.2006 12:58 -&gt;Îáðàáîòàåì ðåçóëüòàòû àâòîðèçàöèè
This.AuthResult(lnSearchCardResult,lcCardCode)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE authresult
LPARAMETERS tnAuthResult, ;
			tcCardCode

*16.07.2006 13:02 -&gt;Àíàëèçèðóåì ðåçóëüòàòû àâòîðèçàöèè
DO CASE
	CASE tnAuthResult = 0
	
		*16.07.2006 13:05 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([Âîçìîæíà ðàáîòà ñ êàðòîé],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
	CASE tnAuthResult = 4
	
		*05.07.2006 10:54 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([Ñðîê äåéñòâèÿ êàðòû èñòåê],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
	CASE tnAuthResult = 5
	
		*05.07.2006 10:54 -&gt;Ïîêàæåì ñîîáùåíèå
		MESSAGEBOX([C äàííûì âèäîì êàðò ðàáîòà íåâîçìîæíà],16,[Àâòîðèçàöèÿ âëàäåëüöà êàðòû],3000)
		*------------------------------------------------------------------------------
		
ENDCASE
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*16.07.2006 13:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 13:23 -&gt;Ïîëó÷èì èìÿ êàòàëîãà äëÿ çàïèñè Log-ôàéëà
This.cLogFileDir = ADDBS(oRes.GetParam([SCUD],[LOG_FILE_DIR]))
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE searchcardbyclu
LPARAMETERS	tcCardCode

*28.06.2006 11:45 -&gt;Ïîëó÷èì äàííûå ïî êàðòå
_PARAM1 = tcCardCode
_PARAM2 = VAL(oRes.GetParam([SCUD],[PLACE_TYPE]))
***
USE IN SELECT([lvSearchCard])
USE lvCardViewByCLU IN 0 ALIAS lvSearchCard
*------------------------------------------------------------------------------

*29.06.2006 09:02 -&gt;Ïðîâåðèì âîçìîæíîñòü ðàáîòû ñ êàðòîé
IF RECCOUNT([lvSearchCard])#0
	RETURN 0
ELSE
	RETURN 5
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE searchcardbydecode
LPARAMETERS	tcCardCode

*28.06.2006 11:45 -&gt;Ïîëó÷èì äàííûå ïî êàðòå
_PARAM1 = VAL([0x]+SUBSTR(tcCardCode,4,8))
_PARAM2 = VAL(oRes.GetParam([SCUD],[PLACE_TYPE]))
***
USE IN SELECT([lvSearchCard])
USE lvCardViewByDecode IN 0 ALIAS lvSearchCard
*------------------------------------------------------------------------------

*29.06.2006 09:02 -&gt;Ïðîâåðèì âîçìîæíîñòü ðàáîòû ñ êàðòîé
IF RECCOUNT([lvSearchCard])#0
	RETURN 0
ELSE
	RETURN 5
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>clogfiledir èìÿ êàòàëîãà äëÿ çàïèñè ëîãîâ
*authorization èäåíòèôèêàöèÿ êàðòû è çàïóñê ôîðìû ñ äàííûìè î âëàäåëüöå
*searchcardbyclu 
*searchcardbydecode 
*authresult Îáðàáîòêà ðåçóëüòàòîâ àâòîðèçàöèè
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U411PYBJ</uniqueid>
		<timestamp>0</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>oleCommProx</objname>
		<parent>cntauth</parent>
		<properties>Top = 1
Left = 1
Height = 38
Width = 39
cbindobj = This.Parent.txtCode
Name = "oleCommProx"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*27.06.2006 17:57 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

This.Parent.Authorization()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANBQ+HwLCMgBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U411PYD0</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCode</objname>
		<parent>cntauth</parent>
		<properties>Height = 23
Left = 1
Top = 38
Visible = .F.
Width = 38
Name = "txtCode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>cntauth</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
