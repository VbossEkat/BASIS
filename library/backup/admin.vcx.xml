<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0SM77I</uniqueid>
		<timestamp>914258533</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdmessage</objname>
		<parent/>
		<properties>ColumnCount = 3
RecordSource = "lvUserMsgView"
ScrollBars = 2
Width = 585
Name = "grdmessage"
Column1.FontBold = .T.
Column1.ControlSource = "lvUserMsgView.UserLogin"
Column1.Width = 130
Column1.Name = "Column1"
Column2.ControlSource = "lvUserMsgView.UserMsgCont"
Column2.Width = 303
Column2.Name = "Column2"
Column3.ControlSource = "lvUserMsgView.UserMsgCreateDate"
Column3.Width = 120
Column3.Name = "Column3"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*30.03.2007 10:04 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*30.03.2007 10:04 -&gt;Ïîêðàñèì íåàêòèâíûå ñåññèè
This.SetAll([DynamicBackColor],[IIF(lvUserMsgView.MsgType = 1,]+ALLTRIM(STR(This.Column1.TxtGrd1.BackColor))+[,RGB(192,192,192))],[Column])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V47I0</uniqueid>
		<timestamp>914191559</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmessage.Column1</parent>
		<properties>FontBold = .T.
Caption = "Àâòîð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V6GK3</uniqueid>
		<timestamp>914248114</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmessage.Column1</parent>
		<properties>FontBold = .T.
Left = 37
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V47I2</uniqueid>
		<timestamp>914191559</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmessage.Column2</parent>
		<properties>FontBold = .T.
Caption = "Ñîäåðæàíèå"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V6GK5</uniqueid>
		<timestamp>914191559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmessage.Column2</parent>
		<properties>Left = 9
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V47I4</uniqueid>
		<timestamp>914191559</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmessage.Column3</parent>
		<properties>FontBold = .T.
Caption = "Âðåìÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0V6GK7</uniqueid>
		<timestamp>914191559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmessage.Column3</parent>
		<properties>Left = 29
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdmessage</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>914712903</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmoduleedit</objname>
		<parent/>
		<properties>Height = 90
Width = 350
DoCreate = .T.
AutoCenter = .T.
Caption = "Ìîäóëü"
Closable = .F.
MaxButton = .F.
MinButton = .F.
KeyPreview = .T.
WindowType = 1
crequestedoperation = 
Name = "frmmoduleedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Left = 22
cstresizable.Height = 17
cstresizable.Width = 15
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmModuleEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*05.04.2007 12:42 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*05.04.2007 12:42 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*05.04.2007 12:42 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cRequestedOperation = [DELE]
		
		*13.01.2005 14:40 -&gt; Óäàëèì çàïèñü
		DELETE IN lvModuleEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:42 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:42 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvModuleEdit])
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:42 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*05.04.2007 12:42 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*05.04.2007 12:42 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cRequestedOperation ,[EDIT],[DELE])

				*05.04.2007 12:42 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cRequestedOperation == [ADD]

				*05.04.2007 12:42 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvModuleEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*05.04.2007 12:43 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*05.04.2007 12:43 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*05.04.2007 12:43 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*05.04.2007 12:43 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*05.04.2007 12:43 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvModuleEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*05.04.2007 12:43 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*05.04.2007 12:43 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvModuleEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*05.04.2007 12:43 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmModuleEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcRequestedOperation,tuParam1

*05.04.2007 12:36 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*12.05.2004 00:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*05.04.2007 12:36 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cRequestedOperation = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*05.04.2007 12:36 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cRequestedOperation == [ADD]

		*12.05.2004 00:32 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		SELECT lvModuleEdit
		APPEND BLANK
		*------------------------------------------------------------------------------

	CASE INLIST(.cRequestedOperation,[DELE],[EDIT],[INFO])

		*05.04.2007 12:37 -&gt;Çàãðóçèì äàííûå ñóùåñòâóþùåãî ìîäóëÿ
		_PARAM = tuParam1
		***
		REQUERY([lvModuleEdit])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*05.04.2007 12:39 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cRequestedOperation = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])
	CASE .cRequestedOperation = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])
	CASE .cRequestedOperation = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		
*13.01.2005 14:16 -&gt; Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cRequestedOperation = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmModuleEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*-------------------------------------------------------

*05.04.2007 12:32 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*05.04.2007 12:32 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*05.04.2007 12:32 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ (ïóñòîé)
USE lvModuleEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModuleEdit])
*------------------------------------------------------------------------------

*05.04.2007 12:32 -&gt; Îòêðîåì ñïðàâî÷íèêè
USE lvModuleTypeView IN 0
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>uretval &lt;public/runtime&gt; Çíà÷åíèå, êîòîðîå âîçâðàùàåòñÿ âî âûçûâàâøóþ ïðîöåäóðó ïîñëå ñêðûòèÿ ôîðìû.
crequestedoperation &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
*_handlecntcancelsaveevent &lt;public/user/nodefault&gt; Îáðàáîòêà íàæàòèÿ íà êëàâèøè êîíòåéíåðà CntCancelSave. Ôîðìèðîâàíèå çíà÷åíèÿ ñâîéñòâ .uRetVal ïåðåä ñêðûòèåì ôîðìû.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB13G3TM</uniqueid>
		<timestamp>914712903</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmmoduleedit</parent>
		<properties>Top = 61
Left = 143
TabIndex = 1
ZOrderSet = 0
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C17ZLMD</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmmoduleedit</parent>
		<properties>Top = 0
Left = 5
Height = 17
Width = 15
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10034Z</uniqueid>
		<timestamp>914712903</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblQueryParam</objname>
		<parent>frmmoduleedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï:"
Left = 5
Top = 8
TabIndex = 11
ZOrderSet = 11
Name = "lblQueryParam"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOO</uniqueid>
		<timestamp>914712903</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridModuleTypeList</objname>
		<parent>frmmoduleedit</parent>
		<properties>Top = 5
Left = 98
Width = 250
TabIndex = 12
_controlsourcetype = 1
_controlsource = lvModuleEdit.ModuleTypeID
_rsaliasname = lvModuleTypeView
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "cntIdCtlGridModuleTypeList"
txtText._highlightobject = .Parent.Parent.lblQueryParam
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200QD1NN</uniqueid>
		<timestamp>914712903</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblModuleNM</objname>
		<parent>frmmoduleedit</parent>
		<properties>FontBold = .T.
Caption = "Íàèìåíîâàíèå:"
Left = 5
Top = 36
TabIndex = 11
ZOrderSet = 11
Name = "lblModuleNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200QGK51</uniqueid>
		<timestamp>914712866</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtModuleNM</objname>
		<parent>frmmoduleedit</parent>
		<properties>ControlSource = "lvModuleEdit.ModuleNM"
Left = 98
Top = 33
Width = 250
Name = "txtModuleNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmoduleedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0V61PJ</uniqueid>
		<timestamp>914717108</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdmodule</objname>
		<parent/>
		<properties>ColumnCount = 2
Height = 200
RecordSource = "lvModuleView"
ScrollBars = 2
Width = 250
_dynamicimagealias = lvModuleBmps
_dynamicimagecolumnindex = 1
_dynamicimagefieldnamefilename = BmpFileNM
_dynamicimagefieldnameindex = BmpID
Name = "grdmodule"
Column1.ControlSource = "lvModuleView.BmpID"
Column1.Width = 18
Column1.Name = "Column1"
Column2.ControlSource = "lvModuleView.ModuleNM"
Column2.Width = 201
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdModule._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî ìîäóëÿ.
*-------------------------------------------------------

*05.04.2007 12:48 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*05.04.2007 12:49 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîãî ìîäóëÿ
lnResAdding = oMgrAdmin.Do([MODULE],[ADD])
*------------------------------------------------------------------------------

*05.04.2007 12:50 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*05.04.2007 12:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:50 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì êëèåíòå
	USE IN SELECT([lvModuleRepl])
	_PARAM = lnId
	USE lvModuleRepl IN 0
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:29 -&gt;Îáíîâèì äàííûå â lvModuleView
	SELECT lvModuleRepl
	SCATTER TO laReplaceArray
	SELECT lvModuleView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*05.04.2007 12:50 -&gt;Çàêðîåì Alis
	USE IN SELECT([lvModuleRepl])
	*------------------------------------------------------------------------------
		
	*05.04.2007 12:51 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvModuleView
	LOCATE FOR lvModuleView.ModuleID = lnID
	*------------------------------------------------------------------------------

	*05.04.2007 12:51 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*05.04.2007 12:51 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:51 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdModule._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå ìîäóëÿ.
*-------------------------------------------------------

*05.04.2007 12:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvModuleView.ModuleID
*------------------------------------------------------------------------------

*05.04.2007 12:53 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrAdmin.Do([MODULE],[DELE],lnId)
*------------------------------------------------------------------------------

*05.04.2007 12:53 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes
	
	*05.04.2007 12:53 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:53 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvModuleView
	DELETE FOR lvModuleView.ModuleID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:53 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:53 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersion._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå ìîäóëÿ.
*-------------------------------------------------------

*05.04.2007 12:54 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnId, ;
		luResEditing
***
lnId = lvModuleView.ModuleID
*------------------------------------------------------------------------------

*05.04.2007 12:55 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ ìîäóëÿ
luResEditing = oMgrAdmin.Do([MODULE],[EDIT],lnId)
*------------------------------------------------------------------------------

*05.04.2007 12:55 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp;äàííûå î ìîäóëå èçìåíåíû
	
	*05.04.2007 12:56 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*05.04.2007 12:56 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå äîêóìåíòà
	IF USED([lvModuleRepl])
		USE IN lvModuleRepl
	ENDIF
	_PARAM = lnId
	USE lvModuleRepl IN 0
	*------------------------------------------------------------------------------

	*05.04.2007 12:56 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvModuleRepl
	SCATTER TO laReplaceArray
	SELECT lvModuleView
	LOCATE FOR lvModuleView.ModuleID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*05.04.2007 12:56 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvModuleRepl
	*------------------------------------------------------------------------------

	*05.04.2007 12:57 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*05.04.2007 12:57 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*05.04.2007 12:57 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdModule._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î ìîäóëå.
*-------------------------------------------------------

*05.04.2007 12:57 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î ìîäóëå
oMgrAdmin.Do([MODULE],[INFO],lvModuleView.ModuleID)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0V6XO4</uniqueid>
		<timestamp>914709450</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmodule.Column1</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0VE66N</uniqueid>
		<timestamp>914584811</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmodule.Column1</parent>
		<properties>Left = 13
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200OMA8L</uniqueid>
		<timestamp>914709450</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmodule.Column2</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Ìîäóëè"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200PRDKB</uniqueid>
		<timestamp>914710565</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmodule.Column2</parent>
		<properties>Left = 138
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdmodule</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XKJUC</uniqueid>
		<timestamp>914784380</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdversion</objname>
		<parent/>
		<properties>ColumnCount = 2
RecordSource = "lvVersionView"
ScrollBars = 2
Width = 155
nmoduleid = 0
cmodulenm = 
lmoduleispacked = .F.
Name = "grdversion"
Column1.ControlSource = "lvVersionView.ModuleVersion"
Column1.Width = 105
Column1.Name = "Column1"
Column2.ControlSource = "lvVersionView.IsUsed"
Column2.Width = 19
Column2.ReadOnly = .T.
Column2.Sparse = .F.
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersion._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîé âåðñèè.
*-------------------------------------------------------

*03.04.2007 17:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*03.04.2007 17:26 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé êàññû
lnResAdding = oMgrAdmin.Do([VERSION],[ADD],This.nModuleID,This.cModuleNM,This.lModuleIsPacked)
*------------------------------------------------------------------------------

*03.04.2007 17:29 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*03.04.2007 17:29 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*17.01.2005 15:31 -&gt; Ïîëó÷èì äàííûå î äîáàâëåííîì êëèåíòå
	USE IN SELECT([lvVersionViewRepl])
	_PARAM = lnId
	USE lvVersionViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:29 -&gt;Îáíîâèì äàííûå â lvVersionView
	SELECT lvVersionViewRepl
	SCATTER TO laReplaceArray
	SELECT lvVersionView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*03.04.2007 17:30 -&gt;Çàêðîåì Alis
	USE IN SELECT([lvVersionViewRepl])
	*------------------------------------------------------------------------------
		
	*03.04.2007 17:30 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvVersionView
	LOCATE FOR lvVersionView.ModuleVersionID = lnID
	*------------------------------------------------------------------------------

	*03.04.2007 17:30 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*03.04.2007 17:30 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:31 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersion._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå âåðñèè ìîäóëÿ.
*-------------------------------------------------------

*04.04.2007 10:05 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvVersionView.ModuleVersionID
*------------------------------------------------------------------------------

*04.04.2007 10:07 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrAdmin.Do([VERSION],[DELE],lnID,This.cModuleNM,This.lModuleIsPacked)
*------------------------------------------------------------------------------

*04.04.2007 10:10 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes
	
	*04.04.2007 10:12 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvVersionView
	DELETE FOR lvVersionView.ModuleVersionID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersion._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î âåðñèè ìîäóëÿ.
*-------------------------------------------------------

*04.04.2007 09:53 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResEditing, ;
		lnID
***
lnID = lvVersionView.ModuleVersionID
*------------------------------------------------------------------------------

*04.04.2007 09:54 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ âåðñèè ìîäóëÿ
luResEditing = oMgrAdmin.Do([VERSION],[EDIT],lnID,This.cModuleNM,This.lModuleIsPacked)
*------------------------------------------------------------------------------

*04.04.2007 09:54 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp;äàííûå î âåðñèè èçìåíåíû
	
	*04.04.2007 09:55 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*04.04.2007 09:55 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå äîêóìåíòà
	IF USED([lvVersionViewRepl])
		USE IN lvVersionViewRepl
	ENDIF
	_PARAM = lnID
	USE lvVersionViewRepl IN 0
	*------------------------------------------------------------------------------

	*04.04.2007 09:55 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvVersionViewRepl
	SCATTER TO laReplaceArray
	SELECT lvVersionView
	LOCATE FOR lvVersionView.ModuleVersionID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*04.04.2007 09:56 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvVersionViewRepl
	*------------------------------------------------------------------------------

	*04.04.2007 09:56 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*04.04.2007 09:56 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*04.04.2007 09:56 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersion._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î âåðñèè ìîäóëÿ.
*-------------------------------------------------------

*04.04.2007 09:58 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î âåðñèè ìîäóëÿ
luResEditing = oMgrAdmin.Do([VERSION],[INFO],lvVersionView.ModuleVersionID,This.cModuleNM,This.lModuleIsPacked)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE nmoduleid_assign
LPARAMETERS lnNewVal

*04.04.2007 15:34 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

This.nModuleID = lnNewVal
_PARAM = lnNewVal
REQUERY(This.RecordSource)
This.Refresh()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>nmoduleid èäåíòèôèêàòîð ìîäóëÿ
cmodulenm èìÿ ìîäóëÿ
lmoduleispacked Àïðèçíàê íåîáõîäèìîñòè óïàêîâêè ìîäóëÿ
*nmoduleid_assign 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XMWZI</uniqueid>
		<timestamp>914587050</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversion.Column1</parent>
		<properties>FontBold = .T.
Caption = "Âåðñèÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XOIR8</uniqueid>
		<timestamp>914587050</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdversion.Column1</parent>
		<properties>Left = 37
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XMWZK</uniqueid>
		<timestamp>914587050</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversion.Column2</parent>
		<properties>Caption = " "
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XPW1X</uniqueid>
		<timestamp>914642414</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>CHK1</objname>
		<parent>grdversion.Column2</parent>
		<properties>Top = 35
Left = 20
Alignment = 2
Caption = " "
SpecialEffect = 1
ReadOnly = .T.
Name = "CHK1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdversion</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IA0O65KW</uniqueid>
		<timestamp>914785340</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmversionedit</objname>
		<parent/>
		<properties>Height = 175
Width = 545
DoCreate = .T.
Caption = "Âåðñèÿ ìîäóëÿ ÏÎ"
cmode = 
Name = "frmversionedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*03.04.2007 17:19 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*03.04.2007 17:19 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*03.04.2007 17:19 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*13.01.2005 14:40 -&gt; Óäàëèì çàïèñü
		DELETE IN lvModuleVersionEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:19 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:20 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvModuleVersionEdit])
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:20 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*03.04.2007 17:20 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode,[EDIT],[DELE])

				*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvModuleVersionEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*03.04.2007 17:20 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:20 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*03.04.2007 17:20 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*03.04.2007 17:21 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*03.04.2007 17:21 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvModuleVersionEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:21 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*03.04.2007 17:21 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvModuleVersionEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*03.04.2007 17:21 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcCommand, tnModuleID, tnModuleNM, tlIsPacked

*12.05.2004 00:34 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*03.04.2007 17:17 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*03.04.2007 17:17 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcCommand))
This.grdVersionFile.IsPacked = tlIsPacked
*------------------------------------------------------------------------------

*03.04.2007 17:17 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode==[ADD]
		
		*03.04.2007 17:17 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		APPEND BLANK IN lvModuleVersionEdit
		*------------------------------------------------------------------------------
		
		*06.09.2005 09:26 -&gt;Ñðîõðàíèì èäåíòèôèêàòîð ìîäóëÿ
		REPLACE lvModuleVersionEdit.ModuleID WITH tnModuleID
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cMode,[EDIT],[INFO],[DELE])
		
		*03.04.2007 17:18 -&gt;Çàãðóçèì äàííûå î âåðñèè
		_PARAM = tnModuleID
		***
		REQUERY([lvModuleVersionEdit])
		*------------------------------------------------------------------------------

ENDCASE
***
This.grdVersionFile.nVersionID = lvModuleVersionEdit.ModuleVersionID
*------------------------------------------------------------------------------

*.Icon = FULLPATH([???.ico])
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		
*13.01.2005 14:16 -&gt; Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
***
This.txtModuleNM.Value = tnModuleNM
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå âåðñèè ìîäóëÿ
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàññ (ïóñòîé)
USE lvModuleVersionEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvModuleVersionEdit])
***
USE lvVersionFileView IN 0 NODATA
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3>cmode &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ðåäàêòèðîâàíèå è äîáàâëåíèå âåðñèé</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_22011PDXD</uniqueid>
		<timestamp>914783820</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtModuleNM</objname>
		<parent>frmversionedit</parent>
		<properties>Enabled = .F.
Height = 23
Left = 5
ReadOnly = .T.
TabIndex = 6
Top = 5
Width = 163
DisabledForeColor = 0,0,0
ZOrderSet = 0
_highlightobject = .Parent.lblVersion
Name = "txtModuleNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10034Z</uniqueid>
		<timestamp>914722369</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtVersion</objname>
		<parent>frmversionedit</parent>
		<properties>ControlSource = "lvModuleVersionEdit.ModuleVersion"
Height = 23
Left = 229
TabIndex = 1
Top = 5
Width = 100
ZOrderSet = 0
_highlightobject = .Parent.lblVersion
Name = "txtVersion"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KX0VLUOO</uniqueid>
		<timestamp>914785340</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkVersionIsUsed</objname>
		<parent>frmversionedit</parent>
		<properties>Top = 8
Left = 440
FontBold = .T.
Alignment = 0
Caption = "Èñïîëüçóåòñÿ"
ControlSource = "lvModuleVersionEdit.IsUsed"
TabIndex = 2
ZOrderSet = 1
Name = "chkVersionIsUsed"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KT0W0MLJ</uniqueid>
		<timestamp>914785340</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmversionedit</parent>
		<properties>Top = 147
Left = 335
TabIndex = 4
ZOrderSet = 4
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>914785340</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblVersion</objname>
		<parent>frmversionedit</parent>
		<properties>FontBold = .T.
Caption = "Âåðñèÿ:"
Left = 174
Top = 8
TabIndex = 5
ZOrderSet = 9
Name = "lblVersion"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZWUKW</uniqueid>
		<timestamp>914784731</timestamp>
		<class>grdversionfile</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdVersionFile</objname>
		<parent>frmversionedit</parent>
		<properties>Height = 110
Left = 5
TabIndex = 3
Top = 32
Width = 535
Name = "grdVersionFile"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.Name = "Column3"
Column4.Header1.Name = "Header1"
Column4.Txtgrd1.Name = "Txtgrd1"
Column4.Name = "Column4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmversionedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 65, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>914980601</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmwstypeedit</objname>
		<parent/>
		<properties>Height = 63
Width = 320
DoCreate = .T.
AutoCenter = .T.
Caption = "Òèïû ðàáî÷èõ ìåñò"
Closable = .F.
MaxButton = .F.
MinButton = .F.
KeyPreview = .T.
WindowType = 1
cmode = 
Name = "frmwstypeedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Left = 22
cstresizable.Height = 17
cstresizable.Width = 15
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmWSTypeEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*09.04.2007 12:45 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*09.04.2007 12:45 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*09.04.2007 12:45 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*09.04.2007 12:46 -&gt;Óäàëèì çàïèñü
		DELETE IN lvWSTypeEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:46 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:46 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvWSTypeEdit])
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:46 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*09.04.2007 12:46 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*09.04.2007 12:46 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode ,[EDIT],[DELE])

				*09.04.2007 12:46 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*09.04.2007 12:46 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvWSTypeEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*09.04.2007 12:46 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*09.04.2007 12:46 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*09.04.2007 12:46 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*09.04.2007 12:46 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*09.04.2007 12:46 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvWSTypeEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*09.04.2007 12:47 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*09.04.2007 12:47 -&gt;&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvWSTypeEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*09.04.2007 12:47 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmWSTypeEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcRequestedOperation,tuParam1

*09.04.2007 12:35 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*09.04.2007 12:35 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*09.04.2007 12:35 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*09.04.2007 12:35 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode == [ADD]

		*09.04.2007 12:41 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		SELECT lvWSTypeEdit
		APPEND BLANK
		*------------------------------------------------------------------------------

	CASE INLIST(.cMode,[DELE],[EDIT],[INFO])

		*12.05.2004 00:31 -&gt;Çàãðóçèì äàííûå ñóùåñòâóþùåé ôóíêöèè
		_PARAM = tuParam1
		***
		REQUERY([lvWSTypeEdit])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*09.04.2007 12:43 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmWSTypeEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*-------------------------------------------------------

*09.04.2007 12:40 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*09.04.2007 12:40 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*09.04.2007 12:40 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ (ïóñòîé)
USE lvWSTypeEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvWSTypeEdit])
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>uretval &lt;public/runtime&gt; Çíà÷åíèå, êîòîðîå âîçâðàùàåòñÿ âî âûçûâàâøóþ ïðîöåäóðó ïîñëå ñêðûòèÿ ôîðìû.
cmode &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
*_handlecntcancelsaveevent &lt;public/user/nodefault&gt; Îáðàáîòêà íàæàòèÿ íà êëàâèøè êîíòåéíåðà CntCancelSave. Ôîðìèðîâàíèå çíà÷åíèÿ ñâîéñòâ .uRetVal ïåðåä ñêðûòèåì ôîðìû.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB13G3TM</uniqueid>
		<timestamp>914980601</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmwstypeedit</parent>
		<properties>Top = 33
Left = 110
TabIndex = 3
ZOrderSet = 0
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C17ZLMD</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmwstypeedit</parent>
		<properties>Top = 0
Left = 5
Height = 17
Width = 15
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOK</uniqueid>
		<timestamp>914980601</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblWSType</objname>
		<parent>frmwstypeedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 11
Name = "lblWSType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2240QZTZK</uniqueid>
		<timestamp>914980499</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtWSType</objname>
		<parent>frmwstypeedit</parent>
		<properties>ControlSource = "lvWSTypeEdit.WSTypeNM"
Height = 23
Left = 37
TabIndex = 2
Top = 5
Width = 278
Name = "txtWSType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmwstypeedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0SZ2EE</uniqueid>
		<timestamp>915034221</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdmodulelist</objname>
		<parent/>
		<properties>ColumnCount = 1
RecordSource = "lvWSTypeModuleView"
ScrollBars = 2
Width = 230
nwstypeid = 0
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;;ADD;INFO;DELE;COPY;;FIND;;PRNDOC;PRNREP;;EXCEL
_handledstandartmsgpromptlist = ;;;;;Äîáàâèòü;Ïðîñìîòð;Óäàëèòü;Ñêîïèðîâàòü;\-;Ïîèñê;\-;Ïîäãîòîâèòü äîêóìåíò;Ïîäãîòîâèòü îò÷åò;\-;Ýêñïîðò â Excel
Name = "grdmodulelist"
Column1.ControlSource = "lvWSTypeModuleView.ModuleNM"
Column1.Width = 200
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdWSTModuleList._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîé ïðèâÿçêè.
*-------------------------------------------------------

*09.04.2007 16:21 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*09.04.2007 16:21 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé ïðèâÿçêè
lnResAdding = oMgrAdmin.Do([WSMODULE],[ADD],This.nWSTypeID)
*------------------------------------------------------------------------------

*09.04.2007 16:22 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*09.04.2007 16:22 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM1, ;
			_PARAM2
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*09.04.2007 10:21 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì òèïå ðàáî÷åé ñòàíöèè
	USE IN SELECT([lvWSTypeModuleViewRepl])
	_PARAM1 = This.nWSTypeID
	_PARAM2 = lnId
	USE lvWSTypeModuleViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:50 -&gt;Îáíîâèì äàííûå â lvWSTypeModuleView
	SELECT lvWSTypeModuleViewRepl
	SCATTER TO laReplaceArray
	SELECT lvWSTypeModuleView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*09.04.2007 17:40 -&gt;Çàêðîåì Alis
	USE IN SELECT([lvWSTypeModuleViewRepl])
	*------------------------------------------------------------------------------
		
	*09.04.2007 17:40 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvWSTypeModuleView
	LOCATE FOR lvWSTypeModuleView.ModuleID = lnID
	*------------------------------------------------------------------------------

	*09.04.2007 17:40 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*09.04.2007 17:41 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*09.04.2007 17:41 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdModuleList._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå òèïà ðàáî÷åé ñòàíöèè.
*-------------------------------------------------------

*10.04.2007 09:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvWSTypeModuleView.ModuleID
*------------------------------------------------------------------------------

*10.04.2007 09:12 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrAdmin.Do([WSMODULE],[DELE],This.nWSTypeID,lnID)
*------------------------------------------------------------------------------

*10.04.2007 09:12 -&gt;Îáðàáîòàåì ðåçóëüòàòû óäàâëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes
	
	*10.04.2007 09:12 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*10.04.2007 09:13 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvWSTypeModuleView
	DELETE FOR lvWSTypeModuleView.ModuleID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*10.04.2007 09:13 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*10.04.2007 09:13 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
oMgrAdmin.Do([WSMODULE],[INFO],This.nWSTypeID,lvWSTypeModuleView.ModuleID)
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE nwstypeid_assign
LPARAMETERS lnNewVal

*04.04.2007 15:34 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

This.nWSTypeID = lnNewVal
_PARAM = lnNewVal
REQUERY(This.RecordSource)
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>nwstypeid
*nwstypeid_assign 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0TDT76</uniqueid>
		<timestamp>914648491</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdmodulelist.Column1</parent>
		<properties>FontBold = .T.
Caption = "Ìîäóëè"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0TEPS9</uniqueid>
		<timestamp>914648491</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdmodulelist.Column1</parent>
		<properties>Left = 37
Top = 35
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdmodulelist</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2280WGF97</uniqueid>
		<timestamp>915245131</timestamp>
		<class>frmmessenger</class>
		<classloc>admin.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmessengerall</objname>
		<parent/>
		<properties>Height = 85
Width = 390
DoCreate = .T.
Caption = "Îòïðàâêà ãðóïïîâîãî ñîîáùåíèÿ"
Name = "frmmessengerall"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
cntIdCtlGridUA.txtText.Name = "txtText"
cntIdCtlGridUA.cmdShow.Name = "cmdShow"
cntIdCtlGridUA.cmdClear.Name = "cmdClear"
cntIdCtlGridUA.Top = 60
cntIdCtlGridUA.Left = 67
cntIdCtlGridUA.Name = "cntIdCtlGridUA"
grdmessage.Column1.Header1.Name = "Header1"
grdmessage.Column1.Txtgrd1.Enabled = .F.
grdmessage.Column1.Txtgrd1.Visible = .F.
grdmessage.Column1.Txtgrd1.Name = "Txtgrd1"
grdmessage.Column1.Enabled = .F.
grdmessage.Column1.Visible = .F.
grdmessage.Column1.Name = "Column1"
grdmessage.Column2.Header1.Name = "Header1"
grdmessage.Column2.Txtgrd1.Enabled = .F.
grdmessage.Column2.Txtgrd1.Visible = .F.
grdmessage.Column2.Txtgrd1.Name = "Txtgrd1"
grdmessage.Column2.Enabled = .F.
grdmessage.Column2.Visible = .F.
grdmessage.Column2.Name = "Column2"
grdmessage.Column3.Header1.Name = "Header1"
grdmessage.Column3.Txtgrd1.Enabled = .F.
grdmessage.Column3.Txtgrd1.Visible = .F.
grdmessage.Column3.Txtgrd1.Name = "Txtgrd1"
grdmessage.Column3.Enabled = .F.
grdmessage.Column3.Visible = .F.
grdmessage.Column3.Name = "Column3"
grdmessage.Enabled = .F.
grdmessage.Height = 20
grdmessage.Left = 0
grdmessage.Top = 0
grdmessage.Visible = .F.
grdmessage.Width = 20
grdmessage.Name = "grdmessage"
edtMsg.Height = 53
edtMsg.Left = 5
edtMsg.Top = 3
edtMsg.Width = 380
edtMsg.Name = "edtMsg"
cmdSend.Top = 60
cmdSend.Left = 289
cmdSend.Name = "cmdSend"
lblMsgAction.Left = 5
lblMsgAction.Top = 63
lblMsgAction.Name = "lblMsgAction"
</properties>
		<protected/>
		<methods>PROCEDURE cmdSend.Click
*13.04.2007 16:25 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

ThisForm.Release()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE sendmsg
*13.04.2007 17:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcMsg
*------------------------------------------------------------------------------

USE IN SELECT([lvSessionView])
USE lvSessionView IN 0

*13.04.2007 15:17 -&gt;Ñîçäàäèì ñïèñîê ñåññèé äëÿ îòïðàâêè ñîîáùåíèé
SELECT ;
	lvSessionView.SessionID ;
FROM lvSessionView ;
WHERE lvSessionView.SessionLive = 1 AND lvSessionView.SessionID &lt;&gt; oSession.SessionID ;
INTO CURSOR curSessionList NOFILTER
*------------------------------------------------------------------------------

*13.04.2007 15:54 -&gt;Ïîñûëàåì ñîîáùåíèÿ
lcMsg = This.edtMsg.Value
SELECT curSessionList
SCAN ALL
	This.nSessionID = curSessionList.SessionID
	IF NOT frmMessenger::SendMsg()
		EXIT
	ENDIF
	This.edtMsg.Value = lcMsg
ENDSCAN
*------------------------------------------------------------------------------

USE IN SELECT([curSessionList])
USE IN SELECT([lvSessionView])
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmessengerall</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200YF51Z</uniqueid>
		<timestamp>915625652</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdversionfile</objname>
		<parent/>
		<properties>ColumnCount = 4
Height = 200
RecordSource = "lvVersionFileView"
ScrollBars = 2
Width = 535
ispacked = .F.
nversionid = 0
Name = "grdversionfile"
Column1.ControlSource = "lvVersionFileView.ModuleFileNM"
Column1.Width = 152
Column1.Name = "Column1"
Column2.ControlSource = "lvVersionFileView.ModuleFilePath"
Column2.Width = 150
Column2.Name = "Column2"
Column3.ControlSource = "lvVersionFileView.ModuleFileSize"
Column3.Width = 100
Column3.Name = "Column3"
Column4.ControlSource = "lvVersionFileView.ModuleFileCRC"
Column4.Width = 100
Column4.Name = "Column4"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersionFile._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå ôàéëà âåðñèè.
*-------------------------------------------------------

*06.04.2007 09:52 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*06.04.2007 09:52 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé êàññû
lnResAdding = oMgrAdmin.Do([VERFILE],[ADD],This.nVersionID,This.IsPacked)
*------------------------------------------------------------------------------

*06.04.2007 11:08 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*03.04.2007 17:29 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*06.04.2007 11:56 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì ôàéëå
	USE IN SELECT([lvVersionFileViewRepl])
	_PARAM = lnId
	USE lvVersionFileViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*06.04.2007 11:56 -&gt;Îáíîâèì äàííûå â lvVersionFileView
	SELECT lvVersionFileViewRepl
	SCATTER TO laReplaceArray
	SELECT lvVersionFileView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*06.04.2007 11:57 -&gt;Çàêðîåì Alis
	USE IN SELECT([lvVersionFileViewRepl])
	*------------------------------------------------------------------------------
		
	*06.04.2007 11:57 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvVersionFileView
	LOCATE FOR lvVersionFileView.MVFileID = lnID
	*------------------------------------------------------------------------------

	*06.04.2007 11:57 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*06.04.2007 11:57 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*06.04.2007 11:57 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersionFile._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå âåðñèè ìîäóëÿ.
*-------------------------------------------------------

*04.04.2007 10:05 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvVersionFileView.MVFileID
*------------------------------------------------------------------------------

*06.04.2007 17:16 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrAdmin.Do([VERFILE],[DELE],lnID,This.IsPacked)
*------------------------------------------------------------------------------

*06.04.2007 17:18 -&gt;Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes
	
	*04.04.2007 10:12 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvVersionFileView
	DELETE FOR lvVersionFileView.MVFileID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*04.04.2007 10:12 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdVersionFile._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î âåðñèè ìîäóëÿ.
*-------------------------------------------------------

*06.04.2007 17:04 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResEditing, ;
		lnID
***
lnID = lvVersionFileView.MVFileID
*------------------------------------------------------------------------------

*06.04.2007 17:04 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ âåðñèè ìîäóëÿ
luResEditing = oMgrAdmin.Do([VERFILE],[EDIT],lnID,This.IsPacked)
*------------------------------------------------------------------------------

*06.04.2007 17:04 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp;äàííûå î âåðñèè èçìåíåíû
	
	*06.04.2007 17:05 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*06.04.2007 17:05 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå äîêóìåíòà
	IF USED([lvVersionFileViewRepl])
		USE IN lvVersionFileViewRepl
	ENDIF
	_PARAM = lnID
	USE lvVersionFileViewRepl IN 0
	*------------------------------------------------------------------------------

	*04.04.2007 09:55 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvVersionFileViewRepl
	SCATTER TO laReplaceArray
	SELECT lvVersionFileView
	LOCATE FOR lvVersionFileView.MVFileID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*04.04.2007 09:56 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvVersionFileViewRepl
	*------------------------------------------------------------------------------

	*04.04.2007 09:56 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*04.04.2007 09:56 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*04.04.2007 09:56 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*06.04.2007 17:04 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ âåðñèè ìîäóëÿ
luResEditing = oMgrAdmin.Do([VERFILE],[INFO],lvVersionFileView.MVFileID,This.IsPacked)
*------------------------------------------------------------------------------

ENDPROC
PROCEDURE nversionid_assign
LPARAMETERS tnNewVal

*06.04.2007 16:38 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
***
_PARAM = tnNewVal
*------------------------------------------------------------------------------

This.nVersionID = tnNewVal
REQUERY(This.RecordSource)
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>9</reserved2>
		<reserved3>ispacked
nversionid
*nversionid_assign 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200YH2ER</uniqueid>
		<timestamp>914719296</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversionfile.Column1</parent>
		<properties>FontBold = .T.
Caption = "Èìÿ ôàéëà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZQLNH</uniqueid>
		<timestamp>914720024</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdversionfile.Column1</parent>
		<properties>Left = 25
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200YH2ET</uniqueid>
		<timestamp>914720024</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversionfile.Column2</parent>
		<properties>FontBold = .T.
FontExtend = .T.
Caption = "Ïóòü"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZQLNJ</uniqueid>
		<timestamp>914720024</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdversionfile.Column2</parent>
		<properties>Left = 28
Top = 35
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200YH2EV</uniqueid>
		<timestamp>914720024</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversionfile.Column3</parent>
		<properties>FontBold = .T.
Caption = "Ðàçìåð"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZQLNL</uniqueid>
		<timestamp>914720024</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdversionfile.Column3</parent>
		<properties>Left = 9
Top = 35
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZJQKD</uniqueid>
		<timestamp>914720024</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdversionfile.Column4</parent>
		<properties>FontBold = .T.
Caption = "CRC"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2200ZQLNO</uniqueid>
		<timestamp>914720024</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdversionfile.Column4</parent>
		<properties>Left = 52
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdversionfile</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
Arial, 65, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_14A10BTEI</uniqueid>
		<timestamp>915702626</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmwsmoduleedit</objname>
		<parent/>
		<properties>Height = 63
Width = 320
DoCreate = .T.
AutoCenter = .T.
Caption = "Ìîäóëü ÐÌ"
Closable = .F.
MaxButton = .F.
MinButton = .F.
KeyPreview = .T.
WindowType = 1
cmode = 
Name = "frmwsmoduleedit"
cstmsghandler.Top = 0
cstmsghandler.Left = 0
cstmsghandler.Height = 17
cstmsghandler.Width = 15
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Left = 22
cstresizable.Height = 17
cstresizable.Width = 15
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmWSModuleEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;cmdOk.Click();cmdCancel.Click()&gt;
* Parameters......: &lt;tcMessage&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ñîõðàíåíèå/îòìåíà
*-------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*09.04.2007 16:16 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*09.04.2007 16:16 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*09.04.2007 16:16 -&gt;Óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*09.04.2007 16:16 -&gt;Óäàëèì çàïèñü
		DELETE IN lvWSTypeModuleEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*09.04.2007 16:16 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:46 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvWSTypeModuleEdit])
	*------------------------------------------------------------------------------
	
	*09.04.2007 16:17 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*09.04.2007 16:17 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*09.04.2007 16:17 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode ,[EDIT],[DELE])

				*09.04.2007 16:17 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*09.04.2007 16:17 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvWSTypeModuleEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*09.04.2007 16:17 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*09.04.2007 16:17 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*09.04.2007 16:17 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*09.04.2007 16:17 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*09.04.2007 16:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvWSTypeModuleEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*09.04.2007 16:17 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*09.04.2007 16:17 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvWSTypeModuleEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*09.04.2007 16:17 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Report_v1.vcx
* Class.Module....: frmWSModileEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcRequestedOperation, tuParam1, tuParam2&gt;
* Returns.........: &lt;none&gt;
* Notes...........: &lt;~&gt;
*-------------------------------------------------------
LPARAMETERS tcRequestedOperation,tuParam1,tuParam2

*09.04.2007 16:06 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*09.04.2007 16:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM,  ;
		_PARAM1, ;
		_PARAM2
***
_PARAM = tuParam1
*------------------------------------------------------------------------------

*12.05.2004 03:12 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcRequestedOperation))
*------------------------------------------------------------------------------

*10.04.2007 09:51 -&gt;Îòêðîåì ñïðàâî÷íèê
DO CASE
	CASE INLIST(.cMode,[ADD] ,[EDIT])
		USE lvModuleExclList IN 0 ALIAS lvModuleList
	CASE INLIST(.cMode,[DELE],[INFO])
		USE lvModuleIncList IN 0 ALIAS lvModuleList
ENDCASE
*------------------------------------------------------------------------------

*09.04.2007 16:07 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode == [ADD]

		*09.04.2007 16:07 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		SELECT lvWSTypeModuleEdit
		APPEND BLANK
		REPLACE lvWSTypeModuleEdit.WSTypeID WITH tuParam1
		*------------------------------------------------------------------------------

	CASE INLIST(.cMode,[DELE],[INFO],[EDIT])

		*09.04.2007 16:14 -&gt;Çàãðóçèì äàííûå ñóùåñòâóþùåé ôóíêöèè
		_PARAM1 = tuParam1
		_PARAM2 = tuParam2
		***
		REQUERY([lvWSTypeModuleEdit])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*09.04.2007 12:43 -&gt;Íàñòðîèì âíåøíèé âèä ôîðìû
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
		.Icon = FULLPATH([frmadd.ico])
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
		.Icon = FULLPATH([frmedit.ico])
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		.Icon = FULLPATH([frminfo.ico])
		.cntCancelSaveHandled.cmdOk.Enabled = .F.
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		.Icon = FULLPATH([frmdele.ico])
		.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: frmWSModuleEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà äàííûõ äëÿ ôîðìû.
*-------------------------------------------------------

*09.04.2007 16:08 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*09.04.2007 16:08 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*09.04.2007 16:08 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ (ïóñòîé)
USE lvWSTypeModuleEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvWSTypeModuleEdit])
*------------------------------------------------------------------------------

*13.01.2005 17:31 -&gt; Îòêðîåì ñïðàâî÷íèêè
*USE lvModuleList IN 0 NODATA
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>uretval &lt;public/runtime&gt; Çíà÷åíèå, êîòîðîå âîçâðàùàåòñÿ âî âûçûâàâøóþ ïðîöåäóðó ïîñëå ñêðûòèÿ ôîðìû.
cmode &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
*_handlecntcancelsaveevent &lt;public/user/nodefault&gt; Îáðàáîòêà íàæàòèÿ íà êëàâèøè êîíòåéíåðà CntCancelSave. Ôîðìèðîâàíèå çíà÷åíèÿ ñâîéñòâ .uRetVal ïåðåä ñêðûòèåì ôîðìû.
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB13G3TM</uniqueid>
		<timestamp>915702626</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmwsmoduleedit</parent>
		<properties>Top = 33
Left = 110
TabIndex = 1
ZOrderSet = 0
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_15C17ZLMD</uniqueid>
		<timestamp>0</timestamp>
		<class>cstdatawork</class>
		<classloc>datawork_v1.vcx</classloc>
		<baseclass>custom</baseclass>
		<objname>cstDataWork</objname>
		<parent>frmwsmoduleedit</parent>
		<properties>Top = 0
Left = 5
Height = 17
Width = 15
Name = "cstDataWork"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOK</uniqueid>
		<timestamp>915702626</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblModule</objname>
		<parent>frmwsmoduleedit</parent>
		<properties>FontBold = .T.
Caption = "Ìîäóëü:"
Left = 5
Top = 8
TabIndex = 11
ZOrderSet = 11
Name = "lblModule"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1HN0ZLHOO</uniqueid>
		<timestamp>915702626</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridModuleList</objname>
		<parent>frmwsmoduleedit</parent>
		<properties>Top = 5
Left = 65
TabIndex = 12
_controlsourcetype = 1
_controlsource = lvWSTypeModuleEdit.ModuleID
_rsaliasname = lvModuleList
_rsfieldnameid = ID
_rsfieldnametext = NM
Name = "cntIdCtlGridModuleList"
txtText._highlightobject = .Parent.Parent.lblModule
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Enabled = .F.
cmdClear.Name = "cmdClear"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmwsmoduleedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0X5JGW</uniqueid>
		<timestamp>921652501</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmodules</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 415
Width = 580
DoCreate = .T.
Caption = "Ìîäóëè Ïðîãðàììíîãî îáåñïå÷åíèÿ"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmmodules"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*03.04.2007 15:31 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.04.2007 15:31 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([Basis])
	OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*03.04.2007 15:32 -&gt;Îòêðîåì íåîáõîäèìûå èñòî÷íèêè äàííûõ
USE lvModuleView IN 0
LOCAL _PARAM
_PARAM = lvModuleView.ModuleID
USE lvVersionView IN 0
***

USE lvModuleBmps IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0XTO9Q</uniqueid>
		<timestamp>921652501</timestamp>
		<class>grdversion</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdVersion</objname>
		<parent>frmmodules</parent>
		<properties>Height = 406
Left = 363
Top = 5
Width = 214
ZOrderSet = 2
Name = "grdVersion"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.CHK1.Alignment = 2
Column2.CHK1.Name = "CHK1"
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y0X8D8H</uniqueid>
		<timestamp>921652501</timestamp>
		<class>grdmodule</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdModule</objname>
		<parent>frmmodules</parent>
		<properties>Height = 406
Left = 5
Top = 5
Width = 358
ZOrderSet = 3
Name = "grdModule"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
This.Parent.grdVersion.cModuleNM = lvModuleView.ModuleNM
This.Parent.grdVersion.lModuleIsPacked = lvModuleView.ModuleTypeIsPacked
This.Parent.grdVersion.nModuleID = lvModuleView.ModuleID

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmodules</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0JHQJF</uniqueid>
		<timestamp>921652521</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsession</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 385
Width = 702
DoCreate = .T.
Caption = "Îòêðûòûå ñåññèè ïîëüçîâàòåëåé"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmsession"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnScrFrmID

*29.03.2007 10:40 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnScrFrmID)
*------------------------------------------------------------------------------

*29.03.2007 10:40 -&gt;Èíèöèàëèçèðóåì Toolbar äëÿ ôîðìû
This.InitCustomFuncToolbar([grdSession])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Load
*28.03.2007 18:05 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*28.03.2007 18:05 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([Basis])
	OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*28.03.2007 18:08 -&gt;Îòêðûâàåì ñïèñîê ñåññèé
USE lvSessionView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE refreshsession
REQUERY([lvSessionView])
This.grdSession.Refresh()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>*refreshsession 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0JMNAA</uniqueid>
		<timestamp>921652379</timestamp>
		<class>grdsession</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdSession</objname>
		<parent>frmsession</parent>
		<properties>Height = 343
Left = 5
Panel = 1
Top = 5
Width = 691
Name = "grdSession"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Width = 162
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Width = 137
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.Width = 165
Column3.Name = "Column3"
Column4.Header1.Name = "Header1"
Column4.Txtgrd1.Name = "Txtgrd1"
Column4.Width = 199
Column4.Name = "Column4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0KQNSV</uniqueid>
		<timestamp>921652379</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdRefresh</objname>
		<parent>frmsession</parent>
		<properties>Top = 354
Left = 598
Caption = "Îáíîâèòü"
Name = "cmdRefresh"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.RefreshSession()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsession</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YR10ZXTH</uniqueid>
		<timestamp>927819862</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>sqlstatus</objname>
		<parent/>
		<properties>Height = 60
Width = 265
ShowWindow = 2
DoCreate = .T.
AutoCenter = .T.
BorderStyle = 1
Caption = "Ñîñòîÿíèå ñåðâåðà"
Closable = .F.
MaxButton = .F.
MinButton = .F.
Icon = ..\imgico\sqlmangr.ico
WindowType = 1
osqlserver = .NULL.
uretval = .F.
Name = "sqlstatus"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected>osqlserver
getservername
</protected>
		<methods>PROCEDURE getservername
*11.12.2006 16:06 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcConnectionString, ;
		lcServerName
*------------------------------------------------------------------------------

*11.12.2006 16:06 -&gt;Ïîëó÷àåì èìÿ ñåðâåðà èç ConnectionString
SET DATABASE TO Basis
lcConnectionString = UPPER(DBGETPROP([SQLBASISCONNECTION],[CONNECTION],[ConnectString]))
lcServerName = SUBSTR(lcConnectionString,AT([SERVER=],lcConnectionString))
lcServerName = STRTRAN(lcServerName,[SERVER=],[])
lcServerName = LEFT(lcServerName,AT([;],lcServerName)-1)
*------------------------------------------------------------------------------

RETURN lcServerName
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
*12.12.2006 10:37 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   llResult, ;
		lnSecond
***
llResult = .T.
*------------------------------------------------------------------------------

*11.12.2006 17:30 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*11.12.2006 16:10 -&gt;Îòêðîåì ÁÄ
lnSecond = SECONDS()
DO WHILE SECONDS()-lnSecond &lt; 60 AND !DBUSED([BASIS])
	TRY
		OPEN DATABASE BASIS SHARED
		llResult = .T.
	CATCH
		llResult = .F.
	ENDTRY
ENDDO	
*------------------------------------------------------------------------------

*11.12.2006 16:10 -&gt;Îòêðîåì ÁÄ
IF NOT llResult
	MESSAGEBOX([Êîíòåéíåð BASIS.DBC íåäîñòóïåí.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó],16,[Îøèáêà])
	RETURN .F.
ENDIF
*------------------------------------------------------------------------------

SET DATABASE TO BASIS
*------------------------------------------------------------------------------

*11.12.2006 18:41 -&gt;Ñîçäàäèì îáúåêò äëÿ äîñòóïà ê ñåðâåðó
TRY
	This.oSQLServer = CREATEOBJECT([SQLDMO.SQLServer])
	This.oSQLServer.Name = This.GetServerName()
CATCH
ENDTRY
*------------------------------------------------------------------------------

*11.12.2006 18:42 -&gt;Ïîêàæåì ñòàòóñ ñåðâåðà
*!*	IF This.RefreshStatus() = -1
*!*		RETURN .F.
*!*	ENDIF
*------------------------------------------------------------------------------

*11.12.2006 18:41 -&gt;Çàïóñòèì òàéìåð
This.Timer.Enabled  = .T.
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE refreshstatus
WITH This

*11.12.2006 17:58 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcPath, ;
		lnSQLServerStatus, ;
		llStatusGetResult, ;
		llConnectResult
***
lcPath = ADDBS(STRTRAN(FULLPATH([POS.EXE]),[POS.EXE],[]))
llConnectResult = .F.
*------------------------------------------------------------------------------

*12.12.2006 10:58 -&gt;Çàïðåòèì ðàáîòó òàéìåðà
.Timer.Enabled = .F.
*------------------------------------------------------------------------------
llStatusGetResult = .T.
*08.02.2007 16:02 -&gt;Ïðè íåóäà÷íîé ïîïûòêå ñîçäàíèÿ îáúåêòà DMO ïðîáóåì îòêðûòü ëþáîé View


IF .t. OR VARTYPE(.oSQLServer)=[O]
	*12.12.2006 10:53 -&gt;Ïîðó÷èì ñòàòóñ ñåðâåðà
	TRY
		*12.12.2006 10:55 -&gt;Ïîêàæåì íåîïðåäåëåííîå ñîñòîÿíèå
		.lblStatus.Caption = [Ñòàòóñ ñåðâåðà íå îïðåäåëåí]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_0.GIF]
		*------------------------------------------------------------------------------
		
		*12.12.2006 10:56 -&gt;Ïîëó÷èì ñòàòóñ
		lnSQLServerStatus = .oSQLServer.Status
		llStatusGetResult = .T.
		*------------------------------------------------------------------------------
		
	CATCH
		llStatusGetResult = .F.
		MESSAGEBOX([Ñåðâåð ]+.oSQLServer.Name+[ íåäîñòóïåí.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
	ENDTRY
	*------------------------------------------------------------------------------
ENDIF
*------------------------------------------------------------------------------

*08.02.2007 17:51 -&gt;Ïðîâåðèì äîñòóïíîñòü ÁÄ
IF 	(llStatusGetResult AND lnSQLServerStatus = 1) OR VARTYPE(.oSQLServer)#[O]
	TRY
		USE lvTLUTypeList IN 0
		llStatusGetResult = .T.
		.uRetVal = .T.
		.Hide()
		CLEAR EVENTS
	CATCH
		llStatusGetResult = .F.
		MESSAGEBOX([Ñåðâåð ]+This.GetServerName()+[ íåäîñòóïåí.]+CHR(13)+[Îáðàòèòåñü ê àäìèíèñòðàòîðó.],16,[Îøèáêà])
	ENDTRY
	***
	IF llStatusGetResult AND VARTYPE(.oSQLServer)#[O]
		RETURN 1
	ENDIF
ENDIF
*------------------------------------------------------------------------------

*12.12.2006 10:57 -&gt;Ïðîâåðèì, áûë ëè ïîëó÷åí ñòàòóñ ñåðâåðà
IF NOT llStatusGetResult  THEN
		.uRetVal = .F.
		.Hide()
		CLEAR EVENTS
		RETURN -1
ENDIF
*------------------------------------------------------------------------------

*11.12.2006 16:31 -&gt;Îïðåäåëÿåì ñîñòîÿíèå SQL-Servera
DO CASE
	CASE lnSQLServerStatus = 1
		.lblStatus.Caption = [Çàïóùåí]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_1.GIF]
		.uRetVal = .T.
		.Hide()
		CLEAR EVENTS
		RETURN 1
	CASE lnSQLServerStatus = 0
		.lblStatus.Caption = [Ñòàòóñ ñåðâåðà íå îïðåäåëåí]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_0.GIF]
	CASE lnSQLServerStatus = 2
		.lblStatus.Caption = [Ïàóçà]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_2.GIF]
	CASE lnSQLServerStatus = 3
		.lblStatus.Caption = [Îñòàíîâëåí]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_3.GIF]
	CASE lnSQLServerStatus = 4
		.lblStatus.Caption = [Ñòàðòóåò...]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_3.GIF]
	CASE lnSQLServerStatus = 5
		.lblStatus.Caption = [Îñòàíàâëèâàåòñÿ...]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_3.GIF]
	CASE lnSQLServerStatus = 6
		.lblStatus.Caption = [Çàïóñêàåòñÿ èç ïàóçû...]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_2.GIF]
	CASE lnSQLServerStatus = 7
		.lblStatus.Caption = [Ïåðåõîäèò â ïàóçó...]
		.SQLStatusImg.Picture = lcPath +[IMGBMP\SQLS_2.GIF]
ENDCASE
*------------------------------------------------------------------------------

*12.12.2006 10:59 -&gt;Åñëè íåîáõîäèìî îòñëåæèâàòü ñîñòîÿíèå ñåðâåðà - ðàçðåøèì ðàáîòó òàéìåðà
IF lnSQLServerStatus &lt;&gt; 1 THEN
	.Timer.Enabled = .T.
ENDIF
*------------------------------------------------------------------------------

RETURN lnSQLServerStatus

ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3>osqlserver
uretval
*getservername 
*refreshstatus 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YR11229M</uniqueid>
		<timestamp>927819862</timestamp>
		<class>img</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>image</baseclass>
		<objname>SQLStatusImg</objname>
		<parent>sqlstatus</parent>
		<properties>Anchor = 48
Picture = ..\imgbmp\sqls_0.gif
Stretch = 2
Height = 48
Left = 0
Top = 0
Width = 48
Name = "SQLStatusImg"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YR113C2L</uniqueid>
		<timestamp>927819862</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>Timer</objname>
		<parent>sqlstatus</parent>
		<properties>Top = 0
Left = 240
Height = 23
Width = 23
Enabled = .F.
Interval = 1000
Name = "Timer"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
This.Parent.RefreshStatus()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YR13PZ2W</uniqueid>
		<timestamp>927819862</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblStatus</objname>
		<parent>sqlstatus</parent>
		<properties>FontBold = .T.
FontSize = 10
Caption = "Ñòàòóñ ñåðâåðà íå îïðåäåëåí"
Left = 62
Top = 5
Name = "lblStatus"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YR13S4QK</uniqueid>
		<timestamp>910724911</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Cmd1</objname>
		<parent>sqlstatus</parent>
		<properties>Top = 28
Left = 161
Caption = "Âûõîä"
Name = "Cmd1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.uRetVal = .F.
This.Parent.Hide()
CLEAR EVENTS
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>sqlstatus</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IA0O65KW</uniqueid>
		<timestamp>930593602</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmversionfileedit</objname>
		<parent/>
		<properties>Height = 148
Width = 367
DoCreate = .T.
Caption = "Ôàéë âåðñèè ìîäóëÿ"
cmode = 
ispacked = .F.
Name = "frmversionfileedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*03.04.2007 17:19 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*03.04.2007 17:19 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*03.04.2007 17:19 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*13.01.2005 14:40 -&gt; Óäàëèì çàïèñü
		DELETE IN lvVersionFileEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:19 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:20 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvVersionFileEdit])
	*------------------------------------------------------------------------------
	
	*03.04.2007 17:20 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*03.04.2007 17:20 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode,[EDIT],[DELE])

				*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*03.04.2007 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvVersionFileEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*03.04.2007 17:20 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:20 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*03.04.2007 17:20 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*03.04.2007 17:21 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*03.04.2007 17:21 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvVersionFileEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:21 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*03.04.2007 17:21 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvVersionFileEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*03.04.2007 17:21 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcCommand, tuParam1, tlIsPacked

*12.05.2004 00:34 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*03.04.2007 17:17 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*03.04.2007 17:17 -&gt;Ñîõðàíèì ïàðàìåòðû
.cMode = UPPER(ALLTRIM(tcCommand))
.IsPacked = tlIsPacked
*------------------------------------------------------------------------------

*03.04.2007 17:17 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode==[ADD]
		
		*03.04.2007 17:17 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		APPEND BLANK IN lvVersionFileEdit
		*------------------------------------------------------------------------------
		
		*06.09.2005 09:26 -&gt;Ñðîõðàíèì èäåíòèôèêàòîð ìîäóëÿ
		REPLACE lvVersionFileEdit.ModuleVersionID WITH tuParam1
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cMode,[EDIT],[INFO],[DELE])
		
		*03.04.2007 17:18 -&gt;Çàãðóçèì äàííûå î âåðñèè
		_PARAM = tuParam1
		***
		REQUERY([lvVersionFileEdit])
		*------------------------------------------------------------------------------

		.cntLocationGetFile.lblLocation.Caption = JUSTFNAME(lvVersionFileEdit.ModuleFileNM)

ENDCASE
*------------------------------------------------------------------------------

*.Icon = FULLPATH([???.ico])
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		
*13.01.2005 14:16 -&gt; Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: frmVersionEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå âåðñèè ìîäóëÿ
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*03.04.2007 17:16 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàññ (ïóñòîé)
USE lvVersionFileEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvVersionFileEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE loadfile
LPARAMETERS tcFileNM

*03.04.2007 17:11 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcFileCont, ;
		lcPackedFile, ;
		llSuccess
***
llSuccess = .T.
*------------------------------------------------------------------------------

WAIT WINDOW [Æäèòå. Èäåò çàãðóçêà ôàéëà] NOWAIT NOCLEAR
SET MESSAGE TO [Æäèòå. Èäåò çàãðóçêà ôàéëà]

*06.04.2007 09:22 -&gt;×èòàåì ôàéë
TRY
	lcFileCont = FILETOSTR(tcFileNM)
CATCH
	llSuccess = .F.
ENDTRY
***
IF NOT llSuccess
	WAIT CLEAR
	SET MESSAGE TO []
	MESSAGEBOX([Íå ìîãó ïðî÷èòàòü ôàéë ]+tcFileNM,48,[Çàãðóçêà ôàéëà])
	RETURN
ENDIF
*------------------------------------------------------------------------------

*03.04.2007 17:12 -&gt;Çàïèñûâàåì ôàéë â Memo-ïîëå
TRY
	IF This.IsPacked
		This.Zlib.Visible = .T.
		This.Zlib.InputFile = tcFileNM
		This.Zlib.OutputFile = [tmp\packed.zlb]
		This.Zlib.COmpress()
		lcPackedFile = FILETOSTR([tmp\packed.zlb])
		REPLACE lvVersionFileEdit.ModuleFile WITH lcPackedFile
		*APPEND MEMO lvModuleVersionEdit.ModuleFile FROM (tcFileNM) OVERWRITE
		This.Zlib.Visible = .F.
		ERASE ([tmp\packed.zlb])
	ELSE
		REPLACE lvVersionFileEdit.ModuleFile WITH lcFileCont
	ENDIF
CATCH
	llSuccess = .F.
ENDTRY
***
IF NOT llSuccess
	WAIT CLEAR
	SET MESSAGE TO []
	MESSAGEBOX([Íå ìîãó óïàêîâàòü ôàéë ]+tcFileNM,48,[Çàãðóçêà ôàéëà])
	RETURN
ENDIF
*------------------------------------------------------------------------------

*03.04.2007 17:13 -&gt;Ñ÷èòàåì ðàçìåð è CRC ôàéëà
REPLACE ;
	lvVersionFileEdit.ModuleFileNM	 WITH JUSTFNAME(tcFileNM), ;
	lvVersionFileEdit.ModuleFileSize WITH LEN(lcFileCont), ;
	lvVersionFileEdit.ModuleFileCRC  WITH SYS(2007,lcFileCont,0,1) ;
IN lvVersionFileEdit
*------------------------------------------------------------------------------

This.txtFileSize.Refresh()
This.txtCrc.Refresh()
This.cntLocationGetFile.lblLocation.Caption = JUSTFNAME(tcFileNM)

WAIT CLEAR
SET MESSAGE TO []
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>12</reserved2>
		<reserved3>cmode &lt;public/runtime&gt; Ðåæèì ðàáîòû ôîðìû (ADD/EDIT/INFO/DELE)
ispacked
*loadfile 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Äîáàâëåíèå è ðåäàêòèðîâàíèå ôàéëà</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2210J1DTZ</uniqueid>
		<timestamp>921657641</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtPath</objname>
		<parent>frmversionfileedit</parent>
		<properties>ControlSource = "lvVersionFileEdit.ModuleFilePath"
Height = 23
Left = 99
TabIndex = 8
Top = 88
Width = 100
ZOrderSet = 0
_highlightobject = .Parent.lblPath
Name = "txtPath"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y10FNOQ</uniqueid>
		<timestamp>921657641</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtFileSize</objname>
		<parent>frmversionfileedit</parent>
		<properties>ControlSource = "lvVersionFileEdit.ModuleFileSize"
Height = 23
Left = 99
ReadOnly = .T.
TabIndex = 3
Top = 33
Width = 100
ZOrderSet = 0
Name = "txtFileSize"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10034Z</uniqueid>
		<timestamp>921657641</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCRC</objname>
		<parent>frmversionfileedit</parent>
		<properties>Alignment = 1
ControlSource = "lvVersionFileEdit.ModuleFileCRC"
Height = 23
Left = 99
ReadOnly = .T.
TabIndex = 6
Top = 60
Width = 100
ZOrderSet = 0
Name = "txtCRC"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KT0W0MLJ</uniqueid>
		<timestamp>930593602</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmversionfileedit</parent>
		<properties>Top = 119
Left = 159
TabIndex = 9
ZOrderSet = 4
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Y10FNON</uniqueid>
		<timestamp>930593602</timestamp>
		<class>cntlocationgetfile</class>
		<classloc>ctlos.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntLocationGetFile</objname>
		<parent>frmversionfileedit</parent>
		<properties>Top = 5
Left = 5
Width = 359
Height = 23
TabIndex = 1
cfileextension = EXE,APP,DB*
Name = "cntLocationGetFile"
cmdGetLocation.Top = 0
cmdGetLocation.Left = 335
cmdGetLocation.Name = "cmdGetLocation"
txtLocation.Height = 23
txtLocation.Left = 94
txtLocation.Top = 0
txtLocation.Width = 238
txtLocation.Name = "txtLocation"
lblLocation.Alignment = 0
lblLocation.Caption = "Ôàéë ìîäóëÿ:"
lblLocation.Height = 17
lblLocation.Left = 0
lblLocation.Top = 3
lblLocation.Width = 91
lblLocation.Name = "lblLocation"
</properties>
		<protected/>
		<methods>PROCEDURE cmdGetLocation.Click
*03.04.2007 17:06 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

ThisForm.LoadFile(This.Parent.LocationGet())
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_22C10W7C0</uniqueid>
		<timestamp>930593602</timestamp>
		<class>olecontrol</class>
		<classloc/>
		<baseclass>olecontrol</baseclass>
		<objname>Zlib</objname>
		<parent>frmversionfileedit</parent>
		<properties>Top = 37
Left = 205
Height = 15
Width = 155
Visible = .F.
TabIndex = 4
Name = "Zlib"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAxBE7+LcgBAwAAAMAAAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJQAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAA/v////7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+jIYHoqZ/PEZ2fAKoAOjqjAAABAAUQAACNAQAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAEAAIABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAA1NDIAP///////////////wQFCnYMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAD/////PQgKvf//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAD//////wAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = D:\Develop\Work\BASISS~1\ZlibTool.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0UFNDK</uniqueid>
		<timestamp>930593602</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin3</objname>
		<parent>frmversionfileedit</parent>
		<properties>Height = 0
Left = 116
Top = 272
Width = 325
ZOrderSet = 11
Name = "Lin3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0UFNDL</uniqueid>
		<timestamp>930593602</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin4</objname>
		<parent>frmversionfileedit</parent>
		<properties>Height = 0
Left = 116
Top = 273
Width = 325
BorderColor = 255,255,255
ZOrderSet = 12
Name = "Lin4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0JHQJF</uniqueid>
		<timestamp>930593602</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFileSize</objname>
		<parent>frmversionfileedit</parent>
		<properties>FontBold = .T.
Caption = "Ðàçìåð:"
Left = 5
Top = 35
TabIndex = 2
ZOrderSet = 13
Name = "lblFileSize"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10034Z</uniqueid>
		<timestamp>930593602</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCRC</objname>
		<parent>frmversionfileedit</parent>
		<properties>FontBold = .T.
Caption = "Êîíòð.ñóììà:"
Left = 5
Top = 62
TabIndex = 5
ZOrderSet = 13
Name = "lblCRC"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2210J1DTY</uniqueid>
		<timestamp>930593602</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblPath</objname>
		<parent>frmversionfileedit</parent>
		<properties>FontBold = .T.
Caption = "Ïóòü:"
Left = 5
Top = 91
TabIndex = 7
ZOrderSet = 13
Name = "lblPath"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmversionfileedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0RG2WB</uniqueid>
		<timestamp>930594030</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdwstype</objname>
		<parent/>
		<properties>ColumnCount = 2
Height = 200
Panel = 1
RecordSource = "lvWSTypeView"
ScrollBars = 2
Width = 268
Name = "grdwstype"
Column1.ControlSource = "lvWSTypeView.WSTypeNM"
Column1.Width = 181
Column1.Name = "Column1"
Column2.ControlSource = "lvWSTypeView.WSTypeID"
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdWSType._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî òèïà ðàáî÷åé ñòàíöèè.
*-------------------------------------------------------

*09.04.2007 10:19 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*09.04.2007 10:19 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîãî òèïà ðàáî÷åé ñòàíöèè
lnResAdding = oMgrAdmin.Do([WSTYPE],[ADD])
*------------------------------------------------------------------------------

*09.04.2007 10:21 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*09.04.2007 10:21 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*09.04.2007 10:21 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì òèït ðàáî÷åé ñòàíöèè
	USE IN SELECT([lvWSTypeViewRepl])
	_PARAM = lnId
	USE lvWSTypeViewRepl IN 0
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:50 -&gt;Îáíîâèì äàííûå â lvWSTypeView
	SELECT lvWSTypeViewRepl
	SCATTER TO laReplaceArray
	SELECT lvWSTypeView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*09.04.2007 12:50 -&gt;Çàêðîåì Alis
	USE IN SELECT([lvWSTypeViewRepl])
	*------------------------------------------------------------------------------
		
	*09.04.2007 12:50 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvWSTypeView
	LOCATE FOR lvWSTypeView.WSTypeID = lnID
	*------------------------------------------------------------------------------

	*09.04.2007 12:51 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*09.04.2007 12:51 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*09.04.2007 12:51 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdWSType._Dele
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Dele()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå òèïà ðàáî÷åé ñòàíöèè.
*-------------------------------------------------------

*09.04.2007 13:18 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvWSTypeView.WSTypeID
*------------------------------------------------------------------------------

*09.04.2007 13:19 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrAdmin.Do([WSTYPE],[DELE],lnID)
*------------------------------------------------------------------------------

*09.04.2007 13:19 -&gt;Îáðàáîòàåì ðåçóëüòàòû óäàâëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes
	
	*09.04.2007 14:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL	lcOldAlias
	***
	lcOldAlias = ALIAS()
	*------------------------------------------------------------------------------
	
	*09.04.2007 14:09 -&gt;Óäàëèì îáúåêò èç Grid-à
	SELECT lvWSTypeView
	DELETE FOR lvWSTypeView.WSTypeID = lnID
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
	
	*09.04.2007 14:10 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
	*09.04.2007 14:10 -&gt;Âûçîâåì ìåòîä äëÿ ïðèíóäèòåëüíîãî îáíîâëåíèÿ RunTime ñâîéñòâ
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdWSType._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î òèïå ðàáî÷åé ñòàíöèè.
*-------------------------------------------------------

*04.04.2007 09:53 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luResEditing, ;
		lnID
***
lnID = lvWSTypeView.WSTypeID
*------------------------------------------------------------------------------

*09.04.2007 14:22 -&gt;ûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ èíôîðìàöèè î òèïå ðàáî÷åé ñòàíöèè
luResEditing = oMgrAdmin.Do([WSTYPE],[EDIT],lnID)
*------------------------------------------------------------------------------

*09.04.2007 14:22 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp;äàííûå î òèïå èçìåíåíû
	
	*09.04.2007 14:39 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*09.04.2007 14:39 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå äîêóìåíòà
	USE IN SELECT([lvWSTypeViewRepl])
	_PARAM = lnID
	USE lvWSTypeViewRepl IN 0
	*------------------------------------------------------------------------------

	*09.04.2007 14:41 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvWSTypeViewRepl
	SCATTER TO laReplaceArray
	SELECT lvWSTypeView
	LOCATE FOR lvWSTypeView.WSTypeID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*09.04.2007 14:41 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvWSTypeViewRepl
	*------------------------------------------------------------------------------

	*09.04.2007 14:41 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*09.04.2007 14:41 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*09.04.2007 14:42 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Admin.vcx
* Class.Module....: grdWSType._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î òèïå ðàáî÷åé ñòàíöèè.
*-------------------------------------------------------

oMgrAdmin.Do([WSTYPE],[INFO],lvWSTypeView.WSTypeID)
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>5</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0RI1KQ</uniqueid>
		<timestamp>914646705</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdwstype.Column1</parent>
		<properties>FontBold = .T.
Caption = "Òèï ðàáî÷åãî ìåñòà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0RI1KR</uniqueid>
		<timestamp>930594030</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdwstype.Column1</parent>
		<properties>ControlSource = "lvWSTypeView.WSTypeNM"
Left = 49
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28G1EPFX4</uniqueid>
		<timestamp>930594030</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdwstype.Column2</parent>
		<properties>Caption = "Êîä ðàá.ìåñòà"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28G1EPFX5</uniqueid>
		<timestamp>930594030</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>grdwstype.Column2</parent>
		<properties>BorderStyle = 0
ControlSource = "lvWSTypeView.WSTypeID"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdwstype</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0TI0H2</uniqueid>
		<timestamp>930594036</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmwsmodule</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 333
Width = 595
DoCreate = .T.
Caption = "Òèï ðàáî÷åãî ìåñòà &lt;-&gt; Ïðîãðàììíûå ìîäóëè"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmwsmodule"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*04.04.2007 14:16 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*04.04.2007 13:48 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

**04.04.2007 14:12 -&gt; Îòêðîåì ÁÄ
IF !DBUSED([Basis])
OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*04.04.2007 14:13 -&gt;Îòêðûâàåì íåîáõîäèìûå èñòî÷íèêè äàííûõ
USE lvWSTypeView IN 0
_PARAM = lvWSTypeView.WSTypeID
USE lvWSTypeModuleView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Òèïû ðàáî÷èõ ìåñò è ìîäóëè ê íèì</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0TK1NX</uniqueid>
		<timestamp>921654274</timestamp>
		<class>grdmodulelist</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdModuleList</objname>
		<parent>frmwsmodule</parent>
		<properties>Height = 322
Left = 336
Panel = 1
Top = 5
Width = 253
ZOrderSet = 2
Name = "grdModuleList"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Width = 253
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21Z0TK1NU</uniqueid>
		<timestamp>930594036</timestamp>
		<class>grdwstype</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdWSType</objname>
		<parent>frmwsmodule</parent>
		<properties>Height = 322
Left = 5
Panel = 1
Top = 5
Width = 331
ZOrderSet = 3
Name = "grdWSType"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Width = 238
Column1.Name = "Column1"
COLUMN2.Header1.Name = "Header1"
COLUMN2.Text1.Name = "Text1"
COLUMN2.Name = "COLUMN2"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
This.Parent.grdModuleList.nWSTypeID = lvWSTypeView.WSTypeID
_PARAM = lvWSTypeView.WSTypeID
REQUERY([lvWSTypeModuleView])
This.Parent.grdModuleList.Refresh()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmwsmodule</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10034Z</uniqueid>
		<timestamp>952527405</timestamp>
		<class>frmview</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmsimplemsgviewer</objname>
		<parent/>
		<properties>Height = 168
Width = 487
DoCreate = .T.
AutoCenter = .T.
BorderStyle = 2
Caption = "Ñîîáùåíèå"
HalfHeightCaption = .T.
MaxButton = .F.
MinButton = .F.
AlwaysOnTop = .T.
ZoomBox = .T.
nsessionid = 0
Name = "frmsimplemsgviewer"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS tcMsg, tcAuthor, ttTime, tnSessionID

*29.03.2007 16:48 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

This.Caption		 = tcAuthor
This.edtMsg.Value	 = tcMsg
This.lblTime.Caption = This.lblTime.Caption + TTOC(ttTime)
This.nSessionID		 = tnSessionID

*29.03.2007 17:12 -&gt;Ïîçèöèîíèðóåì îêíî
This.Top  = _SCREEN.Height - This.Height - 25
This.Left = _SCREEN.Width  - This.Width  - 10
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>4</reserved2>
		<reserved3>nsessionid
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T102EJW</uniqueid>
		<timestamp>921654619</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtMsg</objname>
		<parent>frmsimplemsgviewer</parent>
		<properties>Height = 146
Left = 0
ReadOnly = .T.
Top = 0
Width = 485
SelectedBackColor = 128,128,128
_highlightself = .F.
Name = "edtMsg"
</properties>
		<protected/>
		<methods>PROCEDURE Click
oMgrAdmin.Do([SESSION],[SENDMSG],This.Parent.nSessionID)
ThisForm.Release()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T106ZIR</uniqueid>
		<timestamp>952527405</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblTime</objname>
		<parent>frmsimplemsgviewer</parent>
		<properties>AutoSize = .F.
Caption = "Âðåìÿ: "
Left = 0
Top = 149
Width = 205
Name = "lblTime"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T10PKZC</uniqueid>
		<timestamp>952527405</timestamp>
		<class>timer</class>
		<classloc/>
		<baseclass>timer</baseclass>
		<objname>Timer</objname>
		<parent>frmsimplemsgviewer</parent>
		<properties>Top = 60
Left = 252
Height = 23
Width = 23
Interval = 500000
Name = "Timer"
</properties>
		<protected/>
		<methods>PROCEDURE Timer
ThisForm.Release
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmsimplemsgviewer</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_0VL0XXSOC</uniqueid>
		<timestamp>952529892</timestamp>
		<class>custom</class>
		<classloc/>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE do
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Admin.vcx
* Class.Module....: Interface.Do
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé ìåòîä ìåíåäæåðà áèáëèîòåêè àäìèíèñòðàòîðà
*------------------------------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequstedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10

*28.03.2007 17:18 -&gt;Ïðîâåðÿåì ïåðâûå äâà îáÿçàòåëüíûõ ïàðàìåòðà
IF 	TYPE([tcEntityName])#[C] OR EMPTY([tcEntityName]) OR ;
	TYPE([tcRequstedOperation])#[C] OR EMPTY([tcRequstedOperation])
	*{
	ASSERT .F. MESSAGE [Admin.Interface.Do: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà]
	*}
ENDIF	
*------------------------------------------------------------------------------

*28.03.2007 17:19 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequstedOperation, ;
		llOperateResult
***
lcEntityName = UPPER(ALLTRIM(tcEntityName))
lcRequstedOperation = UPPER(ALLTRIM(tcRequstedOperation))
*------------------------------------------------------------------------------

*28.03.2007 17:19 -&gt;Âûïîëíÿåì îïðåàöèþ íàä ñóùíîñòüþ
DO CASE

	*******************************************************************************
	*[MODULE] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû ñ ìîäóëÿìè					  *
	*******************************************************************************
	CASE lcEntityName == [MODULE] AND lcRequstedOperation == [VIEW]

		*04.04.2007 14:38 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû ñ ìîäóëÿìè
		oApp.ExecuteScrFormByObjDesc([frmModules;admin.vcx;admin.app])
		*------------------------------------------------------------------------------

		*04.04.2007 14:38 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[MODULE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])							  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìîäóëÿ									  *
	*******************************************************************************
	CASE lcEntityName == [MODULE] AND ;
			(lcRequstedOperation == [ADD]  OR ;
			 lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*09.04.2007 12:49 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmmoduleedit;admin.vcx;admin.app],lcRequstedOperation,tuParam1)
		
		*09.04.2007 12:49 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------


	*******************************************************************************
	*[WSTYPE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])							  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìîäóëÿ									  *
	*******************************************************************************
	CASE lcEntityName == [WSTYPE] AND ;
			(lcRequstedOperation == [ADD]  OR ;
			 lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*09.04.2007 12:49 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmwstypeedit;admin.vcx;admin.app],lcRequstedOperation,tuParam1)
		
		*09.04.2007 12:49 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[WSMODULE] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû ïðèâÿçêè ìîäóëåé ê ÐÌ		  *
	*******************************************************************************
	CASE lcEntityName == [WSMODULE] AND lcRequstedOperation == [VIEW]

		*03.04.2007 15:22 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû ñ ìîäóëÿìè
		oApp.ExecuteScrFormByObjDesc([frmWSModule;admin.vcx;admin.app])
		*------------------------------------------------------------------------------

		*03.04.2007 15:22 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------


	*******************************************************************************
	*[WSMODULE] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû ïðèâÿçêè ìîäóëåé ê ÐÌ		  *
	*******************************************************************************
	CASE lcEntityName == [WSMODULE] AND ;
			(lcRequstedOperation == [ADD]  OR ;
			 lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*09.04.2007 12:49 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmwsmoduleedit;admin.vcx;admin.app],lcRequstedOperation,tuParam1,tuParam2)
		
		*09.04.2007 12:49 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[VERSION] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])							  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìîäóëÿ									  *
	*******************************************************************************
	CASE lcEntityName == [VERSION] AND ;
			(lcRequstedOperation == [ADD]  OR ;
			 lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*03.04.2007 17:23 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð êàññû äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------
		
		*03.04.2007 17:23 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmversionedit;admin.vcx;admin.app],lcRequstedOperation,tuParam1,tuParam2,tuParam3)
		
		*03.04.2007 17:24 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[VERFILE] &amp;&amp; ([ADD] || [EDIT] || [INFO] || [DELE])							  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìîäóëÿ									  *
	*******************************************************************************
	CASE lcEntityName == [VERFILE] AND ;
			(lcRequstedOperation == [ADD]  OR ;
			 lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*03.04.2007 17:23 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmversionfileedit;admin.vcx;admin.app],lcRequstedOperation,tuParam1,tuParam2)
		
		*03.04.2007 17:24 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------


	*******************************************************************************
	*[SESSION] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû c ñåññèÿìè					  *
	*******************************************************************************
	CASE lcEntityName == [SESSION] AND lcRequstedOperation == [VIEW]

		*28.03.2007 17:19 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c ñåññèÿìè
		oApp.ExecuteScrFormByObjDesc([frmSession;admin.vcx;admin.app])
		*------------------------------------------------------------------------------

		*28.03.2007 17:20 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[SESSION] &amp;&amp; [SENDMSG] - çàïóñê ôîðìû äëÿ ðàáîòû c ñîîáùåíèÿìè				  *
	*******************************************************************************
	CASE lcEntityName == [SESSION] AND lcRequstedOperation == [SENDMSG]

		*28.03.2007 17:19 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c ñåññèÿìè
		oApp.ExecuteScrFormByObjDesc([frmMessenger;admin.vcx;admin.app],tuParam1,tuParam2)
		*------------------------------------------------------------------------------

		*28.03.2007 17:20 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------
		
	*******************************************************************************
	*[SESSION] &amp;&amp; [SENDMSGALL] - çàïóñê ôîðìû äëÿ ðàáîòû c ñîîáùåíèÿìè				  *
	*******************************************************************************
	CASE lcEntityName == [SESSION] AND lcRequstedOperation == [SENDMSGALL]

		*28.03.2007 17:19 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c ñåññèÿìè
		oApp.ExecuteScrFormByObjDesc([frmMessengerAll;admin.vcx;admin.app],tuParam1)
		*------------------------------------------------------------------------------

		*28.03.2007 17:20 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------
	*******************************************************************************
	*[SESSION] &amp;&amp; [SENDMSGALL] - çàïóñê ôîðìû äëÿ ðàáîòû c ñîîáùåíèÿìè				  *
	*******************************************************************************
*!*		CASE lcEntityName == [MESSENGER] AND lcRequstedOperation == [WAIT]

*!*			*28.03.2007 17:19 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c ñåññèÿìè
*!*			oApp.ExecuteScrFormByObjDesc([frmSimpleMsgViewer;admin.vcx;admin.app],tuParam1)
*!*			*------------------------------------------------------------------------------

*!*			*28.03.2007 17:20 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
*!*			RETURN .T.
*!*			*------------------------------------------------------------------------------

	OTHERWISE
	
		*19.05.2004 21:59 -&gt;Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*do 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ìåíåäæåð êëèåíòîâ</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10C35H</uniqueid>
		<timestamp>952529906</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdsession</objname>
		<parent/>
		<properties>ColumnCount = 4
HeaderHeight = 33
Height = 200
RecordSource = "lvSessionView"
ScrollBars = 2
Width = 505
_handledstandartmsglist = EXCEL
_handledstandartmsgpromptlist = Ýêñïîðò â Excel
_handledcustommsglist = SENDMSG;SENDMSGALL;CLOSESESSION
_handledcustommsgpromptlist = Ñîîáùåíèå ïîëüçîâàòåëþ;Ñîîáùåíèå âñåì;Çàêðûòü ñåññèþ
Name = "grdsession"
Column1.ColumnOrder = 4
Column1.ControlSource = "lvSessionView.WSNM"
Column1.Width = 102
Column1.Name = "Column1"
Column2.ColumnOrder = 2
Column2.ControlSource = "lvSessionView.UserNM"
Column2.Width = 100
Column2.Name = "Column2"
Column3.ColumnOrder = 3
Column3.ControlSource = "lvSessionView.UserLogin"
Column3.Width = 150
Column3.Name = "Column3"
Column4.ColumnOrder = 1
Column4.ControlSource = "lvSessionView.SessionBegin"
Column4.Width = 120
Column4.Name = "Column4"
</properties>
		<protected/>
		<methods>PROCEDURE _gethandledcustommsglist
*30.03.2006 11:13 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   lcHandledCustomMsgList
*------------------------------------------------------------------------------

*30.03.2006 11:13 -&gt;Ïîëó÷èì ñïèñîê ïîëüçîâàòåëüñêèõ ñîîáùåíèé
lcHandledCustomMsgList = DODEFAULT()
*------------------------------------------------------------------------------

*29.03.2007 12:19 -&gt;Îáðàáàòûâàåì ïîëüçîâàòåëüñêèå ôóíêöèè
IF lvSessionView.SessionLive = 1
	lcHandledCustomMsgList = STRTRAN(lcHandledCustomMsgList,[;CLOSESESSION;],[;])
ELSE
	lcHandledCustomMsgList = STRTRAN(lcHandledCustomMsgList,[;SENDMSG;],[;])
ENDIF
*------------------------------------------------------------------------------

*29.03.2007 12:20 -&gt;Óäàëÿåì ñëåâà è ñïðàâà ; äîáàâëåííûå ðàíåå
IF !(lcHandledCustomMsgList==[;])
	lcHandledCustomMsgList= SUBSTR(lcHandledCustomMsgList,2,LEN(lcHandledCustomMsgList)-2)
ELSE
	lcHandledCustomMsgList = []
ENDIF	
*------------------------------------------------------------------------------

*29.03.2007 12:20 -&gt;Âîçâðàùàåì ðåçóëüòàò
RETURN lcHandledCustomMsgList
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE _handlecustommsg
LPARAMETERS	tcMessage

*29.03.2007 12:20 -&gt;Åñëè ñîîáùåíèå(êîìàíäà) ïóñòîå, òî âûõîäèì
IF EMPTY(tcMessage)
	RETURN tcMessage
ENDIF
*------------------------------------------------------------------------------

*29.03.2007 12:21 -&gt;Ïûòàåìñÿ îáðàáîòàòü ñîîáùåíèå(êîìàíäó)
DO CASE
	CASE tcMessage = [SENDMSG]
		This.SendMsg()
		tcMessage = []
	CASE tcMessage = [CLOSESESSION]
		This.CloseSession()
		tcMessage = []
	CASE tcMessage = [SENDMSGALL]
		This.SendMsgAll()
		tcMessage = []
ENDCASE
*------------------------------------------------------------------------------

RETURN tcMessage
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE closesession
*29.03.2007 12:40 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*29.03.2007 12:40 -&gt;Çàêðîåì ñåññèþ
USE IN SELECT([lvSessionEdit])
_PARAM = lvSessionView.SessionID
USE lvSessionEdit IN 0
UPDATE lvSessionEdit SET SessionStatus = 2
***
TABLEUPDATE(1,.T.,[lvSessionEdit])
*------------------------------------------------------------------------------

*29.03.2007 12:41 -&gt;Îáíîâèì Grid
REQUERY([lvSessionView])
This.Refresh()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
PROCEDURE Init
*29.03.2007 11:07 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*29.03.2007 11:07 -&gt;Ïîêðàñèì íåàêòèâíûå ñåññèè
This.SetAll([DynamicForeColor],[IIF(lvSessionView.SessionLive = 1,]+ALLTRIM(STR(This.Column1.TxtGrd1.ForeColor))+[,]+ALLTRIM(STR(This.Column1.TxtGrd1.DisabledForeColor))+[)],[Column])
This.SetAll([DynamicFontItalic],[lvSessionView.SessionLive &lt;&gt; 1],[Column])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE sendmsg
oMgrAdmin.Do([SESSION],[SENDMSG],lvSessionView.SessionID,lvSessionView.UserId)
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE sendmsgall
oMgrAdmin.Do([SESSION],[SENDMSGALL])
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>9</reserved2>
		<reserved3>*closesession çàêðûòèå íåàêòèâíûõ ñåññèé
*sendmsg îòïðàâêà ñîîáùåíèé
*sendmsgall 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10N8VT</uniqueid>
		<timestamp>915243560</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdsession.Column1</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Ðàáî÷àÿ ñòàíöèÿ"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10TV87</uniqueid>
		<timestamp>914131415</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdsession.Column1</parent>
		<properties>Left = 37
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10N8VV</uniqueid>
		<timestamp>915243560</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdsession.Column2</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Ïîëüçîâàòåëü ÐÑ"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10TV89</uniqueid>
		<timestamp>914131415</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdsession.Column2</parent>
		<properties>Left = 32
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10N8VX</uniqueid>
		<timestamp>915243560</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdsession.Column3</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Ïîëüçîâàòåëü"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10TV8B</uniqueid>
		<timestamp>914131415</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdsession.Column3</parent>
		<properties>Left = 39
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10N8VZ</uniqueid>
		<timestamp>915243560</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdsession.Column4</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Íà÷àëî ñåàíñà"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21S10TV8D</uniqueid>
		<timestamp>914131415</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdsession.Column4</parent>
		<properties>Left = 22
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdsession</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0SJUZV</uniqueid>
		<timestamp>952530017</timestamp>
		<class>scrfrmedit</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmmessenger</objname>
		<parent/>
		<properties>Height = 265
Width = 595
DoCreate = .T.
Caption = "Ñîîáùåíèÿ"
Closable = .T.
WindowType = 0
nsessionid = 0
nrecuser = 0
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmmessenger"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE Init
LPARAMETERS	tnScrFrmID, tnSessionID,tnUser
this.nRecUser = tnUser
*29.03.2007 14:50 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	_PARAM
*------------------------------------------------------------------------------

*29.03.2007 14:48 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tnScrFrmID)
*------------------------------------------------------------------------------

*29.03.2007 14:49 -&gt;Ñîõðàíèì èäåíòèôèêàòîð ñåññèè
This.nSessionID = tnSessionID
*------------------------------------------------------------------------------

*29.03.2007 15:13 -&gt;Ïîêàçûâàåì ñîîáùåíèÿ
_PARAM = This.nSessionID
REQUERY([lvUserMsgView])
GO TOP IN lvUserMsgView
*------------------------------------------------------------------------------

*30.03.2007 16:06 -&gt;Ïðîâåðèì âîçìîæíîñòü îòïðàâêè ñîîáùåíèé ïîëüçîâàòåëåì
This.cntIdCtlGridUA.Enabled = _spVerifyUserGrant(oApp.nUserKod, [CustomFunc], [MSGACTION])
*------------------------------------------------------------------------------

*30.03.2007 16:05 -&gt;Ïîëó÷èì èìÿ ïîëüçîâàòåëÿ
_PARAM = oApp.nUserKod
USE IN SELECT([lvUserInfoByID])
USE lvUserInfoByID IN 0
This.Caption = This.Caption + [ - ]+ALLTRIM(lvUserInfoByID.UserLogin)
USE IN SELECT([lvUserInfoByID])
*------------------------------------------------------------------------------

oSession.oMessenger = This


*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Load
*29.03.2007 14:42 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*29.03.2007 14:42 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([Basis])
	OPEN DATABASE Basis SHARED
ENDIF
***
SET DATABASE TO Basis
*------------------------------------------------------------------------------

*29.03.2007 14:42 -&gt;Îòêðûâàåì ñïèñîê cîîáùåíèé
USE lvUserMsgView IN 0 NODATA
*------------------------------------------------------------------------------

*30.03.2007 14:38 -&gt;Îòêðûâàåì ñïðàâî÷íèê äåéñòâèé
USE lvUserMsgActionView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE newmsg
LPARAMETERS tnMsgID, tlOutMsg

*30.03.2007 09:24 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
LOCAL ARRAY laNewMsg[1]
*------------------------------------------------------------------------------

*30.03.2007 09:24 -&gt;×èòàåì íîâîå ñîîáùåíèå
USE IN SELECT([lvUserMsgRepl])
_PARAM = tnMsgID
USE lvUserMsgRepl IN 0
SELECT lvUserMsgRepl
SCATTER TO laNewMsg
USE IN SELECT([lvUserMsgRepl])
*------------------------------------------------------------------------------

*30.03.2007 09:27 -&gt;Äîáàâëÿåì ñîîáùåíèå â ñïèñîê
SELECT lvUserMsgView
APPEND BLANK
GATHER FROM laNewMsg
*------------------------------------------------------------------------------

*30.03.2007 11:58 -&gt;Äëÿ èñõîäÿùåãî ñîîîáùåíèÿ ìåíÿåì òèï
REPLACE lvUserMsgView.MsgType WITH IIF(tlOutMsg,0,1)
*------------------------------------------------------------------------------

This.grdMessage.Refresh()

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************


ENDPROC
PROCEDURE sendmsg
*30.03.2007 10:43 -&gt;Îòïðàâëÿåì ñîîáùåíèå
USE IN SELECT([lvUserMsgEdit])
USE lvUserMsgEdit  IN 0 NODATA
APPEND BLANK IN lvUserMsgEdit
REPLACE ;
	lvUserMsgEdit.SessionID		WITH This.nSessionID,;
	lvUserMsgEdit.UserMsgCont	WITH This.edtMsg.Value, ;
	lvUserMsgEdit.AuthorSessionID WITH oSession.SessionID, ;
	lvUserMsgEdit.UserMsgActionID WITH IIF(This.cntIdCtlGridUA.Value = 0,.NULL.,This.cntIdCtlGridUA.Value), ;
	lvUserMsgEdit.RecUser	 	WITH this.nRecUser ;
IN lvUserMsgEdit
***
IF NOT TABLEUPDATE(1,.T.,[lvUserMsgEdit])
	MESSAGEBOX([Ñîîáùåíèå íå îòïðàâëåíî!],48,[Îøèáêà])
	TABLEREVERT(.T.,[lvUserMsgEdit])
	RETURN .F.
ELSE
	*30.03.2007 11:06 -&gt;Äîáàâëÿåì ñîîáùåíèå â ñïèñîê
	This.NewMsg(spGetLastIncrementedID([lvUserMsgEdit]),.T.)
	*------------------------------------------------------------------------------
	This.edtMsg.Value = []
	USE IN SELECT([lvUserMsgEdit])
	RETURN .T.
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
	

ENDPROC
PROCEDURE Unload
oSession.oMessenger = .NULL.

*29.03.2007 16:23 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>6</reserved2>
		<reserved3>nsessionid
nrecuser Ïîëó÷àòåëü ñîîáùåíèÿ
*newmsg ïîëó÷åíèå âõîäÿøåãî ñîîáùåíèÿ
*sendmsg 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21U0UY8B9</uniqueid>
		<timestamp>952530017</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridUA</objname>
		<parent>frmmessenger</parent>
		<properties>Top = 209
Left = 382
Width = 207
Height = 23
ZOrderSet = 3
_rsaliasname = lvUserMsgActionView
_rsfieldnameid = ID
_rsfieldnametext = NM
_showtextempty = Äåéñòâèå íå âûáðàíî
Name = "cntIdCtlGridUA"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 159
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 161
cmdShow.Name = "cmdShow"
cmdClear.Top = 0
cmdClear.Left = 184
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0SMY4X</uniqueid>
		<timestamp>915246279</timestamp>
		<class>grdmessage</class>
		<classloc>admin.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdMessage</objname>
		<parent>frmmessenger</parent>
		<properties>Left = 5
Top = 5
Name = "grdMessage"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.Name = "Column3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0TBWYA</uniqueid>
		<timestamp>952530017</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtMsg</objname>
		<parent>frmmessenger</parent>
		<properties>Left = 5
Top = 209
Width = 313
Name = "edtMsg"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
This.Parent.cmdSend.Enabled = NOT EMPTY(This.Value)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21T0TBWYB</uniqueid>
		<timestamp>952530017</timestamp>
		<class>cmd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cmdSend</objname>
		<parent>frmmessenger</parent>
		<properties>Top = 237
Left = 490
Caption = "Îòïðàâèòü"
Enabled = .F.
Name = "cmdSend"
</properties>
		<protected/>
		<methods>PROCEDURE Click
This.Parent.SendMsg()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_21U0UY8BB</uniqueid>
		<timestamp>952530017</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblMsgAction</objname>
		<parent>frmmessenger</parent>
		<properties>FontBold = .T.
Caption = "Äåéñòâèå:"
Left = 321
Top = 212
ZOrderSet = 13
Name = "lblMsgAction"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmmessenger</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
