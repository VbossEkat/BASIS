<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Class</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U010ZVFS</uniqueid>
		<timestamp>0</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcardtypeedit</objname>
		<parent/>
		<properties>Height = 85
Width = 315
DoCreate = .T.
BorderStyle = 2
Caption = "Òèï êàðòû"
cmode = 
Name = "frmcardtypeedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardTypeEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*23.06.2006 17:19 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*23.06.2006 17:19 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*23.06.2006 17:19 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*23.06.2006 17:19 -&gt;Óäàëèì çàïèñü
		DELETE IN lvCardTypeEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*23.06.2006 17:20 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*23.06.2006 17:20 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvCardTypeEdit])
	*------------------------------------------------------------------------------
	
	*23.06.2006 17:20 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*23.06.2006 17:20 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*23.06.2006 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode,[EDIT],[DELE])

				*23.06.2006 17:20 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*23.06.2006 17:21 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = spGetLastIncrementedID([lvCardTypeEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*23.06.2006 17:21 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*23.06.2006 17:21 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*23.06.2006 17:21 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*23.06.2006 17:21 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*23.06.2006 17:21 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvCardTypeEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*23.06.2006 17:21 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*23.06.2006 17:22 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvCardTypeEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*23.06.2006 17:22 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardTypeEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcCommand, tuParam1

*23.06.2006 17:16 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*23.06.2006 17:16 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*23.06.2006 17:16 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcCommand))
*------------------------------------------------------------------------------

*23.06.2006 17:17 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode==[ADD]
		
		*12.05.2004 00:32 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		APPEND BLANK IN lvCardTypeEdit
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cMode,[EDIT],[INFO],[DELE])
		
		*23.06.2006 17:17 -&gt;Çàãðóçèì äàííûå î ñóùåñòâóþùåé êàðòå
		_PARAM = tuParam1
		***
		REQUERY([lvCardTypeEdit])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*.Icon = FULLPATH([???.ico])
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		
*23.06.2006 17:17 -&gt;Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardTypeEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ñïðàâî÷íèêîâ
*------------------------------------------------------------------------------

*23.06.2006 17:10 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*23.06.2006 17:10 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*23.06.2006 17:10 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ äèñêîíòíûõ êàðò (ïóñòîé)
USE lvCardTypeEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvCardTypeEdit])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>8</reserved2>
		<reserved3>cmode
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ðåäàêòîð òèïîâ êàðò</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WH</uniqueid>
		<timestamp>0</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCardTypeNM</objname>
		<parent>frmcardtypeedit</parent>
		<properties>ControlSource = "lvCardTypeEdit.CardTypeNM"
Height = 23
Left = 135
Top = 5
Width = 175
Name = "txtCardTypeNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NI0R9WHL</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardTypeNM</objname>
		<parent>frmcardtypeedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû"
Left = 5
Top = 8
Name = "lblCardTypeNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WK</uniqueid>
		<timestamp>0</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmcardtypeedit</parent>
		<properties>FontBold = .T.
Caption = "Áåçíàëè÷íàÿ îïëàòà"
Left = 5
Top = 33
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WL</uniqueid>
		<timestamp>0</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>CHK1</objname>
		<parent>frmcardtypeedit</parent>
		<properties>Top = 33
Left = 135
Alignment = 0
Caption = ""
ControlSource = "lvCardTypeEdit.CardTypePay"
Name = "CHK1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WM</uniqueid>
		<timestamp>0</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmcardtypeedit</parent>
		<properties>Top = 58
Left = 105
ZOrderSet = 29
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30KIRZL</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmcardtypeedit</parent>
		<properties>Height = 0
Left = 2
Top = 54
Width = 311
ZOrderSet = 9
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30KIRZM</uniqueid>
		<timestamp>0</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmcardtypeedit</parent>
		<properties>Height = 0
Left = 3
Top = 55
Width = 311
BorderColor = 255,255,255
ZOrderSet = 10
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcardtypeedit</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>0</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcardtypeview</objname>
		<parent/>
		<properties>DoCreate = .T.
Caption = "Òèïû êàðò"
Name = "frmcardtypeview"
cstmsghandler.Top = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardTypeView.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
DODEFAULT()

*23.06.2006 16:33 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*23.06.2006 16:33 -&gt;Îòêðîåì ñïðàâî÷íèê òèïîâ ñêèäîê
USE lvCardTypeView IN 0
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ñïèñîê òèïîâ êàðò</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00ZUDQV</uniqueid>
		<timestamp>0</timestamp>
		<class>grdcardtype</class>
		<classloc>card_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdCardType</objname>
		<parent>frmcardtypeview</parent>
		<properties>Left = 5
Top = 5
Name = "grdCardType"
Column1.Header1.Name = "Header1"
Column1.Text1.Name = "Text1"
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcardtypeview</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00ZK0QR</uniqueid>
		<timestamp>0</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdcardtype</objname>
		<parent/>
		<properties>ColumnCount = 1
Height = 240
Panel = 1
RecordSource = "lvCardTypeView"
ScrollBars = 2
Width = 365
HighlightStyle = 2
Name = "grdcardtype"
Column1.ControlSource = "lvCardTypeView.CardTypeNM"
Column1.Width = 335
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCardType._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîãî òèïà êàðò.
*-------------------------------------------------------

*23.06.2006 17:33 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*23.06.2006 17:33 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé êàññû
lnResAdding = oMgrCard.Do([CARDTYPE],[ADD])
*------------------------------------------------------------------------------

*23.06.2006 17:36 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*23.06.2006 17:36 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*03.11.2005 14:41 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîì êëèåíòå
	IF USED([lvCardTypeRepl])
		USE IN lvCardTypeRepl
	ENDIF
	_PARAM = lnId
	USE lvCardTypeRepl IN 0
	*------------------------------------------------------------------------------
	
	*23.06.2006 17:38 -&gt;Îáíîâèì äàííûå â lvCardTypeRepl
	SELECT lvCardTypeRepl
	SCATTER TO laReplaceArray
	SELECT lvCardTypeView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*23.06.2006 17:38 -&gt;Çàêðîåì Alis
	USE IN lvCardTypeRepl
	*------------------------------------------------------------------------------
		
	*23.06.2006 17:38 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardTypeView
	LOCATE FOR lvCardTypeView.CardTypeID = lnID
	*------------------------------------------------------------------------------

	*23.06.2006 17:39 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*23.06.2006 17:39 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*23.06.2006 17:39 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _dele
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Cash_v1.vcx
* Class.Module....: grdCardType._Dele
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Óäàëåíèå òèïà êàðòû
*------------------------------------------------------------------------------

*26.06.2006 10:20 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	luDeleRes, ;
		lnID
***
lnID = lvCardTypeView.CardTypeID
*------------------------------------------------------------------------------

*26.06.2006 10:20 -&gt;Âûïîëíèì îïåðàöèþ óäàëåíèÿ
luDeleRes = oMgrCard.Do([CARDTYPE], [DELE], lvCardTypeView.CardTypeID)
*------------------------------------------------------------------------------

*26.06.2006 10:21 -&gt;Îáðàáîòàåì ðåçóëüòàòû óäàëåíèÿ
IF TYPE([luDeleRes]) == [L] AND luDeleRes

	DELETE FOR lvCardTypeView.CardTypeID = lnID
		
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCardType._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î òèïå êàðò.
*-------------------------------------------------------

*26.06.2006 10:31 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnId, ;
		luResEditing
***
lnId = lvCardTypeView.CardTypeId
*------------------------------------------------------------------------------

*26.06.2006 10:31 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ òèïà êàðòû
luResEditing = oMgrCard.Do([CARDTYPE],[EDIT],lnId)
*------------------------------------------------------------------------------

*26.06.2006 10:32 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp;äàííûå î òèïå ñêèäêè èçìåíåíû
	
	*26.06.2006 10:32 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*26.06.2006 10:32 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå ñêèäêè
	IF USED([lvCardTypeRepl])
		USE IN lvCardTypeRepl
	ENDIF
	_PARAM = lnId
	USE lvCardTypeRepl IN 0
	*------------------------------------------------------------------------------

	*26.06.2006 10:32 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardTypeRepl
	SCATTER TO laReplaceArray
	SELECT lvCardTypeView
	LOCATE FOR lvCardTypeView.CardTypeID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*26.06.2006 10:33 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvCardTypeRepl
	*------------------------------------------------------------------------------

	*26.06.2006 10:33 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*26.06.2006 10:33 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*26.06.2006 10:33 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCardType._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î òèïå êàðòû.
*-------------------------------------------------------

*26.06.2006 10:30 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î òèïå êàðòû
oMgrCard.Do([CARDTYPE],[INFO],lvCardTypeView.CardTypeId)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _rsrequery
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Discount_v1.vcx
* Class.Module....: grdCardType._rsRequery
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

WITH This

*26.06.2006 10:23 -&gt;Ñîõðàíèì äàííûå î RecordSource
.SourceKeep()
*------------------------------------------------------------------------------

*26.06.2006 10:23 -&gt;Îòêëþ÷èì RecordSource
.SourceReset()
*------------------------------------------------------------------------------

*26.06.2006 10:23 -&gt;Ïåðå÷èòàåì Local View
REQUERY([lvCardTypeView])

*26.06.2006 10:23 -&gt;Âîññòàíàâëèâàåì RecordSource
.SourceRecall()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00ZR0PC</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcardtype.Column1</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00ZY5HZ</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcardtype.Column1</parent>
		<properties>Left = 73
Top = 23
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdcardtype</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0K3ZFE</uniqueid>
		<timestamp>927163528</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdcard_old</objname>
		<parent/>
		<properties>ColumnCount = 3
RecordSource = "lvCardView"
ScrollBars = 2
Width = 370
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;ADD;EDIT;INFO;\-;EXCEL
_handledstandartmsgpromptlist = ;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;;Ýêñïîðò â Excel
Name = "grdcard"
Column1.ControlSource = "lvCardView.CardNo"
Column1.Width = 90
Column1.Name = "Column1"
Column2.ControlSource = "lvCardView.OwnerNM"
Column2.Width = 150
Column2.Name = "Column2"
Column3.ControlSource = "lvCardView.CardTypeNM"
Column3.Width = 97
Column3.Name = "Column3"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCard._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîé êàðòû.
*-------------------------------------------------------

*26.06.2006 11:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*26.06.2006 11:00 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé êàðòû
lnResAdding = oMgrCard.Do([CARD],[ADD])
*------------------------------------------------------------------------------

*26.06.2006 11:01 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*26.06.2006 11:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:01 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîé êàðòû
	IF USED([lvCardRepl])
		USE IN lvCardRepl
	ENDIF
	_PARAM = lnId
	USE lvCardRepl IN 0
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:01 -&gt;Îáíîâèì äàííûå â lvCardView
	SELECT lvCardRepl
	SCATTER TO laReplaceArray
	SELECT lvCardView
	APPEND BLANK
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*26.06.2006 11:15 -&gt;Çàêðîåì Alis
	USE IN lvCardRepl
	*------------------------------------------------------------------------------
		
	*26.06.2006 11:15 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardView
	LOCATE FOR lvCardView.CardID = lnID
	*------------------------------------------------------------------------------

	*26.06.2006 11:15 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*26.06.2006 11:15 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:15 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Discount_v1.vcx
* Class.Module....: grdCard._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î êàðòå.
*------------------------------------------------------------------------------

*26.06.2006 15:43 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnId, ;
		luResEditing
***
lnId = lvCardView.CardId
*------------------------------------------------------------------------------

*26.06.2006 15:43 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ òèïà äîêóìåíòà
luResEditing = oMgrCard.Do([CARD],[EDIT],lnId)
*------------------------------------------------------------------------------

*26.06.2006 15:43 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp; äàííûå î äèñêîíòíîé êàðòå
	
	*26.06.2006 15:43 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*26.06.2006 15:43 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå ñêèäêè
	IF USED([lvCardRepl])
		USE IN lvCardRepl
	ENDIF
	_PARAM = lnId
	USE lvCardRepl IN 0
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardRepl
	SCATTER TO laReplaceArray
	SELECT lvCardView
	LOCATE FOR lvCardView.CardID = lnID
	GATHER FROM laReplaceArray
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvCardRepl
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*08.11.2005 15:49 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*26.06.2006 15:44 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: DiscCard._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î êàðòàõ.
*-------------------------------------------------------

*01.04.2004 18:49 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î äèñêîíòíûõ êàðòàõ
oMgrCard.Do([CARD],[INFO],lvCardView.CardId)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCard.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*26.06.2006 10:59 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 10:59 -&gt;Óñòàíîâèì öâåòîâóþ ãàììó äëÿ íåàêòèâíûõ êàññèðîâ
This.SetAll([DynamicForeColor],[IIF(lvCardView.CardIsActive,]+ALLTRIM(STR(This.Column1.TxtGrd1.ForeColor))+[,]+ALLTRIM(STR(This.Column1.TxtGrd1.DisabledForeColor))+[)],[Column])
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>7</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMI</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard_old.Column1</parent>
		<properties>FontBold = .T.
Caption = "Íîìåð êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTB</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard_old.Column1</parent>
		<properties>Left = 49
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMK</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard_old.Column2</parent>
		<properties>FontBold = .T.
Caption = "Êëèåíò"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTC</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard_old.Column2</parent>
		<properties>Left = 42
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMM</uniqueid>
		<timestamp>0</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard_old.Column3</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTD</uniqueid>
		<timestamp>0</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard_old.Column3</parent>
		<properties>Left = 23
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdcard_old</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0N5SIM</uniqueid>
		<timestamp>927163530</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcardedit_di</objname>
		<parent/>
		<properties>Height = 525
Width = 445
DoCreate = .T.
Caption = "Êàðòà"
cmode = 
Name = "frmcardedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Cash_v1.vcx
* Class.Module....: frmCardEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*26.06.2006 12:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------

*26.06.2006 12:30 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	
	*09.08.2006 13:15 -&gt;Ñòàâèì NULL â íóæíûå ìåñòà
	IF lvCardEdit.CardFrmID = 0
		REPLACE lvCardEdit.CardFrmID WITH .NULL.
	ENDIF
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*26.06.2006 12:30 -&gt;Óäàëèì çàïèñü
		DELETE IN lvCardEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvCardEdit])
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*26.06.2006 12:30 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode,[EDIT],[DELE])

				*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]

				*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvCardEdit])
				*------------------------------------------------------------------------------

		ENDCASE
		*------------------------------------------------------------------------------
		
	ELSE
		
		*26.06.2006 12:31 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:31 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*26.06.2006 12:31 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*26.06.2006 12:31 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*26.06.2006 12:31 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvCardEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:32 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*08.11.2005 12:49 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvCardEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*26.06.2006 12:32 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcCommand, tuParam1

*26.06.2006 12:26 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*26.06.2006 12:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcCommand))
*------------------------------------------------------------------------------

*26.06.2006 12:27 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode==[ADD]
		
		*26.06.2006 12:27 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		APPEND BLANK IN lvCardEdit
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cMode,[EDIT],[INFO],[DELE])
		
		*26.06.2006 12:27 -&gt;Çàãðóçèì äàííûå î ñóùåñòâóþùåé äèñêîíòíîé êàðòå
		_PARAM = tuParam1
		***
		REQUERY([lvCardEdit])
		*------------------------------------------------------------------------------

		*26.06.2006 12:27 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
		_PARAM = lvCardEdit.CardOwnerID
		***
		REQUERY([lvCltPhysInfo])
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*.Icon = FULLPATH([???.ico])
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå]
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		
*26.06.2006 12:27 -&gt;Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

*05.07.2006 21:12 -&gt;Äåëàåì äîñòóïíûì âîçìîæíîñòü äîáàâëåíèÿ è ïðîñìîòðà êëèåíòà
.cntIdCtlGridOwner._grdAddParams = [oMgrClient;CLT;FASTADDPHYS;] + ALLTRIM(STR(lvCardEdit.CardOwnerID)) + [;lvCltInCntViewRepl]
.cntIdCtlGridOwner._grdInfoParams = [oMgrClient;CLT;INFO]
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ñïðàâî÷íèêîâ
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàðò (ïóñòîé)
USE lvCardEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvCardEdit])
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ïîêóïàòåëåé
USE lvCltPhysicalList IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ñîòðóäíèêîâ
USE lvCltEmployeeList IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î ïîêóïàòåëå (ïóñòîé)
USE lvCltPhysInfo IN 0 NODATA
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î òèïàõ êàðò
USE lvCardTypeView IN 0
*------------------------------------------------------------------------------

*06.07.2006 11:39 -&gt;Îòêðûâàåì ñïèñîê äîãîâîðîâ
USE lvCardFrmList IN 0
*------------------------------------------------------------------------------

*06.07.2006 11:39 -&gt;Îòêðûâàåì ñïèñîê äîãîâîðîâ
USE lvCardFrmList IN 0
*------------------------------------------------------------------------------

*17.07.2006 11:09 -&gt;Îòêðûâàåì ñïèñîê þðèäè÷åñêèõ ëèö
USE lvCltJuridicalList IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>44</reserved2>
		<reserved3>cmode
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardCode</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Êîä êàðòû"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 0
Name = "lblCardCode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>ctlTxtCLU</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 33
Left = 75
Width = 249
Height = 23
TabIndex = 4
ZOrderSet = 1
Name = "ctlTxtCLU"
txtText.ControlSource = "lvCardEdit.CardCode"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 200
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblCardCode
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 207
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>cnkDiscCardIsActive</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 34
Left = 340
FontBold = .T.
Alignment = 0
Caption = "Èñïîëüçóåòñÿ"
ControlSource = "lvCardEdit.CardIsActive"
TabIndex = 5
ZOrderSet = 2
Name = "cnkDiscCardIsActive"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF ThisForm.cMode = [EDIT] AND lvCardEdit.CardIsActive
	REPLACE lvCardEdit.CardExpiredDate WITH DTOT(DATE())
	ThisForm.comTxtCalendExpiredDate.Refresh()
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOwner</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Âëàäåëåö:"
Left = 5
Top = 92
TabIndex = 8
ZOrderSet = 3
Name = "lblOwner"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30V4Y69</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridOwner</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 89
Left = 75
Width = 250
Height = 23
TabIndex = 9
ZOrderSet = 4
_rsaliasname = lvCltPhysicalList
_rsfieldnameid = ID
_rsfieldnametext = NM
_controlsource = lvCardEdit.CardOwnerID
_controlsourcetype = 1
Name = "cntIdCtlGridOwner"
txtText._highlightobject = .parent.parent.lblCardType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: cntIDCtlGridCustomer._RefreshRelatedObjects
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â ñâÿçàííûõ îáúåêòàõ
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
_PARAM = lvCardEdit.CardOwnerID
***
REQUERY([lvCltPhysInfo])
*------------------------------------------------------------------------------

*09.11.2005 12:10 -&gt;Îáíîâèì ïîëÿ
WITH ThisForm
	.txtFNM.Refresh()
	.txtINM.Refresh()
	.txtONM.Refresh()
	.txtCltPhysBirthDate.Refresh()
	.txtCltPasspSeries.Refresh()
	.txtCltPasspNumber.Refresh()
	.txtCltPasspIssueBy.Refresh()
	.txtCltPasspIssueDate.Refresh()
ENDWITH
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32O</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardType</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 3
Name = "lblCardType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IA0O65KW</uniqueid>
		<timestamp>889809429</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 117
Left = 5
Height = 61
Width = 435
SpecialEffect = 0
ZOrderSet = 5
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1FB0UFKZR</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFNM</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Ôàìèëèÿ:"
Left = 10
Top = 125
TabIndex = 10
ZOrderSet = 6
Name = "lblFNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtFNM</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysFNM"
Enabled = .F.
Left = 75
TabIndex = 11
Top = 122
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 7
AutoCompSource = ""
Name = "txtFNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0LECEB</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Èìÿ:"
Left = 245
Top = 125
TabIndex = 12
ZOrderSet = 8
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtINM</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysINM"
Enabled = .F.
Height = 23
Left = 285
TabIndex = 13
Top = 122
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 9
Name = "txtINM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0UFNDL</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl3</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Îò÷åñòâî:"
Left = 10
Top = 153
TabIndex = 14
ZOrderSet = 10
Name = "Lbl3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KT0W0MLJ</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtONM</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysONM"
Enabled = .F.
Left = 75
TabIndex = 15
Top = 150
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 11
Name = "txtONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KT0W0MLK</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl4</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Äàòà ðîæäåíèÿ:"
Left = 245
Top = 153
TabIndex = 16
ZOrderSet = 12
Name = "Lbl4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0MRBGT</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltPhysBirthDate</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysBirthDate"
Enabled = .F.
Format = "D"
Left = 365
TabIndex = 17
Top = 150
Width = 70
DisabledForeColor = 0,0,0
ZOrderSet = 13
NullDisplay = " "
Name = "txtCltPhysBirthDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQV</uniqueid>
		<timestamp>889809429</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp2</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 182
Left = 5
Height = 89
Width = 435
SpecialEffect = 0
ZOrderSet = 14
Name = "Shp2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQX</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltPasspSeries</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
WordWrap = .T.
Caption = "Ïàñïîðò ñåðèÿ:"
Height = 32
Left = 10
Top = 184
Width = 51
TabIndex = 18
ZOrderSet = 15
Name = "lblCltPasspSeries"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQW</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltPasspSeries</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPasspSeries"
Enabled = .F.
Height = 23
Left = 75
TabIndex = 19
Top = 187
Width = 89
DisabledForeColor = 0,0,0
ZOrderSet = 16
Name = "txtCltPasspSeries"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNR1</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltPasspNumber</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Íîìåð:"
Left = 10
Top = 218
TabIndex = 22
ZOrderSet = 17
Name = "lblCltPasspNumber"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltPasspNumber</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPasspNumber"
Enabled = .F.
Height = 23
Left = 75
TabIndex = 23
Top = 215
Width = 89
DisabledForeColor = 0,0,0
ZOrderSet = 18
Name = "txtCltPasspNumber"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQZ</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltAddr</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Âûäàí:"
Left = 174
Top = 190
TabIndex = 20
ZOrderSet = 19
Name = "lblCltAddr"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UO0NS0WR</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Îðãàíèçàöèÿ:"
Left = 5
Top = 306
TabIndex = 27
ZOrderSet = 21
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UO0NS0WS</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>ñntIDCtlGridJrdID</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 303
Left = 120
TabIndex = 28
ZOrderSet = 22
_controlsourcetype = 1
_controlsource = lvCardEdit.CltJrdID
_rsaliasname = lvCltJuridicalList
_rsfieldnameid = ID
_rsfieldnametext = NM
_showtextempty = Îðãàíèçàöèÿ íå óêàçàíà
Name = "ñntIDCtlGridJrdID"
txtText._highlightobject = .parent.parent.lblDoc
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQY</uniqueid>
		<timestamp>888232308</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>txtCltPasspIssueBy</objname>
		<parent>frmcardedit_di</parent>
		<properties>Enabled = .F.
Height = 52
Left = 223
ScrollBars = 0
TabIndex = 21
Top = 186
Width = 212
DisabledForeColor = 0,0,0
ZOrderSet = 20
ControlSource = "lvCltPhysInfo.CltPasspIssueBy"
Name = "txtCltPasspIssueBy"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblJrd</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Âûäàë:"
Left = 5
Top = 335
TabIndex = 29
ZOrderSet = 21
Name = "lblJrd"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridEmpl</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 332
Left = 120
TabIndex = 30
ZOrderSet = 22
_controlsourcetype = 1
_controlsource = lvCardEdit.CardSupplID
_rsaliasname = lvCltEmployeeList
_rsfieldnameid = ID
_rsfieldnametext = NM
_showtextempty = Îïåðàòîð íå âûáðàí
Name = "cntIdCtlGridEmpl"
txtText._highlightobject = .parent.parent.lblJrd
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeliveryDate</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Äàòà âûäà÷è:"
Left = 5
Top = 363
TabIndex = 31
ZOrderSet = 23
Name = "lblDeliveryDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCalendDeliveryDate</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 360
Left = 120
Width = 156
Height = 23
TabIndex = 32
ZOrderSet = 24
Name = "comTxtCalendDeliveryDate"
txtText.ControlSource = "lvCardEdit.CardDeliveryDate"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 130
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 133
cmdShow.Name = "cmdShow"
</properties>
		<protected/>
		<methods>PROCEDURE txtText._handleanychange
*05.07.2006 14:13 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   ltDateValue
*------------------------------------------------------------------------------

*05.07.2006 14:14 -&gt;Îïðåäåëèì äàòó
IF TYPE([This.Value])=[D]
	ltDateValue = DTOT(This.Value)
ELSE
	ltDateValue = This.Value
ENDIF
*------------------------------------------------------------------------------

*26.06.2006 16:30 -&gt;Óñòàíàâëèâàåì ñðîê äåéñòâèÿ êàðòû
DO CASE
	CASE INLIST(lvCardEdit.CardTypeID,1,2)
		REPLACE lvCardEdit.CardExpiredDate WITH DTOT(TTOD(ltDateValue)+183)
	CASE INLIST(lvCardEdit.CardTypeID,3,4)
		REPLACE lvCardEdit.CardExpiredDate WITH DTOT(TTOD(ltDateValue)+1)
ENDCASE
***
ThisForm.comTxtCalendExpiredDate.Refresh()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0O51P5</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl5</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Äåéñòâèòåëüíà äî:"
Left = 5
Top = 391
TabIndex = 33
ZOrderSet = 25
Name = "Lbl5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridCardType</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 5
Left = 75
Width = 250
Height = 23
TabIndex = 2
ZOrderSet = 4
_controlsourcetype = 1
_controlsource = lvCardEdit.CardTypeID
_rsaliasname = lvCardTypeView
_rsfieldnameid = CardTypeID
_rsfieldnametext = CardTypeNM
_showtextempty = Òèï íå âûáðàí
Name = "cntIdCtlGridCardType"
txtText._highlightobject = .parent.parent.lblCardType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Discount_v1.vcx
* Class.Module....: CNTIDCTLGRIDCUSTOMER._REFRESHRELATEDOBJECTS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â ñâÿçàííûõ îáúåêòàõ
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
_PARAM = lvCardEdit.CardOwnerID
***
REQUERY([lvCltPhysInfo])
*------------------------------------------------------------------------------

*09.11.2005 12:10 -&gt;Îáíîâèì ïîëÿ
WITH ThisForm
	.txtFNM.Refresh()
	.txtINM.Refresh()
	.txtONM.Refresh()
	.txtCltPhysBirthDate.Refresh()
	.txtCltPasspSeries.Refresh()
	.txtCltPasspNumber.Refresh()
	.txtCltPasspIssueBy.Refresh()
	.txtCltPasspIssueDate.Refresh()
ENDWITH
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVR</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmcardedit_di</parent>
		<properties>Height = 0
Left = 0
Top = 494
Width = 445
ZOrderSet = 27
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVQ</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmcardedit_di</parent>
		<properties>Height = 0
Left = 0
Top = 495
Width = 445
BorderColor = 255,255,255
ZOrderSet = 28
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVP</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 498
Left = 235
TabIndex = 37
ZOrderSet = 29
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32U</uniqueid>
		<timestamp>889809429</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCtlCalcLen</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 61
Left = 75
Width = 249
Height = 23
TabIndex = 7
ZOrderSet = 1
Name = "comTxtCtlCalcLen"
txtText.ControlSource = "lvCardEdit.CardNo"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 200
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblCardNo
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 207
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32X</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardNo</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "¹ êàðòû"
Left = 5
Top = 64
TabIndex = 6
ZOrderSet = 0
Name = "lblCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC332</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblNote</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 418
TabIndex = 35
ZOrderSet = 23
Name = "lblNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QIL4X</uniqueid>
		<timestamp>889809429</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCalendExpiredDate</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 388
Left = 120
Width = 156
Height = 23
TabIndex = 34
ZOrderSet = 24
Name = "comTxtCalendExpiredDate"
txtText.ControlSource = "lvCardEdit.CardExpiredDate"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 129
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 133
cmdShow.Name = "cmdShow"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UD0OCY6W</uniqueid>
		<timestamp>888232308</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltPasspIssueDate</objname>
		<parent>frmcardedit_di</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPasspIssueDate"
Enabled = .F.
Height = 23
Left = 223
TabIndex = 24
Top = 242
Width = 74
DisabledForeColor = 0,0,0
ZOrderSet = 18
Name = "txtCltPasspIssueDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00ZUDQV</uniqueid>
		<timestamp>889809429</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIDCtlGridDoc</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 275
Left = 120
TabIndex = 26
ZOrderSet = 22
_controlsourcetype = 1
_controlsource = lvCardEdit.CardFrmID
_rsaliasname = lvCardFrmList
_rsfieldnameid = ID
_rsfieldnametext = NM
_showtextempty = Äîãîâîð íå óêàçàí
Name = "cntIDCtlGridDoc"
txtText._highlightobject = .parent.parent.lblDoc
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>889809429</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDoc</objname>
		<parent>frmcardedit_di</parent>
		<properties>FontBold = .T.
Caption = "Äîãîâîð:"
Left = 5
Top = 278
TabIndex = 25
ZOrderSet = 21
Name = "lblDoc"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UY0O18BU</uniqueid>
		<timestamp>889809429</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>chkPay</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 473
Left = 120
FontBold = .T.
Alignment = 0
Caption = "Îïëàòà íàëè÷íûìè"
ControlSource = "lvCardEdit.CardIsPay"
TabIndex = 5
ZOrderSet = 2
Name = "chkPay"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF ThisForm.cMode = [EDIT] AND lvCardEdit.CardIsActive
	REPLACE lvCardEdit.CardExpiredDate WITH DTOT(DATE())
	ThisForm.comTxtCalendExpiredDate.Refresh()
ENDIF


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0KJN7J</uniqueid>
		<timestamp>889809429</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmcardedit_di</parent>
		<properties>Top = 73
Left = 401
Height = 48
Width = 58
lautosave = .F.
cbindobj = ThisForm.ctlTxtCLU.txtText
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAj1bSHBcgBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\WINDOWS\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC330</uniqueid>
		<timestamp>888887704</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtNote</objname>
		<parent>frmcardedit_di</parent>
		<properties>Height = 53
Left = 120
TabIndex = 36
Top = 415
Width = 321
ControlSource = "lvCardEdit.CardNote"
NullDisplay = " "
_highlightobject = .parent.lblNote
Name = "edtNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcardedit_di</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KWDI4</uniqueid>
		<timestamp>927163531</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcard_di</objname>
		<parent/>
		<properties>Top = 0
Left = 0
Height = 420
Width = 840
DoCreate = .T.
Caption = "Ñïðàâî÷íèê êàðò"
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmcard"
cstmsghandler.Top = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCard.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Çàãðóçêà ñïðàâî÷íèêà äèñêîíòíûõ êàðò
USE lvCardView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30NGVFW</uniqueid>
		<timestamp>888179462</timestamp>
		<class>grdcard</class>
		<classloc>card_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdCard</objname>
		<parent>frmcard_di</parent>
		<properties>Left = 5
Panel = 1
Top = 5
Name = "grdCard"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.Name = "Column3"
Column4.Header1.Name = "Header1"
Column4.Txtgrd1.Name = "Txtgrd1"
Column4.Name = "Column4"
Column5.Header1.Name = "Header1"
Column5.Txtgrd1.Name = "Txtgrd1"
Column5.Name = "Column5"
Column6.Header1.Name = "Header1"
Column6.Txtgrd1.Name = "Txtgrd1"
Column6.Name = "Column6"
Column7.Header1.Name = "Header1"
Column7.Txtgrd1.Name = "Txtgrd1"
Column7.Name = "Column7"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _edit
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.cntAuth.oleCommProx._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Column1.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
PROCEDURE Column2.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
PROCEDURE Column3.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UM0V63OG</uniqueid>
		<timestamp>891718086</timestamp>
		<class>cntauth</class>
		<classloc>auth_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntAuth</objname>
		<parent>frmcard_di</parent>
		<properties>Top = 340
Left = 655
Name = "cntAuth"
olecommprox.Top = 1
olecommprox.Left = 1
olecommprox.Height = 38
olecommprox.Width = 39
olecommprox.Name = "olecommprox"
txtCode.Name = "txtCode"
</properties>
		<protected/>
		<methods>PROCEDURE authresult
LPARAMETERS tnAuthResult, ;
			tcCardCode

*16.07.2006 13:37 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - c÷èòàíà êàðòà ñ êîäîì ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud_card.log],1)
*------------------------------------------------------------------------------

*16.07.2006 13:28 -&gt;Åñëè ðàáîòàòü ñ êàðòîé ìîæíî...
IF tnAuthResult = 0

	*16.07.2006 16:09 -&gt;Ñîõðàíèì â ëîã ñîáûòèå çàïóñêà îêíà ðåãèñòðàöèè
	STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - êàðòà ñ êîäîì ]+tcCardCode+[ - ðåãèñòðàöèÿ]+CHR(13),This.cLogFileDir+[Scud_card.log],1)
	*------------------------------------------------------------------------------

	*16.07.2006 16:41 -&gt;Íàéäåì êàðòó â ñïèñêå
	SELECT lvCardView
	LOCATE FOR lvCardView.CardID = lvSearchCard.CardID
	*------------------------------------------------------------------------------
	
	*16.07.2006 13:28 -&gt;...çàïóñêàåì ôîðìó äëÿ ðàáîòû ñ êàðòîé
	This.Parent.grdCard._Edit()
	*------------------------------------------------------------------------------

ELSE
	
	*16.07.2006 13:42 -&gt;Ñîõðàíèì â ëîã èíôîðìàöèþ î òîì, ÷òî c êàðòîé ðàáîòàòü íåâîçìîæíî
	STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - êàðòà ñ êîäîì ]+tcCardCode+[ - íå íàéäåíà]+CHR(13),This.cLogFileDir+[Scud_card.log],1)
	*------------------------------------------------------------------------------

	*16.07.2006 13:43 -&gt;Ïîêàæåì ñîîáùåíèå
	MESSAGEBOX([Êàðòà íå íàéäåíà],16,[Ïîèñê êàðòû],3000)
	*------------------------------------------------------------------------------
			
ENDIF
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcard_di</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_0VL0XXSOC</uniqueid>
		<timestamp>927370051</timestamp>
		<class>custom</class>
		<classloc/>
		<baseclass>custom</baseclass>
		<objname>interface</objname>
		<parent/>
		<properties>Name = "interface"
</properties>
		<protected/>
		<methods>PROCEDURE do
*-------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Cash_v1.vcx
* Class.Module....: Interface.Do
* Called by.......: &lt;Misc External Calls&gt;
* Parameters......: &lt;see below&gt;
* Returns.........: &lt;see below&gt;
* Notes...........: Îñíîâíîé ìåòîä ìåíåäæåðà áèáëèîòåêè êëèåíòîâ
*-------------------------------------------------------
LPARAMETERS	tcEntityName, ;
			tcRequstedOperation, ;
			tuParam1, ;
			tuParam2, ;
			tuParam3, ;
			tuParam4, ;			
			tuParam5, ;
			tuParam6, ;
			tuParam7, ;
			tuParam8, ;
			tuParam9, ;
			tuParam10

*19.05.2004 19:23 -&gt;Ïðîâåðÿåì ïåðâûå äâà îáÿçàòåëüíûõ ïàðàìåòðà
IF 	TYPE([tcEntityName])#[C] OR EMPTY([tcEntityName]) OR ;
	TYPE([tcRequstedOperation])#[C] OR EMPTY([tcRequstedOperation])
	*{
	ASSERT .F. MESSAGE [Discount_v1.Interface.Operate: îøèáêà âûçîâà - íåïðàâèëüíûé òèï èëè çíà÷åíèå ïàðàìåòðà]
	*}
ENDIF	
*------------------------------------------------------------------------------

*19.05.2004 19:24 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcEntityName, ;
		lcRequstedOperation, ;
		llOperateResult
***
lcEntityName = UPPER(ALLTRIM(tcEntityName))
lcRequstedOperation = UPPER(ALLTRIM(tcRequstedOperation))
*------------------------------------------------------------------------------

*05.04.2004 19:59 -&gt;Âûïîëíÿåì îïðåàöèþ íàä ñóùíîñòüþ
DO CASE

	*******************************************************************************
	*[CARDTYPE] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû c òèïàìè êàðò				  *
	*******************************************************************************
	CASE lcEntityName == [CARDTYPE] AND lcRequstedOperation == [VIEW]

		*14.05.2004 14:25 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c òèïàìè ñêèäîê
		oApp.ExecuteScrFormByObjDesc([frmcardtypeview;card_v1.vcx;card.app])
		*------------------------------------------------------------------------------

		*14.05.2004 14:25 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[CARDTYPE] &amp;&amp; [ADD] - äîáàâëåíèå òèïà ñêèäîê								  *
	*******************************************************************************
	CASE lcEntityName == [CARDTYPE] AND lcRequstedOperation == [ADD]
		
		*23.06.2006 17:35 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 (optional) - èäåíòèôèêàòîð ìàãàçèíà
		*------------------------------------------------------------------------------
		
		*23.06.2006 17:35 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmcardtypeedit;card_v1.vcx;card.app],lcRequstedOperation)
		
		*03.11.2005 14:45 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[CARDTYPE] &amp;&amp; ([EDIT] || [INFO] || [DELE])									  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå ìàãàçèíà									  *
	*******************************************************************************
	CASE lcEntityName == [CARDTYPE] AND ;
			(lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*26.06.2006 10:24 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð êàññû äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------
		
		*26.06.2006 10:24 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmcardtypeedit;card_v1.vcx;card.app],lcRequstedOperation,tuParam1)
		
		*26.06.2006 10:24 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[CARD] &amp;&amp; [VIEW] - çàïóñê ôîðìû äëÿ ðàáîòû c êàðòàìè						  *
	*******************************************************************************
	CASE lcEntityName == [CARD] AND lcRequstedOperation == [VIEW]
		*26.06.2006 11:16 -&gt;Çàïóñòèì ôîðìó äëÿ ðàáîòû c îòäåëàìè
		oApp.ExecuteScrFormByObjDesc([frmcard;card_v1.vcx;card.app])
		*------------------------------------------------------------------------------

		*26.06.2006 11:16 -&gt;Âåðíåì ôëàã óñïåøíîñòè îïåðàöèè
		RETURN .T.
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[CARD] &amp;&amp; [ADD] - äîáàâëåíèå êàðòû							  			      *
	*******************************************************************************
	CASE lcEntityName == [CARD] AND lcRequstedOperation == [ADD]
		
		*26.06.2006 11:17 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmcardedit;card_v1.vcx;card.app],lcRequstedOperation,tuParam1)
		
		*26.06.2006 11:17 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	*******************************************************************************
	*[CARD] &amp;&amp; ([EDIT] || [INFO] || [DELE])										  *
	*Ðåäàêòèðîâàíèå/ïðîñìîòð/óäàëåíèå êàðòû										  *
	*******************************************************************************
	CASE lcEntityName == [CARD] AND ;
			(lcRequstedOperation == [EDIT] OR ;
			 lcRequstedOperation == [INFO] OR ;
			 lcRequstedOperation == [DELE])

		*26.06.2006 11:18 -&gt;Ñïèñîê äîïîëíèòåëüíûõ ïàðàìåòðîâ
		* tuParam1 - èäåíòèôèêàòîð êàðòû äëÿ ðåäàêòèðîâàíèÿ/ïðîñìîòðà/óäàëåíèÿ
		*------------------------------------------------------------------------------
		
		*26.06.2006 11:18 -&gt;Âûïîëíèì îïåðàöèþ
		llOperateResult = oApp.DoModalFormRetValObj([frmcardedit;card_v1.vcx;card.app],lcRequstedOperation,tuParam1)
		
		*26.06.2006 11:19 -&gt;Âåðíåì ôëàã ðåçóëüòàòà îïåðàöèè
		RETURN llOperateResult
		*------------------------------------------------------------------------------

	OTHERWISE
	
		*26.06.2006 11:19 -&gt;Âûâåäåì ñîîáùåíèå îá îøèáêå
		MESSAGEBOX( ;
			[Ê ñîæàëåíèþ çàïðîøåííàÿ Âàìè îïåðàöèÿ íå ìîæåò áûòü âûïîëíåíà.]+CHR(13)+ ;
			[Äàííîå ñîîáùåíèå ìîæåò áûòü âûçâàíî ñëåäóþùèìè ïðè÷èíàìè:]+CHR(13)+ ;
			[1. Â äàííîé âåðñèè ïðîãðàìíîãî ïðîäóêòà äàííàÿ ôóíêöèîíàëüíîñòü íå ðåàëèçîâàíà;]+CHR(13)+ ;
			[2. Ïðîèçîøåë ïðîãðàììíûé ñáîé.],64,[Íå âûïîëíåíî...])
		*------------------------------------------------------------------------------
	
ENDCASE
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>1</reserved2>
		<reserved3>*do 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ìåíåäæåð êëèåíòîâ</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>interface</objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0UAMOZ</uniqueid>
		<timestamp>931755063</timestamp>
		<class>frm</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>getcardinfo</objname>
		<parent/>
		<properties>DoCreate = .T.
Caption = "Èíôîðìàöèÿ ïî êàðòå"
Name = "getcardinfo"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
</properties>
		<protected/>
		<methods>PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS lnCardId
LOCAL lcTableRez
lcTableRez = spGetCardInfo(lnCardId)
USE (lcTableRez) IN 0

*26.06.2006 12:26 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------

WITH This

*26.06.2006 12:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
		
		*26.06.2006 12:27 -&gt;Çàãðóçèì äàííûå î ñóùåñòâóþùåé äèñêîíòíîé êàðòå
		_PARAM = lnCardId
		***
		REQUERY([lvCardEdit])
		*------------------------------------------------------------------------------

		*26.06.2006 12:27 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
		_PARAM = lvCardEdit.CardOwnerID
		***
		REQUERY([lvCltPhysInfo])
		*------------------------------------------------------------------------------
	
*26.06.2006 12:27 -&gt;Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------

		lcTableRez = spGetCardInfo(lnCardId)
		USE (lcTableRez) IN 0 ALIAS RptItog
ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************






ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ñïðàâî÷íèêîâ
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàðò (ïóñòîé)
USE lvCardEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvCardEdit])
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ïîêóïàòåëåé
USE lvcltcustomerlist IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ñîòðóäíèêîâ
USE lvCltEmployeeList IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î ïîêóïàòåëå (ïóñòîé)
USE lvCltPhysInfo IN 0 NODATA
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î òèïàõ êàðò
USE lvCardTypeView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>2</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0V7TRZ</uniqueid>
		<timestamp>931755063</timestamp>
		<class>_commandbutton</class>
		<classloc>c:\program files\microsoft visual foxpro 9\ffc\_base.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>o_commandbutton1</objname>
		<parent>getcardinfo</parent>
		<properties>Top = 216
Left = 144
Caption = "Îòìåíèòü"
Name = "o_commandbutton1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>getcardinfo</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KWDI4</uniqueid>
		<timestamp>1015389359</timestamp>
		<class>scrfrmview</class>
		<classloc>basis.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcard</objname>
		<parent/>
		<properties>Height = 510
Width = 885
DoCreate = .T.
AutoCenter = .T.
Caption = "Ñïðàâî÷íèê êàðò"
fastadd = .F.
nusr = 0
_standarttoolbar = tlbStandart;basetoolbar_v1.vcx
Name = "frmcard"
cstmsghandler.Top = 0
cstmsghandler.Name = "cstmsghandler"
cstresizable.Top = 0
cstresizable.Name = "cstresizable"
Img1.Name = "Img1"
</properties>
		<protected/>
		<methods>PROCEDURE getcardinfo
LPARAMETERS tcCardCode
*16.07.2006 13:37 -&gt;Ñîõðàíèì â ëîã ñîáûòèå ñ÷èòûâàíèÿ êàðòû(êîä êàðòû)
*STRTOFILE(TTOC(DATETIME())+[ -&gt; ]+[RFID: - c÷èòàíà êàðòà ñ êîäîì ]+tcCardCode+CHR(13),This.cLogFileDir+[Scud_card.log],1)
*------------------------------------------------------------------------------
LOCAL lResUpdate, lnId
WAIT WINDOW tcCardCode NOWAIT
	*16.07.2006 16:41 -&gt;Íàéäåì êàðòó â ñïèñêå
	SELECT lvCardView
	LOCATE FOR lvCardView.CardCode = tcCardCode
	*------------------------------------------------------------------------------
	IF FOUND()
	*16.07.2006 13:28 -&gt;...çàïóñêàåì ôîðìó äëÿ ðàáîòû ñ êàðòîé
		This.grdCard._Edit()
	*------------------------------------------------------------------------------
		ELSE
		MESSAGEBOX('Êàðòà ñ òàêèì êîäîì â ñèñòåìå îòñóòñòâóåò',0+64,'Êàðòà íå íàéäåíà',IIF(this.fastadd = 1,1,10000))
		IF this.fastadd = 1

				*20.11.2008 12:24 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàðò (ïóñòîé)
				USE lvCardEdit IN 0 NODATA
				CURSORSETPROP([BUFFERING],3,[lvCardEdit])
				*26.06.2006 12:27 -&gt;Äîáàâèì ïóñòóþ çàïèñü
				APPEND BLANK IN lvCardEdit
				REPLACE lvCardEdit.CardSupplID  WITH  this.nusr IN lvCardEdit
				REPLACE lvCardEdit.CardIsActive WITH  .t. IN lvCardEdit
				REPLACE lvCardEdit.CardCode     WITH  ALLTRIM(tcCardCode) IN lvCardEdit
				REPLACE lvCardEdit.CardOwnerId  WITH  1 IN lvCardEdit
				SELECT lvCardEdit
				lResUpdate =TABLEUPDATE(.T.)
				lnId = spGetLastIncrementedID([lvCardEdit])
				USE IN lvCardEdit
				*------------------------------------------------------------------------------
				
				*26.06.2006 11:01 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîé êàðòû
				IF USED([lvCardRepl])
					USE IN lvCardRepl
				ENDIF
				_PARAM = lnId
				USE lvCardEdit IN 0
				CURSORSETPROP([BUFFERING],3,[lvCardEdit])
				*REPLACE lvCardEdit.CardNO      WITH  IIF(lnId&gt;250,'','ä')+ALLTRIM(STR(lnId,10,0)) IN lvCardEdit
				REPLACE lvCardEdit.CardNO      WITH  ALLTRIM(STR(lnId,10,0)) IN lvCardEdit
				REPLACE lvCardEdit.CardBolidId WITH  lnId IN lvCardEdit
				SELECT lvCardEdit
				lResUpdate =TABLEUPDATE(.T.)
				USE IN lvCardEdit
				*------------------------------------------------------------------------------
				
				USE lvCardRepl IN 0
				*26.06.2006 11:01 -&gt;Îáíîâèì äàííûå â lvCardView
				SELECT lvCardRepl
				SCATTER TO laReplaceArray
				SELECT lvCardView
				APPEND BLANK
				REPLACE CardtypeId WITH lvCardRepl.CardtypeId ,;
						CardTypeNm WITH lvCardRepl.CardTypeNm ,;
						CardNO     WITH lvCardRepl.CardNO,;
						CardCode   WITH lvCardRepl.CardCode,;
						CardDeliveryDate WITH lvCardRepl.CardDeliveryDate ,;
						CardExpiredDate WITH lvCardRepl.CardExpiredDate ,;
						CardOwnerId WITH lvCardRepl.CardOwnerId,;
						OwnerNm WITH lvCardRepl.OwnerNm,;
						CardSupplId WITH lvCardRepl.CardSupplId,;
						SupplNm WITH lvCardRepl.SupplNm,;
						CltJrdId WITH lvCardRepl.CltJrdId,;
						JrdNm WITH lvCardRepl.JrdNm,;
						CardFrmId WITH lvCardRepl.CardFrmId,;
						CardRole WITH lvCardRepl.CardRole,;
						CardIsActive WITH lvCardRepl.CardIsActive,;
						CardNote WITH lvCardRepl.CardNote
						
				SELECT lvCardView
				lResUpdate =TABLEUPDATE(.T.)
				*------------------------------------------------------------------------------
					
				*26.06.2006 11:15 -&gt;Çàêðîåì Alis
				USE IN lvCardRepl
				*------------------------------------------------------------------------------
					
				*26.06.2006 11:15 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
				SELECT lvCardView
				LOCATE FOR lvCardView.CardID = lnID
				*------------------------------------------------------------------------------
			
		ENDIF
	ENDIF


*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Init
LPARAMETERS	tnScrFrmID
DODEFAULT(tnScrFrmID)
*** Ðàçðåøàåò áûñòðîå äîáàâëåíå îòñóòñòâóþùèõ êàðò ïî ýòàëîíó
IF TYPE([oRes]) == [O]
	This.FastAdd = VAL(oRes.GetParam([BASIS],[FASTADD]))
ENDIF
this.nusr = spUserClt()

ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCard.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Îòêðîåì ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*26.06.2006 10:58 -&gt;Çàãðóçêà ñïðàâî÷íèêà äèñêîíòíûõ êàðò
USE lvCardView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>3</reserved2>
		<reserved3>fastadd Ðàçðåøàåò áûñòðîå äîáàâëåíå îòñóòñòâóþùèõ êàðò ïî ýòàëîíó
nusr êîä òåêóùåãî ïîëüçîâàòåëÿ
*getcardinfo Ðàáîòàåì ñ äàííûìè êàðòû
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ñïèñîê êàðò</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30NGVFW</uniqueid>
		<timestamp>963930459</timestamp>
		<class>grdcard</class>
		<classloc>card_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdCard</objname>
		<parent>frmcard</parent>
		<properties>HeaderHeight = 35
Height = 499
Left = 1
Panel = 1
ScrollBars = 3
Top = 5
Width = 883
Name = "grdCard"
Column1.Header1.Name = "Header1"
Column1.Txtgrd1.Name = "Txtgrd1"
Column1.Width = 89
Column1.Name = "Column1"
Column2.Header1.Name = "Header1"
Column2.Txtgrd1.Name = "Txtgrd1"
Column2.Width = 170
Column2.Name = "Column2"
Column3.Header1.Name = "Header1"
Column3.Txtgrd1.Name = "Txtgrd1"
Column3.Name = "Column3"
Column4.Header1.Name = "Header1"
Column4.Txtgrd1.Name = "Txtgrd1"
Column4.Name = "Column4"
Column5.Header1.Name = "Header1"
Column5.Txtgrd1.Name = "Txtgrd1"
Column5.Name = "Column5"
Column6.Header1.Name = "Header1"
Column6.Txtgrd1.Name = "Txtgrd1"
Column6.Name = "Column6"
Column7.Header1.Name = "Header1"
Column7.Txtgrd1.Name = "Txtgrd1"
Column7.Name = "Column7"
Column8.Header1.Name = "Header1"
Column8.Text1.Name = "Text1"
Column8.Name = "Column8"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.Olecommprox1._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.Olecommprox1._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _edit
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ
ThisForm.Olecommprox1._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
ThisForm.Olecommprox1._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*16.07.2006 16:44 -&gt;Çàêðîåì ïîðò ñ÷èòûâàòåëÿ

*Olecommprox1
This.Parent.Olecommprox1._Close()
*------------------------------------------------------------------------------
	
*16.07.2006 17:02 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*16.07.2006 16:45 -&gt;Îòêðîåì ïîðò ñ÷èòûâàòåëÿ
This.Parent.Olecommprox1._Open()
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE Column1.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
PROCEDURE Column2.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
PROCEDURE Column3.Header1.DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2890YUCHM</uniqueid>
		<timestamp>1015389359</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmcard</parent>
		<properties>Top = 396
Left = 24
Height = 48
Width = 58
ZOrderSet = 37
lautosave = .F.
cbindobj = ThisForm.txtCardNo
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE OnComm
*** ActiveX Control Event ***

*12.05.2006 11:08 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lcMsg
*------------------------------------------------------------------------------

WITH This

	*12.05.2006 11:08 -&gt;×èòàåì êîä
	lcMsg = ._Read()
	IF EMPTY(lcMsg)
		RETURN
	ENDIF
	*------------------------------------------------------------------------------
	*12.05.2006 11:10 -&gt;Ïîêàçûâàåì äàííûå ïî êàðòà
	This.Parent.GetCardInfo(lcMsg)
	*------------------------------------------------------------------------------
ENDWITH
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBVtCLF1MoBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\Windows\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcard</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0N5SIM</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>frmedit</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>frmcardedit</objname>
		<parent/>
		<properties>Height = 390
Width = 524
DoCreate = .T.
Caption = "Êàðòà"
cmode = 
Name = "frmcardedit"
cstmsghandler.Name = "cstmsghandler"
cstresizable.Name = "cstresizable"
Img1.ZOrderSet = 0
Img1.Name = "Img1"
cstdatawork.Name = "cstdatawork"
</properties>
		<protected/>
		<methods>PROCEDURE _handlecntcancelsaveevent
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Cash_v1.vcx
* Class.Module....: frmCardEdit._HandleCntCancelSaveEvent
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcMessage

WITH This

*26.06.2006 12:30 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	llResSave
*------------------------------------------------------------------------------
*26.06.2006 12:30 -&gt;Ñîõðàíèì/îòìåíèì èçìåíåíèÿ
IF tcMessage = [OK]
	IF !(ISNULL(lvCardEdit.CardExpiredDate) OR EMPTY(lvCardEdit.CardExpiredDate))
		REPLACE lvCardEdit.CardActivationDate WITH DATETIME() IN lvCardEdit
	ENDIF
	
	*26.06.2006 12:30 -&gt;Ïðè óäàëåíè óäàëèì çàïèñü
	IF .cMode = [DELE]
		
		*26.06.2006 12:30 -&gt;Óäàëèì çàïèñü
		DELETE IN lvCardEdit
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Îòêðîåì òðàíçàêöèþ
	BEGIN TRANSACTION
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Ïðîèçâîäèì ñîõðàíåíèå òàáëèöû
	llResSave = .cstDataWork.Save([lvCardEdit])
	*------------------------------------------------------------------------------
	
	*26.06.2006 12:30 -&gt;Îáðàáîòàåì ðåçóëüòàòû îïåðàöèè ñîõðàíåíèÿ
	IF llResSave
	
		*26.06.2006 12:30 -&gt;Ïîäòâåðæäàåì òðàíçàêöèþ
		END TRANSACTION
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		DO CASE
			CASE INLIST(.cMode,[EDIT],[DELE])

				*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .T.
				*------------------------------------------------------------------------------

			CASE .cMode == [ADD]
				*26.06.2006 12:31 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
				.uRetVal = .cstDataWork.GetLastID([lvCardEdit])
				*------------------------------------------------------------------------------

		ENDCASE

		IF MESSAGEBOX('Ïðîãðàììèðîâàòü êàðòó?',4+48,'Ïðîãðàììèðîâàíèå êàðòû')=6
					ltAccesEnd =  CTOT(SUBSTR(TTOC(lvCardEdit.CardExpiredDate),1,11)+'21:59:00')
					USE lvAccessWind IN 0 NODATA
			        CURSORSETPROP([BUFFERING],3,[lvAccessWind])
					INSERT INTO lvAccessWind (CardId,                     CardCode,           AccesStart, AccesEnd,;
											  Child ,        CardOwnerID,OneWay);
					                  VALUES (lvCardEdit.CardId,lvCardEdit.CardCode,DATETIME(),ltAccesEnd,;
					                  		  .f.,lvCardEdit.CardOwnerID,0 )
					TABLEUPDATE(1,.t.,'lvAccessWind')
					USE IN lvAccessWind
		ENDIF

		*------------------------------------------------------------------------------
	*	WAIT WINDOW EncodePasswordToString(ALLTRIM(this.ctlTxtCLU.TxtText.Value))
	*	_CLIPTEXT = EncodePasswordToString(ALLTRIM(this.ctlTxtCLU.txtText.Value))
	ELSE
		
		*26.06.2006 12:31 -&gt;Îòêàòûâàåì òðàíçàêöèþ
		ROLLBACK
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:31 -&gt;Îáðàáàòûâàåì îøèáêó
		IF .cstDataWork.HandleSaveFail() &amp;&amp;åñëè îøèáêà îáðàáîòàíà

			*26.06.2006 12:31 -&gt;Âîçâðàùàåìñÿ ê ðåäàêòèðîâàíèþ
			RETURN .T.
			*------------------------------------------------------------------------------
		
		ELSE
			
			*26.06.2006 12:31 -&gt;Ñîîáùàåì îá îøèáêå
			MESSAGEBOX([Â ïðîöåññå ñîõðàíåíèÿ ïðîèçîøëà îøèáêà. Èçìåíåíèÿ ñîõðàíåíû íå áóäóò.],16,[Îøèáêà...])
			*------------------------------------------------------------------------------
			
			*26.06.2006 12:31 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
			.cstDataWork.Restore([lvCardEdit])
			*------------------------------------------------------------------------------
			
		ENDIF
		*------------------------------------------------------------------------------
		
		*26.06.2006 12:32 -&gt;Ñîõðàíÿåì ðåçóëüòàòû âûïîëíåíèÿ îïåðàöèè â ñâîéñòâå .uRetVal
		.uRetVal = .F.
		*------------------------------------------------------------------------------
		
	ENDIF
	*------------------------------------------------------------------------------
	
ELSE

	*08.11.2005 12:49 -&gt;Îòìåíÿåì èçìåíåíèÿ â Aliase
	.cstDataWork.Restore([lvCardEdit])
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

*26.06.2006 12:32 -&gt;Ñêðûâàåì ôîðìó
.Hide()
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;tcCommand, tuParam1&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------
LPARAMETERS tcCommand, tuParam1
*26.06.2006 12:26 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*----------------------------------------------------------------------------
WITH This

*26.06.2006 12:26 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
PRIVATE _PARAM
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Ñîõðàíèì êîìàíäó (ðåæèì ðàáîòû ñ äàííûìè)
.cMode = UPPER(ALLTRIM(tcCommand))
*------------------------------------------------------------------------------

*26.06.2006 12:27 -&gt;Çàãðóçèì äàííûå â Alias äëÿ ðåäàêòèðîâàíèÿ
DO CASE

	CASE .cMode==[ADD]
		
		*26.06.2006 12:27 -&gt;Äîáàâèì ïóñòóþ çàïèñü
		APPEND BLANK IN lvCardEdit
		
		LOCAL nusr
		nusr = spUserClt()

		REPLACE lvCardEdit.CardSupplID  WITH  nusr IN lvCardEdit
		REPLACE lvCardEdit.CardIsActive WITH  .t. IN lvCardEdit

		IF TYPE('tuParam1')='N' AND tuParam1&lt;&gt; 0
	    	REPLACE lvCardEdit.CardOwnerID WITH tuParam1 IN lvCardEdit
		ENDIF
		*------------------------------------------------------------------------------
		
	CASE INLIST(.cMode,[EDIT],[DELE],[INFO])
		
		*26.06.2006 12:27 -&gt;Çàãðóçèì äàííûå î ñóùåñòâóþùåé äèñêîíòíîé êàðòå
		_PARAM = tuParam1
		***
		REQUERY([lvCardEdit])
		*------------------------------------------------------------------------------

		*26.06.2006 12:27 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
		_PARAM = lvCardEdit.CardOwnerID
		***
		REQUERY([lvCltPhysInfo])
		*------------------------------------------------------------------------------
		***
		lcTableRez = spGetCardInfo(tuParam1)
		USE (lcTableRez) IN 0 ALIAS RptItog
		** BolidCountToday, BolidCount
		.txtAll.Value =RptItog.BdCnt
		.txtToday.Value =RptItog.BdCntToday
		.ctlTxtCLU.txtText.Enabled = !.cnkDiscCardIsActive.Value
ENDCASE
*------------------------------------------------------------------------------

*.Icon = FULLPATH([???.ico])
DO CASE
	CASE .cMode = [ADD]
		.Caption = .Caption + [ - Äîáàâëåíèå]
	CASE .cMode = [EDIT]
		.Caption = .Caption + [ - Ðåäàêòèðîâàíèå (]+ ALLTRIM(STR(tuParam1,10,0))+')'
	CASE .cMode = [INFO]
		.Caption = .Caption + [ - Ïðîñìîòð]
		
*26.06.2006 12:27 -&gt;Çàïðåòèì ñîõðàíåíèå ïðè ïðîñìîòðå
		ThisForm.cntCancelSaveHandled.cmdOk.Enabled = .F.
		*------------------------------------------------------------------------------
		
	CASE .cMode = [DELE]
		.Caption = .Caption + [ - Óäàëåíèå]
		ThisForm.cntCancelSaveHandled.cmdOk.Caption = [Óäàëèòü]
ENDCASE
*------------------------------------------------------------------------------

ENDWITH
************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Load
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: frmCardEdit.Load
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Çàãðóçêà ñïðàâî÷íèêîâ
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì è óñòàíàâëèâàåì òåêóùå ÁÄ
IF !DBUSED([BASIS])
	OPEN DATABASE BASIS
ENDIF
***
SET DATABASE TO BASIS	
*------------------------------------------------------------------------------

*26.06.2006 12:24 -&gt;Îòêðûâàåì Alias äëÿ ðåäàêòèðîâàíèÿ êàðò (ïóñòîé)
USE lvCardEdit IN 0 NODATA
CURSORSETPROP([BUFFERING],3,[lvCardEdit])
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ïîêóïàòåëåé
USE lvcltcustomerlist IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñî ñïèñêîì ñîòðóäíèêîâ
USE lvCltEmployeeList IN 0
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î ïîêóïàòåëå (ïóñòîé)
USE lvCltPhysInfo IN 0 NODATA
*------------------------------------------------------------------------------

*26.06.2006 12:26 -&gt;Îòêðûâàåì Alias ñ èíôîðìàöèåé î òèïàõ êàðò
USE lvCardTypeView IN 0
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>44</reserved2>
		<reserved3>cmode
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7>Ðåäàêòîð êàðò</reserved7>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardCode</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Êîä êàðòû"
Left = 5
Top = 36
TabIndex = 3
ZOrderSet = 1
Name = "lblCardCode"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>ctlTxtCLU</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 33
Left = 75
Width = 249
Height = 23
TabIndex = 4
ZOrderSet = 2
Name = "ctlTxtCLU"
txtText.ControlSource = "lvCardEdit.CardCode"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 200
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblCardCode
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 207
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
IF ThisForm.cMode = [EDIT]
	ThisForm.ctlTxtCLU.txtText.Enabled = .t.
ENDIF

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVM</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>chk</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>checkbox</baseclass>
		<objname>cnkDiscCardIsActive</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 7
Left = 415
FontBold = .T.
Alignment = 0
Caption = "Êàðòà ðàáî÷àÿ"
ControlSource = "lvCardEdit.CardIsActive"
TabIndex = 5
ZOrderSet = 3
Name = "cnkDiscCardIsActive"
</properties>
		<protected/>
		<methods>PROCEDURE _handleanychange
IF ThisForm.cMode = [EDIT] AND lvCardEdit.CardIsActive
	REPLACE lvCardEdit.CardExpiredDate WITH DTOT(DATE())
	ThisForm.comTxtCalendExpiredDate.Refresh()
ENDIF
ThisForm.ctlTxtCLU.txtText.Enabled = !this.Value


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblOwner</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Âëàäåëåö:"
Left = 5
Top = 92
TabIndex = 8
ZOrderSet = 4
Name = "lblOwner"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30V4Y69</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridOwner</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 89
Left = 75
Width = 250
Height = 23
TabIndex = 9
ZOrderSet = 5
_rsaliasname = lvcltcustomerlist
_rsfieldnameid = ID
_rsfieldnametext = NM
_controlsource = lvCardEdit.CardOwnerID
_controlsourcetype = 1
Name = "cntIdCtlGridOwner"
txtText._highlightobject = .parent.parent.lblCardType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: cntIDCtlGridCustomer._RefreshRelatedObjects
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â ñâÿçàííûõ îáúåêòàõ
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
_PARAM = lvCardEdit.CardOwnerID
***
REQUERY([lvCltPhysInfo])
*------------------------------------------------------------------------------

*09.11.2005 12:10 -&gt;Îáíîâèì ïîëÿ
WITH ThisForm
	.txtFNM.Refresh()
	.txtINM.Refresh()
	.txtONM.Refresh()
	.txtCltPhysBirthDate.Refresh()
	.txtCltSity.Refresh()
	.txtCltAddr.Refresh()
	.txtCltTel.Refresh()
ENDWITH
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32O</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardType</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû:"
Left = 5
Top = 8
TabIndex = 1
ZOrderSet = 6
Name = "lblCardType"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1IA0O65KW</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp1</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 117
Left = 5
Height = 61
Width = 435
SpecialEffect = 0
ZOrderSet = 7
Name = "Shp1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U010ZVFS</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblFNM</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Ôàìèëèÿ:"
Left = 10
Top = 125
TabIndex = 10
ZOrderSet = 8
Name = "lblFNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WH</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtFNM</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysFNM"
Enabled = .F.
Left = 75
TabIndex = 11
Top = 122
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 9
Name = "txtFNM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0LECEB</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl2</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Èìÿ:"
Left = 245
Top = 125
TabIndex = 12
ZOrderSet = 10
Name = "Lbl2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtINM</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysINM"
Enabled = .F.
Height = 23
Left = 285
TabIndex = 13
Top = 122
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 11
Name = "txtINM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NI0R9WHL</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl3</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Îò÷åñòâî:"
Left = 10
Top = 153
TabIndex = 14
ZOrderSet = 12
Name = "Lbl3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WK</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtONM</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysONM"
Enabled = .F.
Left = 75
TabIndex = 15
Top = 150
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 13
Name = "txtONM"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KT0W0MLK</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl4</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Äàòà ðîæäåíèÿ:"
Left = 245
Top = 153
TabIndex = 16
ZOrderSet = 14
Name = "Lbl4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1KW0MRBGT</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltPhysBirthDate</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltPhysBirthDate"
Enabled = .F.
Format = "D"
Left = 365
TabIndex = 17
Top = 150
Width = 70
DisabledForeColor = 0,0,0
ZOrderSet = 15
NullDisplay = " "
Name = "txtCltPhysBirthDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQV</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>shp</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>shape</baseclass>
		<objname>Shp2</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 182
Left = 5
Height = 61
Width = 435
SpecialEffect = 0
ZOrderSet = 16
Name = "Shp2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQX</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltSity</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Ãîðîä:"
Left = 10
Top = 190
TabIndex = 18
ZOrderSet = 17
Name = "lblCltSity"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQW</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltSity</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltAddrSettlNM"
Enabled = .F.
Left = 75
TabIndex = 19
Top = 187
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 18
Name = "txtCltSity"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNR1</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltTel</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Òåëåôîí:"
Left = 10
Top = 218
TabIndex = 22
ZOrderSet = 19
Name = "lblCltTel"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNR0</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>txtCltTel</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCltPhysInfo.CltTelNumber"
Enabled = .F.
Left = 75
TabIndex = 23
Top = 215
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 20
Name = "txtCltTel"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQZ</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCltAddr</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Óëèöà:"
Left = 245
Top = 190
TabIndex = 20
ZOrderSet = 21
Name = "lblCltAddr"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0NQNQY</uniqueid>
		<timestamp>963935737</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>txtCltAddr</objname>
		<parent>frmcardedit</parent>
		<properties>Enabled = .F.
Height = 52
Left = 285
ScrollBars = 0
TabIndex = 21
Top = 186
Width = 150
DisabledForeColor = 0,0,0
ZOrderSet = 22
ControlSource = "lvCltPhysInfo.CltAddr"
Name = "txtCltAddr"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVO</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblEmpl</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Âûäàë:"
Left = 5
Top = 251
TabIndex = 24
ZOrderSet = 23
Name = "lblEmpl"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVN</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridEmpl</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 248
Left = 64
TabIndex = 25
ZOrderSet = 24
_controlsourcetype = 1
_controlsource = lvCardEdit.CardSupplID
_rsaliasname = lvCltEmployeeList
_rsfieldnameid = ID
_rsfieldnametext = NM
_showtextempty = Îïåðàòîð íå âûáðàí
Name = "cntIdCtlGridEmpl"
txtText._highlightobject = .parent.parent.lblEmpl
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblDeliveryDate</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Äàòà âûäà÷è:"
Left = 5
Top = 279
TabIndex = 26
ZOrderSet = 25
Name = "lblDeliveryDate"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCalendDeliveryDate</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 276
Left = 105
Width = 135
Height = 23
TabIndex = 27
ZOrderSet = 26
Name = "comTxtCalendDeliveryDate"
txtText.ControlSource = "lvCardEdit.CardDeliveryDate"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 110
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 113
cmdShow.Name = "cmdShow"
</properties>
		<protected/>
		<methods>PROCEDURE txtText._handleanychange
*26.06.2006 16:30 -&gt;Óñòàíàâëèâàåì ñðîê äåéñòâèÿ êàðòû
DO CASE
	CASE INLIST(lvCardEdit.CardTypeID,1,2)
		REPLACE lvCardEdit.CardExpiredDate WITH DTOT(TTOD(This.Value)+183)
	CASE INLIST(lvCardEdit.CardTypeID,3,4)
		REPLACE lvCardEdit.CardExpiredDate WITH DTOT(TTOD(This.Value)+1)
ENDCASE
***
ThisForm.comTxtCalendExpiredDate.Refresh()
*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NO0O51P5</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl5</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Äåéñòâèòåëüíà äî:"
Left = 273
Top = 279
TabIndex = 28
ZOrderSet = 27
Name = "Lbl5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U00XOU8Z</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>cntidctlgrid</class>
		<classloc>comidctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntIdCtlGridCardType</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 5
Left = 75
Width = 250
Height = 23
TabIndex = 2
ZOrderSet = 28
_controlsourcetype = 1
_controlsource = lvCardEdit.CardTypeID
_rsaliasname = lvCardTypeView
_rsfieldnameid = CardTypeID
_rsfieldnametext = CardTypeNM
_showtextempty = Òèï íå âûáðàí
Name = "cntIdCtlGridCardType"
txtText._highlightobject = .parent.parent.lblCardType
txtText.Name = "txtText"
cmdShow.Name = "cmdShow"
cmdClear.Name = "cmdClear"
CmdTree.Name = "CmdTree"
Olecommprox1.Top = 0
Olecommprox1.Left = 36
Olecommprox1.Height = 16
Olecommprox1.Width = 38
Olecommprox1.Enabled = .F.
Olecommprox1.Name = "Olecommprox1"
</properties>
		<protected/>
		<methods>PROCEDURE _refreshrelatedobjects
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Discount_v1.vcx
* Class.Module....: CNTIDCTLGRIDCUSTOMER._REFRESHRELATEDOBJECTS
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáíîâëåíèå èíôîðìàöèè â ñâÿçàííûõ îáúåêòàõ
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   _PARAM
*------------------------------------------------------------------------------

*09.11.2005 12:09 -&gt;Çàãðóçèì èíôîðìàöèþ î ïîêóïàòåëå		
_PARAM = lvCardEdit.CardOwnerID
***
REQUERY([lvCltPhysInfo])
*------------------------------------------------------------------------------

*09.11.2005 12:10 -&gt;Îáíîâèì ïîëÿ
WITH ThisForm
	.txtFNM.Refresh()
	.txtINM.Refresh()
	.txtONM.Refresh()
	.txtCltPhysBirthDate.Refresh()
	.txtCltSity.Refresh()
	.txtCltAddr.Refresh()
	.txtCltTel.Refresh()
ENDWITH
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVR</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin1</objname>
		<parent>frmcardedit</parent>
		<properties>Height = 0
Left = 0
Top = 360
Width = 524
ZOrderSet = 29
Name = "Lin1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0OOBVQ</uniqueid>
		<timestamp>1015389577</timestamp>
		<class>lin</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>line</baseclass>
		<objname>Lin2</objname>
		<parent>frmcardedit</parent>
		<properties>Height = 0
Left = 0
Top = 359
Width = 524
BorderColor = 255,255,255
ZOrderSet = 30
Name = "Lin2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U010ZVFS</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>cntcancelsavehandled</class>
		<classloc>baseform_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>cntCancelSaveHandled</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 364
Left = 318
TabIndex = 33
ZOrderSet = 31
Name = "cntCancelSaveHandled"
cmdCancel.Name = "cmdCancel"
cmdOk.Name = "cmdOk"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32U</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>comtxtctlcalclen</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCtlCalcLen</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 61
Left = 75
Width = 249
Height = 23
TabIndex = 7
ZOrderSet = 32
Name = "comTxtCtlCalcLen"
txtText.ControlSource = "lvCardEdit.CardNo"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 200
txtText._highlightobject = .Parent.lblLen;.Parent.Parent.lblCardNo
txtText._usedbfieldproperty = .T.
txtText.Name = "txtText"
lblLen.Left = 207
lblLen.Top = 3
lblLen.Name = "lblLen"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC32X</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblCardNo</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "¹ êàðòû"
Left = 5
Top = 64
TabIndex = 6
ZOrderSet = 33
Name = "lblCardNo"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC332</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblNote</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Ïðèìå÷àíèå:"
Left = 5
Top = 306
TabIndex = 30
ZOrderSet = 34
Name = "lblNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QIL4X</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>comtxtctlcalendar</class>
		<classloc>comtxtctl_v1.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>comTxtCalendExpiredDate</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 276
Left = 387
Width = 137
Height = 23
TabIndex = 29
ZOrderSet = 35
Name = "comTxtCalendExpiredDate"
txtText.ControlSource = "lvCardEdit.CardExpiredDate"
txtText.Height = 23
txtText.Left = 0
txtText.Top = 0
txtText.Width = 110
txtText.Name = "txtText"
cmdShow.Top = 0
cmdShow.Left = 113
cmdShow.Name = "cmdShow"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0VKYDZ</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl1</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Ïîäúåìîâ çà ñåãîäíÿ:"
Left = 336
Top = 36
TabIndex = 10
ZOrderSet = 36
Name = "Lbl1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0VKYE0</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtToday</objname>
		<parent>frmcardedit</parent>
		<properties>Enabled = .F.
Height = 23
Left = 471
TabIndex = 11
Top = 33
Width = 49
DisabledForeColor = 0,0,0
ZOrderSet = 37
Name = "TxtToday"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U010ZVFS</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl6</objname>
		<parent>frmcardedit</parent>
		<properties>FontBold = .T.
Caption = "Ïîäúåìîâ âñåãî:"
Left = 336
Top = 64
TabIndex = 14
ZOrderSet = 38
Name = "Lbl6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U011J0WH</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>TxtAll</objname>
		<parent>frmcardedit</parent>
		<properties>Enabled = .F.
Height = 23
Left = 438
TabIndex = 15
Top = 61
Width = 82
DisabledForeColor = 0,0,0
ZOrderSet = 39
Name = "TxtAll"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0VKYE3</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>lbl</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Lbl7</objname>
		<parent>frmcardedit</parent>
		<properties>AutoSize = .T.
FontBold = .T.
WordWrap = .T.
Caption = "Ïîñëåäíÿÿ ïðîäàæà:"
Height = 32
Left = 324
Top = 244
Width = 69
TabIndex = 14
ZOrderSet = 40
Name = "Lbl7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28W0VKYE4</uniqueid>
		<timestamp>963935737</timestamp>
		<class>txt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txt3</objname>
		<parent>frmcardedit</parent>
		<properties>ControlSource = "lvCardEdit.CardActivationDate"
Enabled = .F.
Height = 23
Left = 400
TabIndex = 15
Top = 250
Width = 122
DisabledForeColor = 0,0,0
ZOrderSet = 41
Name = "Txt3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1SU0KJN7J</uniqueid>
		<timestamp>1015389578</timestamp>
		<class>olecommprox</class>
		<classloc>olecomm.vcx</classloc>
		<baseclass>olecontrol</baseclass>
		<objname>Olecommprox1</objname>
		<parent>frmcardedit</parent>
		<properties>Top = 129
Left = 485
Height = 48
Width = 58
ZOrderSet = 45
lautosave = .F.
cbindobj = ThisForm.ctlTxtCLU.txtText
Name = "Olecommprox1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBulBbG1MoBAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAGAAAAAAAAAABAAAAAIAAAD+////BQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAABAAAEAAAAAgEAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACwAAAFJUaHJlc2hvbGQACQAAAEkKAAAAAQAAAAkAAABTZXR0aW5ncwATAAAASAAAAAAKAAAAOTYwMCxuAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw4LDELAAAAU1RocmVzaG9sZAAJAAAASQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</ole>
		<ole2>OLEObject = C:\Windows\system32\mscomm32.ocx
</ole2>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1U30QC330</uniqueid>
		<timestamp>963935737</timestamp>
		<class>edt</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtNote</objname>
		<parent>frmcardedit</parent>
		<properties>Height = 53
Left = 108
TabIndex = 31
Top = 303
Width = 415
ZOrderSet = 46
ControlSource = "lvCardEdit.CardNote"
NullDisplay = " "
_highlightobject = .parent.lblNote
Name = "edtNote"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>frmcardedit</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0K3ZFE</uniqueid>
		<timestamp>1100390642</timestamp>
		<class>grd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>grdcard</objname>
		<parent/>
		<properties>ColumnCount = 10
HeaderHeight = 49
Height = 410
Panel = 1
RecordSource = "lvCardView"
ScrollBars = 2
Width = 1025
HighlightStyle = 2
_handledstandartmsglist = FIRST;PREV;NEXT;LAST;ADD;EDIT;INFO;\-;EXCEL
_handledstandartmsgpromptlist = ;;;;Äîáàâèòü;Ðåäàêòèðîâàòü;Ïðîñìîòð;;Ýêñïîðò â Excel
Name = "grdcard"
Column1.ControlSource = "lvCardView.CardTypeNM"
Column1.Width = 66
Column1.Name = "Column1"
Column2.ControlSource = "lvCardView.OwnerNM"
Column2.Width = 114
Column2.Name = "Column2"
Column3.ControlSource = "lvCardView.CardNo"
Column3.Name = "Column3"
Column4.ControlSource = "lvCardView.CardCode"
Column4.Width = 82
Column4.Name = "Column4"
Column5.ControlSource = "lvCardView.JrdNM"
Column5.Width = 113
Column5.Name = "Column5"
Column6.ControlSource = "lvCardView.CardDeliveryDate"
Column6.Width = 98
Column6.Name = "Column6"
Column7.ControlSource = "lvCardView.CardExpiredDate"
Column7.Width = 107
Column7.Name = "Column7"
Column8.ControlSource = "lvCardView.CardActivationDate"
Column8.Width = 109
Column8.Name = "Column8"
Column9.ControlSource = "lvCardView.CltNote"
Column9.Name = "Column9"
Column10.ControlSource = "lvCardView.CltTelNumber"
Column10.Name = "Column10"
</properties>
		<protected/>
		<methods>PROCEDURE _add
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCard._Add
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Add()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Äîáàâëåíèå íîâîé êàðòû.
*-------------------------------------------------------

*26.06.2006 11:00 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnResAdding
*------------------------------------------------------------------------------

*26.06.2006 11:00 -&gt;Âûïîëíèì îïåðàöèþ äîáàâëåíèÿ íîâîé êàðòû
lnResAdding = oMgrCard.Do([CARD],[ADD])
*------------------------------------------------------------------------------

*26.06.2006 11:01 -&gt;Îáðàáîòàåì ðåçóëüòàòû äîáàâëåíèÿ çàïèñè
IF TYPE([lnResAdding])==[N]&amp;&amp;çàïèñü äîáàâëåíà
		
	*26.06.2006 11:01 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias, ;
			lnId, ;
			laReplaceArray[1]
			
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	lnId = lnResAdding
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:01 -&gt;Ïîëó÷èì äàííûå î äîáàâëåííîé êàðòû
	IF USED([lvCardRepl])
		USE IN lvCardRepl
	ENDIF
	_PARAM = lnId
	USE lvCardRepl IN 0
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:01 -&gt;Îáíîâèì äàííûå â lvCardView
	SELECT lvCardRepl
	SCATTER TO laReplaceArray
	SELECT lvCardView
	APPEND BLANK
	REPLACE CardtypeId WITH lvCardRepl.CardtypeId ,;
			CardTypeNm WITH lvCardRepl.CardTypeNm ,;
			CardNO     WITH lvCardRepl.CardNO,;
			CardCode   WITH lvCardRepl.CardCode,;
			CardDeliveryDate WITH lvCardRepl.CardDeliveryDate ,;
			CardExpiredDate WITH lvCardRepl.CardExpiredDate ,;
			CardOwnerId WITH lvCardRepl.CardOwnerId,;
			OwnerNm WITH lvCardRepl.OwnerNm,;
			CardSupplId WITH lvCardRepl.CardSupplId,;
			SupplNm WITH lvCardRepl.SupplNm,;
			CltJrdId WITH lvCardRepl.CltJrdId,;
			JrdNm WITH lvCardRepl.JrdNm,;
			CardFrmId WITH lvCardRepl.CardFrmId,;
			CardRole WITH lvCardRepl.CardRole,;
			CardIsActive WITH lvCardRepl.CardIsActive,;
			CardNote WITH lvCardRepl.CardNote
			
	SELECT lvCardView
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------
		
	*26.06.2006 11:15 -&gt;Çàêðîåì Alis
	USE IN lvCardRepl
	*------------------------------------------------------------------------------
		
	*26.06.2006 11:15 -&gt;Ïåðåõîäèì íà îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardView
	LOCATE FOR lvCardView.CardID = lnID
	*------------------------------------------------------------------------------

	*26.06.2006 11:15 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*26.06.2006 11:15 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
	
	*26.06.2006 11:15 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------

ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _edit
*------------------------------------------------------------------------------
* Project.........: BASIS.pjx
* Library.........: Discount_v1.vcx
* Class.Module....: grdCard._Edit
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg() -&gt; .Edit()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ðåäàêòèðîâàíèå èíôîðìàöèè î êàðòå.
*------------------------------------------------------------------------------

*26.06.2006 15:43 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL	lnId, ;
		luResEditing
***
lnId = lvCardView.CardId
*------------------------------------------------------------------------------

*26.06.2006 15:43 -&gt;Âûïîëíèì îïåðàöèþ ðåäàêòèðîâàíèÿ òèïà äîêóìåíòà
luResEditing = oMgrCard.Do([CARD],[EDIT],lnId)
*------------------------------------------------------------------------------
*26.06.2006 15:43 -&gt;Îáðàáîòàåì ðåçóëüòàòû ðåäàêòèðîâàíèÿ
IF TYPE([luResEditing])==[L] AND luResEditing &amp;&amp; äàííûå î äèñêîíòíîé êàðòå
	
	*26.06.2006 15:43 -&gt;Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
	LOCAL 	lcOldAlias
	LOCAL ARRAY laReplaceArray[1]
	PRIVATE	_PARAM
	***
	lcOldAlias = ALIAS()
	laReplaceArray = .NULL.
	*------------------------------------------------------------------------------
	
	*26.06.2006 15:43 -&gt;Ïîëó÷èì îáíîâëåííûå äàííûå î òèïå ñêèäêè
	IF USED([lvCardRepl])
		USE IN lvCardRepl
	ENDIF
	_PARAM = lnId
	USE lvCardRepl IN 0
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Îáíîâëÿåì îòðåäàêòèðîâàííûé ýëåìåíò
	SELECT lvCardView
	LOCATE FOR lvCardView.CardID = lnID
	SELECT lvCardView
	REPLACE CardtypeId WITH lvCardRepl.CardtypeId ,;
			CardTypeNm WITH lvCardRepl.CardTypeNm ,;
			CardNO     WITH lvCardRepl.CardNO,;
			CardCode   WITH lvCardRepl.CardCode,;
			CardDeliveryDate WITH lvCardRepl.CardDeliveryDate ,;
			CardExpiredDate WITH lvCardRepl.CardExpiredDate ,;
			CardOwnerId WITH lvCardRepl.CardOwnerId,;
			OwnerNm WITH lvCardRepl.OwnerNm,;
			CardSupplId WITH lvCardRepl.CardSupplId,;
			SupplNm WITH lvCardRepl.SupplNm,;
			CltJrdId WITH lvCardRepl.CltJrdId,;
			JrdNm WITH lvCardRepl.JrdNm,;
			CardFrmId WITH lvCardRepl.CardFrmId,;
			CardRole WITH lvCardRepl.CardRole,;
			CardIsActive WITH lvCardRepl.CardIsActive,;
			CardNote WITH lvCardRepl.CardNote
			
	SELECT lvCardView
	TABLEUPDATE(.T.)
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Çàêðîåì íåíóæíûé íàì Alias
	USE IN lvCardRepl
	*------------------------------------------------------------------------------

	*26.06.2006 15:44 -&gt;Âûçîâåì ìåòîä îáíîâëåíèÿ RunTime ñâîéñòâ, ñ ïðèíóäèòåëüíûì
	*08.11.2005 15:49 -&gt;âûçîâîì îáðàáîò÷èêîâ, äàæå åñëè ñâîéñòâî íå èçìåíèëîñü
	This.Refresh(.T.)
	*------------------------------------------------------------------------------
		
	*26.06.2006 15:44 -&gt;Âîññòàíîâèì òåêóùèé Alias
	IF !EMPTY(lcOldAlias) AND USED(lcOldAlias) AND lcOldAlias#ALIAS()
		SELECT(lcOldAlias)
	ENDIF
	*------------------------------------------------------------------------------
	
ENDIF
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE _handlecustommsg
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: PrimaryDoc_v1.vcx
* Class.Module....: grdFormView._HandleCustomMsg
* Called by.......: &lt;NA&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Îáðàáîòêà CustomMsg
*------------------------------------------------------------------------------
LPARAMETERS tcMsg

*14.10.2005 15:04 -&gt; Îáúÿâëåíèå è èíèöèàëèçàöèÿ ïåðåìåííûõ
LOCAL   luResult
*------------------------------------------------------------------------------

*06.12.2005 13:58 -&gt;Âûïîëíèì êîìàíäó
DO CASE

	CASE tcMsg == [GETCARDINFO]
LOCAL lnCardId
		lnCardId = lvCardView.CardId
		lRetVal = oApp.DoModalFormRetValObj([GetCardInfo;card_v1.vcx],lnFrmID  ,lnCardId)
		*------------------------------------------------------------------------------

ENDCASE
*------------------------------------------------------------------------------

*10.12.2004 13:58 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT(tcMsg)
*------------------------------------------------------------------------------

*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
PROCEDURE _info
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: DiscCard._Info
* Called by.......: &lt;ToolBar or Context Menu Action -&gt; .HandleMsg()&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........: Ïðîñìîòð èíôîðìàöèè î êàðòàõ.
*-------------------------------------------------------

*01.04.2004 18:49 -&gt;Âûïîëíèì îïåðàöèþ ïðîñìîòðà èíôîðìàöèè î äèñêîíòíûõ êàðòàõ
oMgrCard.Do([CARD],[INFO],lvCardView.CardId)
*------------------------------------------------------------------------------

************************************************************************************
**********************************  END OF METHOD **********************************
************************************************************************************
ENDPROC
PROCEDURE Column3.AddObject
LPARAMETERS cName, cClass
ENDPROC
PROCEDURE Init
*------------------------------------------------------------------------------
* Project.........: Basis.pjx
* Library.........: Card_v1.vcx
* Class.Module....: grdCard.Init
* Called by.......: &lt;Sys Event&gt;
* Parameters......: &lt;none&gt;
* Returns.........: &lt;none&gt;
* Notes...........:
*------------------------------------------------------------------------------

*26.06.2006 10:59 -&gt;Âûïîëíèì ìåòîä ðîäèòåëüñêîãî êëàññà
DODEFAULT()
*------------------------------------------------------------------------------

*26.06.2006 10:59 -&gt;Óñòàíîâèì öâåòîâóþ ãàììó äëÿ íåàêòèâíûõ êàññèðîâ
This.SetAll([DynamicForeColor],[IIF(lvCardView.CardIsActive,]+ALLTRIM(STR(This.Column1.TxtGrd1.ForeColor))+[,]+ALLTRIM(STR(This.Column1.TxtGrd1.DisabledForeColor))+[)],[Column])
*------------------------------------------------------------------------------

*16.07.2006 17:44 -&gt;Ïîäñâåòèì êàðòû ñ îêàí÷èâàþùèìñÿ ñðîêîì äåéñòâèÿ
This.Column7.DynamicForeColor = [IIF((lvCardView.CardExpiredDate-DATETIME())/(60*60*24)&lt;5,RGB(200,5,5),]+ALLTRIM(STR(This.Column1.TxtGrd1.ForeColor))+[)]
This.Column7.DynamicFontBold  = [(lvCardView.CardExpiredDate-DATETIME())/(60*60*24)&lt;5]
*------------------------------------------------------------------------------


*******************************************************************************
********************************* END METHOD **********************************
*******************************************************************************
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>Class</reserved1>
		<reserved2>21</reserved2>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6>Pixels</reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMI</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column1</parent>
		<properties>FontBold = .T.
Caption = "Òèï êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTB</uniqueid>
		<timestamp>862473607</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column1</parent>
		<properties>Left = 49
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMK</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column2</parent>
		<properties>FontBold = .T.
Caption = "Âëàäåëåö êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTC</uniqueid>
		<timestamp>862473607</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column2</parent>
		<properties>Left = 42
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KLIMM</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column3</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Íîìåð êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1NN0KPTTD</uniqueid>
		<timestamp>862473607</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column3</parent>
		<properties>Left = 23
Top = 47
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN10QW09</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column4</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Êîä êàðòû"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN11EIKH</uniqueid>
		<timestamp>888179559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column4</parent>
		<properties>Left = 20
Top = 59
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN10QW0B</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column5</parent>
		<properties>FontBold = .T.
Caption = "Îðãàíèçàöèÿ"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN11EIKI</uniqueid>
		<timestamp>888179559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column5</parent>
		<properties>Left = 64
Top = 59
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN10QW0D</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column6</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Äàòà âûäà÷è"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN11EIKJ</uniqueid>
		<timestamp>888179559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column6</parent>
		<properties>Left = 21
Top = 59
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN10QW0F</uniqueid>
		<timestamp>888180237</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column7</parent>
		<properties>FontBold = .T.
Alignment = 6
Caption = "Äàòà îêîí÷àíèÿ äåéñòâèÿ"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1UN11EIKK</uniqueid>
		<timestamp>888179559</timestamp>
		<class>txtgrd</class>
		<classloc>base_v1.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Txtgrd1</objname>
		<parent>grdcard.Column7</parent>
		<properties>Left = 29
Top = 59
Name = "Txtgrd1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28H0YYBLP</uniqueid>
		<timestamp>1100390642</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column8</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Äàòà àêòèâàöèè"
Name = "Header1"
</properties>
		<protected/>
		<methods>PROCEDURE DblClick
This.Parent.Parent.Sort(This.Parent.Name)
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_28H0YYBLQ</uniqueid>
		<timestamp>930644559</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>grdcard.Column8</parent>
		<properties>BorderStyle = 0
ControlSource = "lvCardView.CardActivationDate"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3O9172ZYH</uniqueid>
		<timestamp>1100390642</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column9</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Ïðèìå÷àíèå êëèåíòà"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3O9172ZYI</uniqueid>
		<timestamp>1100390594</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>grdcard.Column9</parent>
		<properties>BorderStyle = 0
ControlSource = "lvCardView.CltNote"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3O9172ZYJ</uniqueid>
		<timestamp>1100390642</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>grdcard.Column10</parent>
		<properties>FontBold = .T.
Alignment = 2
Caption = "Òåëåôîí"
WordWrap = .T.
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3O9172ZYK</uniqueid>
		<timestamp>1100390594</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>grdcard.Column10</parent>
		<properties>BorderStyle = 0
ControlSource = "lvCardView.CltTelNumber"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname>grdcard</objname>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 9, 6, 15, 12, 32, 3, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
